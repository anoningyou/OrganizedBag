"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[42],{7685:(Tr,kt,ie)=>{ie.d(kt,{W:()=>v});var v=function(U){return U.JSON="JSON",U.CSV="CSV",U.XLSX="XLSX",U}(v||{})},5936:(Tr,kt,ie)=>{ie.d(kt,{B:()=>v});var v=function(U){return U.Unknown="Unknown",U.String="String",U.Number="Number",U.Decimal="Decimal",U.PictureLink="PictureLink",U.Date="Date",U}(v||{})},1647:(Tr,kt,ie)=>{ie.d(kt,{O:()=>Ze});var v=ie(6452),U=ie(7990);class Ze{static getItem(Re,ct){const it=Object.assign(new v.c,Re);return it.values=ct.map(Fe=>{const Ne=Re.values.find(yt=>yt.propertyId===Fe.id),Qe=Object.assign(new U.Z,Fe);return Qe.value=Ne?.value,Qe}),it}}},6452:(Tr,kt,ie)=>{ie.d(kt,{c:()=>v});class v{constructor(){this.values=[],this.id=""}}},7990:(Tr,kt,ie)=>{ie.d(kt,{Z:()=>U});var v=ie(5936);class U{constructor(){this.name="",this.valueType=v.B.String,this.attributes=[],this.id="",this.params={}}}},4255:(Tr,kt,ie)=>{ie.d(kt,{$:()=>ht});var v=ie(7700),U=ie(9212),Ze=ie(2296);let ht=(()=>{class Re{constructor(it,Fe){this.dialogRef=it,this.title="Are you sure?",Fe&&(this.title=Fe)}onOkClick(){this.dialogRef.close(!0)}onNoClick(){this.dialogRef.close(!1)}static#e=this.\u0275fac=function(Fe){return new(Fe||Re)(U.Y36(v.so),U.Y36(v.WI))};static#t=this.\u0275cmp=U.Xpm({type:Re,selectors:[["app-yes-no"]],decls:7,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(Fe,Ne){1&Fe&&(U.TgZ(0,"h1",0),U._uU(1),U.qZA(),U.TgZ(2,"div",1)(3,"button",2),U.NdJ("click",function(){return Ne.onNoClick()}),U._uU(4,"No"),U.qZA(),U.TgZ(5,"button",3),U.NdJ("click",function(){return Ne.onOkClick()}),U._uU(6,"Yes"),U.qZA()()),2&Fe&&(U.xp6(1),U.Oqu(Ne.title),U.xp6(1),U.Q6J("align","end"))},dependencies:[Ze.lW,v.uh,v.H8]})}return Re})()},2946:(Tr,kt,ie)=>{ie.d(kt,{a:()=>ue});var v=ie(5936),U=ie(9212),Ze=ie(6223),ht=ie(6814),Re=ie(2032),ct=ie(9157),it=ie(617),Fe=ie(8034);function Ne(Te,ut){if(1&Te&&(U.TgZ(0,"mat-error"),U._uU(1),U.qZA()),2&Te){const be=U.oxw(2);U.xp6(1),U.Oqu(be.getErrorMessage())}}function Qe(Te,ut){if(1&Te&&(U.TgZ(0,"mat-form-field")(1,"mat-label"),U._uU(2),U.qZA(),U._UZ(3,"input",3),U.YNc(4,Ne,2,1,"mat-error",4),U.qZA()),2&Te){const be=U.oxw();U.xp6(2),U.Oqu(be.label),U.xp6(1),U.Q6J("type","number")("formControl",be.control)("min",be.min)("max",be.max)("step",be.step),U.xp6(1),U.Q6J("ngIf",be.control.invalid)}}function yt(Te,ut){if(1&Te&&(U.TgZ(0,"mat-error"),U._uU(1),U.qZA()),2&Te){const be=U.oxw(2);U.xp6(1),U.Oqu(be.getErrorMessage())}}function at(Te,ut){if(1&Te&&(U.TgZ(0,"mat-form-field")(1,"mat-label"),U._uU(2),U.qZA(),U._UZ(3,"input",5),U.TgZ(4,"mat-hint"),U._uU(5),U.qZA(),U._UZ(6,"mat-datepicker-toggle",6)(7,"mat-datepicker",null,7),U.YNc(9,yt,2,1,"mat-error",4),U.qZA()),2&Te){const be=U.MAs(8),Ye=U.oxw();U.xp6(2),U.Oqu(Ye.label),U.xp6(1),U.Q6J("matDatepicker",be)("formControl",Ye.control),U.xp6(2),U.Oqu(Ye.getDateFormatString()),U.xp6(1),U.Q6J("for",be),U.xp6(3),U.Q6J("ngIf",Ye.control.invalid)}}function Be(Te,ut){if(1&Te){const be=U.EpF();U.TgZ(0,"div",10),U.NdJ("click",function(){U.CHM(be);const _t=U.oxw(2);return U.KtG(_t.hidePassword=!_t.hidePassword)}),U.TgZ(1,"mat-icon"),U._uU(2),U.qZA()()}if(2&Te){const be=U.oxw(2);U.uIk("aria-label","Hide password")("aria-pressed",be.hidePassword),U.xp6(2),U.Oqu(be.hidePassword?"visibility_off":"visibility")}}function De(Te,ut){if(1&Te&&(U.TgZ(0,"mat-error"),U._uU(1),U.qZA()),2&Te){const be=U.oxw(2);U.xp6(1),U.Oqu(be.getErrorMessage())}}function oe(Te,ut){if(1&Te&&(U.TgZ(0,"mat-form-field")(1,"mat-label"),U._uU(2),U.qZA(),U._UZ(3,"input",8),U.YNc(4,Be,3,3,"div",9)(5,De,2,1,"mat-error",4),U.qZA()),2&Te){const be=U.oxw();U.xp6(2),U.Oqu(be.label),U.xp6(1),U.Q6J("type",be.hidePassword?be.type:"text")("formControl",be.control),U.xp6(1),U.Q6J("ngIf","password"===be.type),U.xp6(1),U.Q6J("ngIf",be.control.invalid)}}let ue=(()=>{class Te{constructor(be){this.ngControl=be,this.label="",this.valueType=v.B.Unknown,this.type="text",this.step=void 0,this.min=null,this.max=null,this.hidePassword=!0,this.valueTypeEnum=v.B,this.ngControl.valueAccessor=this}ngOnInit(){this.setControlType(this.valueType)}setControlType(be){switch(be){case v.B.Number:(null==this.min||isNaN(+this.min))&&(this.min=0),(null==this.step||isNaN(+this.step))&&(this.step=1),this.type="number";break;case v.B.Decimal:(null==this.min||isNaN(+this.min))&&(this.min=0),(null==this.step||isNaN(+this.step))&&(this.step=.01),this.type="number";break;case v.B.Date:this.type="date";break;default:this.type="text"}}getDateFormatString(){return"MM/DD/YYYY"}writeValue(be){}registerOnChange(be){}registerOnTouched(be){}setDisabledState(be){}get control(){return this.ngControl.control}getErrorMessage(){return this.ngControl.hasError("required")?`Please enter a ${this.label}`:this.ngControl.hasError("minlength")?`${this.label} must be at least ${this.ngControl.errors?.minlength.requiredLength} characters`:this.ngControl.hasError("maxlength")?`${this.label} must be at most ${this.ngControl.errors?.maxlength.requiredLength} characters`:this.ngControl.hasError("min")?`${this.label} must be at least ${this.ngControl.errors?.min.min}`:this.ngControl.hasError("max")?`${this.label} must be at most ${this.ngControl.errors?.max.max}`:this.ngControl.hasError("notMatching")?`${this.label} do not match`:this.ngControl.hasError("email")?"Not a valid email":""}static#e=this.\u0275fac=function(Ye){return new(Ye||Te)(U.Y36(Ze.a5,2))};static#t=this.\u0275cmp=U.Xpm({type:Te,selectors:[["app-input"]],inputs:{label:"label",valueType:"valueType",type:"type",step:"step",min:"min",max:"max"},decls:4,vars:3,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","",3,"type","formControl","min","max","step"],[4,"ngIf"],["matInput","",3,"matDatepicker","formControl"],["matIconSuffix","",3,"for"],["picker",""],["matInput","",3,"type","formControl"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"click"]],template:function(Ye,_t){1&Ye&&(U.ynx(0,0),U.YNc(1,Qe,5,7,"mat-form-field",1)(2,at,10,6,"mat-form-field",1)(3,oe,6,5,"mat-form-field",2),U.BQk()),2&Ye&&(U.Q6J("ngSwitch",_t.valueType),U.xp6(1),U.Q6J("ngSwitchCase",_t.valueType===_t.valueTypeEnum.Number||_t.valueType===_t.valueTypeEnum.Decimal?_t.valueType:""),U.xp6(1),U.Q6J("ngSwitchCase",_t.valueTypeEnum.Date))},dependencies:[ht.O5,ht.RF,ht.n9,ht.ED,Re.Nt,ct.KE,ct.hX,ct.bx,ct.TO,ct.R9,it.Hw,Fe.Mq,Fe.hl,Fe.nW,Ze.Fj,Ze.JJ,Ze.oH],styles:[".mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}"]})}return Te})()},1193:(Tr,kt,ie)=>{ie.d(kt,{T:()=>U});var v=ie(9212);let U=(()=>{class Ze{set longPress(Re){!1===Re&&this.endPress(),this.enabled=Re}constructor(Re,ct){this.elRef=Re,this.renderer=ct,this.enabled=!0,this.pressing=!1,this.longPressing=!1,this.longPressDuration=500,this.longPressingInterval=0,this.onLongPress=new v.vpe,this.onLongPressing=new v.vpe,this.onLongPressEnd=new v.vpe}onMouseDown(Re){this.enabled&&(this.renderer.addClass(this.elRef.nativeElement,"ripple-press"),this.pressing=!0,this.longPressing=!1,this.timeout=setTimeout(()=>{this.longPressing=!0,this.onLongPress.emit(Re),this.longPressingInterval>0&&(this.interval=setInterval(()=>{this.onLongPressing.emit(Re)},this.longPressingInterval))},this.longPressDuration))}endPress(){this.longPressing&&this.onLongPressEnd.emit(this.elRef.nativeElement);try{clearTimeout(this.timeout),clearInterval(this.interval)}catch{}this.longPressing=!1,this.pressing=!1}ngOnDestroy(){try{clearTimeout(this.timeout),clearInterval(this.interval)}catch{}}static#e=this.\u0275fac=function(ct){return new(ct||Ze)(v.Y36(v.SBq),v.Y36(v.Qsj))};static#t=this.\u0275dir=v.lG2({type:Ze,selectors:[["","longPress",""]],hostBindings:function(ct,it){1&ct&&v.NdJ("touchstart",function(Ne){return it.onMouseDown(Ne)})("mousedown",function(Ne){return it.onMouseDown(Ne)})("touchend",function(){return it.endPress()})("mouseup",function(){return it.endPress()})("mouseleave",function(){return it.endPress()})},inputs:{longPress:"longPress",longPressDuration:"longPressDuration",longPressingInterval:"longPressingInterval"},outputs:{onLongPress:"onLongPress",onLongPressing:"onLongPressing",onLongPressEnd:"onLongPressEnd"}})}return Ze})()},2057:(Tr,kt,ie)=>{ie.d(kt,{I:()=>Ze});var v=ie(6814),U=ie(9212);let Ze=(()=>{class ht{static#e=this.\u0275fac=function(it){return new(it||ht)};static#t=this.\u0275mod=U.oAB({type:ht});static#r=this.\u0275inj=U.cJS({imports:[v.ez]})}return ht})()},1658:(Tr,kt,ie)=>{ie.d(kt,{C:()=>Be});var v=ie(6814),U=ie(8814),Ze=ie(2057),ht=ie(4833),Re=ie(1534),ct=ie(6223),it=ie(3185),Fe=ie(9212);let Ne=(()=>{class De{static#e=this.\u0275fac=function(Te){return new(Te||De)};static#t=this.\u0275mod=Fe.oAB({type:De});static#r=this.\u0275inj=Fe.cJS({imports:[v.ez,it.vQ,U.A]})}return De})(),Qe=(()=>{class De{static#e=this.\u0275fac=function(Te){return new(Te||De)};static#t=this.\u0275mod=Fe.oAB({type:De});static#r=this.\u0275inj=Fe.cJS({imports:[v.ez,ct.u5,ct.UX,U.A]})}return De})(),yt=(()=>{class De{static#e=this.\u0275fac=function(Te){return new(Te||De)};static#t=this.\u0275mod=Fe.oAB({type:De});static#r=this.\u0275inj=Fe.cJS({imports:[v.ez,U.A]})}return De})();var at=ie(1892);let Be=(()=>{class De{static#e=this.\u0275fac=function(Te){return new(Te||De)};static#t=this.\u0275mod=Fe.oAB({type:De});static#r=this.\u0275inj=Fe.cJS({providers:[at.T],imports:[v.ez,U.A,Ze.I,ht.$,Re.A,ct.u5,Ne,Qe,yt]})}return De})()},8685:(Tr,kt,ie)=>{ie.d(kt,{J:()=>di});var v=ie(9212),U=ie(6452),Ze=ie(7990);class ht extends U.c{constructor(){super(...arguments),this.count=1}}class Re extends ht{constructor(){super(...arguments),this.isGroupBy=!1,this.groupValue=new Ze.Z,this.isSummary=!1}}var ct=ie(6236),it=ie(4255),Fe=ie(5936),Ne=ie(5313),Qe=ie(5619),yt=ie(2096),at=ie(7398),Be=ie(2572),De=ie(8180),oe=ie(2372),ue=ie(6223),Te=ie(7700),ut=ie(2296),be=ie(2946);let Ye=(()=>{class me{constructor(M,Q,Z){this.dialogRef=M,this.fb=Z,this.form=new ue.cw({}),this.valueTypeEnum=Fe.B,this.data=Q}ngOnInit(){this.initializeForm()}initializeForm(){this.form=this.fb.group({count:new ue.NI(this.data,[ue.kI.required,ue.kI.min(1)])})}onOkClick(){this.dialogRef.close(+this.form.value.count)}onNoClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(Q){return new(Q||me)(v.Y36(Te.so),v.Y36(Te.WI),v.Y36(ue.qu))};static#t=this.\u0275cmp=v.Xpm({type:me,selectors:[["app-edit-count"]],decls:10,vars:7,consts:[["mat-dialog-title",""],["autocomplete","off",1,"form",3,"formGroup","ngSubmit"],["mat-dialog-content",""],[3,"formControl","valueType","label","min"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","basic","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit","cdkFocusInitial","",3,"disabled"]],template:function(Q,Z){1&Q&&(v.TgZ(0,"h1",0),v._uU(1,"Edit count"),v.qZA(),v.TgZ(2,"form",1),v.NdJ("ngSubmit",function(){return Z.form.valid&&Z.onOkClick()}),v.TgZ(3,"div",2),v._UZ(4,"app-input",3),v.qZA(),v.TgZ(5,"div",4)(6,"button",5),v.NdJ("click",function(){return Z.onNoClick()}),v._uU(7,"Cancel"),v.qZA(),v.TgZ(8,"button",6),v._uU(9,"Save"),v.qZA()()()),2&Q&&(v.xp6(2),v.Q6J("formGroup",Z.form),v.xp6(2),v.Q6J("formControl",Z.form.controls.count)("valueType",Z.valueTypeEnum.Number)("label","Count")("min",1),v.xp6(1),v.Q6J("align","end"),v.xp6(3),v.Q6J("disabled",!Z.form.valid))},dependencies:[ue._Y,ue.JJ,ue.JL,ue.oH,ue.sg,ut.lW,Te.uh,Te.H8,Te.xY,be.a]})}return me})();var _t=ie(6825),Ut=ie(1418),wt=ie(6592),hn=ie(2942),un=ie(2425),js=ie(2032),Sr=ie(9157);let ui=(()=>{class me{constructor(M,Q,Z,ve){this.dialogRef=M,this.complectsService=Z,this.toastr=ve,this.data=Object.assign({},Q)}getTitle(){return this.data.id?"Edit group":"Add group"}onOkClick(){this.complectsService.saveGroup(this.data).subscribe({next:M=>{M?(this.toastr.success("Done!"),this.dialogRef.close(M)):this.toastr.error("Error with saving group!")},error:M=>this.toastr.error(M.error)})}onNoClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(Q){return new(Q||me)(v.Y36(Te.so),v.Y36(Te.WI),v.Y36(hn.s),v.Y36(un._W))};static#t=this.\u0275cmp=v.Xpm({type:me,selectors:[["app-group-edit-dialog"]],decls:12,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(Q,Z){1&Q&&(v.TgZ(0,"h1",0),v._uU(1),v.qZA(),v.TgZ(2,"div",1)(3,"mat-form-field")(4,"mat-label"),v._uU(5,"Name"),v.qZA(),v.TgZ(6,"input",2),v.NdJ("ngModelChange",function(Oe){return Z.data.name=Oe}),v.qZA()()(),v.TgZ(7,"div",3)(8,"button",4),v.NdJ("click",function(){return Z.onNoClick()}),v._uU(9,"Cancel"),v.qZA(),v.TgZ(10,"button",5),v.NdJ("click",function(){return Z.onOkClick()}),v._uU(11,"Save"),v.qZA()()),2&Q&&(v.xp6(1),v.Oqu(Z.getTitle()),v.xp6(5),v.Q6J("ngModel",Z.data.name),v.xp6(1),v.Q6J("align","end"))},dependencies:[ue.Fj,ue.JJ,ue.On,ut.lW,js.Nt,Sr.KE,Sr.hX,Te.uh,Te.H8,Te.xY],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}return me})();var Jn=ie(2130),jo=ie(1892),nn=ie(6814),lr=ie(5195),wi=ie(7988),Or=ie(617),Ln=ie(2596),yi=ie(5986),dn=ie(8525),Ta=ie(3680),Ca=ie(9014),ts=ie(1193),bi=ie(957),Xs=ie(8260),Nn=ie(3185);function Ji(me,gt){if(1&me&&(v.TgZ(0,"mat-option",9),v._uU(1),v.qZA()),2&me){const M=gt.$implicit;v.s9C("value",M.id),v.xp6(1),v.hij(" ",M.name," ")}}let rs=(()=>{class me{constructor(){this.subsctiptions=[],this.chartData={},this.chartOptions={},this.chartPlugins=[],this.doughnutChartType="doughnut",this.propertiesDigit$=(0,yt.of)([]),this.summPropertyIdSource=new Qe.X(void 0),this.summPropertyId$=this.summPropertyIdSource.asObservable(),this.items$=(0,yt.of)([]),this.properties$=(0,yt.of)([]),this.groups$=(0,yt.of)([]),this.groupPropertyId$=(0,yt.of)(null),this.categoryGroupId="category",this.summPropertyIdChanged=new v.vpe}ngOnInit(){this.chartPlugins.push(this.getHtmlLegendPlugin()),this.chartOptions=this.getChartOptions(),this.summPropertyIdSource.next(this.summPropertyId??"count"),this.propertiesDigit$=this.properties$.pipe((0,at.U)(Q=>Q?.filter(Z=>Z.valueType===Fe.B.Decimal||Z.valueType===Fe.B.Number)??[]));const M=(0,Be.a)([this.groups$,this.propertiesDigit$,this.items$,this.groupPropertyId$,this.summPropertyId$]).subscribe(Q=>{this.chartData=this.getChartData(Q[0],Q[1],Q[2],Q[3],Q[4])});this.subsctiptions.push(M)}ngOnDestroy(){this.subsctiptions.forEach(M=>{M.unsubscribe()})}onSummPropertyIdChanged(M){this.summPropertyIdSource.next(M),this.summPropertyIdChanged.emit(M)}getHtmlLegendPlugin(){return{id:"htmlLegend",afterUpdate(Z,ve,Oe){const st=((Z,ve)=>{const Oe=document.getElementById("legend-container");let st=Oe?.querySelector("ul");return!st&&Oe&&(st=document.createElement("ul"),st.className="legend",Oe.appendChild(st)),st})();for(;st?.firstChild;)st.firstChild.remove();const lt=Z.options.plugins.legend.labels.generateLabels(Z),er=Z.data.datasets[0].data;lt.forEach((Rt,bn)=>{const et=document.createElement("li");et.className="item",et.onclick=()=>{const{type:fr}=Z.config;"pie"===fr||"doughnut"===fr?Z.toggleDataVisibility(Rt.index):Z.setDatasetVisibility(Rt.datasetIndex,!Z.isDatasetVisible(Rt.datasetIndex)),Z.update()};const Jr=document.createElement("span");Jr.style.background=Rt.fillStyle,Jr.style.borderColor=Rt.strokeStyle,Jr.style.borderWidth=Rt.lineWidth+"px",Jr.className="marker";const mn=document.createElement("p");mn.className="name",mn.style.color=Rt.fontColor,mn.style.textDecoration=Rt.hidden?"line-through":"";const ec=document.createTextNode(Rt.text);mn.appendChild(ec);const Un=document.createElement("p");Un.className="data",Un.style.color=Rt.fontColor,Un.style.textDecoration=Rt.hidden?"line-through":"";const Qs=document.createTextNode(er[bn]);Un.appendChild(Qs),et.appendChild(Jr),et.appendChild(mn),et.appendChild(Un),st?.appendChild(et)})}}}getChartOptions(){return{responsive:!0,plugins:{legend:{display:!1}}}}getChartData(M,Q,Z,ve,Oe){const st=[];if(M&&Z){let lt={};lt=ve&&ve!==this.categoryGroupId?this.groupItemsByGrouppingField(M,Z,ve):this.groupItemsByGroups(M,Z),Object.keys(lt).forEach(er=>{st.push({key:lt[er].name,value:lt[er].items.reduce((Rt,bn)=>Rt+(Oe&&"count"!==Oe?+(bn.values.find(et=>et.id===Oe)?.value??"0")*bn.count:bn.count),0)})})}return{labels:st?.map(lt=>lt.key),datasets:[{data:st?.map(lt=>lt.value)}]}}getGroupItems(M,Q){return Q.map(Z=>({groupItem:Z,item:M.find(ve=>ve.id===Z.itemId)})).filter(Z=>Z.item).map(Z=>Object.assign(new ht,Z.item,Z.groupItem))}groupItemsByGroups(M,Q){const Z={};return M.forEach(ve=>{Z[ve.id??""]={name:ve.name??"",items:this.getGroupItems(Q,ve.items)}}),Z}groupItemsByGrouppingField(M,Q,Z){return this.getGroupItems(Q,M.map(Oe=>Oe.items)?.flat()??[]).reduce((Oe,st)=>{const lt=st.values.find(er=>er.id==Z)?.value??"";return Oe[lt]||(Oe[lt]={name:lt,items:[]}),Oe[lt].items.push(st),Oe},{})}chartClicked({}){}chartHovered({}){}static#e=this.\u0275fac=function(Q){return new(Q||me)};static#t=this.\u0275cmp=v.Xpm({type:me,selectors:[["app-chart"]],inputs:{items$:"items$",properties$:"properties$",groups$:"groups$",groupPropertyId$:"groupPropertyId$",categoryGroupId:"categoryGroupId",summPropertyId:"summPropertyId"},outputs:{summPropertyIdChanged:"summPropertyIdChanged"},decls:14,vars:10,consts:[[1,"container"],[1,"chart-container"],["baseChart","",1,"chart",3,"type","data","options","plugins"],[1,"data-container"],["appearance","outline",1,"small-outlined-select"],[3,"value","valueChange"],["value","count",1,"complect__group-select-item"],["class","complect__group-select-item",3,"value",4,"ngFor","ngForOf"],["id","legend-container",1,"legend-container"],[1,"complect__group-select-item",3,"value"]],template:function(Q,Z){1&Q&&(v.TgZ(0,"div",0)(1,"div",1),v._UZ(2,"canvas",2),v.qZA(),v.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),v._uU(6,"Summ by"),v.qZA(),v.TgZ(7,"mat-select",5),v.NdJ("valueChange",function(Oe){return Z.onSummPropertyIdChanged(Oe)}),v.ALo(8,"async"),v.TgZ(9,"mat-option",6),v._uU(10,"Count"),v.qZA(),v.YNc(11,Ji,2,2,"mat-option",7),v.ALo(12,"async"),v.qZA()(),v._UZ(13,"div",8),v.qZA()()),2&Q&&(v.xp6(2),v.Q6J("type","doughnut")("data",Z.chartData)("options",Z.chartOptions)("plugins",Z.chartPlugins),v.xp6(5),v.Q6J("value",v.lcZ(8,6,Z.summPropertyId$)),v.xp6(4),v.Q6J("ngForOf",v.lcZ(12,8,Z.propertiesDigit$)))},dependencies:[nn.sg,Nn.jh,Sr.KE,Sr.hX,dn.gD,Ta.ey,nn.Ov],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:10px}.chart-container[_ngcontent-%COMP%]{position:relative;height:100%;max-width:200px;max-height:200px}.data-container[_ngcontent-%COMP%]   .small-outlined-select[_ngcontent-%COMP%]{margin-top:5px}  .legend{margin-top:5px;display:flex;flex-direction:column;gap:2px;max-height:160px;overflow-y:auto}  .legend .item{align-items:center;cursor:pointer;display:flex;flex-direction:row;justify-content:stretch;gap:10px;word-wrap:break-word}  .legend .item .marker{display:inline-block;flex-shrink:0;height:20px;width:20px}  .legend .item .name{margin:0;padding:0;flex-grow:1;width:120px}  .legend .item .data{margin:0;padding:0;width:50px}"]})}return me})();var ns=ie(7685),ki=ie(342);function vt(me,gt){1&me&&(v.TgZ(0,"mat-icon"),v._uU(1,"edit"),v.qZA())}function Fn(me,gt){1&me&&(v.TgZ(0,"mat-icon"),v._uU(1,"add"),v.qZA())}function Xo(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"button",12),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.onEditComplectClick())}),v.YNc(1,vt,2,0,"mat-icon",13),v.ALo(2,"async"),v.YNc(3,Fn,2,0,"mat-icon",13),v.ALo(4,"async"),v.qZA()}if(2&me){const M=v.oxw();v.xp6(1),v.Q6J("ngIf",v.lcZ(2,2,M.complect$)),v.xp6(2),v.Q6J("ngIf",!v.lcZ(4,4,M.complect$))}}function Pt(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"button",14),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.onCloneComplectClick())}),v.TgZ(1,"mat-icon"),v._uU(2,"control_point_duplicate"),v.qZA()()}}function Vt(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"button",15),v.NdJ("click",function(){v.CHM(M),v.oxw();const Z=v.MAs(5);return v.KtG(Z.click())}),v.TgZ(1,"mat-icon"),v._uU(2,"download"),v.qZA()()}}function It(me,gt){if(1&me&&(v.TgZ(0,"button",16)(1,"mat-icon"),v._uU(2,"ios_share"),v.qZA()()),2&me){v.oxw();const M=v.MAs(9);v.Q6J("matMenuTriggerFor",M)}}function ur(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"button",17),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.onCopyToClipboard())}),v.ALo(1,"async"),v.TgZ(2,"mat-icon",9),v._uU(3,"content_copy"),v.qZA(),v._uU(4," Link "),v.qZA()}if(2&me){const M=v.oxw();let Q;v.Q6J("cdkCopyToClipboard",null!==(Q=v.lcZ(1,1,M.complectLink$))&&void 0!==Q?Q:"")}}let an=(()=>{class me{constructor(M){this.toastr=M,this.isReadonly=!1,this.complect$=(0,yt.of)(null),this.onEditComplect=new v.vpe,this.onCloneComplect=new v.vpe,this.onExportComplect=new v.vpe,this.onImportComplect=new v.vpe,this.complectLink$=(0,yt.of)(""),this.fileTypeEnum=ns.W,this.acceptedFiles=".json,.csv,.xlsx"}ngOnInit(){this.complectLink$=this.complect$.pipe((0,at.U)(M=>M?.id?`${location.origin}/shared/${M.id}`:""))}onEditComplectClick(){this.onEditComplect.emit()}onCloneComplectClick(){this.onCloneComplect.emit()}onCopyToClipboard(){this.toastr.success("Link was copied to the clipboard")}onExportComplectClick(M){this.onExportComplect.emit(M)}onFileSelected(M){let Z=M.currentTarget.files;Z&&Z.length&&this.onImportComplect.emit(Z[0])}static#e=this.\u0275fac=function(Q){return new(Q||me)(v.Y36(un._W))};static#t=this.\u0275cmp=v.Xpm({type:me,selectors:[["app-complect-items-header-buttons"]],inputs:{isReadonly:"isReadonly",complect$:"complect$"},outputs:{onEditComplect:"onEditComplect",onCloneComplect:"onCloneComplect",onExportComplect:"onExportComplect",onImportComplect:"onImportComplect"},decls:24,vars:12,consts:[["mat-icon-button","","color","primary","aria-label","Edit","class","small-button",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Edit item","class","small-button","matTooltip","Clone",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Import","class","small-button","matTooltip","Import",3,"click",4,"ngIf"],["hidden","","type","file","id","file",3,"accept","change"],["fileInput",""],["mat-icon-button","","color","primary","aria-label","Export","class","small-button","matTooltip","Export",3,"matMenuTriggerFor",4,"ngIf"],["exportMenu","matMenu"],["mat-menu-item","","color","primary","aria-label","Copy link to clipboard","matTooltip","Copy link to clipboard",3,"cdkCopyToClipboard","click",4,"ngIf"],["mat-menu-item","","color","primary","aria-label","Save as XLSX","matTooltip","Save as XLSX",3,"click"],["color","primary"],["mat-menu-item","","color","primary","aria-label","Save as CSV","matTooltip","Save as CSV",3,"click"],["mat-menu-item","","color","primary","aria-label","Save as JSON","matTooltip","Save as JSON",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit",1,"small-button",3,"click"],[4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Clone",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Import","matTooltip","Import",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Export","matTooltip","Export",1,"small-button",3,"matMenuTriggerFor"],["mat-menu-item","","color","primary","aria-label","Copy link to clipboard","matTooltip","Copy link to clipboard",3,"cdkCopyToClipboard","click"]],template:function(Q,Z){if(1&Q&&(v.YNc(0,Xo,5,6,"button",0)(1,Pt,3,0,"button",1),v.ALo(2,"async"),v.YNc(3,Vt,3,0,"button",2),v.TgZ(4,"input",3,4),v.NdJ("change",function(Oe){return Z.onFileSelected(Oe)}),v.qZA(),v.YNc(6,It,3,1,"button",5),v.ALo(7,"async"),v.TgZ(8,"mat-menu",null,6),v.YNc(10,ur,5,3,"button",7),v.ALo(11,"async"),v.TgZ(12,"button",8),v.NdJ("click",function(){return Z.onExportComplectClick(Z.fileTypeEnum.XLSX)}),v.TgZ(13,"mat-icon",9),v._uU(14,"save"),v.qZA(),v._uU(15," Exel "),v.qZA(),v.TgZ(16,"button",10),v.NdJ("click",function(){return Z.onExportComplectClick(Z.fileTypeEnum.CSV)}),v.TgZ(17,"mat-icon",9),v._uU(18,"save"),v.qZA(),v._uU(19," CSV "),v.qZA(),v.TgZ(20,"button",11),v.NdJ("click",function(){return Z.onExportComplectClick(Z.fileTypeEnum.JSON)}),v.TgZ(21,"mat-icon",9),v._uU(22,"save"),v.qZA(),v._uU(23," JSON "),v.qZA()()),2&Q){let ve;v.Q6J("ngIf",!Z.isReadonly),v.xp6(1),v.Q6J("ngIf",!Z.isReadonly&&v.lcZ(2,6,Z.complect$)),v.xp6(2),v.Q6J("ngIf",!Z.isReadonly),v.xp6(1),v.Q6J("accept",Z.acceptedFiles),v.xp6(2),v.Q6J("ngIf",v.lcZ(7,8,Z.complect$)),v.xp6(4),v.Q6J("ngIf",null==(ve=v.lcZ(11,10,Z.complect$))?null:ve.isShared)}},dependencies:[nn.O5,ut.RK,wi.VK,wi.OP,wi.p6,Or.Hw,Ln.gM,ki.i3,nn.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;gap:4px;padding:0 4px}"]})}return me})();function Tt(me,gt){if(1&me&&(v.TgZ(0,"mat-option",10),v._uU(1),v.qZA()),2&me){const M=gt.$implicit;v.s9C("value",M.id),v.xp6(1),v.hij(" ",M.name," ")}}function is(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"mat-card-header",3)(1,"div",4)(2,"h4",5),v._uU(3),v.ALo(4,"async"),v.qZA(),v.TgZ(5,"mat-form-field",6),v.ALo(6,"async"),v.TgZ(7,"mat-label"),v._uU(8,"Category"),v.qZA(),v.TgZ(9,"mat-select",7),v.NdJ("valueChange",function(Z){v.CHM(M);const ve=v.oxw();return v.KtG(ve.onCurrentCategoryIdChanged(Z))}),v.ALo(10,"async"),v.YNc(11,Tt,2,2,"mat-option",8),v.ALo(12,"async"),v.qZA()()(),v.TgZ(13,"button",9),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.onActiveClick())}),v.TgZ(14,"mat-icon"),v._uU(15,"work_outline"),v.qZA()()()}if(2&me){const M=v.oxw();let Q,Z;v.xp6(3),v.hij("",null==(Q=v.lcZ(4,4,M.complect$))?null:Q.name," "),v.xp6(2),v.Q6J("matBadge",v.lcZ(6,6,M.currentGroupCount$)),v.xp6(4),v.Q6J("value",v.lcZ(10,8,M.currentCategoryId$)),v.xp6(2),v.Q6J("ngForOf",null==(Z=v.lcZ(12,10,M.complect$))?null:Z.groups)}}function Ys(me,gt){if(1&me&&v._UZ(0,"app-chart",25),2&me){const M=v.oxw(2);v.Q6J("items$",M.items$)("properties$",M.properties$)("categoryGroupId",M.categoryGroupId)("groupPropertyId$",M.groupPropertyId$)("groups$",M.groups$)}}function Qt(me,gt){if(1&me&&(v.TgZ(0,"mat-option",10),v._uU(1),v.qZA()),2&me){const M=gt.$implicit;v.s9C("value",M.id),v.xp6(1),v.hij(" ",M.name," ")}}function Xt(me,gt){1&me&&v._UZ(0,"div",32)}function Qn(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"li",28),v.YNc(1,Xt,1,0,"div",29),v.TgZ(2,"mat-checkbox",30),v.NdJ("ngModelChange",function(Z){const Oe=v.CHM(M).$implicit;return v.KtG(Oe.params.complectDisplay=Z)})("click",function(Z){return Z.stopPropagation()})("change",function(){const ve=v.CHM(M).$implicit,Oe=v.oxw(3);return v.KtG(Oe.onTableHeaderSelected(ve.params))}),v._uU(3),v.qZA(),v.TgZ(4,"mat-icon",31),v._uU(5," swap_vert "),v.qZA()()}if(2&me){const M=gt.$implicit;v.xp6(2),v.Q6J("ngModel",M.params.complectDisplay)("disableRipple",!0),v.xp6(1),v.hij(" ",M.name," ")}}function Dn(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"ul",26),v.NdJ("cdkDropListDropped",function(Z){v.CHM(M);const ve=v.oxw(2);return v.KtG(ve.onHeaderDrop(Z))}),v.YNc(1,Qn,6,3,"li",27),v.qZA()}if(2&me){const M=gt.ngIf;v.Q6J("cdkDropListData",M),v.xp6(1),v.Q6J("ngForOf",M)}}function Zs(me,gt){if(1&me&&(v.TgZ(0,"mat-header-cell",51)(1,"span"),v._uU(2),v.qZA()()),2&me){const M=v.oxw(2).$implicit;v.Q6J("ngClass",M.class),v.xp6(2),v.Oqu(M.header)}}function Yo(me,gt){1&me&&v.YNc(0,Zs,3,2,"mat-header-cell",50)}function pn(me,gt){if(1&me&&(v.TgZ(0,"mat-header-cell",53)(1,"span"),v._uU(2),v.qZA()()),2&me){const M=v.oxw(2).$implicit;v.Q6J("ngClass",M.class),v.xp6(2),v.Oqu(M.header)}}function Ti(me,gt){1&me&&v.YNc(0,pn,3,2,"mat-header-cell",52)}function Zo(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"mat-icon",58),v.NdJ("mousedown",function(){v.CHM(M);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!1)})("mouseUp",function(){v.CHM(M);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!0)})("touchstart",function(){v.CHM(M);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!1)})("touchend",function(){v.CHM(M);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!0)}),v._uU(1,"more_vert"),v.qZA()}}function Al(me,gt){if(1&me&&(v.ynx(0),v.YNc(1,Zo,2,0,"mat-icon",57),v.BQk()),2&me){const M=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!M.isSummary)}}function as(me,gt){if(1&me&&(v.ynx(0),v.TgZ(1,"span",59),v._uU(2),v.qZA(),v.BQk()),2&me){const M=v.oxw().$implicit;v.xp6(2),v.Oqu(M.count)}}function Ks(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"div",61)(1,"button",62),v.NdJ("click",function(Z){v.CHM(M);const ve=v.oxw(2).$implicit,Oe=v.oxw(4);return v.KtG(Oe.openEditItemCountDialog(ve,Z))}),v.TgZ(2,"i",63),v._uU(3,"\xb1"),v.qZA()(),v.TgZ(4,"button",64),v.NdJ("click",function(Z){v.CHM(M);const ve=v.oxw(2).$implicit,Oe=v.oxw(4);return v.KtG(Oe.openEditItemDialog(ve,Z))}),v.TgZ(5,"mat-icon"),v._uU(6,"edit"),v.qZA()(),v.TgZ(7,"button",65),v.NdJ("click",function(Z){v.CHM(M);const ve=v.oxw(2).$implicit,Oe=v.oxw(4);return v.KtG(Oe.openDeleteComplectItemDialog(ve,Z))}),v.TgZ(8,"mat-icon"),v._uU(9,"delete"),v.qZA()()()}}function Ko(me,gt){if(1&me&&(v.ynx(0),v.YNc(1,Ks,10,0,"div",60),v.BQk()),2&me){const M=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!M.isSummary)}}function qn(me,gt){if(1&me&&(v.ynx(0),v.TgZ(1,"span",66),v._uU(2),v.qZA(),v.BQk()),2&me){const M=v.oxw().$implicit,Q=v.oxw().$implicit;v.xp6(2),v.Oqu(Q.cell(M))}}function Ea(me,gt){if(1&me&&(v.ynx(0),v._UZ(1,"app-item-value",67),v.BQk()),2&me){const M=v.oxw().$implicit,Q=v.oxw().$implicit;v.xp6(1),v.Q6J("property",Q.property)("value",Q.cell(M))}}function Ci(me,gt){if(1&me&&(v.TgZ(0,"mat-cell",54),v.YNc(1,Al,2,1,"ng-container",55)(2,as,3,1,"ng-container",55)(3,Ko,2,1,"ng-container",55)(4,qn,3,1,"ng-container",55)(5,Ea,2,2,"ng-container",56),v.qZA()),2&me){const M=v.oxw().$implicit;v.Q6J("ngClass",M.class)("ngSwitch",M.columnDef),v.xp6(1),v.Q6J("ngSwitchCase","move-item"),v.xp6(1),v.Q6J("ngSwitchCase","count"),v.xp6(1),v.Q6J("ngSwitchCase","actions"),v.xp6(1),v.Q6J("ngSwitchCase","category")}}function Bn(me,gt){if(1&me&&(v.ynx(0,45)(1,46),v.YNc(2,Yo,1,0,"ng-template",47)(3,Ti,1,0,"ng-template",48),v.BQk(),v.YNc(4,Ci,6,6,"mat-cell",49),v.BQk()),2&me){const M=gt.$implicit;v.Q6J("matColumnDef",M.columnDef),v.xp6(1),v.Q6J("ngSwitch",M.columnDef),v.xp6(1),v.s9C("ngSwitchCase","count"===M.columnDef||"actions"===M.columnDef||"move-item"===M.columnDef)}}function Br(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"mat-cell",68)(1,"div",69)(2,"span"),v._uU(3),v.qZA(),v._UZ(4,"app-item-value",67),v.TgZ(5,"span"),v._uU(6,'"'),v.qZA()(),v.TgZ(7,"div",61)(8,"button",64),v.NdJ("click",function(){const ve=v.CHM(M).$implicit,Oe=v.oxw(3);return v.KtG(Oe.openEditGroupDialog(ve))}),v.TgZ(9,"mat-icon"),v._uU(10,"edit"),v.qZA()(),v.TgZ(11,"button",65),v.NdJ("click",function(){const ve=v.CHM(M).$implicit,Oe=v.oxw(3);return v.KtG(Oe.openDeleteGroupDialog(ve))}),v.TgZ(12,"mat-icon"),v._uU(13,"delete"),v.qZA()()()()}if(2&me){const M=gt.$implicit;v.xp6(3),v.hij("",M.groupValue.name,': "'),v.xp6(1),v.Q6J("property",M.groupValue)("value",M.groupValue.value)}}function Js(me,gt){if(1&me&&v._UZ(0,"app-item-view",73),2&me){const M=v.oxw().$implicit;v.Q6J("item",M)}}function qt(me,gt){if(1&me&&(v.TgZ(0,"mat-cell",70)(1,"div",71),v.YNc(2,Js,1,1,"app-item-view",72),v.qZA()()),2&me){const M=gt.$implicit,Q=v.oxw().ngIf,Z=v.oxw(2);v.ekj("hidden",M!==Z.expandedElement),v.uIk("colspan",Q.length),v.xp6(1),v.Q6J("@detailExpand",M==Z.expandedElement?"expanded":"collapsed"),v.xp6(1),v.Q6J("ngIf",M==Z.expandedElement)}}function ir(me,gt){1&me&&v._UZ(0,"mat-header-row",74)}function Jo(me,gt){1&me&&v._UZ(0,"div",32)}function zr(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"mat-row",75),v.NdJ("click",function(Z){const Oe=v.CHM(M).$implicit,st=v.oxw(3);return v.KtG(st.onItemClick(Oe,Z))})("onLongPress",function(Z){const Oe=v.CHM(M).$implicit,st=v.oxw(3);return v.KtG(st.onItemLongPress(Oe,Z))}),v.YNc(1,Jo,1,0,"div",29),v.qZA()}if(2&me){const M=gt.$implicit,Q=v.oxw(3);v.ekj("expanded-row",Q.expandedElement===M),v.Q6J("cdkDragData",M)("longPress",!0)}}function Qo(me,gt){1&me&&v._UZ(0,"mat-row",76)}function gr(me,gt){1&me&&v._UZ(0,"mat-row",77),2&me&&v.Q6J("cdkDragData",gt.$implicit)("cdkDragDisabled",!0)}function ei(me,gt){1&me&&v._UZ(0,"mat-row",78),2&me&&v.Q6J("cdkDragData",gt.$implicit)("cdkDragDisabled",!0)}const yn=()=>["expandedDetail"],Ur=()=>["groupHeader"];function On(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"mat-table",33,34),v.NdJ("cdkDropListDropped",function(Z){v.CHM(M);const ve=v.oxw(2);return v.KtG(ve.onItemDrop(Z))}),v.YNc(2,Bn,5,3,"ng-container",35),v.ALo(3,"async"),v.ynx(4,36),v.YNc(5,Br,14,3,"mat-cell",37),v.BQk(),v.ynx(6,38),v.YNc(7,qt,3,5,"mat-cell",39),v.BQk(),v.YNc(8,ir,1,0,"mat-header-row",40),v.ALo(9,"async"),v.YNc(10,zr,2,4,"mat-row",41),v.ALo(11,"async"),v.YNc(12,Qo,1,0,"mat-row",42)(13,gr,1,2,"mat-row",43),v.ALo(14,"async"),v.YNc(15,ei,1,2,"mat-row",44),v.qZA()}if(2&me){const M=v.oxw(2);v.Q6J("dataSource",M.dataSource)("cdkDropListData",M.dataSource)("cdkDropListDisabled",M.dragDisabled),v.xp6(2),v.Q6J("ngForOf",v.lcZ(3,14,M.columnViews$)),v.xp6(6),v.Q6J("matHeaderRowDef",v.lcZ(9,16,M.displayedColumns$))("matHeaderRowDefSticky",!0),v.xp6(2),v.Q6J("matRowDefColumns",v.lcZ(11,18,M.displayedColumns$))("matRowDefWhen",M.isItem),v.xp6(2),v.Q6J("matRowDefColumns",v.DdM(22,yn))("matRowDefWhen",M.isItem),v.xp6(1),v.Q6J("matRowDefColumns",v.lcZ(14,20,M.displayedColumns$))("matRowDefWhen",M.isSummary),v.xp6(2),v.Q6J("matRowDefColumns",v.DdM(23,Ur))("matRowDefWhen",M.isGroup)}}function Ei(me,gt){if(1&me){const M=v.EpF();v.TgZ(0,"div",79)(1,"div",80)(2,"button",81),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw(2);return v.KtG(Z.openAddGroupDialog())}),v.TgZ(3,"mat-icon"),v._uU(4,"add"),v.qZA()()()()}}function ti(me,gt){if(1&me){const M=v.EpF();v.ynx(0),v.YNc(1,Ys,1,5,"app-chart",11),v.TgZ(2,"mat-card-header",4)(3,"mat-card-title",12)(4,"span",13),v._uU(5),v.ALo(6,"async"),v.qZA(),v.TgZ(7,"app-complect-items-header-buttons",14),v.NdJ("onEditComplect",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.openEditComplectDialog())})("onCloneComplect",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.openCloneComplectDialog())})("onExportComplect",function(Z){v.CHM(M);const ve=v.oxw();return v.KtG(ve.exportComplect(Z))})("onImportComplect",function(Z){v.CHM(M);const ve=v.oxw();return v.KtG(ve.importComplect(Z))}),v.qZA()(),v.TgZ(8,"mat-card-subtitle"),v._uU(9),v.ALo(10,"async"),v.qZA(),v.TgZ(11,"div",15)(12,"mat-form-field",16)(13,"mat-label"),v._uU(14,"Show by"),v.qZA(),v.TgZ(15,"mat-select",7),v.NdJ("valueChange",function(Z){v.CHM(M);const ve=v.oxw();return v.KtG(ve.onGroupPropertyIdChanged(Z))}),v.ALo(16,"async"),v.TgZ(17,"mat-option"),v._uU(18,"None"),v.qZA(),v.TgZ(19,"mat-option",10),v._uU(20,"Category"),v.qZA(),v.YNc(21,Qt,2,2,"mat-option",8),v.ALo(22,"async"),v.qZA()(),v.TgZ(23,"button",17)(24,"mat-icon"),v._uU(25,"settings"),v.qZA()(),v.TgZ(26,"mat-menu",18,19),v.NdJ("click",function(Z){return Z.stopPropagation()}),v.YNc(28,Dn,2,2,"ul",20),v.ALo(29,"async"),v.qZA(),v.TgZ(30,"button",21),v.NdJ("click",function(){v.CHM(M);const Z=v.oxw();return v.KtG(Z.onChartToggleClick())}),v.TgZ(31,"mat-icon"),v._uU(32,"pie_chart"),v.qZA()()()(),v.TgZ(33,"mat-card-content",22),v.YNc(34,On,16,24,"mat-table",23),v.ALo(35,"async"),v.YNc(36,Ei,5,0,"div",24),v.ALo(37,"async"),v.qZA(),v.BQk()}if(2&me){const M=v.MAs(27),Q=v.oxw();let Z,ve;v.xp6(1),v.Q6J("ngIf",Q.showChart),v.xp6(4),v.hij("",null==(Z=v.lcZ(6,13,Q.complect$))?null:Z.name," "),v.xp6(2),v.Q6J("isReadonly",Q.isReadonly)("complect$",Q.complect$),v.xp6(2),v.hij(" ",null==(ve=v.lcZ(10,15,Q.complect$))?null:ve.description," "),v.xp6(6),v.Q6J("value",v.lcZ(16,17,Q.groupPropertyId$)),v.xp6(4),v.s9C("value",Q.categoryGroupId),v.xp6(2),v.Q6J("ngForOf",v.lcZ(22,19,Q.properties$)),v.xp6(2),v.Q6J("matMenuTriggerFor",M),v.xp6(5),v.Q6J("ngIf",v.lcZ(29,21,Q.propertiesSorted$)),v.xp6(2),v.Q6J("matTooltip",Q.getChartLabel()),v.xp6(4),v.Q6J("ngIf",v.lcZ(35,23,Q.displayedColumns$)),v.xp6(2),v.Q6J("ngIf",!Q.isReadonly&&v.lcZ(37,25,Q.complect$))}}const qo=(me,gt)=>({mobile:me,inactive:gt});let di=(()=>{class me{constructor(M,Q,Z,ve){this.complectsService=M,this.dialog=Q,this.toastr=Z,this.exportService=ve,this.categoryGroupId="group",this.dataSource=new Ne.by,this.groupPropertyIdSource=new Qe.X(this.categoryGroupId),this.groupPropertyId$=this.groupPropertyIdSource.asObservable(),this.groups$=(0,yt.of)([]),this.propertiesSorted$=(0,yt.of)([]),this.propertiesFiltered$=(0,yt.of)([]),this.columnViews$=(0,yt.of)([]),this.displayedColumns$=(0,yt.of)([]),this.currentGroup$=(0,yt.of)(null),this.currentGroupCount$=(0,yt.of)(0),this.currentCategoryId=new Qe.X(void 0),this.currentCategoryId$=this.currentCategoryId.asObservable(),this.subsctiptions=[],this.dragDisabled=!0,this.expandedElement=null,this.screenStateStore=(0,v.f3M)(Jn.M),this.isActive=!1,this.isReadonly=!1,this.isActiveChange=new v.vpe,this.properties$=(0,yt.of)([]),this.items$=(0,yt.of)([]),this.complect$=(0,yt.of)(null),this.showChart=!1,this.showChartChange=new v.vpe,this.complectChange=new v.vpe,this.complectItemUpdated=new v.vpe,this.currentCategoryChange=new v.vpe,this.propertyParamChange=new v.vpe,this.propertyParamsChange=new v.vpe,this.onImportComplect=new v.vpe}ngOnInit(){this.groups$=this.complect$.pipe((0,at.U)(Q=>Q?.groups??[])),this.propertiesSorted$=this.properties$.pipe((0,at.U)(Q=>[...Q?.sort((Z,ve)=>Z.params.complectOrder>ve.params.complectOrder?1:-1)??[]])),this.propertiesFiltered$=this.propertiesSorted$.pipe((0,at.U)(Q=>Q.filter(Z=>Z.params.complectDisplay))),this.columnViews$=(0,Be.a)([this.propertiesFiltered$,this.groupPropertyId$,this.complect$]).pipe((0,at.U)(Q=>this.getColumns(Q[0],Q[1],Q[2]))),this.displayedColumns$=this.columnViews$.pipe((0,at.U)(Q=>Q.map(Z=>Z.columnDef)??[])),this.currentGroup$=(0,Be.a)([this.complect$,this.currentCategoryId$]).pipe((0,at.U)(Q=>{const Z=Q[0],ve=Q[1];let Oe=null;return Z&&(Oe=Z.groups.find(st=>st.id==ve)??Z.groups[0]??null),ve!==Oe?.id&&this.currentCategoryId.next(Oe?.id),this.currentCategoryChange.emit(Oe),Oe})),this.currentGroupCount$=this.currentGroup$.pipe((0,at.U)(Q=>Q?.items?.reduce((Z,ve)=>Z+ve.count,0)??0));const M=(0,Be.a)([this.groups$,this.items$,this.propertiesFiltered$,this.groupPropertyId$]).subscribe(Q=>{this.dataSource.data=Q[0]&&Q[1]?this.getComplectItemViews(Q[0],Q[1],Q[2],Q[3]):[],this.table?.renderRows()});this.subsctiptions.push(M)}ngOnDestroy(){this.subsctiptions.forEach(M=>{M.unsubscribe()}),this.currentCategoryChange.emit(null)}onGroupPropertyIdChanged(M){this.groupPropertyIdSource.next(M)}onTableHeaderSelected(M){this.propertyParamChange.emit(M)}onHeaderDrop(M){const Q=M.container.data?.map(Z=>Z.params)??[];(0,ct.bA)(Q,M.previousIndex,M.currentIndex),Q.forEach((Z,ve)=>{Z.complectOrder=ve}),this.propertyParamsChange.emit(Q)}onItemDrop(M){this.dragDisabled=!0,this.complect$.pipe((0,De.q)(1)).subscribe(Q=>{if(!Q)return;const Z=0===M.currentIndex?1:M.currentIndex-1;let ve=M.container.data.data[Z];if(ve)if(ve.groupId||(ve=M.container.data.data[Z-1]),M.previousContainer===M.container){const Oe=M.previousContainer.data.data[M.previousIndex];this.changeItemGroup(Oe.id,Oe.groupId,ve.groupId)}else{const Oe=M.item.data,st=Q.groups.find(lt=>lt.id===ve.groupId)??Q.groups[0];this.complectsService.addItemToGroup(Oe,st)}})}onChartToggleClick(){this.showChart=!this.showChart,this.showChartChange.emit(this.showChart)}onActiveClick(){this.isActiveChange.emit()}onCurrentCategoryIdChanged(M){M!==this.currentCategoryId.value&&this.currentCategoryId.next(M)}onItemClick(M,Q){this.screenStateStore.isMobile()||(this.expandedElement=this.expandedElement===M?null:M,Q.stopPropagation())}onItemLongPress(M,Q){this.screenStateStore.isMobile()&&(this.expandedElement=this.dragDisabled?this.expandedElement===M?null:M:null,Q.stopPropagation())}onCopyToClipboard(){this.toastr.success("Link was copied to the clipboard")}getColumns(M,Q,Z){const ve=M.map(Oe=>({columnDef:Oe.id??"",header:Oe.name,property:Oe,cell:st=>`${st.values.find(lt=>lt.id===Oe.id)?.value}`,width:`${Oe.params.complectWidth??50} px`,class:"item__value"}))??[];return Q!==this.categoryGroupId?ve.push({columnDef:"group",header:"Group",property:null,cell:Oe=>Z?.groups?.find(st=>st.id===Oe.groupId)?.name??"",width:"30px",class:"item__category"}):this.isReadonly||ve.unshift({columnDef:"move-item",header:"",property:null,cell:()=>"",width:"30px",class:"move"}),ve.push({columnDef:"count",header:"Count",property:null,cell:Oe=>`${Oe.count}`,width:"20px",class:"value count"}),this.isReadonly||ve.push({columnDef:"actions",header:"",property:null,cell:Oe=>"",width:"30px",class:"actions"}),ve}getComplectItemViews(M,Q,Z,ve){return M&&Q?ve===this.categoryGroupId?this.getItemsByGroups(M,Q,Z):this.getItemsByGrouppingField(M,Q,Z,ve):[]}getItemViews(M,Q){return Q.map(Z=>({groupItem:Z,item:M.find(ve=>ve.id===Z.itemId)})).filter(Z=>Z.item).map(Z=>Object.assign(new Re,Z.item,Z.groupItem))}getItemsByGroups(M,Q,Z){const ve={};return M.forEach(Oe=>{const st=new Ze.Z;st.value=st.id=Oe.name,st.name="Group",ve[Oe.id??""]=[{isGroupBy:!0,groupValue:st,groupId:Oe.id}].concat(this.getItemViews(Q,Oe.items))}),this.fillGroupViews(ve,Z)}getItemsByGrouppingField(M,Q,Z,ve){let Oe=this.getItemViews(Q,M.map(st=>st.items)?.flat()??[]);return ve&&(Oe=this.groupItemsByProp(Oe,Z,ve)),Oe}groupItemsByProp(M,Q,Z){const ve=M.reduce((Oe,st)=>{const lt=st.values.find(Rt=>Rt.id==Z),er=lt?.value??"";return Oe[er]||(Oe[er]=[{isGroupBy:!0,groupValue:lt}]),Oe[er].push(st),Oe},{});return this.fillGroupViews(ve,Q)}fillGroupViews(M,Q){let Z=[];return Object.keys(M).forEach(ve=>{Z=Z.concat(M[ve]);const Oe=[];Q.forEach(st=>{Oe.push(0)}),M[ve].forEach(st=>{st.isGroupBy||st.values.forEach((lt,er)=>{(lt.valueType===Fe.B.Decimal||lt.valueType===Fe.B.Number)&&(Oe[er]+=+(lt.value??"0")*st.count)})}),Z.push({isSummary:!0,count:M[ve].splice(1).reduce((st,lt)=>st+lt.count,0),values:Q.map((st,lt)=>{const er=Object.assign(new Ze.Z,st);return er.value=er.valueType===Fe.B.Decimal||er.valueType===Fe.B.Number?Oe[lt].toString():"",er})})}),Z}changeItemGroup(M,Q,Z){Q!==Z&&this.complect$.pipe((0,De.q)(1)).subscribe(ve=>{const Oe=ve?.groups.find(bn=>bn.id==Q),st=ve?.groups.find(bn=>bn.id==Z),lt=Oe?.items?.find(bn=>bn.itemId==M);if(!Oe||!st||!lt)return;const Rt={itemId:lt.itemId,groupId:st.id,count:lt.count};this.complectsService.deleteGroupItem({itemId:lt.itemId,groupId:lt.groupId,count:lt.count}),this.complectsService.addGroupItemToGroup(Rt,st)})}isGroup(M,Q){return Q.isGroupBy}isSummary(M,Q){return Q.isSummary}isItem(M,Q){return!Q.isGroupBy&&!Q.isSummary}getChartLabel(){return(this.showChart?"Hide":"Show")+" chart"}openEditComplectDialog(){this.complect$.pipe((0,De.q)(1)).subscribe(M=>{this.dialog.open(wt.g,{data:M}).afterClosed().subscribe(Z=>{Z&&this.complectChange.emit(Z)})})}openCloneComplectDialog(){this.complect$.pipe((0,De.q)(1)).subscribe(M=>{if(M){const Q=Object.assign({},M);Q.id="",Q.groups=M.groups.map(ve=>{const Oe=Object.assign({},ve);return Oe.id=(0,oe.Z)(),Oe.items=ve.items.map(st=>{const lt=Object.assign({},st);return lt.groupId=Oe.id??"",lt}),Oe}),this.dialog.open(wt.g,{data:Q}).afterClosed().subscribe(ve=>{ve&&this.complectChange.emit(ve)})}})}openEditItemDialog(M,Q){Q.stopPropagation(),this.dialog.open(Ut.s,{data:M})}openCloneItemDialog(M,Q){Q.stopPropagation();const Z=Object.assign(new U.c,M);Z.id="",this.dialog.open(Ut.s,{data:Z}).afterClosed().subscribe(Oe=>{this.complect$.pipe((0,De.q)(1)).subscribe(st=>{if(Oe&&st){const lt=st.groups.find(er=>er.id===M.groupId)??st.groups[0];this.complectsService.addItemToGroup(Oe,lt)}})})}openEditItemCountDialog(M,Q){Q.stopPropagation(),this.dialog.open(Ye,{data:M.count}).afterClosed().subscribe(ve=>{ve&&ve>0&&ve!==M.count&&this.complect$.pipe((0,De.q)(1)).subscribe(Oe=>{if(Oe){const st=Oe?.groups.find(lt=>!!M.groupId&&lt.id===M.groupId)?.items.find(lt=>lt.itemId==M.id);st&&(st.count=ve),this.complectsService.updateGroupItem({itemId:M.id,groupId:M.groupId,count:ve})}})})}openDeleteComplectItemDialog(M,Q){Q.stopPropagation(),this.dialog.open(it.$,{data:"Delete item from complect?"}).afterClosed().subscribe(ve=>{ve&&this.complectsService.deleteGroupItem({itemId:M.id,groupId:M.groupId,count:M.count})})}openAddGroupDialog(){this.complect$.pipe((0,De.q)(1)).subscribe(M=>{M&&this.dialog.open(ui,{data:{complectId:M?.id,items:[]}})})}openEditGroupDialog(M){this.complect$.pipe((0,De.q)(1)).subscribe(Q=>{const Z=Q?.groups?.find(ve=>ve.id===M.groupId);Z&&this.dialog.open(ui,{data:Z})})}openDeleteGroupDialog(M){this.dialog.open(it.$,{data:"Delete group?"}).afterClosed().subscribe(Z=>{Z&&this.complect$.pipe((0,De.q)(1)).subscribe(ve=>{this.complectsService.deleteGroup({id:M.groupId,complectId:ve?.id})})})}changeDragDisabled(M){this.dragDisabled=M}exportComplect(M){(0,Be.a)([this.complect$,this.items$,this.properties$]).pipe((0,De.q)(1)).subscribe(Q=>{Q[0]&&Q[1]&&Q[2]&&this.exportService.saveToFile({complect:Q[0],items:Q[1],properties:Q[2]},M)})}importComplect(M){this.onImportComplect.emit(M)}static#e=this.\u0275fac=function(Q){return new(Q||me)(v.Y36(hn.s),v.Y36(Te.uw),v.Y36(un._W),v.Y36(jo.T))};static#t=this.\u0275cmp=v.Xpm({type:me,selectors:[["app-complect-items"]],viewQuery:function(Q,Z){if(1&Q&&v.Gf(Ne.BZ,5),2&Q){let ve;v.iGM(ve=v.CRH())&&(Z.table=ve.first)}},inputs:{isActive:"isActive",isReadonly:"isReadonly",properties$:"properties$",items$:"items$",complect$:"complect$",showChart:"showChart"},outputs:{isActiveChange:"isActiveChange",showChartChange:"showChartChange",complectChange:"complectChange",complectItemUpdated:"complectItemUpdated",currentCategoryChange:"currentCategoryChange",propertyParamChange:"propertyParamChange",propertyParamsChange:"propertyParamsChange",onImportComplect:"onImportComplect"},decls:3,vars:6,consts:[[1,"complect-container","card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],[4,"ngIf"],[1,"mobile-preview"],[1,"header"],[1,"name"],["appearance","outline","matBadgeOverlap","true",1,"small-outlined-select","stretch-badge",3,"matBadge"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[3,"value"],["class","chart",3,"items$","properties$","categoryGroupId","groupPropertyId$","groups$",4,"ngIf"],[1,"title"],[1,"header-name"],[3,"isReadonly","complect$","onEditComplect","onCloneComplect","onExportComplect","onImportComplect"],[1,"buttons-container","complect-buttons"],["appearance","outline",1,"small-outlined-select","category-grouping-select"],["mat-icon-button","","color","primary","aria-label","Show headers","matTooltip","Show headers",3,"matMenuTriggerFor"],[1,"table-headers-menu",3,"click"],["listHeadersMenu","matMenu"],["class","table-headers-menu-list","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Toggle chart",3,"matTooltip","click"],[1,"complect-items"],["multiTemplateDataRows","","cdkDropList","","id","complectItemsList","cdkDropListConnectedTo","itemsList",3,"dataSource","cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],["class","end-row",4,"ngIf"],[1,"chart",3,"items$","properties$","categoryGroupId","groupPropertyId$","groups$"],["cdkDropList","",1,"table-headers-menu-list",3,"cdkDropListData","cdkDropListDropped"],["class","item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",1,"item"],["class","drag-placeholder",4,"cdkDragPlaceholder"],[3,"ngModel","disableRipple","ngModelChange","click","change"],["cdkDragHandle","",1,"drag-handle"],[1,"drag-placeholder"],["multiTemplateDataRows","","cdkDropList","","id","complectItemsList","cdkDropListConnectedTo","itemsList",3,"dataSource","cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["complectItemsList","cdkDropList"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","groupHeader"],["class","cell","colspan","999",4,"matCellDef"],["matColumnDef","expandedDetail"],["class","detail-cell",3,"hidden",4,"matCellDef"],["class","row table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","row item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary","#complectItemsList",3,"expanded-row","cdkDragData","longPress","click","onLongPress",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row detail-row",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row summary","cdkDrag","",3,"cdkDragData","cdkDragDisabled",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row group-item","cdkDrag","",3,"cdkDragData","cdkDragDisabled",4,"matRowDef","matRowDefColumns","matRowDefWhen"],[3,"matColumnDef"],[3,"ngSwitch"],[3,"ngSwitchCase"],["ngSwitchDefault",""],[3,"ngClass","ngSwitch",4,"matCellDef"],["sticky","",3,"ngClass",4,"matHeaderCellDef"],["sticky","",3,"ngClass"],[3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass"],[3,"ngClass","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","reorder",3,"mousedown","mouseUp","touchstart","touchend",4,"ngIf"],[1,"reorder",3,"mousedown","mouseUp","touchstart","touchend"],[1,"count-value"],["class","buttons-container",4,"ngIf"],[1,"buttons-container"],["mat-icon-button","","color","primary","aria-label","Edit count",1,"small-button",3,"click"],[1,"mat-icon"],["mat-icon-button","","color","primary","aria-label","Edit item",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete from complect",1,"small-button",3,"click"],[1,"category"],[1,"value",3,"property","value"],["colspan","999",1,"cell"],[1,"container"],[1,"detail-cell"],[1,"detail"],[3,"item",4,"ngIf"],[3,"item"],[1,"row","table-header"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary","#complectItemsList",1,"row","item",3,"cdkDragData","longPress","click","onLongPress"],[1,"row","detail-row"],["cdkDrag","",1,"row","summary",3,"cdkDragData","cdkDragDisabled"],["cdkDrag","",1,"row","group-item",3,"cdkDragData","cdkDragDisabled"],[1,"end-row"],[1,"buttons"],["mat-icon-button","","color","primary","aria-label","Add category","matTooltip","Add category",1,"add-category-btn",3,"click"]],template:function(Q,Z){1&Q&&(v.TgZ(0,"mat-card",0),v.YNc(1,is,16,12,"mat-card-header",1)(2,ti,38,27,"ng-container",2),v.qZA()),2&Q&&(v.Q6J("ngClass",v.WLB(3,qo,Z.screenStateStore.isMobilePortrait(),!Z.isActive)),v.xp6(1),v.Q6J("ngIf",Z.screenStateStore.isMobilePortrait()&&!Z.isActive),v.xp6(1),v.Q6J("ngIf",!Z.screenStateStore.isMobilePortrait()||Z.isActive))},dependencies:[nn.mk,nn.sg,nn.O5,nn.RF,nn.n9,nn.ED,ut.RK,lr.a8,lr.dn,lr.dk,lr.$j,lr.n5,Sr.KE,Sr.hX,wi.VK,wi.p6,Ne.BZ,Ne.fO,Ne.as,Ne.w1,Ne.Dz,Ne.nj,Ne.ge,Ne.ev,Ne.XQ,Ne.Gk,Or.Hw,ct.Wj,ct.Zt,ct.Bh,ct.Hk,Ln.gM,yi.oG,dn.gD,Ta.ey,Ca.k,ts.T,bi.F,Xs.H,ue.JJ,ue.On,rs,an,nn.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;background:#F5F5F5;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.buttons-container[_ngcontent-%COMP%]{display:flex;align-items:center}.complect-buttons[_ngcontent-%COMP%]{width:100%}  .mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{top:25px!important}.chart-container[_ngcontent-%COMP%]{height:40%;margin-bottom:4px}.chart-container[_ngcontent-%COMP%]   .chart[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content}.complect-container[_ngcontent-%COMP%]{height:100%}.complect-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:16px 36px 0;justify-content:space-between;flex-wrap:wrap}.complect-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 10px;margin:0;display:flex;flex-wrap:nowrap;justify-content:space-between;align-items:center;gap:10px}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:0 0 5px;flex-grow:1;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:2px;max-width:calc(100% - 65px)}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:block}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:500}.table-headers-menu-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;min-width:190px}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;padding-right:10px;justify-content:space-between;align-items:center;transition:box-shadow .2s cubic-bezier(0,0,.2,1)}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active{background:#F5F5F5}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:move}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:100px;transition:transform .25s cubic-bezier(0,0,.2,1)}.complect-items[_ngcontent-%COMP%]{height:calc(100% - 75px);overflow-y:auto}.row[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .group-item[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:none;position:absolute;right:0;z-index:100}.row[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%], .group-item[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .group-item[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{display:flex}.row[_ngcontent-%COMP%]{min-height:30px;overflow-wrap:break-word;position:relative}.row[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{display:flex}.row.group-item[_ngcontent-%COMP%], .row.group-item[_ngcontent-%COMP%]:hover{background-color:#0000000a}.row[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:white;border:3px dotted rgba(0,0,0,.14);min-height:35px}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{max-width:0;min-width:0;padding-left:0;padding-right:0;position:relative;overflow:visible}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{background-color:#fdfdfd;border-radius:10px}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{position:relative;width:0;max-width:0;min-width:0;padding-left:0;padding-right:0;overflow:visible}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]   .reorder[_ngcontent-%COMP%]{position:absolute;left:-5px;top:0;z-index:100;cursor:move;display:block;color:#0003}.row[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{max-width:60px}.row[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]   .count-value[_ngcontent-%COMP%]{width:50px;border:none;outline:none;padding:5px;margin:auto 0}.row.expanded-row[_ngcontent-%COMP%], .row.detail-row[_ngcontent-%COMP%]{background-color:#00000008}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom-width:0!important}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:none}.row.draggable-row[_ngcontent-%COMP%]{border:red 1px solid}.group-item[_ngcontent-%COMP%]{font-weight:500}.group-item[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{display:flex;justify-content:space-between;position:relative}.group-item[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;gap:2px;align-items:center}.summary[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.summary[_ngcontent-%COMP%]   .count-value[_ngcontent-%COMP%]{padding:0 5px}.detail-row[_ngcontent-%COMP%]{min-height:0}.detail-row[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{overflow:hidden;width:100%;padding-bottom:5px}.end-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;position:sticky;bottom:0;width:100%;height:30px}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add-category-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.card.mobile[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{min-height:60px}"],data:{animation:[(0,_t.X$)("detailExpand",[(0,_t.SB)("collapsed",(0,_t.oB)({height:"0px",minHeight:"0"})),(0,_t.SB)("expanded",(0,_t.oB)({height:"*"})),(0,_t.eR)("expanded <=> collapsed",(0,_t.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]},changeDetection:0})}return me})()},6592:(Tr,kt,ie)=>{ie.d(kt,{g:()=>Ne});var v=ie(7700),U=ie(9212),Ze=ie(2942),ht=ie(6223),Re=ie(2296),ct=ie(2032),it=ie(9157),Fe=ie(5986);let Ne=(()=>{class Qe{constructor(at,Be,De){this.dialogRef=at,this.complectsService=De,this.data=Be?Object.assign({},Be):this.complectsService.createNewComplect()}getTitle(){return this.data.id?"Edit complect":"Add complect"}onOkClick(){this.complectsService.saveComplect(this.data),this.dialogRef.close(this.data)}onNoClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(Be){return new(Be||Qe)(U.Y36(v.so),U.Y36(v.WI),U.Y36(Ze.s))};static#t=this.\u0275cmp=U.Xpm({type:Qe,selectors:[["app-complect-edit-dialog"]],decls:22,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["matInput","",3,"hidden","ngModel","ngModelChange"],[3,"ngModel","labelPosition","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(Be,De){1&Be&&(U.TgZ(0,"h1",0),U._uU(1),U.qZA(),U.TgZ(2,"div",1)(3,"mat-form-field")(4,"mat-label"),U._uU(5,"Name"),U.qZA(),U.TgZ(6,"input",2),U.NdJ("ngModelChange",function(ue){return De.data.name=ue}),U.qZA()(),U.TgZ(7,"mat-form-field")(8,"mat-label"),U._uU(9,"Description"),U.qZA(),U.TgZ(10,"input",2),U.NdJ("ngModelChange",function(ue){return De.data.description=ue}),U.qZA()(),U.TgZ(11,"mat-form-field")(12,"mat-label"),U._uU(13,"Public"),U.qZA(),U.TgZ(14,"input",3),U.NdJ("ngModelChange",function(ue){return De.data.isShared=ue}),U.qZA(),U.TgZ(15,"mat-checkbox",4),U.NdJ("ngModelChange",function(ue){return De.data.isShared=ue}),U._uU(16," Share complect "),U.qZA()()(),U.TgZ(17,"div",5)(18,"button",6),U.NdJ("click",function(){return De.onNoClick()}),U._uU(19,"Cancel"),U.qZA(),U.TgZ(20,"button",7),U.NdJ("click",function(){return De.onOkClick()}),U._uU(21,"Save"),U.qZA()()),2&Be&&(U.xp6(1),U.Oqu(De.getTitle()),U.xp6(5),U.Q6J("ngModel",De.data.name),U.xp6(4),U.Q6J("ngModel",De.data.description),U.xp6(4),U.Q6J("hidden",!0)("ngModel",De.data.isShared),U.xp6(1),U.Q6J("ngModel",De.data.isShared)("labelPosition","before"),U.xp6(2),U.Q6J("align","end"))},dependencies:[ht.Fj,ht.JJ,ht.On,Re.lW,ct.Nt,it.KE,it.hX,v.uh,v.H8,v.xY,Fe.oG],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}return Qe})()},1418:(Tr,kt,ie)=>{ie.d(kt,{s:()=>yt});var v=ie(6223),U=ie(7700),Ze=ie(6452),ht=ie(7990),Re=ie(9212),ct=ie(1859),it=ie(6814),Fe=ie(2946),Ne=ie(2296);function Qe(at,Be){if(1&at&&(Re.ynx(0),Re._UZ(1,"app-input",7),Re.BQk()),2&at){const De=Be.$implicit,oe=Re.oxw();Re.xp6(1),Re.Q6J("formControl",oe.form.controls[De.id])("valueType",De.valueType)("label",De.name)}}let yt=(()=>{class at{constructor(De,oe,ue,Te){this.dialogRef=De,this.itemsService=ue,this.fb=Te,this.form=new v.cw({}),oe?(this.data=Object.assign(new Ze.c,oe),this.data.values=oe.values.map(ut=>Object.assign(new ht.Z,ut))):this.data=this.itemsService.createNewItem()}ngOnInit(){this.initializeForm()}initializeForm(){const De={};this.data.values.forEach(oe=>{De[oe.id]=new v.NI(oe.value||"",this.getValidators(oe))}),this.form=this.fb.group(De)}getValidators(De){const oe=[];return"Name"===De.name&&oe.push(v.kI.required),oe}getTitle(){return this.data.id?"Edit item":"Add item"}onOkClick(){const De=this.form.value;this.data.values.forEach(ue=>{ue.value=De[ue.id]});const oe=this.itemsService.saveItem(this.data);this.dialogRef.close(oe)}onNoClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(oe){return new(oe||at)(Re.Y36(U.so),Re.Y36(U.WI),Re.Y36(ct.L),Re.Y36(v.qu))};static#t=this.\u0275cmp=Re.Xpm({type:at,selectors:[["app-item-edit-dialog"]],decls:10,vars:5,consts:[["mat-dialog-title",""],["autocomplete","off",1,"form",3,"formGroup","ngSubmit"],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","basic","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit","cdkFocusInitial","",3,"disabled"],[3,"formControl","valueType","label"]],template:function(oe,ue){1&oe&&(Re.TgZ(0,"h1",0),Re._uU(1),Re.qZA(),Re.TgZ(2,"form",1),Re.NdJ("ngSubmit",function(){return ue.form.valid&&ue.onOkClick()}),Re.TgZ(3,"div",2),Re.YNc(4,Qe,2,3,"ng-container",3),Re.qZA(),Re.TgZ(5,"div",4)(6,"button",5),Re.NdJ("click",function(){return ue.onNoClick()}),Re._uU(7,"Cancel"),Re.qZA(),Re.TgZ(8,"button",6),Re._uU(9,"Save"),Re.qZA()()()),2&oe&&(Re.xp6(1),Re.Oqu(ue.getTitle()),Re.xp6(1),Re.Q6J("formGroup",ue.form),Re.xp6(2),Re.Q6J("ngForOf",ue.data.values),Re.xp6(1),Re.Q6J("align","end"),Re.xp6(3),Re.Q6J("disabled",!ue.form.valid))},dependencies:[it.sg,Fe.a,v._Y,v.JJ,v.JL,v.oH,v.sg,Ne.lW,U.uh,U.H8,U.xY],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{max-width:360px;width:360px;display:flex;flex-direction:column}@media only screen and (max-width: 560px){.mdc-dialog__content[_ngcontent-%COMP%]{width:100%}}"]})}return at})()},1534:(Tr,kt,ie)=>{ie.d(kt,{A:()=>Ze});var v=ie(6814),U=ie(9212);let Ze=(()=>{class ht{static#e=this.\u0275fac=function(it){return new(it||ht)};static#t=this.\u0275mod=U.oAB({type:ht});static#r=this.\u0275inj=U.cJS({imports:[v.ez]})}return ht})()},8260:(Tr,kt,ie)=>{ie.d(kt,{H:()=>it});var v=ie(5936),U=ie(9212),Ze=ie(6814);function ht(Fe,Ne){if(1&Fe&&(U.TgZ(0,"span"),U._uU(1),U.ALo(2,"date"),U.qZA()),2&Fe){const Qe=U.oxw(2);U.xp6(1),U.hij(" ",U.xi3(2,1,Qe.value,"shortDate")," ")}}function Re(Fe,Ne){if(1&Fe&&(U.TgZ(0,"p",3),U.YNc(1,ht,3,4,"span",4),U.qZA()),2&Fe){const Qe=U.oxw();U.xp6(1),U.Q6J("ngIf",!!Qe.value&&"undefined"!==Qe.value&&"null"!==Qe.value)}}function ct(Fe,Ne){if(1&Fe&&(U.TgZ(0,"p",3),U._uU(1),U.qZA()),2&Fe){const Qe=U.oxw();U.xp6(1),U.hij(" ",Qe.value," ")}}let it=(()=>{class Fe{constructor(){this.valueTypeEnum=v.B}static#e=this.\u0275fac=function(yt){return new(yt||Fe)};static#t=this.\u0275cmp=U.Xpm({type:Fe,selectors:[["app-item-value"]],inputs:{property:"property",value:"value"},decls:3,vars:2,consts:[[1,"item-value",3,"ngSwitch"],["class","item-value__value",4,"ngSwitchCase"],["class","item-value__value",4,"ngSwitchDefault"],[1,"item-value__value"],[4,"ngIf"]],template:function(yt,at){1&yt&&(U.TgZ(0,"div",0),U.YNc(1,Re,2,1,"p",1)(2,ct,2,1,"p",2),U.qZA()),2&yt&&(U.Q6J("ngSwitch",null==at.property?null:at.property.valueType),U.xp6(1),U.Q6J("ngSwitchCase",at.valueTypeEnum.Date))},dependencies:[Ze.O5,Ze.RF,Ze.n9,Ze.ED,Ze.uU],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center}.item-value[_ngcontent-%COMP%]   .item-value__value[_ngcontent-%COMP%]{margin:0;padding:5px 0;min-height:20px;-webkit-hyphens:auto;hyphens:auto;word-break:break-all}"]})}return Fe})()},4833:(Tr,kt,ie)=>{ie.d(kt,{$:()=>Re});var v=ie(6814),U=ie(8814),Ze=ie(1534),ht=ie(9212);let Re=(()=>{class ct{static#e=this.\u0275fac=function(Ne){return new(Ne||ct)};static#t=this.\u0275mod=ht.oAB({type:ct});static#r=this.\u0275inj=ht.cJS({imports:[v.ez,U.A,Ze.A]})}return ct})()},957:(Tr,kt,ie)=>{ie.d(kt,{F:()=>yt});var v=ie(9212),U=ie(6814),Ze=ie(5195),ht=ie(5313),Re=ie(8260);function ct(at,Be){if(1&at&&(v.TgZ(0,"mat-cell",8),v._uU(1),v.qZA()),2&at){const De=Be.$implicit;v.xp6(1),v.hij(" ",De.name," ")}}function it(at,Be){if(1&at&&(v.TgZ(0,"mat-cell"),v._UZ(1,"app-item-value",9),v.qZA()),2&at){const De=Be.$implicit;v.xp6(1),v.Q6J("property",De)("value",De.value)}}function Fe(at,Be){1&at&&v._UZ(0,"mat-row")}const Ne=()=>["name","value"];function Qe(at,Be){if(1&at&&(v.TgZ(0,"mat-card",1)(1,"mat-card-content")(2,"mat-table",2),v.ynx(3,3),v.YNc(4,ct,2,1,"mat-cell",4),v.BQk(),v.ynx(5,5),v.YNc(6,it,2,2,"mat-cell",6),v.BQk(),v.YNc(7,Fe,1,0,"mat-row",7),v.qZA()()()),2&at){const De=v.oxw();v.xp6(2),v.Q6J("dataSource",De.item.values),v.xp6(5),v.Q6J("matRowDefColumns",v.DdM(2,Ne))}}let yt=(()=>{class at{static#e=this.\u0275fac=function(oe){return new(oe||at)};static#t=this.\u0275cmp=v.Xpm({type:at,selectors:[["app-item-view"]],inputs:{item:"item"},decls:1,vars:1,consts:[["class","item",4,"ngIf"],[1,"item"],[3,"dataSource"],["matColumnDef","name"],["class","name",4,"matCellDef"],["matColumnDef","value"],[4,"matCellDef"],[4,"matRowDef","matRowDefColumns"],[1,"name"],[1,"value",3,"property","value"]],template:function(oe,ue){1&oe&&v.YNc(0,Qe,8,3,"mat-card",0),2&oe&&v.Q6J("ngIf",ue.item)},dependencies:[U.O5,Ze.a8,Ze.dn,ht.BZ,ht.w1,ht.Dz,ht.nj,ht.ev,ht.Gk,Re.H],styles:[".item[_ngcontent-%COMP%]{width:100%}.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}"]})}return at})()},5744:(Tr,kt,ie)=>{ie.d(kt,{B:()=>v});class v{constructor(Ze){this.accountService=Ze,this.unsinchronised=!1}init(){this.accountService.currentUser$.subscribe(Ze=>{(this.userId??"")!==(Ze?.id??"")&&(this.userId?this.cleanData():this.mergeData(),this.userId=Ze?.id)}),this.loadAll()}execAuthorisedHttp(Ze,ht){return!!this.userId&&(Ze.subscribe({next:ht,error:Re=>{console.error(Re),this.unsinchronised=!0}}),!0)}}},2942:(Tr,kt,ie)=>{ie.d(kt,{s:()=>at});var v=ie(9212),U=ie(5619),Ze=ie(7398),ht=ie(2572),Re=ie(8180),ct=ie(5744),it=ie(2372),Fe=ie(6719),Ne=ie(4826),Qe=ie(1474);let yt=(()=>{class Be extends Ne.q{constructor(oe){super(oe,"complects")}getAll(){return this.http.get(`${this.rootUrl}getall`)}add(oe){return this.http.post(`${this.rootUrl}add`,oe)}edit(oe){return this.http.put(`${this.rootUrl}edit`,oe)}delete(oe){const ue=(new Qe.LE).set("id",oe);return this.http.delete(`${this.rootUrl}delete`,{params:ue})}addGroup(oe){return this.http.post(`${this.rootUrl}addGroup`,oe)}deleteGroup(oe){const ue=(new Qe.LE).set("id",oe);return this.http.delete(`${this.rootUrl}deleteGroup`,{params:ue})}updateGroup(oe){return this.http.put(`${this.rootUrl}updateGroup`,oe)}addItem(oe){return this.http.post(`${this.rootUrl}addItem`,oe)}deleteItem(oe){const ue=(new Qe.LE).set("itemId",oe.itemId).set("groupId",oe.groupId);return this.http.delete(`${this.rootUrl}deleteItem`,{params:ue})}updateItem(oe){return this.http.put(`${this.rootUrl}updateItem`,oe)}static#e=this.\u0275fac=function(ue){return new(ue||Be)(v.LFG(Qe.eN))};static#t=this.\u0275prov=v.Yz7({token:Be,factory:Be.\u0275fac,providedIn:"root"})}return Be})(),at=(()=>{class Be extends ct.B{constructor(oe,ue){super(oe),this.complectsHttp=ue,this.complectsSource=new U.X([]),this.complects$=this.complectsSource.asObservable().pipe((0,Ze.U)(Te=>(localStorage.setItem("complects",JSON.stringify(Te)),Te))),this.currentGroup=new U.X(null),this.currentGroup$=this.currentGroup.asObservable(),this.groupItemAdded=new v.vpe,this.currentComplectSource=new U.X(null),this.currentComplect$=(0,ht.a)({currentComplect:this.currentComplectSource.asObservable(),complects:this.complects$}).pipe((0,Ze.U)(Te=>Te.currentComplect)),this.init()}cleanData(){localStorage.removeItem("complects"),this.complectsSource.next([])}mergeData(){this.loadComplects().subscribe(oe=>{})}loadAll(){if(this.userId)this.loadComplects().subscribe(oe=>{this.checkCurrentComplect()});else{const oe=localStorage.getItem("complects");if(oe){const ue=JSON.parse(oe);this.complectsSource.next(ue),this.checkCurrentComplect()}}}loadComplects(){return this.complectsHttp.getAll().pipe((0,Ze.U)(oe=>{const ue=oe??[];return this.complectsSource.next(ue),ue}))}createNewComplect(){return{id:null,name:"",description:"",groups:[this.createNewGroup()]}}createNewGroup(oe=null){return{id:(0,it.Z)(),name:"Default group",complectId:null,items:[]}}saveComplect(oe){oe.id?this.updateComplect(oe):this.addComplect(oe)}addComplect(oe){this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{oe.id=(0,it.Z)(),oe.groups.length?oe.groups.forEach(Te=>{Te.id=(0,it.Z)(),Te.complectId=oe.id??"",Te.items.forEach(ut=>{ut.groupId=Te.id??""})}):oe.groups.push(this.createNewGroup(oe.id)),ue.push(oe),this.complectsSource.next(ue),this.setCurrentComplect(oe),this.execAuthorisedHttp(this.complectsHttp.add(oe))})}updateComplect(oe){this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{var Te=ue.findIndex(ut=>ut.id===oe.id);ue[Te]=oe,this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.edit(oe))})}deleteComplect(oe){return this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{const Te=ue.filter(ut=>ut.id!==oe);this.complectsSource.next(Te)}),this.execAuthorisedHttp(this.complectsHttp.delete(oe)),this.checkCurrentComplect(),!0}saveGroup(oe){return oe.id?this.updateGroup(oe):this.addGroup(oe)}addGroup(oe){return oe.id=(0,it.Z)(),this.complects$.pipe((0,Re.q)(1)).pipe((0,Ze.U)(ue=>{const Te=ue.find(ut=>ut.id==oe.complectId);return Te?(Te.groups.push(oe),this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.addGroup(oe)),oe):null}))}updateGroup(oe){return this.complects$.pipe((0,Re.q)(1)).pipe((0,Ze.U)(ue=>{const Te=ue.find(be=>be.id==oe.complectId),ut=Te?.groups?.findIndex(be=>be.id===oe.id)??-1;return Te&&-1!=ut?(Te.groups[ut].name=oe.name,this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.updateGroup(oe)),oe):null}))}deleteGroup(oe){return this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{const Te=ue.find(ut=>ut.id==oe.complectId);Te&&oe.id&&(Te.groups=Te.groups.filter(ut=>ut.id!==oe.id),this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.deleteGroup(oe.id)))})}addGroupItemToGroup(oe,ue){this.complects$.pipe((0,Re.q)(1)).subscribe(Te=>{const be=Te.find(Ut=>Ut.id===ue.complectId)?.groups?.find(Ut=>Ut.id===ue.id);if(!be)return;const Ye=Object.assign({},oe);Ye.groupId=be.id??"";let _t=0;if(be.items){const Ut=be.items.find(wt=>wt.itemId===oe.itemId);Ut&&(_t=Ut.count,Ut.count+=Ye.count,Ye.count=Ut.count)}else be.items=[];_t||be.items.push(Ye),this.complectsSource.next(Te),this.groupItemAdded.emit(oe),this.execAuthorisedHttp(_t?this.complectsHttp.updateItem(Ye):this.complectsHttp.addItem(Ye))})}addItemToGroup(oe,ue){this.addGroupItemToGroup({itemId:oe.id,groupId:ue.id,count:1},ue)}addItemToCurrentGroup(oe){return this.currentGroup$.pipe((0,Re.q)(1),(0,Ze.U)(ue=>!!ue&&(this.addItemToGroup(oe,ue),!0)))}updateGroupItem(oe){this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{let Te=-1;const ut=ue.find(be=>(Te=be.groups.findIndex(Ye=>Ye.id===oe.groupId),Te>-1));if(ut){const be=ut.groups[Te].items.findIndex(Ye=>Ye.itemId===oe.itemId)??-1;-1!==be&&(ut.groups[Te].items[be]=oe)}this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.updateItem(oe))})}deleteGroupItem(oe){this.complects$.pipe((0,Re.q)(1)).subscribe(ue=>{let Te=-1;const ut=ue.find(be=>(Te=be.groups.findIndex(Ye=>Ye.id===oe.groupId),Te>-1));if(ut){const be=ut.groups[Te],Ye=be.items.findIndex(_t=>_t.itemId===oe.itemId)??-1;-1!==Ye&&be.items.splice(Ye,1)}this.complectsSource.next(ue),this.execAuthorisedHttp(this.complectsHttp.deleteItem(oe))})}setCurrentGroup(oe){this.currentGroup.next(oe??null)}setCurrentComplect(oe){this.currentComplectSource.next(oe??null),this.checkCurrentComplect()}checkCurrentComplect(){(0,ht.a)({currentComplect:this.currentComplect$,complects:this.complects$}).pipe((0,Re.q)(1)).subscribe(oe=>{let ue=oe.currentComplect;if(oe.complects.length){if(!oe.currentComplect&&oe.complects.length)ue=oe.complects[0];else if(oe.currentComplect&&oe.complects.length){const Te=oe.complects.find(ut=>ut.id===oe.currentComplect?.id);Te?Te!==ue&&(ue=Te):ue=oe.complects[0]}}else ue=null;ue!==oe.currentComplect&&this.currentComplectSource.next(ue)})}static#e=this.\u0275fac=function(ue){return new(ue||Be)(v.LFG(Fe.B),v.LFG(yt))};static#t=this.\u0275prov=v.Yz7({token:Be,factory:Be.\u0275fac,providedIn:"root"})}return Be})()},1892:(Tr,kt,ie)=>{ie.d(kt,{T:()=>Re});var v=ie(7685),U=ie(1486),Ze=ie(5936),ht=ie(9212);let Re=(()=>{class ct{constructor(){}saveToFile(Fe,Ne){switch(Ne){case v.W.CSV:this.saveCsvFile(Fe);break;case v.W.XLSX:this.saveExcelFile(Fe);break;default:this.saveJsonFile(Fe)}}getExportComplect(Fe){return{name:Fe.complect.name,description:Fe.complect.description,groups:Fe.complect.groups.map(Ne=>({name:Ne.name,items:Ne.items.map(Qe=>this.getExportItem(Qe,Fe.items))}))}}getExportItem(Fe,Ne){return{id:Fe.itemId,count:Fe.count,values:Ne.find(Qe=>Qe.id===Fe.itemId)?.values?.map(Qe=>({id:Qe.id,attributes:Qe.attributes,name:Qe.name,valueType:Qe.valueType,value:Qe.value}))}}getDataArray(Fe){const Ne=[];return Fe.forEach(Qe=>{Qe.items.forEach(yt=>{let at=[Qe.name];at=at.concat(yt.values.map(Be=>{switch(Be.valueType){case Ze.B.Number:case Ze.B.Decimal:return Be.value?+Be.value:Be.value;case Ze.B.Date:return Be.value?new Date(Date.parse(Be.value)).toLocaleDateString():null;default:return Be.value}})),at.push(yt.count),Ne.push(at)})}),Ne}downoadFile(Fe){const Ne=document.createElement("a");Ne.setAttribute("href",`${Fe.type},${encodeURIComponent(Fe.data)}`),Ne.setAttribute("download",Fe.name),Ne.style.display="none",document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne)}saveExcelFile(Fe){const Ne=this.getExportComplect(Fe),Qe=["Group"];Ne.groups[0]?.items[0]?.values.forEach(Be=>{Qe.push(Be.name)}),Qe.push("Count");const yt=U.P6.book_new(),at=U.P6.json_to_sheet([]);U.P6.sheet_add_aoa(at,[Qe]),U.P6.sheet_add_aoa(at,this.getDataArray(Ne.groups),{origin:"A2"}),U.P6.book_append_sheet(yt,at,Ne.name),(0,U.NC)(yt,`${Ne.name}.xlsx`)}saveJsonFile(Fe){const Ne=this.getExportComplect(Fe);this.downoadFile({data:JSON.stringify(Ne),name:`${Ne.name}.json`,type:"data:text/json;charset=utf-8"})}saveCsvFile(Fe){const Ne=this.getExportComplect(Fe);let Qe="";const yt=["Group"];Ne.groups[0]?.items[0]?.values.forEach(Be=>{yt.push(Be.name)}),yt.push("Count"),Qe+=yt.join(",")+"\n",this.getDataArray(Ne.groups).forEach(Be=>{Qe+=Be.map(De=>De||"").join(",")+"\n"}),this.downoadFile({data:Qe,name:`${Ne.name}.csv`,type:"data:text/csv;charset=utf-8"})}static#e=this.\u0275fac=function(Ne){return new(Ne||ct)};static#t=this.\u0275prov=ht.Yz7({token:ct,factory:ct.\u0275fac})}return ct})()},1859:(Tr,kt,ie)=>{ie.d(kt,{L:()=>ue});var v=ie(5619),U=ie(2572),Ze=ie(7398),ht=ie(8180),Re=ie(6452),ct=ie(7990),it=ie(5744),Fe=ie(2372),Ne=ie(1647),Qe=ie(9212),yt=ie(4826),at=ie(1474);let Be=(()=>{class Te extends yt.q{constructor(be){super(be,"items")}getAll(){return this.http.get(`${this.rootUrl}getall`)}add(be){return this.http.post(`${this.rootUrl}add`,be)}addRange(be){return this.http.post(`${this.rootUrl}addRange`,be)}edit(be){return this.http.put(`${this.rootUrl}edit`,be)}delete(be){const Ye=(new at.LE).set("id",be);return this.http.delete(`${this.rootUrl}delete`,{params:Ye})}static#e=this.\u0275fac=function(Ye){return new(Ye||Te)(Qe.LFG(at.eN))};static#t=this.\u0275prov=Qe.Yz7({token:Te,factory:Te.\u0275fac,providedIn:"root"})}return Te})(),De=(()=>{class Te extends yt.q{constructor(be){super(be,"properties")}getAll(){return this.http.get(`${this.rootUrl}getall`)}updateParam(be){return this.http.put(`${this.rootUrl}updateParam`,be)}updateParams(be){return this.http.put(`${this.rootUrl}updateParams`,be)}static#e=this.\u0275fac=function(Ye){return new(Ye||Te)(Qe.LFG(at.eN))};static#t=this.\u0275prov=Qe.Yz7({token:Te,factory:Te.\u0275fac,providedIn:"root"})}return Te})();var oe=ie(6719);let ue=(()=>{class Te extends it.B{constructor(be,Ye,_t){super(_t),this.itemsHttp=be,this.propertiesHttp=Ye,this.itemsSource=new v.X([]),this.items$=this.itemsSource.asObservable(),this.propertiesSource=new v.X([]),this.properties$=this.propertiesSource.asObservable(),this.itemObjects$=(0,U.a)({properties:this.properties$,items:this.items$}).pipe((0,Ze.U)(Ut=>Ut.items.map(wt=>Ne.O.getItem(wt,Ut.properties)))),this.init()}cleanData(){localStorage.removeItem("items"),this.itemsSource.next([])}mergeData(){this.loadProperties().subscribe(be=>{this.loadItems().subscribe(Ye=>{})})}loadAll(){this.loadProperties().subscribe(be=>{if(this.userId)this.loadItems().subscribe(Ye=>{});else{const Ye=localStorage.getItem("items");if(Ye){const _t=JSON.parse(Ye);this.itemsSource.next(_t)}}this.items$.subscribe(Ye=>{localStorage.setItem("items",JSON.stringify(Ye))})})}loadProperties(){return this.propertiesHttp.getAll().pipe((0,Ze.U)(be=>{const Ye=be??[];return this.propertiesSource.next(Ye),Ye}))}loadItems(){return this.itemsHttp.getAll().pipe((0,Ze.U)(be=>{const Ye=be??[];return this.itemsSource.next(Ye),Ye}))}createNewItem(){const be=new Re.c;return be.values=(this.propertiesSource.getValue()??[]).map(Ye=>Object.assign(new ct.Z,Ye)),be}saveItem(be){return be.id?this.updateItem(be):this.addItem(be)}addItem(be){const Ye={id:(0,Fe.Z)(),values:be.values.map(_t=>({propertyId:_t.id,value:_t.value}))};return this.items$.pipe((0,ht.q)(1)).subscribe(_t=>{_t.push(Ye),this.itemsSource.next(_t)}),this.execAuthorisedHttp(this.itemsHttp.add(Ye)),Ye}addItems(be,Ye){return this.items$.pipe((0,ht.q)(1)).subscribe(_t=>{this.itemsSource.next(_t.concat(be))}),!this.execAuthorisedHttp(this.itemsHttp.addRange(be),Ye)&&Ye&&Ye(be),be}updateItem(be){const Ye={id:be.id,values:be.values.map(_t=>({propertyId:_t.id,value:_t.value}))};return this.items$.pipe((0,ht.q)(1)).subscribe(_t=>{var Ut=_t.findIndex(wt=>wt.id===Ye.id);_t[Ut]=Ye,this.itemsSource.next(_t)}),this.execAuthorisedHttp(this.itemsHttp.edit(Ye)),Ye}deleteItem(be){return this.items$.pipe((0,ht.q)(1)).subscribe(Ye=>{const _t=Ye.filter(Ut=>Ut.id!==be);this.itemsSource.next(_t)}),this.execAuthorisedHttp(this.itemsHttp.delete(be)),!0}updatePropertyParam(be){this.resetPropertyParams([be]),this.execAuthorisedHttp(this.propertiesHttp.updateParam(be))}updatePropertyParams(be){this.resetPropertyParams(be),this.execAuthorisedHttp(this.propertiesHttp.updateParams(be))}resetPropertyParams(be){this.properties$.pipe((0,ht.q)(1)).subscribe(Ye=>{be.forEach(_t=>{const Ut=Ye.find(wt=>wt.id===_t.propertyId);Ut&&(Ut.params=_t)}),this.propertiesSource.next(Ye)})}static#e=this.\u0275fac=function(Ye){return new(Ye||Te)(Qe.LFG(Be),Qe.LFG(De),Qe.LFG(oe.B))};static#t=this.\u0275prov=Qe.Yz7({token:Te,factory:Te.\u0275fac})}return Te})()},2372:(Tr,kt,ie)=>{ie.d(kt,{Z:()=>at});var v,U=new Uint8Array(16);function Ze(){if(!v&&!(v=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(U)}const ht=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var it=[],Fe=0;Fe<256;++Fe)it.push((Fe+256).toString(16).substr(1));const Qe=function Ne(Be){var De=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,oe=(it[Be[De+0]]+it[Be[De+1]]+it[Be[De+2]]+it[Be[De+3]]+"-"+it[Be[De+4]]+it[Be[De+5]]+"-"+it[Be[De+6]]+it[Be[De+7]]+"-"+it[Be[De+8]]+it[Be[De+9]]+"-"+it[Be[De+10]]+it[Be[De+11]]+it[Be[De+12]]+it[Be[De+13]]+it[Be[De+14]]+it[Be[De+15]]).toLowerCase();if(!function Re(Be){return"string"==typeof Be&&ht.test(Be)}(oe))throw TypeError("Stringified UUID is invalid");return oe},at=function yt(Be,De,oe){var ue=(Be=Be||{}).random||(Be.rng||Ze)();if(ue[6]=15&ue[6]|64,ue[8]=63&ue[8]|128,De){oe=oe||0;for(var Te=0;Te<16;++Te)De[oe+Te]=ue[Te];return De}return Qe(ue)}},3185:(Tr,kt,ie)=>{ie.d(kt,{jh:()=>u1,vQ:()=>g1});var v=ie(9212);function U(i){return i+.5|0}const Ze=(i,a,n)=>Math.max(Math.min(i,n),a);function ht(i){return Ze(U(2.55*i),0,255)}function ct(i){return Ze(U(255*i),0,255)}function it(i){return Ze(U(i/2.55)/100,0,1)}function Fe(i){return Ze(U(100*i),0,100)}const Ne={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Qe=[..."0123456789ABCDEF"],yt=i=>Qe[15&i],at=i=>Qe[(240&i)>>4]+Qe[15&i],Be=i=>(240&i)>>4==(15&i);const ut=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function be(i,a,n){const c=a*Math.min(n,1-n),l=(h,d=(h+i/30)%12)=>n-c*Math.max(Math.min(d-3,9-d,1),-1);return[l(0),l(8),l(4)]}function Ye(i,a,n){const c=(l,h=(l+i/60)%6)=>n-n*a*Math.max(Math.min(h,4-h,1),0);return[c(5),c(3),c(1)]}function _t(i,a,n){const c=be(i,1,.5);let l;for(a+n>1&&(l=1/(a+n),a*=l,n*=l),l=0;l<3;l++)c[l]*=1-a-n,c[l]+=a;return c}function wt(i){const n=i.r/255,c=i.g/255,l=i.b/255,h=Math.max(n,c,l),d=Math.min(n,c,l),m=(h+d)/2;let g,y,b;return h!==d&&(b=h-d,y=m>.5?b/(2-h-d):b/(h+d),g=function Ut(i,a,n,c,l){return i===l?(a-n)/c+(a<n?6:0):a===l?(n-i)/c+2:(i-a)/c+4}(n,c,l,b,h),g=60*g+.5),[0|g,y||0,m]}function hn(i,a,n,c){return(Array.isArray(a)?i(a[0],a[1],a[2]):i(a,n,c)).map(ct)}function un(i,a,n){return hn(be,i,a,n)}function ui(i){return(i%360+360)%360}const lr={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wi={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Ln;const dn=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,ts=i=>i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055,bi=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function Nn(i,a,n){if(i){let c=wt(i);c[a]=Math.max(0,Math.min(c[a]+c[a]*n,0===a?360:1)),c=un(c),i.r=c[0],i.g=c[1],i.b=c[2]}}function Ji(i,a){return i&&Object.assign(a||{},i)}function rs(i){var a={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(a={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(a.a=ct(i[3]))):(a=Ji(i,{r:0,g:0,b:0,a:1})).a=ct(a.a),a}function ns(i){return"r"===i.charAt(0)?function Ta(i){const a=dn.exec(i);let c,l,h,n=255;if(a){if(a[7]!==c){const d=+a[7];n=a[8]?ht(d):Ze(255*d,0,255)}return c=+a[1],l=+a[3],h=+a[5],c=255&(a[2]?ht(c):Ze(c,0,255)),l=255&(a[4]?ht(l):Ze(l,0,255)),h=255&(a[6]?ht(h):Ze(h,0,255)),{r:c,g:l,b:h,a:n}}}(i):function Jn(i){const a=ut.exec(i);let c,n=255;if(!a)return;a[5]!==c&&(n=a[6]?ht(+a[5]):ct(+a[5]));const l=ui(+a[2]),h=+a[3]/100,d=+a[4]/100;return c="hwb"===a[1]?function js(i,a,n){return hn(_t,i,a,n)}(l,h,d):"hsv"===a[1]?function Sr(i,a,n){return hn(Ye,i,a,n)}(l,h,d):un(l,h,d),{r:c[0],g:c[1],b:c[2],a:n}}(i)}class ki{constructor(a){if(a instanceof ki)return a;const n=typeof a;let c;"object"===n?c=rs(a):"string"===n&&(c=function oe(i){var n,a=i.length;return"#"===i[0]&&(4===a||5===a?n={r:255&17*Ne[i[1]],g:255&17*Ne[i[2]],b:255&17*Ne[i[3]],a:5===a?17*Ne[i[4]]:255}:(7===a||9===a)&&(n={r:Ne[i[1]]<<4|Ne[i[2]],g:Ne[i[3]]<<4|Ne[i[4]],b:Ne[i[5]]<<4|Ne[i[6]],a:9===a?Ne[i[7]]<<4|Ne[i[8]]:255})),n}(a)||function yi(i){Ln||(Ln=function Or(){const i={},a=Object.keys(wi),n=Object.keys(lr);let c,l,h,d,m;for(c=0;c<a.length;c++){for(d=m=a[c],l=0;l<n.length;l++)h=n[l],m=m.replace(h,lr[h]);h=parseInt(wi[d],16),i[m]=[h>>16&255,h>>8&255,255&h]}return i}(),Ln.transparent=[0,0,0,0]);const a=Ln[i.toLowerCase()];return a&&{r:a[0],g:a[1],b:a[2],a:4===a.length?a[3]:255}}(a)||ns(a)),this._rgb=c,this._valid=!!c}get valid(){return this._valid}get rgb(){var a=Ji(this._rgb);return a&&(a.a=it(a.a)),a}set rgb(a){this._rgb=rs(a)}rgbString(){return this._valid?function Ca(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${it(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}(this._rgb):void 0}hexString(){return this._valid?function Te(i){var a=(i=>Be(i.r)&&Be(i.g)&&Be(i.b)&&Be(i.a))(i)?yt:at;return i?"#"+a(i.r)+a(i.g)+a(i.b)+((i,a)=>i<255?a(i):"")(i.a,a):void 0}(this._rgb):void 0}hslString(){return this._valid?function nn(i){if(!i)return;const a=wt(i),n=a[0],c=Fe(a[1]),l=Fe(a[2]);return i.a<255?`hsla(${n}, ${c}%, ${l}%, ${it(i.a)})`:`hsl(${n}, ${c}%, ${l}%)`}(this._rgb):void 0}mix(a,n){if(a){const c=this.rgb,l=a.rgb;let h;const d=n===h?.5:n,m=2*d-1,g=c.a-l.a,y=((m*g==-1?m:(m+g)/(1+m*g))+1)/2;h=1-y,c.r=255&y*c.r+h*l.r+.5,c.g=255&y*c.g+h*l.g+.5,c.b=255&y*c.b+h*l.b+.5,c.a=d*c.a+(1-d)*l.a,this.rgb=c}return this}interpolate(a,n){return a&&(this._rgb=function Xs(i,a,n){const c=bi(it(i.r)),l=bi(it(i.g)),h=bi(it(i.b));return{r:ct(ts(c+n*(bi(it(a.r))-c))),g:ct(ts(l+n*(bi(it(a.g))-l))),b:ct(ts(h+n*(bi(it(a.b))-h))),a:i.a+n*(a.a-i.a)}}(this._rgb,a._rgb,n)),this}clone(){return new ki(this.rgb)}alpha(a){return this._rgb.a=ct(a),this}clearer(a){return this._rgb.a*=1-a,this}greyscale(){const a=this._rgb,n=U(.3*a.r+.59*a.g+.11*a.b);return a.r=a.g=a.b=n,this}opaquer(a){return this._rgb.a*=1+a,this}negate(){const a=this._rgb;return a.r=255-a.r,a.g=255-a.g,a.b=255-a.b,this}lighten(a){return Nn(this._rgb,2,a),this}darken(a){return Nn(this._rgb,2,-a),this}saturate(a){return Nn(this._rgb,1,a),this}desaturate(a){return Nn(this._rgb,1,-a),this}rotate(a){return function jo(i,a){var n=wt(i);n[0]=ui(n[0]+a),n=un(n),i.r=n[0],i.g=n[1],i.b=n[2]}(this._rgb,a),this}}function Fn(){}const Xo=(()=>{let i=0;return()=>i++})();function Pt(i){return null===i||typeof i>"u"}function Vt(i){if(Array.isArray&&Array.isArray(i))return!0;const a=Object.prototype.toString.call(i);return"[object"===a.slice(0,7)&&"Array]"===a.slice(-6)}function It(i){return null!==i&&"[object Object]"===Object.prototype.toString.call(i)}function ur(i){return("number"==typeof i||i instanceof Number)&&isFinite(+i)}function an(i,a){return ur(i)?i:a}function Tt(i,a){return typeof i>"u"?a:i}const Ys=(i,a)=>"string"==typeof i&&i.endsWith("%")?parseFloat(i)/100*a:+i;function Qt(i,a,n){if(i&&"function"==typeof i.call)return i.apply(n,a)}function Xt(i,a,n,c){let l,h,d;if(Vt(i))if(h=i.length,c)for(l=h-1;l>=0;l--)a.call(n,i[l],l);else for(l=0;l<h;l++)a.call(n,i[l],l);else if(It(i))for(d=Object.keys(i),h=d.length,l=0;l<h;l++)a.call(n,i[d[l]],d[l])}function Qn(i,a){let n,c,l,h;if(!i||!a||i.length!==a.length)return!1;for(n=0,c=i.length;n<c;++n)if(l=i[n],h=a[n],l.datasetIndex!==h.datasetIndex||l.index!==h.index)return!1;return!0}function Dn(i){if(Vt(i))return i.map(Dn);if(It(i)){const a=Object.create(null),n=Object.keys(i),c=n.length;let l=0;for(;l<c;++l)a[n[l]]=Dn(i[n[l]]);return a}return i}function Zs(i){return-1===["__proto__","prototype","constructor"].indexOf(i)}function Yo(i,a,n,c){if(!Zs(i))return;const l=a[i],h=n[i];It(l)&&It(h)?pn(l,h,c):a[i]=Dn(h)}function pn(i,a,n){const c=Vt(a)?a:[a],l=c.length;if(!It(i))return i;const h=(n=n||{}).merger||Yo;let d;for(let m=0;m<l;++m){if(d=c[m],!It(d))continue;const g=Object.keys(d);for(let y=0,b=g.length;y<b;++y)h(g[y],i,d,n)}return i}function Ti(i,a){return pn(i,a,{merger:Zo})}function Zo(i,a,n){if(!Zs(i))return;const c=a[i],l=n[i];It(c)&&It(l)?Ti(c,l):Object.prototype.hasOwnProperty.call(a,i)||(a[i]=Dn(l))}const as={"":i=>i,x:i=>i.x,y:i=>i.y};function qn(i,a){return(as[a]||(as[a]=function Ko(i){const a=function Ks(i){const a=i.split("."),n=[];let c="";for(const l of a)c+=l,c.endsWith("\\")?c=c.slice(0,-1)+".":(n.push(c),c="");return n}(i);return n=>{for(const c of a){if(""===c)break;n=n&&n[c]}return n}}(a)))(i)}function Ea(i){return i.charAt(0).toUpperCase()+i.slice(1)}const Ci=i=>typeof i<"u",Bn=i=>"function"==typeof i,Br=(i,a)=>{if(i.size!==a.size)return!1;for(const n of i)if(!a.has(n))return!1;return!0},qt=Math.PI,ir=2*qt,Jo=ir+qt,zr=Number.POSITIVE_INFINITY,Qo=qt/180,gr=qt/2,ei=qt/4,yn=2*qt/3,Ur=Math.log10,On=Math.sign;function Ei(i,a,n){return Math.abs(i-a)<n}function ti(i){const a=Math.round(i);i=Ei(i,a,i/1e3)?a:i;const n=Math.pow(10,Math.floor(Ur(i))),c=i/n;return(c<=1?1:c<=2?2:c<=5?5:10)*n}function di(i){return!isNaN(parseFloat(i))&&isFinite(i)}function gt(i,a,n){let c,l,h;for(c=0,l=i.length;c<l;c++)h=i[c][n],isNaN(h)||(a.min=Math.min(a.min,h),a.max=Math.max(a.max,h))}function M(i){return i*(qt/180)}function Q(i){return i*(180/qt)}function Z(i){if(!ur(i))return;let a=1,n=0;for(;Math.round(i*a)/a!==i;)a*=10,n++;return n}function ve(i,a){const n=a.x-i.x,c=a.y-i.y,l=Math.sqrt(n*n+c*c);let h=Math.atan2(c,n);return h<-.5*qt&&(h+=ir),{angle:h,distance:l}}function Oe(i,a){return Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2))}function st(i,a){return(i-a+Jo)%ir-qt}function lt(i){return(i%ir+ir)%ir}function er(i,a,n,c){const l=lt(i),h=lt(a),d=lt(n),m=lt(h-l),g=lt(d-l),y=lt(l-h),b=lt(l-d);return l===h||l===d||c&&h===d||m>g&&y<b}function Rt(i,a,n){return Math.max(a,Math.min(n,i))}function et(i,a,n,c=1e-6){return i>=Math.min(a,n)-c&&i<=Math.max(a,n)+c}function Jr(i,a,n){n=n||(d=>i[d]<a);let h,c=i.length-1,l=0;for(;c-l>1;)h=l+c>>1,n(h)?l=h:c=h;return{lo:l,hi:c}}const mn=(i,a,n,c)=>Jr(i,n,c?l=>{const h=i[l][a];return h<n||h===n&&i[l+1][a]===n}:l=>i[l][a]<n),ec=(i,a,n)=>Jr(i,n,c=>i[c][a]>=n),Qs=["push","pop","shift","splice","unshift"];function tc(i,a){const n=i._chartjs;if(!n)return;const c=n.listeners,l=c.indexOf(a);-1!==l&&c.splice(l,1),!(c.length>0)&&(Qs.forEach(h=>{delete i[h]}),delete i._chartjs)}function ss(i){const a=new Set(i);return a.size===i.length?i:Array.from(a)}const Fl=typeof window>"u"?function(i){return i()}:window.requestAnimationFrame;function os(i,a){let n=[],c=!1;return function(...l){n=l,c||(c=!0,Fl.call(window,()=>{c=!1,i.apply(a,n)}))}}const qs=i=>"start"===i?"left":"end"===i?"right":"center",Qr=(i,a,n)=>"start"===i?a:"end"===i?n:(a+n)/2;function cs(i,a,n){const c=a.length;let l=0,h=c;if(i._sorted){const{iScale:d,_parsed:m}=i,g=d.axis,{min:y,max:b,minDefined:S,maxDefined:O}=d.getUserBounds();S&&(l=Rt(Math.min(mn(m,g,y).lo,n?c:mn(a,g,d.getPixelForValue(y)).lo),0,c-1)),h=O?Rt(Math.max(mn(m,d.axis,b,!0).hi+1,n?0:mn(a,g,d.getPixelForValue(b),!0).hi+1),l,c)-l:c-l}return{start:l,count:h}}function Ol(i){const{xScale:a,yScale:n,_scaleRanges:c}=i,l={xmin:a.min,xmax:a.max,ymin:n.min,ymax:n.max};if(!c)return i._scaleRanges=l,!0;const h=c.xmin!==a.min||c.xmax!==a.max||c.ymin!==n.min||c.ymax!==n.max;return Object.assign(c,l),h}const ls=i=>0===i||1===i,nc=(i,a,n)=>-Math.pow(2,10*(i-=1))*Math.sin((i-a)*ir/n),Il=(i,a,n)=>Math.pow(2,-10*i)*Math.sin((i-a)*ir/n)+1,Zt={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>1-Math.cos(i*gr),easeOutSine:i=>Math.sin(i*gr),easeInOutSine:i=>-.5*(Math.cos(qt*i)-1),easeInExpo:i=>0===i?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>1===i?1:1-Math.pow(2,-10*i),easeInOutExpo:i=>ls(i)?i:i<.5?.5*Math.pow(2,10*(2*i-1)):.5*(2-Math.pow(2,-10*(2*i-1))),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>ls(i)?i:nc(i,.075,.3),easeOutElastic:i=>ls(i)?i:Il(i,.075,.3),easeInOutElastic:i=>ls(i)?i:i<.5?.5*nc(2*i,.1125,.45):.5+.5*Il(2*i-1,.1125,.45),easeInBack:i=>i*i*(2.70158*i-1.70158),easeOutBack:i=>(i-=1)*i*(2.70158*i+1.70158)+1,easeInOutBack(i){let a=1.70158;return(i/=.5)<1?i*i*((1+(a*=1.525))*i-a)*.5:.5*((i-=2)*i*((1+(a*=1.525))*i+a)+2)},easeInBounce:i=>1-Zt.easeOutBounce(1-i),easeOutBounce:i=>i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375,easeInOutBounce:i=>i<.5?.5*Zt.easeInBounce(2*i):.5*Zt.easeOutBounce(2*i-1)+.5};function pi(i){if(i&&"object"==typeof i){const a=i.toString();return"[object CanvasPattern]"===a||"[object CanvasGradient]"===a}return!1}function tr(i){return pi(i)?i:new ki(i)}function dr(i){return pi(i)?i:new ki(i).saturate(.5).darken(.1).hexString()}const Hn=["x","y","borderWidth","radius","tension"],Th=["color","borderColor","backgroundColor"],ic=new Map;function fs(i,a,n){return function Pl(i,a){a=a||{};const n=i+JSON.stringify(a);let c=ic.get(n);return c||(c=new Intl.NumberFormat(i,a),ic.set(n,c)),c}(a,n).format(i)}const kn={values:i=>Vt(i)?i:""+i,numeric(i,a,n){if(0===i)return"0";const c=this.chart.options.locale;let l,h=i;if(n.length>1){const y=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(y<1e-4||y>1e15)&&(l="scientific"),h=function ac(i,a){let n=a.length>3?a[2].value-a[1].value:a[1].value-a[0].value;return Math.abs(n)>=1&&i!==Math.floor(i)&&(n=i-Math.floor(i)),n}(i,n)}const d=Ur(Math.abs(h)),m=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),g={notation:l,minimumFractionDigits:m,maximumFractionDigits:m};return Object.assign(g,this.options.ticks.format),fs(i,c,g)},logarithmic(i,a,n){if(0===i)return"0";const c=n[a].significand||i/Math.pow(10,Math.floor(Ur(i)));return[1,2,3,5,10,15].includes(c)||a>.8*n.length?kn.numeric.call(this,i,a,n):""}};var xr={formatters:kn};const Si=Object.create(null),eo=Object.create(null);function Ct(i,a){if(!a)return i;const n=a.split(".");for(let c=0,l=n.length;c<l;++c){const h=n[c];i=i[h]||(i[h]=Object.create(null))}return i}function hs(i,a,n){return"string"==typeof a?pn(Ct(i,a),n):pn(Ct(i,""),a)}class Ml{constructor(a,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=c=>c.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(c,l)=>dr(l.backgroundColor),this.hoverBorderColor=(c,l)=>dr(l.borderColor),this.hoverColor=(c,l)=>dr(l.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(a),this.apply(n)}set(a,n){return hs(this,a,n)}get(a){return Ct(this,a)}describe(a,n){return hs(eo,a,n)}override(a,n){return hs(Si,a,n)}route(a,n,c,l){const h=Ct(this,a),d=Ct(this,c),m="_"+n;Object.defineProperties(h,{[m]:{value:h[n],writable:!0},[n]:{enumerable:!0,get(){const g=this[m],y=d[l];return It(g)?Object.assign({},y,g):Tt(g,y)},set(g){this[m]=g}}})}apply(a){a.forEach(n=>n(this))}}var ar=new Ml({_scriptable:i=>!i.startsWith("on"),_indexable:i=>"events"!==i,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function Sa(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:a=>"onProgress"!==a&&"onComplete"!==a&&"fn"!==a}),i.set("animations",{colors:{type:"color",properties:Th},numbers:{type:"number",properties:Hn}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:a=>0|a}}}})},function Ch(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function Tn(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(a,n)=>n.lineWidth,tickColor:(a,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xr.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:a=>!a.startsWith("before")&&!a.startsWith("after")&&"callback"!==a&&"parser"!==a,_indexable:a=>"borderDash"!==a&&"tickBorderDash"!==a&&"dash"!==a}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:a=>"backdropPadding"!==a&&"callback"!==a,_indexable:a=>"backdropPadding"!==a})}]);function to(i,a,n,c,l){let h=a[l];return h||(h=a[l]=i.measureText(l).width,n.push(l)),h>c&&(c=h),c}function Rl(i,a,n,c){let l=(c=c||{}).data=c.data||{},h=c.garbageCollect=c.garbageCollect||[];c.font!==a&&(l=c.data={},h=c.garbageCollect=[],c.font=a),i.save(),i.font=a;let d=0;const m=n.length;let g,y,b,S,O;for(g=0;g<m;g++)if(S=n[g],null==S||Vt(S)){if(Vt(S))for(y=0,b=S.length;y<b;y++)O=S[y],null!=O&&!Vt(O)&&(d=to(i,l,h,d,O))}else d=to(i,l,h,d,S);i.restore();const P=h.length/2;if(P>n.length){for(g=0;g<P;g++)delete l[h[g]];h.splice(0,P)}return d}function Qi(i,a,n){const c=i.currentDevicePixelRatio,l=0!==n?Math.max(n/2,.5):0;return Math.round((a-l)*c)/c+l}function $r(i,a){(a=a||i.getContext("2d")).save(),a.resetTransform(),a.clearRect(0,0,i.width,i.height),a.restore()}function sc(i,a,n,c){Ll(i,a,n,c,null)}function Ll(i,a,n,c,l){let h,d,m,g,y,b,S,O;const P=a.pointStyle,j=a.rotation,Y=a.radius;let K=(j||0)*Qo;if(P&&"object"==typeof P&&(h=P.toString(),"[object HTMLImageElement]"===h||"[object HTMLCanvasElement]"===h))return i.save(),i.translate(n,c),i.rotate(K),i.drawImage(P,-P.width/2,-P.height/2,P.width,P.height),void i.restore();if(!(isNaN(Y)||Y<=0)){switch(i.beginPath(),P){default:l?i.ellipse(n,c,l/2,Y,0,0,ir):i.arc(n,c,Y,0,ir),i.closePath();break;case"triangle":b=l?l/2:Y,i.moveTo(n+Math.sin(K)*b,c-Math.cos(K)*Y),K+=yn,i.lineTo(n+Math.sin(K)*b,c-Math.cos(K)*Y),K+=yn,i.lineTo(n+Math.sin(K)*b,c-Math.cos(K)*Y),i.closePath();break;case"rectRounded":y=.516*Y,g=Y-y,d=Math.cos(K+ei)*g,S=Math.cos(K+ei)*(l?l/2-y:g),m=Math.sin(K+ei)*g,O=Math.sin(K+ei)*(l?l/2-y:g),i.arc(n-S,c-m,y,K-qt,K-gr),i.arc(n+O,c-d,y,K-gr,K),i.arc(n+S,c+m,y,K,K+gr),i.arc(n-O,c+d,y,K+gr,K+qt),i.closePath();break;case"rect":if(!j){g=Math.SQRT1_2*Y,b=l?l/2:g,i.rect(n-b,c-g,2*b,2*g);break}K+=ei;case"rectRot":S=Math.cos(K)*(l?l/2:Y),d=Math.cos(K)*Y,m=Math.sin(K)*Y,O=Math.sin(K)*(l?l/2:Y),i.moveTo(n-S,c-m),i.lineTo(n+O,c-d),i.lineTo(n+S,c+m),i.lineTo(n-O,c+d),i.closePath();break;case"crossRot":K+=ei;case"cross":S=Math.cos(K)*(l?l/2:Y),d=Math.cos(K)*Y,m=Math.sin(K)*Y,O=Math.sin(K)*(l?l/2:Y),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d);break;case"star":S=Math.cos(K)*(l?l/2:Y),d=Math.cos(K)*Y,m=Math.sin(K)*Y,O=Math.sin(K)*(l?l/2:Y),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d),K+=ei,S=Math.cos(K)*(l?l/2:Y),d=Math.cos(K)*Y,m=Math.sin(K)*Y,O=Math.sin(K)*(l?l/2:Y),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d);break;case"line":d=l?l/2:Math.cos(K)*Y,m=Math.sin(K)*Y,i.moveTo(n-d,c-m),i.lineTo(n+d,c+m);break;case"dash":i.moveTo(n,c),i.lineTo(n+Math.cos(K)*(l?l/2:Y),c+Math.sin(K)*Y);break;case!1:i.closePath()}i.fill(),a.borderWidth>0&&i.stroke()}}function mt(i,a,n){return n=n||.5,!a||i&&i.x>a.left-n&&i.x<a.right+n&&i.y>a.top-n&&i.y<a.bottom+n}function Cn(i,a){i.save(),i.beginPath(),i.rect(a.left,a.top,a.right-a.left,a.bottom-a.top),i.clip()}function us(i){i.restore()}function oc(i,a,n,c,l){if(!a)return i.lineTo(n.x,n.y);if("middle"===l){const h=(a.x+n.x)/2;i.lineTo(h,a.y),i.lineTo(h,n.y)}else"after"===l!=!!c?i.lineTo(a.x,n.y):i.lineTo(n.x,a.y);i.lineTo(n.x,n.y)}function zt(i,a,n,c){if(!a)return i.lineTo(n.x,n.y);i.bezierCurveTo(c?a.cp1x:a.cp2x,c?a.cp1y:a.cp2y,c?n.cp2x:n.cp1x,c?n.cp2y:n.cp1y,n.x,n.y)}function Eh(i,a,n,c,l){if(l.strikethrough||l.underline){const h=i.measureText(c),d=a-h.actualBoundingBoxLeft,m=a+h.actualBoundingBoxRight,y=n+h.actualBoundingBoxDescent,b=l.strikethrough?(n-h.actualBoundingBoxAscent+y)/2:y;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=l.decorationWidth||2,i.moveTo(d,b),i.lineTo(m,b),i.stroke()}}function Kt(i,a){const n=i.fillStyle;i.fillStyle=a.color,i.fillRect(a.left,a.top,a.width,a.height),i.fillStyle=n}function Ai(i,a,n,c,l,h={}){const d=Vt(a)?a:[a],m=h.strokeWidth>0&&""!==h.strokeColor;let g,y;for(i.save(),i.font=l.string,function cc(i,a){a.translation&&i.translate(a.translation[0],a.translation[1]),Pt(a.rotation)||i.rotate(a.rotation),a.color&&(i.fillStyle=a.color),a.textAlign&&(i.textAlign=a.textAlign),a.textBaseline&&(i.textBaseline=a.textBaseline)}(i,h),g=0;g<d.length;++g)y=d[g],h.backdrop&&Kt(i,h.backdrop),m&&(h.strokeColor&&(i.strokeStyle=h.strokeColor),Pt(h.strokeWidth)||(i.lineWidth=h.strokeWidth),i.strokeText(y,n,c,h.maxWidth)),i.fillText(y,n,c,h.maxWidth),Eh(i,n,c,y,h),c+=Number(l.lineHeight);i.restore()}function Aa(i,a){const{x:n,y:c,w:l,h,radius:d}=a;i.arc(n+d.topLeft,c+d.topLeft,d.topLeft,1.5*qt,qt,!0),i.lineTo(n,c+h-d.bottomLeft),i.arc(n+d.bottomLeft,c+h-d.bottomLeft,d.bottomLeft,qt,gr,!0),i.lineTo(n+l-d.bottomRight,c+h),i.arc(n+l-d.bottomRight,c+h-d.bottomRight,d.bottomRight,gr,0,!0),i.lineTo(n+l,c+d.topRight),i.arc(n+l-d.topRight,c+d.topRight,d.topRight,0,-gr,!0),i.lineTo(n+d.topLeft,c)}const lc=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Sh=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Nl(i,a){const n=(""+i).match(lc);if(!n||"normal"===n[1])return 1.2*a;switch(i=+n[2],n[3]){case"px":return i;case"%":i/=100}return a*i}const Ah=i=>+i||0;function sr(i,a){const n={},c=It(a),l=c?Object.keys(a):a,h=It(i)?c?d=>Tt(i[d],i[a[d]]):d=>i[d]:()=>i;for(const d of l)n[d]=Ah(h(d));return n}function ro(i){return sr(i,{top:"y",right:"x",bottom:"y",left:"x"})}function Fi(i){return sr(i,["topLeft","topRight","bottomLeft","bottomRight"])}function Gr(i){const a=ro(i);return a.width=a.left+a.right,a.height=a.top+a.bottom,a}function wr(i,a){let n=Tt((i=i||{}).size,(a=a||ar.font).size);"string"==typeof n&&(n=parseInt(n,10));let c=Tt(i.style,a.style);c&&!(""+c).match(Sh)&&(console.warn('Invalid font style specified: "'+c+'"'),c=void 0);const l={family:Tt(i.family,a.family),lineHeight:Nl(Tt(i.lineHeight,a.lineHeight),n),size:n,style:c,weight:Tt(i.weight,a.weight),string:""};return l.string=function vr(i){return!i||Pt(i.size)||Pt(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}(l),l}function jt(i,a,n,c){let h,d,m,l=!0;for(h=0,d=i.length;h<d;++h)if(m=i[h],void 0!==m&&(void 0!==a&&"function"==typeof m&&(m=m(a),l=!1),void 0!==n&&Vt(m)&&(m=m[n%m.length],l=!1),void 0!==m))return c&&!l&&(c.cacheable=!1),m}function In(i,a){return Object.assign(Object.create(i),a)}function no(i,a=[""],n,c,l=(()=>i[0])){const h=n||i;typeof c>"u"&&(c=Ul("_fallback",i));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:h,_fallback:c,_getTarget:l,override:m=>no([m,...i],a,h,c)};return new Proxy(d,{deleteProperty:(m,g)=>(delete m[g],delete m._keys,delete i[0][g],!0),get:(m,g)=>fc(m,g,()=>function En(i,a,n,c){let l;for(const h of a)if(l=Ul(Fh(h,i),n),typeof l<"u")return io(i,l)?qi(n,c,i,l):l}(g,a,i,m)),getOwnPropertyDescriptor:(m,g)=>Reflect.getOwnPropertyDescriptor(m._scopes[0],g),getPrototypeOf:()=>Reflect.getPrototypeOf(i[0]),has:(m,g)=>Hl(m).includes(g),ownKeys:m=>Hl(m),set(m,g,y){const b=m._storage||(m._storage=l());return m[g]=b[g]=y,delete m._keys,!0}})}function Fa(i,a,n,c){const l={_cacheable:!1,_proxy:i,_context:a,_subProxy:n,_stack:new Set,_descriptors:Bl(i,c),setContext:h=>Fa(i,h,n,c),override:h=>Fa(i.override(h),a,n,c)};return new Proxy(l,{deleteProperty:(h,d)=>(delete h[d],delete i[d],!0),get:(h,d,m)=>fc(h,d,()=>function jr(i,a,n){const{_proxy:c,_context:l,_subProxy:h,_descriptors:d}=i;let m=c[a];return Bn(m)&&d.isScriptable(a)&&(m=function ds(i,a,n,c){const{_proxy:l,_context:h,_subProxy:d,_stack:m}=n;if(m.has(i))throw new Error("Recursion detected: "+Array.from(m).join("->")+"->"+i);m.add(i);let g=a(h,d||c);return m.delete(i),io(i,g)&&(g=qi(l._scopes,l,i,g)),g}(a,m,i,n)),Vt(m)&&m.length&&(m=function Ue(i,a,n,c){const{_proxy:l,_context:h,_subProxy:d,_descriptors:m}=n;if(typeof h.index<"u"&&c(i))return a[h.index%a.length];if(It(a[0])){const g=a,y=l._scopes.filter(b=>b!==g);a=[];for(const b of g){const S=qi(y,l,i,b);a.push(Fa(S,h,d&&d[i],m))}}return a}(a,m,i,d.isIndexable)),io(a,m)&&(m=Fa(m,l,h&&h[a],d)),m}(h,d,m)),getOwnPropertyDescriptor:(h,d)=>h._descriptors.allKeys?Reflect.has(i,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,d),getPrototypeOf:()=>Reflect.getPrototypeOf(i),has:(h,d)=>Reflect.has(i,d),ownKeys:()=>Reflect.ownKeys(i),set:(h,d,m)=>(i[d]=m,delete h[d],!0)})}function Bl(i,a={scriptable:!0,indexable:!0}){const{_scriptable:n=a.scriptable,_indexable:c=a.indexable,_allKeys:l=a.allKeys}=i;return{allKeys:l,scriptable:n,indexable:c,isScriptable:Bn(n)?n:()=>n,isIndexable:Bn(c)?c:()=>c}}const Fh=(i,a)=>i?i+Ea(a):a,io=(i,a)=>It(a)&&"adapters"!==i&&(null===Object.getPrototypeOf(a)||a.constructor===Object);function fc(i,a,n){if(Object.prototype.hasOwnProperty.call(i,a))return i[a];const c=n();return i[a]=c,c}function ao(i,a,n){return Bn(i)?i(a,n):i}const Dh=(i,a)=>!0===i?a:"string"==typeof i?qn(a,i):void 0;function hc(i,a,n,c,l){for(const h of a){const d=Dh(n,h);if(d){i.add(d);const m=ao(d._fallback,n,l);if(typeof m<"u"&&m!==n&&m!==c)return m}else if(!1===d&&typeof c<"u"&&n!==c)return null}return!1}function qi(i,a,n,c){const l=a._rootScopes,h=ao(a._fallback,n,c),d=[...i,...l],m=new Set;m.add(c);let g=Cr(m,d,n,h||n,c);return!(null===g||typeof h<"u"&&h!==n&&(g=Cr(m,d,h,g,c),null===g))&&no(Array.from(m),[""],l,h,()=>function Di(i,a,n){const c=i._getTarget();a in c||(c[a]={});const l=c[a];return Vt(l)&&It(n)?n:l||{}}(a,n,c))}function Cr(i,a,n,c,l){for(;n;)n=hc(i,a,n,c,l);return n}function Ul(i,a){for(const n of a){if(!n)continue;const c=n[i];if(typeof c<"u")return c}}function Hl(i){let a=i._keys;return a||(a=i._keys=function Wl(i){const a=new Set;for(const n of i)for(const c of Object.keys(n).filter(l=>!l.startsWith("_")))a.add(c);return Array.from(a)}(i._scopes)),a}function uc(i,a,n,c){const{iScale:l}=i,{key:h="r"}=this._parsing,d=new Array(c);let m,g,y,b;for(m=0,g=c;m<g;++m)y=m+n,b=a[y],d[m]={r:l.parse(qn(b,h),y)};return d}const Vl=Number.EPSILON||1e-14,mi=(i,a)=>a<i.length&&!i[a].skip&&i[a],dc=i=>"x"===i?"y":"x";function zl(i,a,n,c){const l=i.skip?a:i,h=a,d=n.skip?a:n,m=Oe(h,l),g=Oe(d,h);let y=m/(m+g),b=g/(m+g);y=isNaN(y)?0:y,b=isNaN(b)?0:b;const S=c*y,O=c*b;return{previous:{x:h.x-S*(d.x-l.x),y:h.y-S*(d.y-l.y)},next:{x:h.x+O*(d.x-l.x),y:h.y+O*(d.y-l.y)}}}function Oa(i,a,n){return Math.max(Math.min(i,n),a)}function pc(i,a,n,c,l){let h,d,m,g;if(a.spanGaps&&(i=i.filter(y=>!y.skip)),"monotone"===a.cubicInterpolationMode)!function Gl(i,a="x"){const n=dc(a),c=i.length,l=Array(c).fill(0),h=Array(c);let d,m,g,y=mi(i,0);for(d=0;d<c;++d)if(m=g,g=y,y=mi(i,d+1),g){if(y){const b=y[a]-g[a];l[d]=0!==b?(y[n]-g[n])/b:0}h[d]=m?y?On(l[d-1])!==On(l[d])?0:(l[d-1]+l[d])/2:l[d-1]:l[d]}(function $l(i,a,n){const c=i.length;let l,h,d,m,g,y=mi(i,0);for(let b=0;b<c-1;++b)if(g=y,y=mi(i,b+1),g&&y){if(Ei(a[b],0,Vl)){n[b]=n[b+1]=0;continue}l=n[b]/a[b],h=n[b+1]/a[b],m=Math.pow(l,2)+Math.pow(h,2),!(m<=9)&&(d=3/Math.sqrt(m),n[b]=l*d*a[b],n[b+1]=h*d*a[b])}})(i,l,h),function Da(i,a,n="x"){const c=dc(n),l=i.length;let h,d,m,g=mi(i,0);for(let y=0;y<l;++y){if(d=m,m=g,g=mi(i,y+1),!m)continue;const b=m[n],S=m[c];d&&(h=(b-d[n])/3,m[`cp1${n}`]=b-h,m[`cp1${c}`]=S-h*a[y]),g&&(h=(g[n]-b)/3,m[`cp2${n}`]=b+h,m[`cp2${c}`]=S+h*a[y])}}(i,h,a)}(i,l);else{let y=c?i[i.length-1]:i[0];for(h=0,d=i.length;h<d;++h)m=i[h],g=zl(y,m,i[Math.min(h+1,d-(c?0:1))%d],a.tension),m.cp1x=g.previous.x,m.cp1y=g.previous.y,m.cp2x=g.next.x,m.cp2y=g.next.y,y=m}a.capBezierPoints&&function jl(i,a){let n,c,l,h,d,m=mt(i[0],a);for(n=0,c=i.length;n<c;++n)d=h,h=m,m=n<c-1&&mt(i[n+1],a),h&&(l=i[n],d&&(l.cp1x=Oa(l.cp1x,a.left,a.right),l.cp1y=Oa(l.cp1y,a.top,a.bottom)),m&&(l.cp2x=Oa(l.cp2x,a.left,a.right),l.cp2y=Oa(l.cp2y,a.top,a.bottom)))}(i,n)}function so(){return typeof window<"u"&&typeof document<"u"}function ps(i){let a=i.parentNode;return a&&"[object ShadowRoot]"===a.toString()&&(a=a.host),a}function ms(i,a,n){let c;return"string"==typeof i?(c=parseInt(i,10),-1!==i.indexOf("%")&&(c=c/100*a.parentNode[n])):c=i,c}const Ia=i=>i.ownerDocument.defaultView.getComputedStyle(i,null),mc=["top","right","bottom","left"];function Oi(i,a,n){const c={};n=n?"-"+n:"";for(let l=0;l<4;l++){const h=mc[l];c[h]=parseFloat(i[a+"-"+h+n])||0}return c.width=c.left+c.right,c.height=c.top+c.bottom,c}const oo=(i,a,n)=>(i>0||a>0)&&(!n||!n.shadowRoot);function Ii(i,a){if("native"in i)return i;const{canvas:n,currentDevicePixelRatio:c}=a,l=Ia(n),h="border-box"===l.boxSizing,d=Oi(l,"padding"),m=Oi(l,"border","width"),{x:g,y,box:b}=function gc(i,a){const n=i.touches,c=n&&n.length?n[0]:i,{offsetX:l,offsetY:h}=c;let m,g,d=!1;if(oo(l,h,i.target))m=l,g=h;else{const y=a.getBoundingClientRect();m=c.clientX-y.left,g=c.clientY-y.top,d=!0}return{x:m,y:g,box:d}}(i,n),S=d.left+(b&&m.left),O=d.top+(b&&m.top);let{width:P,height:j}=a;return h&&(P-=d.width+m.width,j-=d.height+m.height),{x:Math.round((g-S)/P*n.width/c),y:Math.round((y-O)/j*n.height/c)}}const Pn=i=>Math.round(10*i)/10;function Pr(i,a,n){const c=a||1,l=Math.floor(i.height*c),h=Math.floor(i.width*c);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const d=i.canvas;return d.style&&(n||!d.style.height&&!d.style.width)&&(d.style.height=`${i.height}px`,d.style.width=`${i.width}px`),(i.currentDevicePixelRatio!==c||d.height!==l||d.width!==h)&&(i.currentDevicePixelRatio=c,d.height=l,d.width=h,i.ctx.setTransform(c,0,0,c,0,0),!0)}const ea=function(){let i=!1;try{const a={get passive(){return i=!0,!1}};so()&&(window.addEventListener("test",null,a),window.removeEventListener("test",null,a))}catch{}return i}();function Yl(i,a){const n=function Xl(i,a){return Ia(i).getPropertyValue(a)}(i,a),c=n&&n.match(/^(\d+)(\.\d+)?px$/);return c?+c[1]:void 0}function Wn(i,a,n,c){return{x:i.x+n*(a.x-i.x),y:i.y+n*(a.y-i.y)}}function Ih(i,a,n,c){return{x:i.x+n*(a.x-i.x),y:"middle"===c?n<.5?i.y:a.y:"after"===c?n<1?i.y:a.y:n>0?a.y:i.y}}function Ph(i,a,n,c){const l={x:i.cp2x,y:i.cp2y},h={x:a.cp1x,y:a.cp1y},d=Wn(i,l,n),m=Wn(l,h,n),g=Wn(h,a,n),y=Wn(d,m,n),b=Wn(m,g,n);return Wn(y,b,n)}function ta(i,a,n){return i?function(i,a){return{x:n=>i+i+a-n,setWidth(n){a=n},textAlign:n=>"center"===n?n:"right"===n?"left":"right",xPlus:(n,c)=>n-c,leftForLtr:(n,c)=>n-c}}(a,n):{x:i=>i,setWidth(i){},textAlign:i=>i,xPlus:(i,a)=>i+a,leftForLtr:(i,a)=>i}}function Hr(i,a){let n,c;("ltr"===a||"rtl"===a)&&(n=i.canvas.style,c=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",a,"important"),i.prevTextDirection=c)}function Xr(i,a){void 0!==a&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",a[0],a[1]))}function we(i){return"angle"===i?{between:er,compare:st,normalize:lt}:{between:et,compare:(a,n)=>a-n,normalize:a=>a}}function ni({start:i,end:a,count:n,loop:c,style:l}){return{start:i%n,end:a%n,loop:c&&(a-i+1)%n==0,style:l}}function Se(i,a,n){if(!n)return[i];const{property:c,start:l,end:h}=n,d=a.length,{compare:m,between:g,normalize:y}=we(c),{start:b,end:S,loop:O,style:P}=function sn(i,a,n){const{property:c,start:l,end:h}=n,{between:d,normalize:m}=we(c),g=a.length;let O,P,{start:y,end:b,loop:S}=i;if(S){for(y+=g,b+=g,O=0,P=g;O<P&&d(m(a[y%g][c]),l,h);++O)y--,b--;y%=g,b%=g}return b<y&&(b+=g),{start:y,end:b,loop:S,style:i.style}}(i,a,n),j=[];let xe,pe,Ie,Y=!1,K=null;for(let Ve=b,dt=b;Ve<=S;++Ve)pe=a[Ve%d],!pe.skip&&(xe=y(pe[c]),xe!==Ie&&(Y=g(xe,l,h),null===K&&(Y||g(l,Ie,xe)&&0!==m(l,Ie))&&(K=0===m(xe,l)?Ve:dt),null!==K&&(!Y||0===m(h,xe)||g(h,Ie,xe))&&(j.push(ni({start:K,end:Ve,loop:O,count:d,style:P})),K=null),dt=Ve,Ie=xe));return null!==K&&j.push(ni({start:K,end:S,loop:O,count:d,style:P})),j}function Ma(i,a){const n=[],c=i.segments;for(let l=0;l<c.length;l++){const h=Se(c[l],i.points,a);h.length&&n.push(...h)}return n}function Kl(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function Lh(i,a){if(!a)return!1;const n=[],c=function(l,h){return pi(h)?(n.includes(h)||n.push(h),n.indexOf(h)):h};return JSON.stringify(i,c)!==JSON.stringify(a,c)}class _c{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(a,n,c,l){const d=n.duration;n.listeners[l].forEach(m=>m({chart:a,initial:n.initial,numSteps:d,currentStep:Math.min(c-n.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=Fl.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(a=Date.now()){let n=0;this._charts.forEach((c,l)=>{if(!c.running||!c.items.length)return;const h=c.items;let g,d=h.length-1,m=!1;for(;d>=0;--d)g=h[d],g._active?(g._total>c.duration&&(c.duration=g._total),g.tick(a),m=!0):(h[d]=h[h.length-1],h.pop());m&&(l.draw(),this._notify(l,c,a,"progress")),h.length||(c.running=!1,this._notify(l,c,a,"complete"),c.initial=!1),n+=h.length}),this._lastDate=a,0===n&&(this._running=!1)}_getAnims(a){const n=this._charts;let c=n.get(a);return c||(c={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(a,c)),c}listen(a,n,c){this._getAnims(a).listeners[n].push(c)}add(a,n){!n||!n.length||this._getAnims(a).items.push(...n)}has(a){return this._getAnims(a).items.length>0}start(a){const n=this._charts.get(a);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((c,l)=>Math.max(c,l._duration),0),this._refresh())}running(a){if(!this._running)return!1;const n=this._charts.get(a);return!(!n||!n.running||!n.items.length)}stop(a){const n=this._charts.get(a);if(!n||!n.items.length)return;const c=n.items;let l=c.length-1;for(;l>=0;--l)c[l].cancel();n.items=[],this._notify(a,n,Date.now(),"complete")}remove(a){return this._charts.delete(a)}}var $t=new _c;const Jl="transparent",Nh={boolean:(i,a,n)=>n>.5?a:i,color(i,a,n){const c=tr(i||Jl),l=c.valid&&tr(a||Jl);return l&&l.valid?l.mix(c,n).hexString():a},number:(i,a,n)=>i+(a-i)*n};class Bh{constructor(a,n,c,l){const h=n[c];l=jt([a.to,l,h,a.from]);const d=jt([a.from,h,l]);this._active=!0,this._fn=a.fn||Nh[a.type||typeof d],this._easing=Zt[a.easing]||Zt.linear,this._start=Math.floor(Date.now()+(a.delay||0)),this._duration=this._total=Math.floor(a.duration),this._loop=!!a.loop,this._target=n,this._prop=c,this._from=d,this._to=l,this._promises=void 0}active(){return this._active}update(a,n,c){if(this._active){this._notify(!1);const l=this._target[this._prop],h=c-this._start,d=this._duration-h;this._start=c,this._duration=Math.floor(Math.max(d,a.duration)),this._total+=h,this._loop=!!a.loop,this._to=jt([a.to,n,l,a.from]),this._from=jt([a.from,l,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(a){const n=a-this._start,c=this._duration,l=this._prop,h=this._from,d=this._loop,m=this._to;let g;if(this._active=h!==m&&(d||n<c),!this._active)return this._target[l]=m,void this._notify(!0);n<0?this._target[l]=h:(g=n/c%2,g=d&&g>1?2-g:g,g=this._easing(Math.min(1,Math.max(0,g))),this._target[l]=this._fn(h,m,g))}wait(){const a=this._promises||(this._promises=[]);return new Promise((n,c)=>{a.push({res:n,rej:c})})}_notify(a){const n=a?"res":"rej",c=this._promises||[];for(let l=0;l<c.length;l++)c[l][n]()}}class pr{constructor(a,n){this._chart=a,this._properties=new Map,this.configure(n)}configure(a){if(!It(a))return;const n=Object.keys(ar.animation),c=this._properties;Object.getOwnPropertyNames(a).forEach(l=>{const h=a[l];if(!It(h))return;const d={};for(const m of n)d[m]=h[m];(Vt(h.properties)&&h.properties||[l]).forEach(m=>{(m===l||!c.has(m))&&c.set(m,d)})})}_animateOptions(a,n){const c=n.options,l=function on(i,a){if(!a)return;let n=i.options;if(n)return n.$shared&&(i.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;i.options=a}(a,c);if(!l)return[];const h=this._createAnimations(l,c);return c.$shared&&function bt(i,a){const n=[],c=Object.keys(a);for(let l=0;l<c.length;l++){const h=i[c[l]];h&&h.active()&&n.push(h.wait())}return Promise.all(n)}(a.options.$animations,c).then(()=>{a.options=c},()=>{}),h}_createAnimations(a,n){const c=this._properties,l=[],h=a.$animations||(a.$animations={}),d=Object.keys(n),m=Date.now();let g;for(g=d.length-1;g>=0;--g){const y=d[g];if("$"===y.charAt(0))continue;if("options"===y){l.push(...this._animateOptions(a,n));continue}const b=n[y];let S=h[y];const O=c.get(y);if(S){if(O&&S.active()){S.update(O,b,m);continue}S.cancel()}O&&O.duration?(h[y]=S=new Bh(O,a,y,b),l.push(S)):a[y]=b}return l}update(a,n){if(0===this._properties.size)return void Object.assign(a,n);const c=this._createAnimations(a,n);return c.length?($t.add(this._chart,c),!0):void 0}}function Et(i,a){const n=i&&i.options||{},c=n.reverse,l=void 0===n.min?a:0,h=void 0===n.max?a:0;return{start:c?h:l,end:c?l:h}}function Vn(i,a){const n=[],c=i._getSortedDatasetMetas(a);let l,h;for(l=0,h=c.length;l<h;++l)n.push(c[l].index);return n}function gi(i,a,n,c={}){const l=i.keys,h="single"===c.mode;let d,m,g,y;if(null!==a){for(d=0,m=l.length;d<m;++d){if(g=+l[d],g===n){if(c.all)continue;break}y=i.values[g],ur(y)&&(h||0===a||On(a)===On(y))&&(a+=y)}return a}}function ra(i,a){const n=i&&i.options.stacked;return n||void 0===n&&void 0!==a.stack}function qr(i,a,n){const c=i[a]||(i[a]={});return c[n]||(c[n]={})}function Mr(i,a,n,c){for(const l of a.getMatchingVisibleMetas(c).reverse()){const h=i[l.index];if(n&&h>0||!n&&h<0)return l.index}return null}function e0(i,a){const{chart:n,_cachedMeta:c}=i,l=n._stacks||(n._stacks={}),{iScale:h,vScale:d,index:m}=c,g=h.axis,y=d.axis,b=function Uh(i,a,n){return`${i.id}.${a.id}.${n.stack||n.type}`}(h,d,c),S=a.length;let O;for(let P=0;P<S;++P){const j=a[P],{[g]:Y,[y]:K}=j;O=(j._stacks||(j._stacks={}))[y]=qr(l,b,Y),O[m]=K,O._top=Mr(O,d,!0,c.type),O._bottom=Mr(O,d,!1,c.type),(O._visualValues||(O._visualValues={}))[m]=K}}function vc(i,a){const n=i.scales;return Object.keys(n).filter(c=>n[c].axis===a).shift()}function xs(i,a){const n=i.controller.index,c=i.vScale&&i.vScale.axis;if(c){a=a||i._parsed;for(const l of a){const h=l._stacks;if(!h||void 0===h[c]||void 0===h[c][n])return;delete h[c][n],void 0!==h[c]._visualValues&&void 0!==h[c]._visualValues[n]&&delete h[c]._visualValues[n]}}}const yc=i=>"reset"===i||"none"===i,Sn=(i,a)=>a?i:Object.assign({},i);let gn=(()=>class i{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(n,c){this.chart=n,this._ctx=n.ctx,this.index=c,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const n=this._cachedMeta;this.configure(),this.linkScales(),n._stacked=ra(n.vScale,n),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(n){this.index!==n&&xs(this._cachedMeta),this.index=n}linkScales(){const n=this.chart,c=this._cachedMeta,l=this.getDataset(),h=(O,P,j,Y)=>"x"===O?P:"r"===O?Y:j,d=c.xAxisID=Tt(l.xAxisID,vc(n,"x")),m=c.yAxisID=Tt(l.yAxisID,vc(n,"y")),g=c.rAxisID=Tt(l.rAxisID,vc(n,"r")),y=c.indexAxis,b=c.iAxisID=h(y,d,m,g),S=c.vAxisID=h(y,m,d,g);c.xScale=this.getScaleForId(d),c.yScale=this.getScaleForId(m),c.rScale=this.getScaleForId(g),c.iScale=this.getScaleForId(b),c.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(n){return this.chart.scales[n]}_getOtherScale(n){const c=this._cachedMeta;return n===c.iScale?c.vScale:c.iScale}reset(){this._update("reset")}_destroy(){const n=this._cachedMeta;this._data&&tc(this._data,this),n._stacked&&xs(n)}_dataCheck(){const n=this.getDataset(),c=n.data||(n.data=[]),l=this._data;if(It(c))this._data=function ql(i){const a=Object.keys(i),n=new Array(a.length);let c,l,h;for(c=0,l=a.length;c<l;++c)h=a[c],n[c]={x:h,y:i[h]};return n}(c);else if(l!==c){if(l){tc(l,this);const h=this._cachedMeta;xs(h),h._parsed=[]}c&&Object.isExtensible(c)&&function fr(i,a){i._chartjs?i._chartjs.listeners.push(a):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[a]}}),Qs.forEach(n=>{const c="_onData"+Ea(n),l=i[n];Object.defineProperty(i,n,{configurable:!0,enumerable:!1,value(...h){const d=l.apply(this,h);return i._chartjs.listeners.forEach(m=>{"function"==typeof m[c]&&m[c](...h)}),d}})}))}(c,this),this._syncList=[],this._data=c}}addElements(){const n=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(n.dataset=new this.datasetElementType)}buildOrUpdateElements(n){const c=this._cachedMeta,l=this.getDataset();let h=!1;this._dataCheck();const d=c._stacked;c._stacked=ra(c.vScale,c),c.stack!==l.stack&&(h=!0,xs(c),c.stack=l.stack),this._resyncElements(n),(h||d!==c._stacked)&&e0(this,c._parsed)}configure(){const n=this.chart.config,c=n.datasetScopeKeys(this._type),l=n.getOptionScopes(this.getDataset(),c,!0);this.options=n.createResolver(l,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(n,c){const{_cachedMeta:l,_data:h}=this,{iScale:d,_stacked:m}=l,g=d.axis;let S,O,P,y=0===n&&c===h.length||l._sorted,b=n>0&&l._parsed[n-1];if(!1===this._parsing)l._parsed=h,l._sorted=!0,P=h;else{P=Vt(h[n])?this.parseArrayData(l,h,n,c):It(h[n])?this.parseObjectData(l,h,n,c):this.parsePrimitiveData(l,h,n,c);const j=()=>null===O[g]||b&&O[g]<b[g];for(S=0;S<c;++S)l._parsed[S+n]=O=P[S],y&&(j()&&(y=!1),b=O);l._sorted=y}m&&e0(this,P)}parsePrimitiveData(n,c,l,h){const{iScale:d,vScale:m}=n,g=d.axis,y=m.axis,b=d.getLabels(),S=d===m,O=new Array(h);let P,j,Y;for(P=0,j=h;P<j;++P)Y=P+l,O[P]={[g]:S||d.parse(b[Y],Y),[y]:m.parse(c[Y],Y)};return O}parseArrayData(n,c,l,h){const{xScale:d,yScale:m}=n,g=new Array(h);let y,b,S,O;for(y=0,b=h;y<b;++y)S=y+l,O=c[S],g[y]={x:d.parse(O[0],S),y:m.parse(O[1],S)};return g}parseObjectData(n,c,l,h){const{xScale:d,yScale:m}=n,{xAxisKey:g="x",yAxisKey:y="y"}=this._parsing,b=new Array(h);let S,O,P,j;for(S=0,O=h;S<O;++S)P=S+l,j=c[P],b[S]={x:d.parse(qn(j,g),P),y:m.parse(qn(j,y),P)};return b}getParsed(n){return this._cachedMeta._parsed[n]}getDataElement(n){return this._cachedMeta.data[n]}applyStack(n,c,l){const d=this._cachedMeta,m=c[n.axis];return gi({keys:Vn(this.chart,!0),values:c._stacks[n.axis]._visualValues},m,d.index,{mode:l})}updateRangeFromParsed(n,c,l,h){const d=l[c.axis];let m=null===d?NaN:d;const g=h&&l._stacks[c.axis];h&&g&&(h.values=g,m=gi(h,d,this._cachedMeta.index)),n.min=Math.min(n.min,m),n.max=Math.max(n.max,m)}getMinMax(n,c){const l=this._cachedMeta,h=l._parsed,d=l._sorted&&n===l.iScale,m=h.length,g=this._getOtherScale(n),y=((i,a,n)=>i&&!a.hidden&&a._stacked&&{keys:Vn(this.chart,!0),values:null})(c,l),b={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:O}=function zn(i){const{min:a,max:n,minDefined:c,maxDefined:l}=i.getUserBounds();return{min:c?a:Number.NEGATIVE_INFINITY,max:l?n:Number.POSITIVE_INFINITY}}(g);let P,j;function Y(){j=h[P];const K=j[g.axis];return!ur(j[n.axis])||S>K||O<K}for(P=0;P<m&&(Y()||(this.updateRangeFromParsed(b,n,j,y),!d));++P);if(d)for(P=m-1;P>=0;--P)if(!Y()){this.updateRangeFromParsed(b,n,j,y);break}return b}getAllParsedValues(n){const c=this._cachedMeta._parsed,l=[];let h,d,m;for(h=0,d=c.length;h<d;++h)m=c[h][n.axis],ur(m)&&l.push(m);return l}getMaxOverflow(){return!1}getLabelAndValue(n){const c=this._cachedMeta,l=c.iScale,h=c.vScale,d=this.getParsed(n);return{label:l?""+l.getLabelForValue(d[l.axis]):"",value:h?""+h.getLabelForValue(d[h.axis]):""}}_update(n){const c=this._cachedMeta;this.update(n||"default"),c._clip=function Ql(i){let a,n,c,l;return It(i)?(a=i.top,n=i.right,c=i.bottom,l=i.left):a=n=c=l=i,{top:a,right:n,bottom:c,left:l,disabled:!1===i}}(Tt(this.options.clip,function Lt(i,a,n){if(!1===n)return!1;const c=Et(i,n),l=Et(a,n);return{top:l.end,right:c.end,bottom:l.start,left:c.start}}(c.xScale,c.yScale,this.getMaxOverflow())))}update(n){}draw(){const n=this._ctx,l=this._cachedMeta,h=l.data||[],d=this.chart.chartArea,m=[],g=this._drawStart||0,y=this._drawCount||h.length-g,b=this.options.drawActiveElementsOnTop;let S;for(l.dataset&&l.dataset.draw(n,d,g,y),S=g;S<g+y;++S){const O=h[S];O.hidden||(O.active&&b?m.push(O):O.draw(n,d))}for(S=0;S<m.length;++S)m[S].draw(n,d)}getStyle(n,c){const l=c?"active":"default";return void 0===n&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(l):this.resolveDataElementOptions(n||0,l)}getContext(n,c,l){const h=this.getDataset();let d;if(n>=0&&n<this._cachedMeta.data.length){const m=this._cachedMeta.data[n];d=m.$context||(m.$context=function Hh(i,a,n){return In(i,{active:!1,dataIndex:a,parsed:void 0,raw:void 0,element:n,index:a,mode:"default",type:"data"})}(this.getContext(),n,m)),d.parsed=this.getParsed(n),d.raw=h.data[n],d.index=d.dataIndex=n}else d=this.$context||(this.$context=function wc(i,a){return In(i,{active:!1,dataset:void 0,datasetIndex:a,index:a,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),d.dataset=h,d.index=d.datasetIndex=this.index;return d.active=!!c,d.mode=l,d}resolveDatasetElementOptions(n){return this._resolveElementOptions(this.datasetElementType.id,n)}resolveDataElementOptions(n,c){return this._resolveElementOptions(this.dataElementType.id,c,n)}_resolveElementOptions(n,c="default",l){const h="active"===c,d=this._cachedDataOpts,m=n+"-"+c,g=d[m],y=this.enableOptionSharing&&Ci(l);if(g)return Sn(g,y);const b=this.chart.config,S=b.datasetElementScopeKeys(this._type,n),O=h?[`${n}Hover`,"hover",n,""]:[n,""],P=b.getOptionScopes(this.getDataset(),S),j=Object.keys(ar.elements[n]),K=b.resolveNamedOptions(P,j,()=>this.getContext(l,h,c),O);return K.$shared&&(K.$shared=y,d[m]=Object.freeze(Sn(K,y))),K}_resolveAnimations(n,c,l){const h=this.chart,d=this._cachedDataOpts,m=`animation-${c}`,g=d[m];if(g)return g;let y;if(!1!==h.options.animation){const S=this.chart.config,O=S.datasetAnimationScopeKeys(this._type,c),P=S.getOptionScopes(this.getDataset(),O);y=S.createResolver(P,this.getContext(n,l,c))}const b=new pr(h,y&&y.animations);return y&&y._cacheable&&(d[m]=Object.freeze(b)),b}getSharedOptions(n){if(n.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},n))}includeOptions(n,c){return!c||yc(n)||this.chart._animationsDisabled}_getSharedOptions(n,c){const l=this.resolveDataElementOptions(n,c),h=this._sharedOptions,d=this.getSharedOptions(l),m=this.includeOptions(c,d)||d!==h;return this.updateSharedOptions(d,c,l),{sharedOptions:d,includeOptions:m}}updateElement(n,c,l,h){yc(h)?Object.assign(n,l):this._resolveAnimations(c,h).update(n,l)}updateSharedOptions(n,c,l){n&&!yc(c)&&this._resolveAnimations(void 0,c).update(n,l)}_setStyle(n,c,l,h){n.active=h;const d=this.getStyle(c,h);this._resolveAnimations(c,l,h).update(n,{options:!h&&this.getSharedOptions(d)||d})}removeHoverStyle(n,c,l){this._setStyle(n,l,"active",!1)}setHoverStyle(n,c,l){this._setStyle(n,l,"active",!0)}_removeDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!1)}_setDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!0)}_resyncElements(n){const c=this._data,l=this._cachedMeta.data;for(const[g,y,b]of this._syncList)this[g](y,b);this._syncList=[];const h=l.length,d=c.length,m=Math.min(d,h);m&&this.parse(0,m),d>h?this._insertElements(h,d-h,n):d<h&&this._removeElements(d,h-d)}_insertElements(n,c,l=!0){const h=this._cachedMeta,d=h.data,m=n+c;let g;const y=b=>{for(b.length+=c,g=b.length-1;g>=m;g--)b[g]=b[g-c]};for(y(d),g=n;g<m;++g)d[g]=new this.dataElementType;this._parsing&&y(h._parsed),this.parse(n,c),l&&this.updateElements(d,n,c,"reset")}updateElements(n,c,l,h){}_removeElements(n,c){const l=this._cachedMeta;if(this._parsing){const h=l._parsed.splice(n,c);l._stacked&&xs(l,h)}l.data.splice(n,c)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[c,l,h]=n;this[c](l,h)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const n=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-n,n])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(n,c){c&&this._sync(["_removeElements",n,c]);const l=arguments.length-2;l&&this._sync(["_insertElements",n,l])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}})();function Wh(i){const a=i.iScale,n=function ia(i,a){if(!i._cache.$bar){const n=i.getMatchingVisibleMetas(a);let c=[];for(let l=0,h=n.length;l<h;l++)c=c.concat(n[l].controller.getAllParsedValues(i));i._cache.$bar=ss(c.sort((l,h)=>l-h))}return i._cache.$bar}(a,i.type);let l,h,d,m,c=a._length;const g=()=>{32767===d||-32768===d||(Ci(m)&&(c=Math.min(c,Math.abs(d-m)||c)),m=d)};for(l=0,h=n.length;l<h;++l)d=a.getPixelForValue(n[l]),g();for(m=void 0,l=0,h=a.ticks.length;l<h;++l)d=a.getPixelForTick(l),g();return c}function r0(i,a,n,c){return Vt(i)?function lo(i,a,n,c){const l=n.parse(i[0],c),h=n.parse(i[1],c),d=Math.min(l,h),m=Math.max(l,h);let g=d,y=m;Math.abs(d)>Math.abs(m)&&(g=m,y=d),a[n.axis]=y,a._custom={barStart:g,barEnd:y,start:l,end:h,min:d,max:m}}(i,a,n,c):a[n.axis]=n.parse(i,c),a}function fo(i,a,n,c){const l=i.iScale,h=i.vScale,d=l.getLabels(),m=l===h,g=[];let y,b,S,O;for(y=n,b=n+c;y<b;++y)O=a[y],S={},S[l.axis]=m||l.parse(d[y],y),g.push(r0(O,S,h,y));return g}function _s(i){return i&&void 0!==i.barStart&&void 0!==i.barEnd}function i0(i,a,n,c){let l=a.borderSkipped;const h={};if(!l)return void(i.borderSkipped=h);if(!0===l)return void(i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:d,end:m,reverse:g,top:y,bottom:b}=function n0(i){let a,n,c,l,h;return i.horizontal?(a=i.base>i.x,n="left",c="right"):(a=i.base<i.y,n="bottom",c="top"),a?(l="end",h="start"):(l="start",h="end"),{start:n,end:c,reverse:a,top:l,bottom:h}}(i);"middle"===l&&n&&(i.enableBorderRadius=!0,(n._top||0)===c?l=y:(n._bottom||0)===c?l=b:(h[a0(b,d,m,g)]=!0,l=y)),h[a0(l,d,m,g)]=!0,i.borderSkipped=h}function a0(i,a,n,c){return c?(i=function aa(i,a,n){return i===a?n:i===n?a:i}(i,a,n),i=sa(i,n,a)):i=sa(i,a,n),i}function sa(i,a,n){return"start"===i?a:"end"===i?n:i}function en(i,{inflateAmount:a},n){i.inflateAmount="auto"===a?1===n?.33:0:a}let oa=(()=>class i extends gn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(n,c,l,h){return fo(n,c,l,h)}parseArrayData(n,c,l,h){return fo(n,c,l,h)}parseObjectData(n,c,l,h){const{iScale:d,vScale:m}=n,{xAxisKey:g="x",yAxisKey:y="y"}=this._parsing,b="x"===d.axis?g:y,S="x"===m.axis?g:y,O=[];let P,j,Y,K;for(P=l,j=l+h;P<j;++P)K=c[P],Y={},Y[d.axis]=d.parse(qn(K,b),P),O.push(r0(qn(K,S),Y,m,P));return O}updateRangeFromParsed(n,c,l,h){super.updateRangeFromParsed(n,c,l,h);const d=l._custom;d&&c===this._cachedMeta.vScale&&(n.min=Math.min(n.min,d.min),n.max=Math.max(n.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(n){const c=this._cachedMeta,{iScale:l,vScale:h}=c,d=this.getParsed(n),m=d._custom,g=_s(m)?"["+m.start+", "+m.end+"]":""+h.getLabelForValue(d[h.axis]);return{label:""+l.getLabelForValue(d[l.axis]),value:g}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(n){const c=this._cachedMeta;this.updateElements(c.data,0,c.data.length,n)}updateElements(n,c,l,h){const d="reset"===h,{index:m,_cachedMeta:{vScale:g}}=this,y=g.getBasePixel(),b=g.isHorizontal(),S=this._getRuler(),{sharedOptions:O,includeOptions:P}=this._getSharedOptions(c,h);for(let j=c;j<c+l;j++){const Y=this.getParsed(j),K=d||Pt(Y[g.axis])?{base:y,head:y}:this._calculateBarValuePixels(j),xe=this._calculateBarIndexPixels(j,S),pe=(Y._stacks||{})[g.axis],Ie={horizontal:b,base:K.base,enableBorderRadius:!pe||_s(Y._custom)||m===pe._top||m===pe._bottom,x:b?K.head:xe.center,y:b?xe.center:K.head,height:b?xe.size:Math.abs(K.size),width:b?Math.abs(K.size):xe.size};P&&(Ie.options=O||this.resolveDataElementOptions(j,n[j].active?"active":h));const Me=Ie.options||n[j].options;i0(Ie,Me,pe,m),en(Ie,Me,S.ratio),this.updateElement(n[j],j,Ie,h)}}_getStacks(n,c){const{iScale:l}=this._cachedMeta,h=l.getMatchingVisibleMetas(this._type).filter(y=>y.controller.options.grouped),d=l.options.stacked,m=[],g=y=>{const b=y.controller.getParsed(c),S=b&&b[y.vScale.axis];if(Pt(S)||isNaN(S))return!0};for(const y of h)if((void 0===c||!g(y))&&((!1===d||-1===m.indexOf(y.stack)||void 0===d&&void 0===y.stack)&&m.push(y.stack),y.index===n))break;return m.length||m.push(void 0),m}_getStackCount(n){return this._getStacks(void 0,n).length}_getStackIndex(n,c,l){const h=this._getStacks(n,l),d=void 0!==c?h.indexOf(c):-1;return-1===d?h.length-1:d}_getRuler(){const n=this.options,c=this._cachedMeta,l=c.iScale,h=[];let d,m;for(d=0,m=c.data.length;d<m;++d)h.push(l.getPixelForValue(this.getParsed(d)[l.axis],d));const g=n.barThickness;return{min:g||Wh(c),pixels:h,start:l._startPixel,end:l._endPixel,stackCount:this._getStackCount(),scale:l,grouped:n.grouped,ratio:g?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(n){const{_cachedMeta:{vScale:c,_stacked:l,index:h},options:{base:d,minBarLength:m}}=this,g=d||0,y=this.getParsed(n),b=y._custom,S=_s(b);let Y,K,O=y[c.axis],P=0,j=l?this.applyStack(c,y,l):O;j!==O&&(P=j-O,j=O),S&&(O=b.barStart,j=b.barEnd-b.barStart,0!==O&&On(O)!==On(b.barEnd)&&(P=0),P+=O);const xe=Pt(d)||S?P:d;let pe=c.getPixelForValue(xe);if(Y=this.chart.getDataVisibility(n)?c.getPixelForValue(P+j):pe,K=Y-pe,Math.abs(K)<m){K=function kc(i,a,n){return 0!==i?On(i):(a.isHorizontal()?1:-1)*(a.min>=n?1:-1)}(K,c,g)*m,O===g&&(pe-=K/2);const Ie=c.getPixelForDecimal(0),Me=c.getPixelForDecimal(1),Ce=Math.min(Ie,Me),Pe=Math.max(Ie,Me);pe=Math.max(Math.min(pe,Pe),Ce),Y=pe+K,l&&!S&&(y._stacks[c.axis]._visualValues[h]=c.getValueForPixel(Y)-c.getValueForPixel(pe))}if(pe===c.getPixelForValue(g)){const Ie=On(K)*c.getLineWidthForValue(g)/2;pe+=Ie,K-=Ie}return{size:K,base:pe,head:Y,center:Y+K/2}}_calculateBarIndexPixels(n,c){const l=c.scale,h=this.options,d=h.skipNull,m=Tt(h.maxBarThickness,1/0);let g,y;if(c.grouped){const b=d?this._getStackCount(n):c.stackCount,S="flex"===h.barThickness?function bc(i,a,n,c){const l=a.pixels,h=l[i];let d=i>0?l[i-1]:null,m=i<l.length-1?l[i+1]:null;const g=n.categoryPercentage;null===d&&(d=h-(null===m?a.end-a.start:m-h)),null===m&&(m=h+h-d);const y=h-(h-Math.min(d,m))/2*g;return{chunk:Math.abs(m-d)/2*g/c,ratio:n.barPercentage,start:y}}(n,c,h,b):function t0(i,a,n,c){const l=n.barThickness;let h,d;return Pt(l)?(h=a.min*n.categoryPercentage,d=n.barPercentage):(h=l*c,d=1),{chunk:h/c,ratio:d,start:a.pixels[i]-h/2}}(n,c,h,b),O=this._getStackIndex(this.index,this._cachedMeta.stack,d?n:void 0);g=S.start+S.chunk*O+S.chunk/2,y=Math.min(m,S.chunk*S.ratio)}else g=l.getPixelForValue(this.getParsed(n)[l.axis],n),y=Math.min(m,c.min*c.ratio);return{base:g-y/2,head:g+y/2,center:g,size:y}}draw(){const n=this._cachedMeta,c=n.vScale,l=n.data,h=l.length;let d=0;for(;d<h;++d)null!==this.getParsed(d)[c.axis]&&l[d].draw(this._ctx)}})(),Vh=(()=>class i extends gn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(n,c,l,h){const d=super.parsePrimitiveData(n,c,l,h);for(let m=0;m<d.length;m++)d[m]._custom=this.resolveDataElementOptions(m+l).radius;return d}parseArrayData(n,c,l,h){const d=super.parseArrayData(n,c,l,h);for(let m=0;m<d.length;m++)d[m]._custom=Tt(c[l+m][2],this.resolveDataElementOptions(m+l).radius);return d}parseObjectData(n,c,l,h){const d=super.parseObjectData(n,c,l,h);for(let m=0;m<d.length;m++){const g=c[l+m];d[m]._custom=Tt(g&&g.r&&+g.r,this.resolveDataElementOptions(m+l).radius)}return d}getMaxOverflow(){const n=this._cachedMeta.data;let c=0;for(let l=n.length-1;l>=0;--l)c=Math.max(c,n[l].size(this.resolveDataElementOptions(l))/2);return c>0&&c}getLabelAndValue(n){const c=this._cachedMeta,l=this.chart.data.labels||[],{xScale:h,yScale:d}=c,m=this.getParsed(n),g=h.getLabelForValue(m.x),y=d.getLabelForValue(m.y),b=m._custom;return{label:l[n]||"",value:"("+g+", "+y+(b?", "+b:"")+")"}}update(n){const c=this._cachedMeta.data;this.updateElements(c,0,c.length,n)}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g}=this._cachedMeta,{sharedOptions:y,includeOptions:b}=this._getSharedOptions(c,h),S=m.axis,O=g.axis;for(let P=c;P<c+l;P++){const j=n[P],Y=!d&&this.getParsed(P),K={},xe=K[S]=d?m.getPixelForDecimal(.5):m.getPixelForValue(Y[S]),pe=K[O]=d?g.getBasePixel():g.getPixelForValue(Y[O]);K.skip=isNaN(xe)||isNaN(pe),b&&(K.options=y||this.resolveDataElementOptions(P,j.active?"active":h),d&&(K.options.radius=0)),this.updateElement(j,P,K,h)}}resolveDataElementOptions(n,c){const l=this.getParsed(n);let h=super.resolveDataElementOptions(n,c);h.$shared&&(h=Object.assign({},h,{$shared:!1}));const d=h.radius;return"active"!==c&&(h.radius=0),h.radius+=Tt(l&&l._custom,d),h}})(),Tc=(()=>class i extends gn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:n=>"spacing"!==n,_indexable:n=>"spacing"!==n&&!n.startsWith("borderDash")&&!n.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const c=n.data;if(c.labels.length&&c.datasets.length){const{labels:{pointStyle:l,color:h}}=n.legend.options;return c.labels.map((d,m)=>{const y=n.getDatasetMeta(0).controller.getStyle(m);return{text:d,fillStyle:y.backgroundColor,strokeStyle:y.borderColor,fontColor:h,lineWidth:y.borderWidth,pointStyle:l,hidden:!n.getDataVisibility(m),index:m}})}return[]}},onClick(n,c,l){l.chart.toggleDataVisibility(c.index),l.chart.update()}}}};constructor(n,c){super(n,c),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,c){const l=this.getDataset().data,h=this._cachedMeta;if(!1===this._parsing)h._parsed=l;else{let m,g,d=y=>+l[y];if(It(l[n])){const{key:y="value"}=this._parsing;d=b=>+qn(l[b],y)}for(m=n,g=n+c;m<g;++m)h._parsed[m]=d(m)}}_getRotation(){return M(this.options.rotation-90)}_getCircumference(){return M(this.options.circumference)}_getRotationExtents(){let n=ir,c=-ir;for(let l=0;l<this.chart.data.datasets.length;++l)if(this.chart.isDatasetVisible(l)&&this.chart.getDatasetMeta(l).type===this._type){const h=this.chart.getDatasetMeta(l).controller,d=h._getRotation(),m=h._getCircumference();n=Math.min(n,d),c=Math.max(c,d+m)}return{rotation:n,circumference:c-n}}update(n){const c=this.chart,{chartArea:l}=c,h=this._cachedMeta,d=h.data,m=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,g=Math.max((Math.min(l.width,l.height)-m)/2,0),y=Math.min(((i,a)=>"string"==typeof i&&i.endsWith("%")?parseFloat(i)/100:+i/a)(this.options.cutout,g),1),b=this._getRingWeight(this.index),{circumference:S,rotation:O}=this._getRotationExtents(),{ratioX:P,ratioY:j,offsetX:Y,offsetY:K}=function ho(i,a,n){let c=1,l=1,h=0,d=0;if(a<ir){const m=i,g=m+a,y=Math.cos(m),b=Math.sin(m),S=Math.cos(g),O=Math.sin(g),P=(Ie,Me,Ce)=>er(Ie,m,g,!0)?1:Math.max(Me,Me*n,Ce,Ce*n),j=(Ie,Me,Ce)=>er(Ie,m,g,!0)?-1:Math.min(Me,Me*n,Ce,Ce*n),Y=P(0,y,S),K=P(gr,b,O),xe=j(qt,y,S),pe=j(qt+gr,b,O);c=(Y-xe)/2,l=(K-pe)/2,h=-(Y+xe)/2,d=-(K+pe)/2}return{ratioX:c,ratioY:l,offsetX:h,offsetY:d}}(O,S,y),Ie=Math.max(Math.min((l.width-m)/P,(l.height-m)/j)/2,0),Me=Ys(this.options.radius,Ie),Pe=(Me-Math.max(Me*y,0))/this._getVisibleDatasetWeightTotal();this.offsetX=Y*Me,this.offsetY=K*Me,h.total=this.calculateTotal(),this.outerRadius=Me-Pe*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Pe*b,0),this.updateElements(d,0,d.length,n)}_circumference(n,c){const l=this.options,h=this._cachedMeta,d=this._getCircumference();return c&&l.animation.animateRotate||!this.chart.getDataVisibility(n)||null===h._parsed[n]||h.data[n].hidden?0:this.calculateCircumference(h._parsed[n]*d/ir)}updateElements(n,c,l,h){const d="reset"===h,m=this.chart,g=m.chartArea,S=(g.left+g.right)/2,O=(g.top+g.bottom)/2,P=d&&m.options.animation.animateScale,j=P?0:this.innerRadius,Y=P?0:this.outerRadius,{sharedOptions:K,includeOptions:xe}=this._getSharedOptions(c,h);let Ie,pe=this._getRotation();for(Ie=0;Ie<c;++Ie)pe+=this._circumference(Ie,d);for(Ie=c;Ie<c+l;++Ie){const Me=this._circumference(Ie,d),Ce=n[Ie],Pe={x:S+this.offsetX,y:O+this.offsetY,startAngle:pe,endAngle:pe+Me,circumference:Me,outerRadius:Y,innerRadius:j};xe&&(Pe.options=K||this.resolveDataElementOptions(Ie,Ce.active?"active":h)),pe+=Me,this.updateElement(Ce,Ie,Pe,h)}}calculateTotal(){const n=this._cachedMeta,c=n.data;let h,l=0;for(h=0;h<c.length;h++){const d=n._parsed[h];null!==d&&!isNaN(d)&&this.chart.getDataVisibility(h)&&!c[h].hidden&&(l+=Math.abs(d))}return l}calculateCircumference(n){const c=this._cachedMeta.total;return c>0&&!isNaN(n)?ir*(Math.abs(n)/c):0}getLabelAndValue(n){const l=this.chart,h=l.data.labels||[],d=fs(this._cachedMeta._parsed[n],l.options.locale);return{label:h[n]||"",value:d}}getMaxBorderWidth(n){let c=0;const l=this.chart;let h,d,m,g,y;if(!n)for(h=0,d=l.data.datasets.length;h<d;++h)if(l.isDatasetVisible(h)){m=l.getDatasetMeta(h),n=m.data,g=m.controller;break}if(!n)return 0;for(h=0,d=n.length;h<d;++h)y=g.resolveDataElementOptions(h),"inner"!==y.borderAlign&&(c=Math.max(c,y.borderWidth||0,y.hoverBorderWidth||0));return c}getMaxOffset(n){let c=0;for(let l=0,h=n.length;l<h;++l){const d=this.resolveDataElementOptions(l);c=Math.max(c,d.offset||0,d.hoverOffset||0)}return c}_getRingWeightOffset(n){let c=0;for(let l=0;l<n;++l)this.chart.isDatasetVisible(l)&&(c+=this._getRingWeight(l));return c}_getRingWeight(n){return Math.max(Tt(this.chart.data.datasets[n].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}})(),zh=(()=>class i extends gn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(n){const c=this._cachedMeta,{dataset:l,data:h=[],_dataset:d}=c,m=this.chart._animationsDisabled;let{start:g,count:y}=cs(c,h,m);this._drawStart=g,this._drawCount=y,Ol(c)&&(g=0,y=h.length),l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!d._decimated,l.points=h;const b=this.resolveDatasetElementOptions(n);this.options.showLine||(b.borderWidth=0),b.segment=this.options.segment,this.updateElement(l,void 0,{animated:!m,options:b},n),this.updateElements(h,g,y,n)}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g,_stacked:y,_dataset:b}=this._cachedMeta,{sharedOptions:S,includeOptions:O}=this._getSharedOptions(c,h),P=m.axis,j=g.axis,{spanGaps:Y,segment:K}=this.options,xe=di(Y)?Y:Number.POSITIVE_INFINITY,pe=this.chart._animationsDisabled||d||"none"===h,Ie=c+l,Me=n.length;let Ce=c>0&&this.getParsed(c-1);for(let Pe=0;Pe<Me;++Pe){const rt=n[Pe],Ve=pe?rt:{};if(Pe<c||Pe>=Ie){Ve.skip=!0;continue}const dt=this.getParsed(Pe),Dt=Pt(dt[j]),Ft=Ve[P]=m.getPixelForValue(dt[P],Pe),Mt=Ve[j]=d||Dt?g.getBasePixel():g.getPixelForValue(y?this.applyStack(g,dt,y):dt[j],Pe);Ve.skip=isNaN(Ft)||isNaN(Mt)||Dt,Ve.stop=Pe>0&&Math.abs(dt[P]-Ce[P])>xe,K&&(Ve.parsed=dt,Ve.raw=b.data[Pe]),O&&(Ve.options=S||this.resolveDataElementOptions(Pe,rt.active?"active":h)),pe||this.updateElement(rt,Pe,Ve,h),Ce=dt}}getMaxOverflow(){const n=this._cachedMeta,c=n.dataset,l=c.options&&c.options.borderWidth||0,h=n.data||[];if(!h.length)return l;const d=h[0].size(this.resolveDataElementOptions(0)),m=h[h.length-1].size(this.resolveDataElementOptions(h.length-1));return Math.max(l,d,m)/2}draw(){const n=this._cachedMeta;n.dataset.updateControlPoints(this.chart.chartArea,n.iScale.axis),super.draw()}})(),Cc=(()=>class i extends gn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const c=n.data;if(c.labels.length&&c.datasets.length){const{labels:{pointStyle:l,color:h}}=n.legend.options;return c.labels.map((d,m)=>{const y=n.getDatasetMeta(0).controller.getStyle(m);return{text:d,fillStyle:y.backgroundColor,strokeStyle:y.borderColor,fontColor:h,lineWidth:y.borderWidth,pointStyle:l,hidden:!n.getDataVisibility(m),index:m}})}return[]}},onClick(n,c,l){l.chart.toggleDataVisibility(c.index),l.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(n,c){super(n,c),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(n){const l=this.chart,h=l.data.labels||[],d=fs(this._cachedMeta._parsed[n].r,l.options.locale);return{label:h[n]||"",value:d}}parseObjectData(n,c,l,h){return uc.bind(this)(n,c,l,h)}update(n){const c=this._cachedMeta.data;this._updateRadius(),this.updateElements(c,0,c.length,n)}getMinMax(){const c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((l,h)=>{const d=this.getParsed(h).r;!isNaN(d)&&this.chart.getDataVisibility(h)&&(d<c.min&&(c.min=d),d>c.max&&(c.max=d))}),c}_updateRadius(){const n=this.chart,c=n.chartArea,l=n.options,h=Math.min(c.right-c.left,c.bottom-c.top),d=Math.max(h/2,0),g=(d-Math.max(l.cutoutPercentage?d/100*l.cutoutPercentage:1,0))/n.getVisibleDatasetCount();this.outerRadius=d-g*this.index,this.innerRadius=this.outerRadius-g}updateElements(n,c,l,h){const d="reset"===h,m=this.chart,y=m.options.animation,b=this._cachedMeta.rScale,S=b.xCenter,O=b.yCenter,P=b.getIndexAngle(0)-.5*qt;let Y,j=P;const K=360/this.countVisibleElements();for(Y=0;Y<c;++Y)j+=this._computeAngle(Y,h,K);for(Y=c;Y<c+l;Y++){const xe=n[Y];let pe=j,Ie=j+this._computeAngle(Y,h,K),Me=m.getDataVisibility(Y)?b.getDistanceFromCenterForValue(this.getParsed(Y).r):0;j=Ie,d&&(y.animateScale&&(Me=0),y.animateRotate&&(pe=Ie=P));const Ce={x:S,y:O,innerRadius:0,outerRadius:Me,startAngle:pe,endAngle:Ie,options:this.resolveDataElementOptions(Y,xe.active?"active":h)};this.updateElement(xe,Y,Ce,h)}}countVisibleElements(){let c=0;return this._cachedMeta.data.forEach((l,h)=>{!isNaN(this.getParsed(h).r)&&this.chart.getDataVisibility(h)&&c++}),c}_computeAngle(n,c,l){return this.chart.getDataVisibility(n)?M(this.resolveDataElementOptions(n,c).angle||l):0}})();var xn=Object.freeze({__proto__:null,BarController:oa,BubbleController:Vh,DoughnutController:Tc,LineController:zh,PieController:(()=>class i extends Tc{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}})(),PolarAreaController:Cc,RadarController:(()=>class i extends gn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(n){const c=this._cachedMeta.vScale,l=this.getParsed(n);return{label:c.getLabels()[n],value:""+c.getLabelForValue(l[c.axis])}}parseObjectData(n,c,l,h){return uc.bind(this)(n,c,l,h)}update(n){const c=this._cachedMeta,l=c.dataset,h=c.data||[],d=c.iScale.getLabels();if(l.points=h,"resize"!==n){const m=this.resolveDatasetElementOptions(n);this.options.showLine||(m.borderWidth=0),this.updateElement(l,void 0,{_loop:!0,_fullLoop:d.length===h.length,options:m},n)}this.updateElements(h,0,h.length,n)}updateElements(n,c,l,h){const d=this._cachedMeta.rScale,m="reset"===h;for(let g=c;g<c+l;g++){const y=n[g],b=this.resolveDataElementOptions(g,y.active?"active":h),S=d.getPointPositionForValue(g,this.getParsed(g).r),O=m?d.xCenter:S.x,P=m?d.yCenter:S.y,j={x:O,y:P,angle:S.angle,skip:isNaN(O)||isNaN(P),options:b};this.updateElement(y,g,j,h)}}})(),ScatterController:(()=>class i extends gn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(n){const c=this._cachedMeta,l=this.chart.data.labels||[],{xScale:h,yScale:d}=c,m=this.getParsed(n),g=h.getLabelForValue(m.x),y=d.getLabelForValue(m.y);return{label:l[n]||"",value:"("+g+", "+y+")"}}update(n){const c=this._cachedMeta,{data:l=[]}=c,h=this.chart._animationsDisabled;let{start:d,count:m}=cs(c,l,h);if(this._drawStart=d,this._drawCount=m,Ol(c)&&(d=0,m=l.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:g,_dataset:y}=c;g._chart=this.chart,g._datasetIndex=this.index,g._decimated=!!y._decimated,g.points=l;const b=this.resolveDatasetElementOptions(n);b.segment=this.options.segment,this.updateElement(g,void 0,{animated:!h,options:b},n)}else this.datasetElementType&&(delete c.dataset,this.datasetElementType=!1);this.updateElements(l,d,m,n)}addElements(){const{showLine:n}=this.options;!this.datasetElementType&&n&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g,_stacked:y,_dataset:b}=this._cachedMeta,S=this.resolveDataElementOptions(c,h),O=this.getSharedOptions(S),P=this.includeOptions(h,O),j=m.axis,Y=g.axis,{spanGaps:K,segment:xe}=this.options,pe=di(K)?K:Number.POSITIVE_INFINITY,Ie=this.chart._animationsDisabled||d||"none"===h;let Me=c>0&&this.getParsed(c-1);for(let Ce=c;Ce<c+l;++Ce){const Pe=n[Ce],rt=this.getParsed(Ce),Ve=Ie?Pe:{},dt=Pt(rt[Y]),Dt=Ve[j]=m.getPixelForValue(rt[j],Ce),Ft=Ve[Y]=d||dt?g.getBasePixel():g.getPixelForValue(y?this.applyStack(g,rt,y):rt[Y],Ce);Ve.skip=isNaN(Dt)||isNaN(Ft)||dt,Ve.stop=Ce>0&&Math.abs(rt[j]-Me[j])>pe,xe&&(Ve.parsed=rt,Ve.raw=b.data[Ce]),P&&(Ve.options=O||this.resolveDataElementOptions(Ce,Pe.active?"active":h)),Ie||this.updateElement(Pe,Ce,Ve,h),Me=rt}this.updateSharedOptions(O,h,S)}getMaxOverflow(){const n=this._cachedMeta,c=n.data||[];if(!this.options.showLine){let g=0;for(let y=c.length-1;y>=0;--y)g=Math.max(g,c[y].size(this.resolveDataElementOptions(y))/2);return g>0&&g}const l=n.dataset,h=l.options&&l.options.borderWidth||0;if(!c.length)return h;const d=c[0].size(this.resolveDataElementOptions(0)),m=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(h,d,m)/2}})()});function ii(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class uo{static override(a){Object.assign(uo.prototype,a)}options;constructor(a){this.options=a||{}}init(){}formats(){return ii()}parse(){return ii()}format(){return ii()}add(){return ii()}diff(){return ii()}startOf(){return ii()}endOf(){return ii()}}var po__date=uo;function B1(i,a,n,c){const{controller:l,data:h,_sorted:d}=i,m=l._cachedMeta.iScale;if(m&&a===m.axis&&"r"!==a&&d&&h.length){const g=m._reversePixels?ec:mn;if(!c)return g(h,a,n);if(l._sharedOptions){const y=h[0],b="function"==typeof y.getRange&&y.getRange(a);if(b){const S=g(h,a,n-b),O=g(h,a,n+b);return{lo:S.lo,hi:O.hi}}}}return{lo:0,hi:h.length-1}}function Pi(i,a,n,c,l){const h=i.getSortedVisibleDatasetMetas(),d=n[a];for(let m=0,g=h.length;m<g;++m){const{index:y,data:b}=h[m],{lo:S,hi:O}=B1(h[m],a,d,l);for(let P=S;P<=O;++P){const j=b[P];j.skip||c(j,y,P)}}}function Ec(i,a,n,c,l){const h=[];return!l&&!i.isPointInArea(a)||Pi(i,n,a,function(m,g,y){!l&&!mt(m,i.chartArea,0)||m.inRange(a.x,a.y,c)&&h.push({element:m,datasetIndex:g,index:y})},!0),h}function Sc(i,a,n,c,l,h){return h||i.isPointInArea(a)?"r"!==n||c?function Gh(i,a,n,c,l,h){let d=[];const m=function $h(i){const a=-1!==i.indexOf("x"),n=-1!==i.indexOf("y");return function(c,l){const h=a?Math.abs(c.x-l.x):0,d=n?Math.abs(c.y-l.y):0;return Math.sqrt(Math.pow(h,2)+Math.pow(d,2))}}(n);let g=Number.POSITIVE_INFINITY;return Pi(i,n,a,function y(b,S,O){const P=b.inRange(a.x,a.y,l);if(c&&!P)return;const j=b.getCenterPoint(l);if(!h&&!i.isPointInArea(j)&&!P)return;const K=m(a,j);K<g?(d=[{element:b,datasetIndex:S,index:O}],g=K):K===g&&d.push({element:b,datasetIndex:S,index:O})}),d}(i,a,n,c,l,h):function U1(i,a,n,c){let l=[];return Pi(i,n,a,function h(d,m,g){const{startAngle:y,endAngle:b}=d.getProps(["startAngle","endAngle"],c),{angle:S}=ve(d,{x:a.x,y:a.y});er(S,y,b)&&l.push({element:d,datasetIndex:m,index:g})}),l}(i,a,n,l):[]}function Rr(i,a,n,c,l){const h=[],d="x"===n?"inXRange":"inYRange";let m=!1;return Pi(i,n,a,(g,y,b)=>{g[d](a[n],l)&&(h.push({element:g,datasetIndex:y,index:b}),m=m||g.inRange(a.x,a.y,l))}),c&&!m?[]:h}var o0={evaluateInteractionItems:Pi,modes:{index(i,a,n,c){const l=Ii(a,i),h=n.axis||"x",d=n.includeInvisible||!1,m=n.intersect?Ec(i,l,h,c,d):Sc(i,l,h,!1,c,d),g=[];return m.length?(i.getSortedVisibleDatasetMetas().forEach(y=>{const b=m[0].index,S=y.data[b];S&&!S.skip&&g.push({element:S,datasetIndex:y.index,index:b})}),g):[]},dataset(i,a,n,c){const l=Ii(a,i),h=n.axis||"xy",d=n.includeInvisible||!1;let m=n.intersect?Ec(i,l,h,c,d):Sc(i,l,h,!1,c,d);if(m.length>0){const g=m[0].datasetIndex,y=i.getDatasetMeta(g).data;m=[];for(let b=0;b<y.length;++b)m.push({element:y[b],datasetIndex:g,index:b})}return m},point:(i,a,n,c)=>Ec(i,Ii(a,i),n.axis||"xy",c,n.includeInvisible||!1),nearest:(i,a,n,c)=>Sc(i,Ii(a,i),n.axis||"xy",n.intersect,c,n.includeInvisible||!1),x:(i,a,n,c)=>Rr(i,Ii(a,i),"x",n.intersect,c),y:(i,a,n,c)=>Rr(i,Ii(a,i),"y",n.intersect,c)}};const c0=["left","top","right","bottom"];function ca(i,a){return i.filter(n=>n.pos===a)}function mo(i,a){return i.filter(n=>-1===c0.indexOf(n.pos)&&n.box.axis===a)}function Ra(i,a){return i.sort((n,c)=>{const l=a?c:n,h=a?n:c;return l.weight===h.weight?l.index-h.index:l.weight-h.weight})}function ai(i,a,n,c){return Math.max(i[n],a[n])+Math.max(i[c],a[c])}function Ac(i,a){i.top=Math.max(i.top,a.top),i.left=Math.max(i.left,a.left),i.bottom=Math.max(i.bottom,a.bottom),i.right=Math.max(i.right,a.right)}function Fc(i,a,n,c){const{pos:l,box:h}=n,d=i.maxPadding;if(!It(l)){n.size&&(i[l]-=n.size);const S=c[n.stack]||{size:0,count:1};S.size=Math.max(S.size,n.horizontal?h.height:h.width),n.size=S.size/S.count,i[l]+=n.size}h.getPadding&&Ac(d,h.getPadding());const m=Math.max(0,a.outerWidth-ai(d,i,"left","right")),g=Math.max(0,a.outerHeight-ai(d,i,"top","bottom")),y=m!==i.w,b=g!==i.h;return i.w=m,i.h=g,n.horizontal?{same:y,other:b}:{same:b,other:y}}function Dc(i,a){const n=a.maxPadding;return function c(l){const h={left:0,top:0,right:0,bottom:0};return l.forEach(d=>{h[d]=Math.max(a[d],n[d])}),h}(i?["left","right"]:["top","bottom"])}function vs(i,a,n,c){const l=[];let h,d,m,g,y,b;for(h=0,d=i.length,y=0;h<d;++h){m=i[h],g=m.box,g.update(m.width||a.w,m.height||a.h,Dc(m.horizontal,a));const{same:S,other:O}=Fc(a,n,m,c);y|=S&&l.length,b=b||O,g.fullSize||l.push(m)}return y&&vs(l,a,n,c)||b}function ws(i,a,n,c,l){i.top=n,i.left=a,i.right=a+c,i.bottom=n+l,i.width=c,i.height=l}function St(i,a,n,c){const l=n.padding;let{x:h,y:d}=a;for(const m of i){const g=m.box,y=c[m.stack]||{count:1,placed:0,weight:1},b=m.stackWeight/y.weight||1;if(m.horizontal){const S=a.w*b,O=y.size||g.height;Ci(y.start)&&(d=y.start),g.fullSize?ws(g,l.left,d,n.outerWidth-l.right-l.left,O):ws(g,a.left+y.placed,d,S,O),y.start=d,y.placed+=S,d=g.bottom}else{const S=a.h*b,O=y.size||g.width;Ci(y.start)&&(h=y.start),g.fullSize?ws(g,h,l.top,O,n.outerHeight-l.bottom-l.top):ws(g,h,a.top+y.placed,O,S),y.start=h,y.placed+=S,h=g.right}}a.x=h,a.y=d}var Ar={addBox(i,a){i.boxes||(i.boxes=[]),a.fullSize=a.fullSize||!1,a.position=a.position||"top",a.weight=a.weight||0,a._layers=a._layers||function(){return[{z:0,draw(n){a.draw(n)}}]},i.boxes.push(a)},removeBox(i,a){const n=i.boxes?i.boxes.indexOf(a):-1;-1!==n&&i.boxes.splice(n,1)},configure(i,a,n){a.fullSize=n.fullSize,a.position=n.position,a.weight=n.weight},update(i,a,n,c){if(!i)return;const l=Gr(i.options.layout.padding),h=Math.max(a-l.width,0),d=Math.max(n-l.height,0),m=function la(i){const a=function jh(i){const a=[];let n,c,l,h,d,m;for(n=0,c=(i||[]).length;n<c;++n)l=i[n],({position:h,options:{stack:d,stackWeight:m=1}}=l),a.push({index:n,box:l,pos:h,horizontal:l.isHorizontal(),weight:l.weight,stack:d&&h+d,stackWeight:m});return a}(i),n=Ra(a.filter(y=>y.box.fullSize),!0),c=Ra(ca(a,"left"),!0),l=Ra(ca(a,"right")),h=Ra(ca(a,"top"),!0),d=Ra(ca(a,"bottom")),m=mo(a,"x"),g=mo(a,"y");return{fullSize:n,leftAndTop:c.concat(h),rightAndBottom:l.concat(g).concat(d).concat(m),chartArea:ca(a,"chartArea"),vertical:c.concat(l).concat(g),horizontal:h.concat(d).concat(m)}}(i.boxes),g=m.vertical,y=m.horizontal;Xt(i.boxes,Y=>{"function"==typeof Y.beforeLayout&&Y.beforeLayout()});const b=g.reduce((Y,K)=>K.box.options&&!1===K.box.options.display?Y:Y+1,0)||1,S=Object.freeze({outerWidth:a,outerHeight:n,padding:l,availableWidth:h,availableHeight:d,vBoxMaxWidth:h/2/b,hBoxMaxHeight:d/2}),O=Object.assign({},l);Ac(O,Gr(c));const P=Object.assign({maxPadding:O,w:h,h:d,x:l.left,y:l.top},l),j=function Yh(i,a){const n=function Xh(i){const a={};for(const n of i){const{stack:c,pos:l,stackWeight:h}=n;if(!c||!c0.includes(l))continue;const d=a[c]||(a[c]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=h}return a}(i),{vBoxMaxWidth:c,hBoxMaxHeight:l}=a;let h,d,m;for(h=0,d=i.length;h<d;++h){m=i[h];const{fullSize:g}=m.box,y=n[m.stack],b=y&&m.stackWeight/y.weight;m.horizontal?(m.width=b?b*c:g&&a.availableWidth,m.height=l):(m.width=c,m.height=b?b*l:g&&a.availableHeight)}return n}(g.concat(y),S);vs(m.fullSize,P,S,j),vs(g,P,S,j),vs(y,P,S,j)&&vs(g,P,S,j),function go(i){const a=i.maxPadding;function n(c){const l=Math.max(a[c]-i[c],0);return i[c]+=l,l}i.y+=n("top"),i.x+=n("left"),n("right"),n("bottom")}(P),St(m.leftAndTop,P,S,j),P.x+=P.w,P.y+=P.h,St(m.rightAndBottom,P,S,j),i.chartArea={left:P.left,top:P.top,right:P.left+P.w,bottom:P.top+P.h,height:P.h,width:P.w},Xt(m.chartArea,Y=>{const K=Y.box;Object.assign(K,i.chartArea),K.update(P.w,P.h,{left:0,top:0,right:0,bottom:0})})}};class La{acquireContext(a,n){}releaseContext(a){return!1}addEventListener(a,n,c){}removeEventListener(a,n,c){}getDevicePixelRatio(){return 1}getMaximumSize(a,n,c,l){return n=Math.max(0,n||a.width),c=c||a.height,{width:n,height:Math.max(0,l?Math.floor(n/l):c)}}isAttached(a){return!0}updateConfig(a){}}class Na extends La{acquireContext(a){return a&&a.getContext&&a.getContext("2d")||null}updateConfig(a){a.options.animation=!1}}const Gt="$chartjs",Zh={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},l0=i=>null===i||""===i,Oc=!!ea&&{passive:!0};function Qh(i,a,n){i.canvas.removeEventListener(a,n,Oc)}function cn(i,a){for(const n of i)if(n===a||n.contains(a))return!0}function qh(i,a,n){const c=i.canvas,l=new MutationObserver(h=>{let d=!1;for(const m of h)d=d||cn(m.addedNodes,c),d=d&&!cn(m.removedNodes,c);d&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}function h0(i,a,n){const c=i.canvas,l=new MutationObserver(h=>{let d=!1;for(const m of h)d=d||cn(m.removedNodes,c),d=d&&!cn(m.addedNodes,c);d&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}const fa=new Map;let Ic=0;function Mi(){const i=window.devicePixelRatio;i!==Ic&&(Ic=i,fa.forEach((a,n)=>{n.currentDevicePixelRatio!==i&&a()}))}function eu(i,a,n){const c=i.canvas,l=c&&ps(c);if(!l)return;const h=os((m,g)=>{const y=l.clientWidth;n(m,g),y<l.clientWidth&&n()},window),d=new ResizeObserver(m=>{const g=m[0],y=g.contentRect.width,b=g.contentRect.height;0===y&&0===b||h(y,b)});return d.observe(l),function u0(i,a){fa.size||window.addEventListener("resize",Mi),fa.set(i,a)}(i,h),d}function xo(i,a,n){n&&n.disconnect(),"resize"===a&&function d0(i){fa.delete(i),fa.size||window.removeEventListener("resize",Mi)}(i)}function tu(i,a,n){const c=i.canvas,l=os(h=>{null!==i.ctx&&n(function f0(i,a){const n=Zh[i.type]||i.type,{x:c,y:l}=Ii(i,a);return{type:n,chart:a,native:i,x:void 0!==c?c:null,y:void 0!==l?l:null}}(h,i))},i);return function Jh(i,a,n){i.addEventListener(a,n,Oc)}(c,a,l),l}class ru extends La{acquireContext(a,n){const c=a&&a.getContext&&a.getContext("2d");return c&&c.canvas===a?(function Kh(i,a){const n=i.style,c=i.getAttribute("height"),l=i.getAttribute("width");if(i[Gt]={initial:{height:c,width:l,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",l0(l)){const h=Yl(i,"width");void 0!==h&&(i.width=h)}if(l0(c))if(""===i.style.height)i.height=i.width/(a||2);else{const h=Yl(i,"height");void 0!==h&&(i.height=h)}}(a,n),c):null}releaseContext(a){const n=a.canvas;if(!n[Gt])return!1;const c=n[Gt].initial;["height","width"].forEach(h=>{const d=c[h];Pt(d)?n.removeAttribute(h):n.setAttribute(h,d)});const l=c.style||{};return Object.keys(l).forEach(h=>{n.style[h]=l[h]}),n.width=n.width,delete n[Gt],!0}addEventListener(a,n,c){this.removeEventListener(a,n),(a.$proxies||(a.$proxies={}))[n]=({attach:qh,detach:h0,resize:eu}[n]||tu)(a,n,c)}removeEventListener(a,n){const c=a.$proxies||(a.$proxies={}),l=c[n];l&&(({attach:xo,detach:xo,resize:xo}[n]||Qh)(a,n,l),c[n]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(a,n,c,l){return function Oh(i,a,n,c){const l=Ia(i),h=Oi(l,"margin"),d=ms(l.maxWidth,i,"clientWidth")||zr,m=ms(l.maxHeight,i,"clientHeight")||zr,g=function Pa(i,a,n){let c,l;if(void 0===a||void 0===n){const h=ps(i);if(h){const d=h.getBoundingClientRect(),m=Ia(h),g=Oi(m,"border","width"),y=Oi(m,"padding");a=d.width-y.width-g.width,n=d.height-y.height-g.height,c=ms(m.maxWidth,h,"clientWidth"),l=ms(m.maxHeight,h,"clientHeight")}else a=i.clientWidth,n=i.clientHeight}return{width:a,height:n,maxWidth:c||zr,maxHeight:l||zr}}(i,a,n);let{width:y,height:b}=g;if("content-box"===l.boxSizing){const O=Oi(l,"border","width"),P=Oi(l,"padding");y-=P.width+O.width,b-=P.height+O.height}return y=Math.max(0,y-h.width),b=Math.max(0,c?y/c:b-h.height),y=Pn(Math.min(y,d,g.maxWidth)),b=Pn(Math.min(b,m,g.maxHeight)),y&&!b&&(b=Pn(y/2)),(void 0!==a||void 0!==n)&&c&&g.height&&b>g.height&&(b=g.height,y=Pn(Math.floor(b*c))),{width:y,height:b}}(a,n,c,l)}isAttached(a){const n=ps(a);return!(!n||!n.isConnected)}}class $n{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(a){const{x:n,y:c}=this.getProps(["x","y"],a);return{x:n,y:c}}hasValue(){return di(this.x)&&di(this.y)}getProps(a,n){const c=this.$animations;if(!n||!c)return this;const l={};return a.forEach(h=>{l[h]=c[h]&&c[h].active()?c[h]._to:this[h]}),l}}function _o(i,a,n,c,l){const h=Tt(c,0),d=Math.min(Tt(l,i.length),i.length);let g,y,b,m=0;for(n=Math.ceil(n),l&&(g=l-c,n=g/Math.floor(g/n)),b=h;b<0;)m++,b=Math.round(h+m*n);for(y=Math.max(h,0);y<d;y++)y===b&&(a.push(i[y]),m++,b=Math.round(h+m*n))}const Rc=(i,a,n)=>"top"===a||"left"===a?i[a]+n:i[a]-n,vo=(i,a)=>Math.min(a||i,i);function x0(i,a){const n=[],c=i.length/a,l=i.length;let h=0;for(;h<l;h+=c)n.push(i[Math.floor(h)]);return n}function su(i,a,n){const c=i.ticks.length,l=Math.min(a,c-1),h=i._startPixel,d=i._endPixel,m=1e-6;let y,g=i.getPixelForTick(l);if(!(n&&(y=1===c?Math.max(g-h,d-g):0===a?(i.getPixelForTick(1)-g)/2:(g-i.getPixelForTick(l-1))/2,g+=l<a?y:-y,g<h-m||g>d+m)))return g}function ys(i){return i.drawTicks?i.tickLength:0}function _0(i,a){if(!i.display)return 0;const n=wr(i.font,a),c=Gr(i.padding);return(Vt(i.text)?i.text.length:1)*n.lineHeight+c.height}function cu(i,a,n){let c=qs(i);return(n&&"right"!==a||!n&&"right"===a)&&(c=(i=>"left"===i?"right":"right"===i?"left":i)(c)),c}class Ri extends $n{constructor(a){super(),this.id=a.id,this.type=a.type,this.options=void 0,this.ctx=a.ctx,this.chart=a.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(a){this.options=a.setContext(this.getContext()),this.axis=a.axis,this._userMin=this.parse(a.min),this._userMax=this.parse(a.max),this._suggestedMin=this.parse(a.suggestedMin),this._suggestedMax=this.parse(a.suggestedMax)}parse(a,n){return a}getUserBounds(){let{_userMin:a,_userMax:n,_suggestedMin:c,_suggestedMax:l}=this;return a=an(a,Number.POSITIVE_INFINITY),n=an(n,Number.NEGATIVE_INFINITY),c=an(c,Number.POSITIVE_INFINITY),l=an(l,Number.NEGATIVE_INFINITY),{min:an(a,c),max:an(n,l),minDefined:ur(a),maxDefined:ur(n)}}getMinMax(a){let d,{min:n,max:c,minDefined:l,maxDefined:h}=this.getUserBounds();if(l&&h)return{min:n,max:c};const m=this.getMatchingVisibleMetas();for(let g=0,y=m.length;g<y;++g)d=m[g].controller.getMinMax(this,a),l||(n=Math.min(n,d.min)),h||(c=Math.max(c,d.max));return n=h&&n>c?c:n,c=l&&n>c?n:c,{min:an(n,an(c,n)),max:an(c,an(n,c))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const a=this.chart.data;return this.options.labels||(this.isHorizontal()?a.xLabels:a.yLabels)||a.labels||[]}getLabelItems(a=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(a))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Qt(this.options.beforeUpdate,[this])}update(a,n,c){const{beginAtZero:l,grace:h,ticks:d}=this.options,m=d.sampleSize;this.beforeUpdate(),this.maxWidth=a,this.maxHeight=n,this._margins=c=Object.assign({left:0,right:0,top:0,bottom:0},c),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+c.left+c.right:this.height+c.top+c.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function ri(i,a,n){const{min:c,max:l}=i,h=Ys(a,(l-c)/2),d=(m,g)=>n&&0===m?0:m+g;return{min:d(c,-Math.abs(h)),max:d(l,h)}}(this,h,l),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const g=m<this.ticks.length;this._convertTicksToLabels(g?x0(this.ticks,m):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||"auto"===d.source)&&(this.ticks=function Pc(i,a){const n=i.options.ticks,c=function nu(i){const a=i.options.offset,n=i._tickSize();return Math.floor(Math.min(i._length/n+(a?0:1),i._maxLength/n))}(i),l=Math.min(n.maxTicksLimit||c,c),h=n.major.enabled?function au(i){const a=[];let n,c;for(n=0,c=i.length;n<c;n++)i[n].major&&a.push(n);return a}(a):[],d=h.length,m=h[0],g=h[d-1],y=[];if(d>l)return function Mc(i,a,n,c){let d,l=0,h=n[0];for(c=Math.ceil(c),d=0;d<i.length;d++)d===h&&(a.push(i[d]),l++,h=n[l*c])}(a,y,h,d/l),y;const b=function iu(i,a,n){const c=function m0(i){const a=i.length;let n,c;if(a<2)return!1;for(c=i[0],n=1;n<a;++n)if(i[n]-i[n-1]!==c)return!1;return c}(i),l=a.length/n;if(!c)return Math.max(l,1);const h=function qo(i){const a=[],n=Math.sqrt(i);let c;for(c=1;c<n;c++)i%c==0&&(a.push(c),a.push(i/c));return n===(0|n)&&a.push(n),a.sort((l,h)=>l-h).pop(),a}(c);for(let d=0,m=h.length-1;d<m;d++){const g=h[d];if(g>l)return g}return Math.max(l,1)}(h,a,l);if(d>0){let S,O;const P=d>1?Math.round((g-m)/(d-1)):null;for(_o(a,y,b,Pt(P)?0:m-P,m),S=0,O=d-1;S<O;S++)_o(a,y,b,h[S],h[S+1]);return _o(a,y,b,g,Pt(P)?a.length:g+P),y}return _o(a,y,b),y}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),g&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n,c,a=this.options.reverse;this.isHorizontal()?(n=this.left,c=this.right):(n=this.top,c=this.bottom,a=!a),this._startPixel=n,this._endPixel=c,this._reversePixels=a,this._length=c-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Qt(this.options.afterUpdate,[this])}beforeSetDimensions(){Qt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Qt(this.options.afterSetDimensions,[this])}_callHooks(a){this.chart.notifyPlugins(a,this.getContext()),Qt(this.options[a],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Qt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(a){const n=this.options.ticks;let c,l,h;for(c=0,l=a.length;c<l;c++)h=a[c],h.label=Qt(n.callback,[h.value,c,a],this)}afterTickToLabelConversion(){Qt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Qt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const a=this.options,n=a.ticks,c=vo(this.ticks.length,a.ticks.maxTicksLimit),l=n.minRotation||0,h=n.maxRotation;let m,g,y,d=l;if(!this._isVisible()||!n.display||l>=h||c<=1||!this.isHorizontal())return void(this.labelRotation=l);const b=this._getLabelSizes(),S=b.widest.width,O=b.highest.height,P=Rt(this.chart.width-S,0,this.maxWidth);m=a.offset?this.maxWidth/c:P/(c-1),S+6>m&&(m=P/(c-(a.offset?.5:1)),g=this.maxHeight-ys(a.grid)-n.padding-_0(a.title,this.chart.options.font),y=Math.sqrt(S*S+O*O),d=Q(Math.min(Math.asin(Rt((b.highest.height+6)/m,-1,1)),Math.asin(Rt(g/y,-1,1))-Math.asin(Rt(O/y,-1,1)))),d=Math.max(l,Math.min(h,d))),this.labelRotation=d}afterCalculateLabelRotation(){Qt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Qt(this.options.beforeFit,[this])}fit(){const a={width:0,height:0},{chart:n,options:{ticks:c,title:l,grid:h}}=this,d=this._isVisible(),m=this.isHorizontal();if(d){const g=_0(l,n.options.font);if(m?(a.width=this.maxWidth,a.height=ys(h)+g):(a.height=this.maxHeight,a.width=ys(h)+g),c.display&&this.ticks.length){const{first:y,last:b,widest:S,highest:O}=this._getLabelSizes(),P=2*c.padding,j=M(this.labelRotation),Y=Math.cos(j),K=Math.sin(j);m?a.height=Math.min(this.maxHeight,a.height+(c.mirror?0:K*S.width+Y*O.height)+P):a.width=Math.min(this.maxWidth,a.width+(c.mirror?0:Y*S.width+K*O.height)+P),this._calculatePadding(y,b,K,Y)}}this._handleMargins(),m?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=a.height):(this.width=a.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(a,n,c,l){const{ticks:{align:h,padding:d},position:m}=this.options,g=0!==this.labelRotation,y="top"!==m&&"x"===this.axis;if(this.isHorizontal()){const b=this.getPixelForTick(0)-this.left,S=this.right-this.getPixelForTick(this.ticks.length-1);let O=0,P=0;g?y?(O=l*a.width,P=c*n.height):(O=c*a.height,P=l*n.width):"start"===h?P=n.width:"end"===h?O=a.width:"inner"!==h&&(O=a.width/2,P=n.width/2),this.paddingLeft=Math.max((O-b+d)*this.width/(this.width-b),0),this.paddingRight=Math.max((P-S+d)*this.width/(this.width-S),0)}else{let b=n.height/2,S=a.height/2;"start"===h?(b=0,S=a.height):"end"===h&&(b=n.height,S=0),this.paddingTop=b+d,this.paddingBottom=S+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Qt(this.options.afterFit,[this])}isHorizontal(){const{axis:a,position:n}=this.options;return"top"===n||"bottom"===n||"x"===a}isFullSize(){return this.options.fullSize}_convertTicksToLabels(a){let n,c;for(this.beforeTickToLabelConversion(),this.generateTickLabels(a),n=0,c=a.length;n<c;n++)Pt(a[n].label)&&(a.splice(n,1),c--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let a=this._labelSizes;if(!a){const n=this.options.ticks.sampleSize;let c=this.ticks;n<c.length&&(c=x0(c,n)),this._labelSizes=a=this._computeLabelSizes(c,c.length,this.options.ticks.maxTicksLimit)}return a}_computeLabelSizes(a,n,c){const{ctx:l,_longestTextCache:h}=this,d=[],m=[],g=Math.floor(n/vo(n,c));let S,O,P,j,Y,K,xe,pe,Ie,Me,Ce,y=0,b=0;for(S=0;S<n;S+=g){if(j=a[S].label,Y=this._resolveTickFontOptions(S),l.font=K=Y.string,xe=h[K]=h[K]||{data:{},gc:[]},pe=Y.lineHeight,Ie=Me=0,Pt(j)||Vt(j)){if(Vt(j))for(O=0,P=j.length;O<P;++O)Ce=j[O],!Pt(Ce)&&!Vt(Ce)&&(Ie=to(l,xe.data,xe.gc,Ie,Ce),Me+=pe)}else Ie=to(l,xe.data,xe.gc,Ie,j),Me=pe;d.push(Ie),m.push(Me),y=Math.max(Ie,y),b=Math.max(Me,b)}!function ou(i,a){Xt(i,n=>{const c=n.gc,l=c.length/2;let h;if(l>a){for(h=0;h<l;++h)delete n.data[c[h]];c.splice(0,l)}})}(h,n);const Pe=d.indexOf(y),rt=m.indexOf(b),Ve=dt=>({width:d[dt]||0,height:m[dt]||0});return{first:Ve(0),last:Ve(n-1),widest:Ve(Pe),highest:Ve(rt),widths:d,heights:m}}getLabelForValue(a){return a}getPixelForValue(a,n){return NaN}getValueForPixel(a){}getPixelForTick(a){const n=this.ticks;return a<0||a>n.length-1?null:this.getPixelForValue(n[a].value)}getPixelForDecimal(a){this._reversePixels&&(a=1-a);const n=this._startPixel+a*this._length;return function bn(i){return Rt(i,-32768,32767)}(this._alignToPixels?Qi(this.chart,n,0):n)}getDecimalForPixel(a){const n=(a-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:a,max:n}=this;return a<0&&n<0?n:a>0&&n>0?a:0}getContext(a){const n=this.ticks||[];if(a>=0&&a<n.length){const c=n[a];return c.$context||(c.$context=function w0(i,a,n){return In(i,{tick:n,index:a,type:"tick"})}(this.getContext(),a,c))}return this.$context||(this.$context=function v0(i,a){return In(i,{scale:a,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const a=this.options.ticks,n=M(this.labelRotation),c=Math.abs(Math.cos(n)),l=Math.abs(Math.sin(n)),h=this._getLabelSizes(),d=a.autoSkipPadding||0,m=h?h.widest.width+d:0,g=h?h.highest.height+d:0;return this.isHorizontal()?g*c>m*l?m/c:g/l:g*l<m*c?g/c:m/l}_isVisible(){const a=this.options.display;return"auto"!==a?!!a:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(a){const n=this.axis,c=this.chart,l=this.options,{grid:h,position:d,border:m}=l,g=h.offset,y=this.isHorizontal(),S=this.ticks.length+(g?1:0),O=ys(h),P=[],j=m.setContext(this.getContext()),Y=j.display?j.width:0,K=Y/2,xe=function(mr){return Qi(c,mr,Y)};let pe,Ie,Me,Ce,Pe,rt,Ve,dt,Dt,Ft,Mt,Wr;if("top"===d)pe=xe(this.bottom),rt=this.bottom-O,dt=pe-K,Ft=xe(a.top)+K,Wr=a.bottom;else if("bottom"===d)pe=xe(this.top),Ft=a.top,Wr=xe(a.bottom)-K,rt=pe+K,dt=this.top+O;else if("left"===d)pe=xe(this.right),Pe=this.right-O,Ve=pe-K,Dt=xe(a.left)+K,Mt=a.right;else if("right"===d)pe=xe(this.left),Dt=a.left,Mt=xe(a.right)-K,Pe=pe+K,Ve=this.left+O;else if("x"===n){if("center"===d)pe=xe((a.top+a.bottom)/2+.5);else if(It(d)){const mr=Object.keys(d)[0];pe=xe(this.chart.scales[mr].getPixelForValue(d[mr]))}Ft=a.top,Wr=a.bottom,rt=pe+K,dt=rt+O}else if("y"===n){if("center"===d)pe=xe((a.left+a.right)/2);else if(It(d)){const mr=Object.keys(d)[0];pe=xe(this.chart.scales[mr].getPixelForValue(d[mr]))}Pe=pe-K,Ve=Pe-O,Dt=a.left,Mt=a.right}const vn=Tt(l.ticks.maxTicksLimit,S),rr=Math.max(1,Math.ceil(S/vn));for(Ie=0;Ie<S;Ie+=rr){const mr=this.getContext(Ie),kr=h.setContext(mr),Yn=m.setContext(mr),Zr=kr.lineWidth,Ja=kr.color,zo=Yn.dash||[],_a=Yn.dashOffset,Ws=kr.tickWidth,va=kr.tickColor,Vs=kr.tickBorderDash||[],wa=kr.tickBorderDashOffset;Me=su(this,Ie,g),void 0!==Me&&(Ce=Qi(c,Me,Zr),y?Pe=Ve=Dt=Mt=Ce:rt=dt=Ft=Wr=Ce,P.push({tx1:Pe,ty1:rt,tx2:Ve,ty2:dt,x1:Dt,y1:Ft,x2:Mt,y2:Wr,width:Zr,color:Ja,borderDash:zo,borderDashOffset:_a,tickWidth:Ws,tickColor:va,tickBorderDash:Vs,tickBorderDashOffset:wa}))}return this._ticksLength=S,this._borderValue=pe,P}_computeLabelItems(a){const n=this.axis,c=this.options,{position:l,ticks:h}=c,d=this.isHorizontal(),m=this.ticks,{align:g,crossAlign:y,padding:b,mirror:S}=h,O=ys(c.grid),P=O+b,j=S?-b:P,Y=-M(this.labelRotation),K=[];let xe,pe,Ie,Me,Ce,Pe,rt,Ve,dt,Dt,Ft,Mt,Wr="middle";if("top"===l)Pe=this.bottom-j,rt=this._getXAxisLabelAlignment();else if("bottom"===l)Pe=this.top+j,rt=this._getXAxisLabelAlignment();else if("left"===l){const rr=this._getYAxisLabelAlignment(O);rt=rr.textAlign,Ce=rr.x}else if("right"===l){const rr=this._getYAxisLabelAlignment(O);rt=rr.textAlign,Ce=rr.x}else if("x"===n){if("center"===l)Pe=(a.top+a.bottom)/2+P;else if(It(l)){const rr=Object.keys(l)[0];Pe=this.chart.scales[rr].getPixelForValue(l[rr])+P}rt=this._getXAxisLabelAlignment()}else if("y"===n){if("center"===l)Ce=(a.left+a.right)/2-P;else if(It(l)){const rr=Object.keys(l)[0];Ce=this.chart.scales[rr].getPixelForValue(l[rr])}rt=this._getYAxisLabelAlignment(O).textAlign}"y"===n&&("start"===g?Wr="top":"end"===g&&(Wr="bottom"));const vn=this._getLabelSizes();for(xe=0,pe=m.length;xe<pe;++xe){Ie=m[xe],Me=Ie.label;const rr=h.setContext(this.getContext(xe));Ve=this.getPixelForTick(xe)+h.labelOffset,dt=this._resolveTickFontOptions(xe),Dt=dt.lineHeight,Ft=Vt(Me)?Me.length:1;const mr=Ft/2,kr=rr.color,Yn=rr.textStrokeColor,Zr=rr.textStrokeWidth;let zo,Ja=rt;if(d?(Ce=Ve,"inner"===rt&&(Ja=xe===pe-1?this.options.reverse?"left":"right":0===xe?this.options.reverse?"right":"left":"center"),Mt="top"===l?"near"===y||0!==Y?-Ft*Dt+Dt/2:"center"===y?-vn.highest.height/2-mr*Dt+Dt:Dt/2-vn.highest.height:"near"===y||0!==Y?Dt/2:"center"===y?vn.highest.height/2-mr*Dt:vn.highest.height-Ft*Dt,S&&(Mt*=-1),0!==Y&&!rr.showLabelBackdrop&&(Ce+=Dt/2*Math.sin(Y))):(Pe=Ve,Mt=(1-Ft)*Dt/2),rr.showLabelBackdrop){const _a=Gr(rr.backdropPadding),Ws=vn.heights[xe],va=vn.widths[xe];let Vs=Mt-_a.top,wa=0-_a.left;switch(Wr){case"middle":Vs-=Ws/2;break;case"bottom":Vs-=Ws}switch(rt){case"center":wa-=va/2;break;case"right":wa-=va;break;case"inner":xe===pe-1?wa-=va:xe>0&&(wa-=va/2)}zo={left:wa,top:Vs,width:va+_a.width,height:Ws+_a.height,color:rr.backdropColor}}K.push({label:Me,font:dt,textOffset:Mt,options:{rotation:Y,color:kr,strokeColor:Yn,strokeWidth:Zr,textAlign:Ja,textBaseline:Wr,translation:[Ce,Pe],backdrop:zo}})}return K}_getXAxisLabelAlignment(){const{position:a,ticks:n}=this.options;if(-M(this.labelRotation))return"top"===a?"left":"right";let l="center";return"start"===n.align?l="left":"end"===n.align?l="right":"inner"===n.align&&(l="inner"),l}_getYAxisLabelAlignment(a){const{position:n,ticks:{crossAlign:c,mirror:l,padding:h}}=this.options,m=a+h,g=this._getLabelSizes().widest.width;let y,b;return"left"===n?l?(b=this.right+h,"near"===c?y="left":"center"===c?(y="center",b+=g/2):(y="right",b+=g)):(b=this.right-m,"near"===c?y="right":"center"===c?(y="center",b-=g/2):(y="left",b=this.left)):"right"===n?l?(b=this.left+h,"near"===c?y="right":"center"===c?(y="center",b-=g/2):(y="left",b-=g)):(b=this.left+m,"near"===c?y="left":"center"===c?(y="center",b+=g/2):(y="right",b=this.right)):y="right",{textAlign:y,x:b}}_computeLabelArea(){if(this.options.ticks.mirror)return;const a=this.chart,n=this.options.position;return"left"===n||"right"===n?{top:0,left:this.left,bottom:a.height,right:this.right}:"top"===n||"bottom"===n?{top:this.top,left:0,bottom:this.bottom,right:a.width}:void 0}drawBackground(){const{ctx:a,options:{backgroundColor:n},left:c,top:l,width:h,height:d}=this;n&&(a.save(),a.fillStyle=n,a.fillRect(c,l,h,d),a.restore())}getLineWidthForValue(a){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const l=this.ticks.findIndex(h=>h.value===a);return l>=0?n.setContext(this.getContext(l)).lineWidth:0}drawGrid(a){const n=this.options.grid,c=this.ctx,l=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(a));let h,d;const m=(g,y,b)=>{!b.width||!b.color||(c.save(),c.lineWidth=b.width,c.strokeStyle=b.color,c.setLineDash(b.borderDash||[]),c.lineDashOffset=b.borderDashOffset,c.beginPath(),c.moveTo(g.x,g.y),c.lineTo(y.x,y.y),c.stroke(),c.restore())};if(n.display)for(h=0,d=l.length;h<d;++h){const g=l[h];n.drawOnChartArea&&m({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),n.drawTicks&&m({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const{chart:a,ctx:n,options:{border:c,grid:l}}=this,h=c.setContext(this.getContext()),d=c.display?h.width:0;if(!d)return;const m=l.setContext(this.getContext(0)).lineWidth,g=this._borderValue;let y,b,S,O;this.isHorizontal()?(y=Qi(a,this.left,d)-d/2,b=Qi(a,this.right,m)+m/2,S=O=g):(S=Qi(a,this.top,d)-d/2,O=Qi(a,this.bottom,m)+m/2,y=b=g),n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.beginPath(),n.moveTo(y,S),n.lineTo(b,O),n.stroke(),n.restore()}drawLabels(a){if(!this.options.ticks.display)return;const c=this.ctx,l=this._computeLabelArea();l&&Cn(c,l);const h=this.getLabelItems(a);for(const d of h)Ai(c,d.label,0,d.textOffset,d.font,d.options);l&&us(c)}drawTitle(){const{ctx:a,options:{position:n,title:c,reverse:l}}=this;if(!c.display)return;const h=wr(c.font),d=Gr(c.padding),m=c.align;let g=h.lineHeight/2;"bottom"===n||"center"===n||It(n)?(g+=d.bottom,Vt(c.text)&&(g+=h.lineHeight*(c.text.length-1))):g+=d.top;const{titleX:y,titleY:b,maxWidth:S,rotation:O}=function wo(i,a,n,c){const{top:l,left:h,bottom:d,right:m,chart:g}=i,{chartArea:y,scales:b}=g;let O,P,j,S=0;const Y=d-l,K=m-h;if(i.isHorizontal()){if(P=Qr(c,h,m),It(n)){const xe=Object.keys(n)[0];j=b[xe].getPixelForValue(n[xe])+Y-a}else j="center"===n?(y.bottom+y.top)/2+Y-a:Rc(i,n,a);O=m-h}else{if(It(n)){const xe=Object.keys(n)[0];P=b[xe].getPixelForValue(n[xe])-K+a}else P="center"===n?(y.left+y.right)/2-K+a:Rc(i,n,a);j=Qr(c,d,l),S="left"===n?-gr:gr}return{titleX:P,titleY:j,maxWidth:O,rotation:S}}(this,g,n,m);Ai(a,c.text,0,0,h,{color:c.color,maxWidth:S,rotation:O,textAlign:cu(m,n,l),textBaseline:"middle",translation:[y,b]})}draw(a){this._isVisible()&&(this.drawBackground(),this.drawGrid(a),this.drawBorder(),this.drawTitle(),this.drawLabels(a))}_layers(){const a=this.options,n=a.ticks&&a.ticks.z||0,c=Tt(a.grid&&a.grid.z,-1),l=Tt(a.border&&a.border.z,0);return this._isVisible()&&this.draw===Ri.prototype.draw?[{z:c,draw:h=>{this.drawBackground(),this.drawGrid(h),this.drawTitle()}},{z:l,draw:()=>{this.drawBorder()}},{z:n,draw:h=>{this.drawLabels(h)}}]:[{z:n,draw:h=>{this.draw(h)}}]}getMatchingVisibleMetas(a){const n=this.chart.getSortedVisibleDatasetMetas(),c=this.axis+"AxisID",l=[];let h,d;for(h=0,d=n.length;h<d;++h){const m=n[h];m[c]===this.id&&(!a||m.type===a)&&l.push(m)}return l}_resolveTickFontOptions(a){return wr(this.options.ticks.setContext(this.getContext(a)).font)}_maxDigits(){const a=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/a}}class bs{constructor(a,n,c){this.type=a,this.scope=n,this.override=c,this.items=Object.create(null)}isForType(a){return Object.prototype.isPrototypeOf.call(this.type.prototype,a.prototype)}register(a){const n=Object.getPrototypeOf(a);let c;(function b0(i){return"id"in i&&"defaults"in i})(n)&&(c=this.register(n));const l=this.items,h=a.id,d=this.scope+"."+h;if(!h)throw new Error("class does not have id: "+a);return h in l||(l[h]=a,function y0(i,a,n){const c=pn(Object.create(null),[n?ar.get(n):{},ar.get(a),i.defaults]);ar.set(a,c),i.defaultRoutes&&function lu(i,a){Object.keys(a).forEach(n=>{const c=n.split("."),l=c.pop(),h=[i].concat(c).join("."),d=a[n].split("."),m=d.pop(),g=d.join(".");ar.route(h,l,g,m)})}(a,i.defaultRoutes),i.descriptors&&ar.describe(a,i.descriptors)}(a,d,c),this.override&&ar.override(a.id,a.overrides)),d}get(a){return this.items[a]}unregister(a){const n=this.items,c=a.id,l=this.scope;c in n&&delete n[c],l&&c in ar[l]&&(delete ar[l][c],this.override&&delete Si[c])}}class k0{constructor(){this.controllers=new bs(gn,"datasets",!0),this.elements=new bs($n,"elements"),this.plugins=new bs(Object,"plugins"),this.scales=new bs(Ri,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...a){this._each("register",a)}remove(...a){this._each("unregister",a)}addControllers(...a){this._each("register",a,this.controllers)}addElements(...a){this._each("register",a,this.elements)}addPlugins(...a){this._each("register",a,this.plugins)}addScales(...a){this._each("register",a,this.scales)}getController(a){return this._get(a,this.controllers,"controller")}getElement(a){return this._get(a,this.elements,"element")}getPlugin(a){return this._get(a,this.plugins,"plugin")}getScale(a){return this._get(a,this.scales,"scale")}removeControllers(...a){this._each("unregister",a,this.controllers)}removeElements(...a){this._each("unregister",a,this.elements)}removePlugins(...a){this._each("unregister",a,this.plugins)}removeScales(...a){this._each("unregister",a,this.scales)}_each(a,n,c){[...n].forEach(l=>{const h=c||this._getRegistryForType(l);c||h.isForType(l)||h===this.plugins&&l.id?this._exec(a,h,l):Xt(l,d=>{const m=c||this._getRegistryForType(d);this._exec(a,m,d)})})}_exec(a,n,c){const l=Ea(a);Qt(c["before"+l],[],c),n[a](c),Qt(c["after"+l],[],c)}_getRegistryForType(a){for(let n=0;n<this._typedRegistries.length;n++){const c=this._typedRegistries[n];if(c.isForType(a))return c}return this.plugins}_get(a,n,c){const l=n.get(a);if(void 0===l)throw new Error('"'+a+'" is not a registered '+c+".");return l}}var Gn=new k0;class Li{constructor(){this._init=[]}notify(a,n,c,l){"beforeInit"===n&&(this._init=this._createDescriptors(a,!0),this._notify(this._init,a,"install"));const h=l?this._descriptors(a).filter(l):this._descriptors(a),d=this._notify(h,a,n,c);return"afterDestroy"===n&&(this._notify(h,a,"stop"),this._notify(this._init,a,"uninstall")),d}_notify(a,n,c,l){l=l||{};for(const h of a){const d=h.plugin;if(!1===Qt(d[c],[n,l,h.options],d)&&l.cancelable)return!1}return!0}invalidate(){Pt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(a){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(a);return this._notifyStateChanges(a),n}_createDescriptors(a,n){const c=a&&a.config,l=Tt(c.options&&c.options.plugins,{}),h=function fu(i){const a={},n=[],c=Object.keys(Gn.plugins.items);for(let h=0;h<c.length;h++)n.push(Gn.getPlugin(c[h]));const l=i.plugins||[];for(let h=0;h<l.length;h++){const d=l[h];-1===n.indexOf(d)&&(n.push(d),a[d.id]=!0)}return{plugins:n,localIds:a}}(c);return!1!==l||n?function Er(i,{plugins:a,localIds:n},c,l){const h=[],d=i.getContext();for(const m of a){const g=m.id,y=hu(c[g],l);null!==y&&h.push({plugin:m,options:ln(i.config,{plugin:m,local:n[g]},y,d)})}return h}(a,h,l,n):[]}_notifyStateChanges(a){const n=this._oldCache||[],c=this._cache,l=(h,d)=>h.filter(m=>!d.some(g=>m.plugin.id===g.plugin.id));this._notify(l(n,c),a,"stop"),this._notify(l(c,n),a,"start")}}function hu(i,a){return a||!1!==i?!0===i?{}:i:null}function ln(i,{plugin:a,local:n},c,l){const h=i.pluginScopeKeys(a),d=i.getOptionScopes(c,h);return n&&a.defaults&&d.push(a.defaults),i.createResolver(d,l,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function br(i,a){return((a.datasets||{})[i]||{}).indexAxis||a.indexAxis||(ar.datasets[i]||{}).indexAxis||"x"}function C0(i){if("x"===i||"y"===i||"r"===i)return i}function E0(i){return"top"===i||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0}function ha(i,...a){if(C0(i))return i;for(const n of a){const c=n.axis||E0(n.position)||i.length>1&&C0(i[0].toLowerCase());if(c)return c}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function S0(i,a,n){if(n[a+"AxisID"]===i)return{axis:a}}function Ba(i){const a=i.options||(i.options={});a.plugins=Tt(a.plugins,{}),a.scales=function ua(i,a){const n=Si[i.type]||{scales:{}},c=a.scales||{},l=br(i.type,a),h=Object.create(null);return Object.keys(c).forEach(d=>{const m=c[d];if(!It(m))return console.error(`Invalid scale configuration for scale: ${d}`);if(m._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const g=ha(d,m,function uu(i,a){if(a.data&&a.data.datasets){const n=a.data.datasets.filter(c=>c.xAxisID===i||c.yAxisID===i);if(n.length)return S0(i,"x",n[0])||S0(i,"y",n[0])}return{}}(d,i),ar.scales[m.type]),y=function T0(i,a){return i===a?"_index_":"_value_"}(g,l),b=n.scales||{};h[d]=Ti(Object.create(null),[{axis:g},m,b[g],b[y]])}),i.data.datasets.forEach(d=>{const m=d.type||i.type,g=d.indexAxis||br(m,a),b=(Si[m]||{}).scales||{};Object.keys(b).forEach(S=>{const O=function Mn(i,a){let n=i;return"_index_"===i?n=a:"_value_"===i&&(n="x"===a?"y":"x"),n}(S,g),P=d[O+"AxisID"]||O;h[P]=h[P]||Object.create(null),Ti(h[P],[{axis:O},c[P],b[S]])})}),Object.keys(h).forEach(d=>{const m=h[d];Ti(m,[ar.scales[m.type],ar.scale])}),h}(i,a)}function Ni(i){return(i=i||{}).datasets=i.datasets||[],i.labels=i.labels||[],i}const F0=new Map,D0=new Set;function yo(i,a){let n=F0.get(i);return n||(n=a(),F0.set(i,n),D0.add(n)),n}const ks=(i,a,n)=>{const c=qn(a,n);void 0!==c&&i.add(c)};class bo{constructor(a){this._config=function A0(i){return(i=i||{}).data=Ni(i.data),Ba(i),i}(a),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(a){this._config.type=a}get data(){return this._config.data}set data(a){this._config.data=Ni(a)}get options(){return this._config.options}set options(a){this._config.options=a}get plugins(){return this._config.plugins}update(){const a=this._config;this.clearCache(),Ba(a)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(a){return yo(a,()=>[[`datasets.${a}`,""]])}datasetAnimationScopeKeys(a,n){return yo(`${a}.transition.${n}`,()=>[[`datasets.${a}.transitions.${n}`,`transitions.${n}`],[`datasets.${a}`,""]])}datasetElementScopeKeys(a,n){return yo(`${a}-${n}`,()=>[[`datasets.${a}.elements.${n}`,`datasets.${a}`,`elements.${n}`,""]])}pluginScopeKeys(a){const n=a.id;return yo(`${this.type}-plugin-${n}`,()=>[[`plugins.${n}`,...a.additionalOptionScopes||[]]])}_cachedScopes(a,n){const c=this._scopeCache;let l=c.get(a);return(!l||n)&&(l=new Map,c.set(a,l)),l}getOptionScopes(a,n,c){const{options:l,type:h}=this,d=this._cachedScopes(a,c),m=d.get(n);if(m)return m;const g=new Set;n.forEach(b=>{a&&(g.add(a),b.forEach(S=>ks(g,a,S))),b.forEach(S=>ks(g,l,S)),b.forEach(S=>ks(g,Si[h]||{},S)),b.forEach(S=>ks(g,ar,S)),b.forEach(S=>ks(g,eo,S))});const y=Array.from(g);return 0===y.length&&y.push(Object.create(null)),D0.has(n)&&d.set(n,y),y}chartOptionScopes(){const{options:a,type:n}=this;return[a,Si[n]||{},ar.datasets[n]||{},{type:n},ar,eo]}resolveNamedOptions(a,n,c,l=[""]){const h={$shared:!0},{resolver:d,subPrefixes:m}=Lc(this._resolverCache,a,l);let g=d;(function pu(i,a){const{isScriptable:n,isIndexable:c}=Bl(i);for(const l of a){const h=n(l),d=c(l),m=(d||h)&&i[l];if(h&&(Bn(m)||du(m))||d&&Vt(m))return!0}return!1})(d,n)&&(h.$shared=!1,g=Fa(d,c=Bn(c)?c():c,this.createResolver(a,c,m)));for(const y of n)h[y]=g[y];return h}createResolver(a,n,c=[""],l){const{resolver:h}=Lc(this._resolverCache,a,c);return It(n)?Fa(h,n,void 0,l):h}}function Lc(i,a,n){let c=i.get(a);c||(c=new Map,i.set(a,c));const l=n.join();let h=c.get(l);return h||(h={resolver:no(a,n),subPrefixes:n.filter(m=>!m.toLowerCase().includes("hover"))},c.set(l,h)),h}const du=i=>It(i)&&Object.getOwnPropertyNames(i).some(a=>Bn(i[a])),I0=["top","bottom","left","right","chartArea"];function jn(i,a){return"top"===i||"bottom"===i||-1===I0.indexOf(i)&&"x"===a}function Bi(i,a){return function(n,c){return n[i]===c[i]?n[a]-c[a]:n[i]-c[i]}}function P0(i){const a=i.chart,n=a.options.animation;a.notifyPlugins("afterRender"),Qt(n&&n.onComplete,[i],a)}function mu(i){const a=i.chart,n=a.options.animation;Qt(n&&n.onProgress,[i],a)}function M0(i){return so()&&"string"==typeof i?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const Ts={},R0=i=>{const a=M0(i);return Object.values(Ts).filter(n=>n.canvas===a).pop()};function ko(i,a,n){const c=Object.keys(i);for(const l of c){const h=+l;if(h>=a){const d=i[l];delete i[l],(n>0||h>a)&&(i[h+n]=d)}}}function Cs(i,a,n){return i.options.clip?i[n]:a[n]}let Es=(()=>class i{static defaults=ar;static instances=Ts;static overrides=Si;static registry=Gn;static version="4.4.1";static getChart=R0;static register(...n){Gn.add(...n),N0()}static unregister(...n){Gn.remove(...n),N0()}constructor(n,c){const l=this.config=new bo(c),h=M0(n),d=R0(h);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const m=l.createResolver(l.chartOptionScopes(),this.getContext());this.platform=new(l.platform||function p0(i){return!so()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?Na:ru}(h)),this.platform.updateConfig(l);const g=this.platform.acquireContext(h,m.aspectRatio),y=g&&g.canvas,b=y&&y.height,S=y&&y.width;this.id=Xo(),this.ctx=g,this.canvas=y,this.width=S,this.height=b,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Li,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function Ir(i,a){let n;return function(...c){return a?(clearTimeout(n),n=setTimeout(i,a,c)):i.apply(this,c),a}}(O=>this.update(O),m.resizeDelay||0),this._dataChanges=[],Ts[this.id]=this,g&&y?($t.listen(this,"complete",P0),$t.listen(this,"progress",mu),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:n,maintainAspectRatio:c},width:l,height:h,_aspectRatio:d}=this;return Pt(n)?c&&d?d:h?l/h:null:n}get data(){return this.config.data}set data(n){this.config.data=n}get options(){return this._options}set options(n){this.config.options=n}get registry(){return Gn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Pr(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return $r(this.canvas,this.ctx),this}stop(){return $t.stop(this),this}resize(n,c){$t.running(this)?this._resizeBeforeDraw={width:n,height:c}:this._resize(n,c)}_resize(n,c){const l=this.options,m=this.platform.getMaximumSize(this.canvas,n,c,l.maintainAspectRatio&&this.aspectRatio),g=l.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,Pr(this,g,!0)&&(this.notifyPlugins("resize",{size:m}),Qt(l.onResize,[this,m],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){Xt(this.options.scales||{},(l,h)=>{l.id=h})}buildOrUpdateScales(){const n=this.options,c=n.scales,l=this.scales,h=Object.keys(l).reduce((m,g)=>(m[g]=!1,m),{});let d=[];c&&(d=d.concat(Object.keys(c).map(m=>{const g=c[m],y=ha(m,g),b="r"===y,S="x"===y;return{options:g,dposition:b?"chartArea":S?"bottom":"left",dtype:b?"radialLinear":S?"category":"linear"}}))),Xt(d,m=>{const g=m.options,y=g.id,b=ha(y,g),S=Tt(g.type,m.dtype);(void 0===g.position||jn(g.position,b)!==jn(m.dposition))&&(g.position=m.dposition),h[y]=!0;let O=null;y in l&&l[y].type===S?O=l[y]:(O=new(Gn.getScale(S))({id:y,type:S,ctx:this.ctx,chart:this}),l[O.id]=O),O.init(g,n)}),Xt(h,(m,g)=>{m||delete l[g]}),Xt(l,m=>{Ar.configure(this,m,m.options),Ar.addBox(this,m)})}_updateMetasets(){const n=this._metasets,c=this.data.datasets.length,l=n.length;if(n.sort((h,d)=>h.index-d.index),l>c){for(let h=c;h<l;++h)this._destroyDatasetMeta(h);n.splice(c,l-c)}this._sortedMetasets=n.slice(0).sort(Bi("order","index"))}_removeUnreferencedMetasets(){const{_metasets:n,data:{datasets:c}}=this;n.length>c.length&&delete this._stacks,n.forEach((l,h)=>{0===c.filter(d=>d===l._dataset).length&&this._destroyDatasetMeta(h)})}buildOrUpdateControllers(){const n=[],c=this.data.datasets;let l,h;for(this._removeUnreferencedMetasets(),l=0,h=c.length;l<h;l++){const d=c[l];let m=this.getDatasetMeta(l);const g=d.type||this.config.type;if(m.type&&m.type!==g&&(this._destroyDatasetMeta(l),m=this.getDatasetMeta(l)),m.type=g,m.indexAxis=d.indexAxis||br(g,this.options),m.order=d.order||0,m.index=l,m.label=""+d.label,m.visible=this.isDatasetVisible(l),m.controller)m.controller.updateIndex(l),m.controller.linkScales();else{const y=Gn.getController(g),{datasetElementType:b,dataElementType:S}=ar.datasets[g];Object.assign(y,{dataElementType:Gn.getElement(S),datasetElementType:b&&Gn.getElement(b)}),m.controller=new y(this,l),n.push(m.controller)}}return this._updateMetasets(),n}_resetElements(){Xt(this.data.datasets,(n,c)=>{this.getDatasetMeta(c).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(n){const c=this.config;c.update();const l=this._options=c.createResolver(c.chartOptionScopes(),this.getContext()),h=this._animationsDisabled=!l.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:n,cancelable:!0}))return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let b=0,S=this.data.datasets.length;b<S;b++){const{controller:O}=this.getDatasetMeta(b),P=!h&&-1===d.indexOf(O);O.buildOrUpdateElements(P),m=Math.max(+O.getMaxOverflow(),m)}m=this._minPadding=l.layout.autoPadding?m:0,this._updateLayout(m),h||Xt(d,b=>{b.reset()}),this._updateDatasets(n),this.notifyPlugins("afterUpdate",{mode:n}),this._layers.sort(Bi("z","_idx"));const{_active:g,_lastEvent:y}=this;y?this._eventHandler(y,!0):g.length&&this._updateHoverStyles(g,g,!0),this.render()}_updateScales(){Xt(this.scales,n=>{Ar.removeBox(this,n)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const n=this.options,c=new Set(Object.keys(this._listeners)),l=new Set(n.events);(!Br(c,l)||!!this._responsiveListeners!==n.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,c=this._getUniformDataChanges()||[];for(const{method:l,start:h,count:d}of c)ko(n,h,"_removeElements"===l?-d:d)}_getUniformDataChanges(){const n=this._dataChanges;if(!n||!n.length)return;this._dataChanges=[];const c=this.data.datasets.length,l=d=>new Set(n.filter(m=>m[0]===d).map((m,g)=>g+","+m.splice(1).join(","))),h=l(0);for(let d=1;d<c;d++)if(!Br(h,l(d)))return;return Array.from(h).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(n){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Ar.update(this,this.width,this.height,n);const c=this.chartArea,l=c.width<=0||c.height<=0;this._layers=[],Xt(this.boxes,h=>{l&&"chartArea"===h.position||(h.configure&&h.configure(),this._layers.push(...h._layers()))},this),this._layers.forEach((h,d)=>{h._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(n){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:n,cancelable:!0})){for(let c=0,l=this.data.datasets.length;c<l;++c)this.getDatasetMeta(c).controller.configure();for(let c=0,l=this.data.datasets.length;c<l;++c)this._updateDataset(c,Bn(n)?n({datasetIndex:c}):n);this.notifyPlugins("afterDatasetsUpdate",{mode:n})}}_updateDataset(n,c){const l=this.getDatasetMeta(n),h={meta:l,index:n,mode:c,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",h)&&(l.controller._update(c),h.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",h))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&($t.has(this)?this.attached&&!$t.running(this)&&$t.start(this):(this.draw(),P0({chart:this})))}draw(){let n;if(this._resizeBeforeDraw){const{width:l,height:h}=this._resizeBeforeDraw;this._resize(l,h),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const c=this._layers;for(n=0;n<c.length&&c[n].z<=0;++n)c[n].draw(this.chartArea);for(this._drawDatasets();n<c.length;++n)c[n].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(n){const c=this._sortedMetasets,l=[];let h,d;for(h=0,d=c.length;h<d;++h){const m=c[h];(!n||m.visible)&&l.push(m)}return l}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const n=this.getSortedVisibleDatasetMetas();for(let c=n.length-1;c>=0;--c)this._drawDataset(n[c]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(n){const c=this.ctx,l=n._clip,h=!l.disabled,d=function gu(i,a){const{xScale:n,yScale:c}=i;return n&&c?{left:Cs(n,a,"left"),right:Cs(n,a,"right"),top:Cs(c,a,"top"),bottom:Cs(c,a,"bottom")}:a}(n,this.chartArea),m={meta:n,index:n.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",m)&&(h&&Cn(c,{left:!1===l.left?0:d.left-l.left,right:!1===l.right?this.width:d.right+l.right,top:!1===l.top?0:d.top-l.top,bottom:!1===l.bottom?this.height:d.bottom+l.bottom}),n.controller.draw(),h&&us(c),m.cancelable=!1,this.notifyPlugins("afterDatasetDraw",m))}isPointInArea(n){return mt(n,this.chartArea,this._minPadding)}getElementsAtEventForMode(n,c,l,h){const d=o0.modes[c];return"function"==typeof d?d(this,n,l,h):[]}getDatasetMeta(n){const c=this.data.datasets[n],l=this._metasets;let h=l.filter(d=>d&&d._dataset===c).pop();return h||(h={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:c&&c.order||0,index:n,_dataset:c,_parsed:[],_sorted:!1},l.push(h)),h}getContext(){return this.$context||(this.$context=In(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(n){const c=this.data.datasets[n];if(!c)return!1;const l=this.getDatasetMeta(n);return"boolean"==typeof l.hidden?!l.hidden:!c.hidden}setDatasetVisibility(n,c){this.getDatasetMeta(n).hidden=!c}toggleDataVisibility(n){this._hiddenIndices[n]=!this._hiddenIndices[n]}getDataVisibility(n){return!this._hiddenIndices[n]}_updateVisibility(n,c,l){const h=l?"show":"hide",d=this.getDatasetMeta(n),m=d.controller._resolveAnimations(void 0,h);Ci(c)?(d.data[c].hidden=!l,this.update()):(this.setDatasetVisibility(n,l),m.update(d,{visible:l}),this.update(g=>g.datasetIndex===n?h:void 0))}hide(n,c){this._updateVisibility(n,c,!1)}show(n,c){this._updateVisibility(n,c,!0)}_destroyDatasetMeta(n){const c=this._metasets[n];c&&c.controller&&c.controller._destroy(),delete this._metasets[n]}_stop(){let n,c;for(this.stop(),$t.remove(this),n=0,c=this.data.datasets.length;n<c;++n)this._destroyDatasetMeta(n)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:n,ctx:c}=this;this._stop(),this.config.clearCache(),n&&(this.unbindEvents(),$r(n,c),this.platform.releaseContext(c),this.canvas=null,this.ctx=null),delete Ts[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...n){return this.canvas.toDataURL(...n)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const n=this._listeners,c=this.platform,l=(d,m)=>{c.addEventListener(this,d,m),n[d]=m},h=(d,m,g)=>{d.offsetX=m,d.offsetY=g,this._eventHandler(d)};Xt(this.options.events,d=>l(d,h))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const n=this._responsiveListeners,c=this.platform,l=(y,b)=>{c.addEventListener(this,y,b),n[y]=b},h=(y,b)=>{n[y]&&(c.removeEventListener(this,y,b),delete n[y])},d=(y,b)=>{this.canvas&&this.resize(y,b)};let m;const g=()=>{h("attach",g),this.attached=!0,this.resize(),l("resize",d),l("detach",m)};m=()=>{this.attached=!1,h("resize",d),this._stop(),this._resize(0,0),l("attach",g)},c.isAttached(this.canvas)?g():m()}unbindEvents(){Xt(this._listeners,(n,c)=>{this.platform.removeEventListener(this,c,n)}),this._listeners={},Xt(this._responsiveListeners,(n,c)=>{this.platform.removeEventListener(this,c,n)}),this._responsiveListeners=void 0}updateHoverStyle(n,c,l){const h=l?"set":"remove";let d,m,g,y;for("dataset"===c&&(d=this.getDatasetMeta(n[0].datasetIndex),d.controller["_"+h+"DatasetHoverStyle"]()),g=0,y=n.length;g<y;++g){m=n[g];const b=m&&this.getDatasetMeta(m.datasetIndex).controller;b&&b[h+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(n){const c=this._active||[],l=n.map(({datasetIndex:d,index:m})=>{const g=this.getDatasetMeta(d);if(!g)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:g.data[m],index:m}});!Qn(l,c)&&(this._active=l,this._lastEvent=null,this._updateHoverStyles(l,c))}notifyPlugins(n,c,l){return this._plugins.notify(this,n,c,l)}isPluginEnabled(n){return 1===this._plugins._cache.filter(c=>c.plugin.id===n).length}_updateHoverStyles(n,c,l){const h=this.options.hover,d=(y,b)=>y.filter(S=>!b.some(O=>S.datasetIndex===O.datasetIndex&&S.index===O.index)),m=d(c,n),g=l?n:d(n,c);m.length&&this.updateHoverStyle(m,h.mode,!1),g.length&&h.mode&&this.updateHoverStyle(g,h.mode,!0)}_eventHandler(n,c){const l={event:n,replay:c,cancelable:!0,inChartArea:this.isPointInArea(n)},h=m=>(m.options.events||this.options.events).includes(n.native.type);if(!1===this.notifyPlugins("beforeEvent",l,h))return;const d=this._handleEvent(n,c,l.inChartArea);return l.cancelable=!1,this.notifyPlugins("afterEvent",l,h),(d||l.changed)&&this.render(),this}_handleEvent(n,c,l){const{_active:h=[],options:d}=this,g=this._getActiveElements(n,h,l,c),y=function Js(i){return"mouseup"===i.type||"click"===i.type||"contextmenu"===i.type}(n),b=function L0(i,a,n,c){return n&&"mouseout"!==i.type?c?a:i:null}(n,this._lastEvent,l,y);l&&(this._lastEvent=null,Qt(d.onHover,[n,g,this],this),y&&Qt(d.onClick,[n,g,this],this));const S=!Qn(g,h);return(S||c)&&(this._active=g,this._updateHoverStyles(g,h,c)),this._lastEvent=b,S}_getActiveElements(n,c,l,h){if("mouseout"===n.type)return[];if(!l)return c;const d=this.options.hover;return this.getElementsAtEventForMode(n,d.mode,d,h)}})();function N0(){return Xt(Es.instances,i=>i._plugins.invalidate())}function Ua(i,a,n,c){return{x:n+i*Math.cos(a),y:c+i*Math.sin(a)}}function da(i,a,n,c,l,h){const{x:d,y:m,startAngle:g,pixelMargin:y,innerRadius:b}=a,S=Math.max(a.outerRadius+c+n-y,0),O=b>0?b+c+n+y:0;let P=0;const j=l-g;if(c){const kr=((b>0?b-c:0)+(S>0?S-c:0))/2;P=(j-(0!==kr?j*kr/(kr+c):j))/2}const K=(j-Math.max(.001,j*S-n/qt)/S)/2,xe=g+K+P,pe=l-K-P,{outerStart:Ie,outerEnd:Me,innerStart:Ce,innerEnd:Pe}=function _u(i,a,n,c){const l=function tn(i){return sr(i,["outerStart","outerEnd","innerStart","innerEnd"])}(i.options.borderRadius),h=(n-a)/2,d=Math.min(h,c*a/2),m=g=>{const y=(n-Math.min(h,g))*c/2;return Rt(g,0,Math.min(h,y))};return{outerStart:m(l.outerStart),outerEnd:m(l.outerEnd),innerStart:Rt(l.innerStart,0,d),innerEnd:Rt(l.innerEnd,0,d)}}(a,O,S,pe-xe),rt=S-Ie,Ve=S-Me,dt=xe+Ie/rt,Dt=pe-Me/Ve,Ft=O+Ce,Mt=O+Pe,Wr=xe+Ce/Ft,vn=pe-Pe/Mt;if(i.beginPath(),h){const rr=(dt+Dt)/2;if(i.arc(d,m,S,dt,rr),i.arc(d,m,S,rr,Dt),Me>0){const Zr=Ua(Ve,Dt,d,m);i.arc(Zr.x,Zr.y,Me,Dt,pe+gr)}const mr=Ua(Mt,pe,d,m);if(i.lineTo(mr.x,mr.y),Pe>0){const Zr=Ua(Mt,vn,d,m);i.arc(Zr.x,Zr.y,Pe,pe+gr,vn+Math.PI)}const kr=(pe-Pe/O+(xe+Ce/O))/2;if(i.arc(d,m,O,pe-Pe/O,kr,!0),i.arc(d,m,O,kr,xe+Ce/O,!0),Ce>0){const Zr=Ua(Ft,Wr,d,m);i.arc(Zr.x,Zr.y,Ce,Wr+Math.PI,xe-gr)}const Yn=Ua(rt,xe,d,m);if(i.lineTo(Yn.x,Yn.y),Ie>0){const Zr=Ua(rt,dt,d,m);i.arc(Zr.x,Zr.y,Ie,xe-gr,dt)}}else{i.moveTo(d,m);const rr=Math.cos(dt)*S+d,mr=Math.sin(dt)*S+m;i.lineTo(rr,mr);const kr=Math.cos(Dt)*S+d,Yn=Math.sin(Dt)*S+m;i.lineTo(kr,Yn)}i.closePath()}function B0(i,a,n=a){i.lineCap=Tt(n.borderCapStyle,a.borderCapStyle),i.setLineDash(Tt(n.borderDash,a.borderDash)),i.lineDashOffset=Tt(n.borderDashOffset,a.borderDashOffset),i.lineJoin=Tt(n.borderJoinStyle,a.borderJoinStyle),i.lineWidth=Tt(n.borderWidth,a.borderWidth),i.strokeStyle=Tt(n.borderColor,a.borderColor)}function yu(i,a,n){i.lineTo(n.x,n.y)}function U0(i,a,n={}){const c=i.length,{start:l=0,end:h=c-1}=n,{start:d,end:m}=a,g=Math.max(l,d),y=Math.min(h,m);return{count:c,start:g,loop:a.loop,ilen:y<g&&!(l<d&&h<d||l>m&&h>m)?c+y-g:y-g}}function ku(i,a,n,c){const{points:l,options:h}=a,{count:d,start:m,loop:g,ilen:y}=U0(l,n,c),b=function bu(i){return i.stepped?oc:i.tension||"monotone"===i.cubicInterpolationMode?zt:yu}(h);let P,j,Y,{move:S=!0,reverse:O}=c||{};for(P=0;P<=y;++P)j=l[(m+(O?y-P:P))%d],!j.skip&&(S?(i.moveTo(j.x,j.y),S=!1):b(i,Y,j,O,h.stepped),Y=j);return g&&(j=l[(m+(O?y:0))%d],b(i,Y,j,O,h.stepped)),!!g}function Tu(i,a,n,c){const l=a.points,{count:h,start:d,ilen:m}=U0(l,n,c),{move:g=!0,reverse:y}=c||{};let O,P,j,Y,K,xe,b=0,S=0;const pe=Me=>(d+(y?m-Me:Me))%h,Ie=()=>{Y!==K&&(i.lineTo(b,K),i.lineTo(b,Y),i.lineTo(b,xe))};for(g&&(P=l[pe(0)],i.moveTo(P.x,P.y)),O=0;O<=m;++O){if(P=l[pe(O)],P.skip)continue;const Me=P.x,Ce=P.y,Pe=0|Me;Pe===j?(Ce<Y?Y=Ce:Ce>K&&(K=Ce),b=(S*b+Me)/++S):(Ie(),i.lineTo(Me,Ce),j=Pe,S=0,Y=K=Ce),xe=Ce}Ie()}function Bc(i){const a=i.options;return i._decimated||i._loop||a.tension||"monotone"===a.cubicInterpolationMode||a.stepped||a.borderDash&&a.borderDash.length?ku:Tu}const H0="function"==typeof Path2D;let To=(()=>class i extends $n{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:n=>"borderDash"!==n&&"fill"!==n};constructor(n){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,n&&Object.assign(this,n)}updateControlPoints(n,c){const l=this.options;!l.tension&&"monotone"!==l.cubicInterpolationMode||l.stepped||this._pointsUpdated||(pc(this._points,l,n,l.spanGaps?this._loop:this._fullLoop,c),this._pointsUpdated=!0)}set points(n){this._points=n,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function xc(i,a){const n=i.points,c=i.options.spanGaps,l=n.length;if(!l)return[];const h=!!i._loop,{start:d,end:m}=function Zl(i,a,n,c){let l=0,h=a-1;if(n&&!c)for(;l<a&&!i[l].skip;)l++;for(;l<a&&i[l].skip;)l++;for(l%=a,n&&(h+=l);h>l&&i[h%a].skip;)h--;return h%=a,{start:l,end:h}}(n,l,h,c);return function co(i,a,n,c){return c&&c.setContext&&n?function yr(i,a,n,c){const l=i._chart.getContext(),h=Kl(i.options),{_datasetIndex:d,options:{spanGaps:m}}=i,g=n.length,y=[];let b=h,S=a[0].start,O=S;function P(j,Y,K,xe){const pe=m?-1:1;if(j!==Y){for(j+=g;n[j%g].skip;)j-=pe;for(;n[Y%g].skip;)Y+=pe;j%g!=Y%g&&(y.push({start:j%g,end:Y%g,loop:K,style:xe}),b=xe,S=Y%g)}}for(const j of a){S=m?S:j.start;let K,Y=n[S%g];for(O=S+1;O<=j.end;O++){const xe=n[O%g];K=Kl(c.setContext(In(l,{type:"segment",p0:Y,p1:xe,p0DataIndex:(O-1)%g,p1DataIndex:O%g,datasetIndex:d}))),Lh(K,b)&&P(S,O-1,j.loop,b),Y=xe,b=K}S<O-1&&P(S,O-1,j.loop,b)}return y}(i,a,n,c):a}(i,!0===c?[{start:d,end:m,loop:h}]:function gs(i,a,n,c){const l=i.length,h=[];let g,d=a,m=i[a];for(g=a+1;g<=n;++g){const y=i[g%l];y.skip||y.stop?m.skip||(h.push({start:a%l,end:(g-1)%l,loop:c=!1}),a=d=y.stop?g:null):(d=g,m.skip&&(a=g)),m=y}return null!==d&&h.push({start:a%l,end:d%l,loop:c}),h}(n,d,m<d?m+l:m,!!i._fullLoop&&0===d&&m===l-1),n,a)}(this,this.options.segment))}first(){const n=this.segments;return n.length&&this.points[n[0].start]}last(){const n=this.segments,l=n.length;return l&&this.points[n[l-1].end]}interpolate(n,c){const l=this.options,h=n[c],d=this.points,m=Ma(this,{property:c,start:h,end:h});if(!m.length)return;const g=[],y=function Cu(i){return i.stepped?Ih:i.tension||"monotone"===i.cubicInterpolationMode?Ph:Wn}(l);let b,S;for(b=0,S=m.length;b<S;++b){const{start:O,end:P}=m[b],j=d[O],Y=d[P];if(j===Y){g.push(j);continue}const xe=y(j,Y,Math.abs((h-j[c])/(Y[c]-j[c])),l.stepped);xe[c]=n[c],g.push(xe)}return 1===g.length?g[0]:g}pathSegment(n,c,l){return Bc(this)(n,this,c,l)}path(n,c,l){const h=this.segments,d=Bc(this);let m=this._loop;c=c||0,l=l||this.points.length-c;for(const g of h)m&=d(n,this,g,{start:c,end:c+l-1});return!!m}draw(n,c,l,h){(this.points||[]).length&&(this.options||{}).borderWidth&&(n.save(),function Au(i,a,n,c){H0&&!a.options.segment?function Eu(i,a,n,c){let l=a._path;l||(l=a._path=new Path2D,a.path(l,n,c)&&l.closePath()),B0(i,a.options),i.stroke(l)}(i,a,n,c):function Su(i,a,n,c){const{segments:l,options:h}=a,d=Bc(a);for(const m of l)B0(i,h,m.style),i.beginPath(),d(i,a,m,{start:n,end:n+c-1})&&i.closePath(),i.stroke()}(i,a,n,c)}(n,this,l,h),n.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}})();function W0(i,a,n,c){const l=i.options,{[n]:h}=i.getProps([n],c);return Math.abs(a-h)<l.radius+l.hitRadius}let Fu=(()=>class i extends $n{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,c,l){const h=this.options,{x:d,y:m}=this.getProps(["x","y"],l);return Math.pow(n-d,2)+Math.pow(c-m,2)<Math.pow(h.hitRadius+h.radius,2)}inXRange(n,c){return W0(this,n,"x",c)}inYRange(n,c){return W0(this,n,"y",c)}getCenterPoint(n){const{x:c,y:l}=this.getProps(["x","y"],n);return{x:c,y:l}}size(n){let c=(n=n||this.options||{}).radius||0;return c=Math.max(c,c&&n.hoverRadius||0),2*(c+(c&&n.borderWidth||0))}draw(n,c){const l=this.options;this.skip||l.radius<.1||!mt(this,c,this.size(l)/2)||(n.strokeStyle=l.borderColor,n.lineWidth=l.borderWidth,n.fillStyle=l.backgroundColor,sc(n,l,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}})();function V0(i,a){const{x:n,y:c,base:l,width:h,height:d}=i.getProps(["x","y","base","width","height"],a);let m,g,y,b,S;return i.horizontal?(S=d/2,m=Math.min(n,l),g=Math.max(n,l),y=c-S,b=c+S):(S=h/2,m=n-S,g=n+S,y=Math.min(c,l),b=Math.max(c,l)),{left:m,top:y,right:g,bottom:b}}function Ui(i,a,n,c){return i?0:Rt(a,n,c)}function Uc(i,a,n,c){const l=null===a,h=null===n,m=i&&!(l&&h)&&V0(i,c);return m&&(l||et(a,m.left,m.right))&&(h||et(n,m.top,m.bottom))}function Mu(i,a){i.rect(a.x,a.y,a.w,a.h)}function Hc(i,a,n={}){const c=i.x!==n.x?-a:0,l=i.y!==n.y?-a:0;return{x:i.x+c,y:i.y+l,w:i.w+((i.x+i.w!==n.x+n.w?a:0)-c),h:i.h+((i.y+i.h!==n.y+n.h?a:0)-l),radius:i.radius}}var z0=Object.freeze({__proto__:null,ArcElement:class wu extends $n{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:a=>"borderDash"!==a};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(a){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,a&&Object.assign(this,a)}inRange(a,n,c){const l=this.getProps(["x","y"],c),{angle:h,distance:d}=ve(l,{x:a,y:n}),{startAngle:m,endAngle:g,innerRadius:y,outerRadius:b,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],c),O=(this.options.spacing+this.options.borderWidth)/2,j=Tt(S,g-m)>=ir||er(h,m,g),Y=et(d,y+O,b+O);return j&&Y}getCenterPoint(a){const{x:n,y:c,startAngle:l,endAngle:h,innerRadius:d,outerRadius:m}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],a),{offset:g,spacing:y}=this.options,b=(l+h)/2,S=(d+m+y+g)/2;return{x:n+Math.cos(b)*S,y:c+Math.sin(b)*S}}tooltipPosition(a){return this.getCenterPoint(a)}draw(a){const{options:n,circumference:c}=this,l=(n.offset||0)/4,h=(n.spacing||0)/2,d=n.circular;if(this.pixelMargin="inner"===n.borderAlign?.33:0,this.fullCircles=c>ir?Math.floor(c/ir):0,0===c||this.innerRadius<0||this.outerRadius<0)return;a.save();const m=(this.startAngle+this.endAngle)/2;a.translate(Math.cos(m)*l,Math.sin(m)*l);const y=l*(1-Math.sin(Math.min(qt,c||0)));a.fillStyle=n.backgroundColor,a.strokeStyle=n.borderColor,function Nc(i,a,n,c,l){const{fullCircles:h,startAngle:d,circumference:m}=a;let g=a.endAngle;if(h){da(i,a,n,c,g,l);for(let y=0;y<h;++y)i.fill();isNaN(m)||(g=d+(m%ir||ir))}da(i,a,n,c,g,l),i.fill()}(a,this,y,h,d),function vu(i,a,n,c,l){const{fullCircles:h,startAngle:d,circumference:m,options:g}=a,{borderWidth:y,borderJoinStyle:b,borderDash:S,borderDashOffset:O}=g,P="inner"===g.borderAlign;if(!y)return;i.setLineDash(S||[]),i.lineDashOffset=O,P?(i.lineWidth=2*y,i.lineJoin=b||"round"):(i.lineWidth=y,i.lineJoin=b||"bevel");let j=a.endAngle;if(h){da(i,a,n,c,j,l);for(let Y=0;Y<h;++Y)i.stroke();isNaN(m)||(j=d+(m%ir||ir))}P&&function xu(i,a,n){const{startAngle:c,pixelMargin:l,x:h,y:d,outerRadius:m,innerRadius:g}=a;let y=l/m;i.beginPath(),i.arc(h,d,m,c-y,n+y),g>l?(y=l/g,i.arc(h,d,g,n+y,c-y,!0)):i.arc(h,d,l,n+gr,c-gr),i.closePath(),i.clip()}(i,a,j),h||(da(i,a,n,c,j,l),i.stroke())}(a,this,y,h,d),a.restore()}},BarElement:class Ru extends $n{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(a){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,a&&Object.assign(this,a)}draw(a){const{inflateAmount:n,options:{borderColor:c,backgroundColor:l}}=this,{inner:h,outer:d}=function Iu(i){const a=V0(i),n=a.right-a.left,c=a.bottom-a.top,l=function Du(i,a,n){const l=i.borderSkipped,h=ro(i.options.borderWidth);return{t:Ui(l.top,h.top,0,n),r:Ui(l.right,h.right,0,a),b:Ui(l.bottom,h.bottom,0,n),l:Ui(l.left,h.left,0,a)}}(i,n/2,c/2),h=function Ou(i,a,n){const{enableBorderRadius:c}=i.getProps(["enableBorderRadius"]),l=i.options.borderRadius,h=Fi(l),d=Math.min(a,n),m=i.borderSkipped,g=c||It(l);return{topLeft:Ui(!g||m.top||m.left,h.topLeft,0,d),topRight:Ui(!g||m.top||m.right,h.topRight,0,d),bottomLeft:Ui(!g||m.bottom||m.left,h.bottomLeft,0,d),bottomRight:Ui(!g||m.bottom||m.right,h.bottomRight,0,d)}}(i,n/2,c/2);return{outer:{x:a.left,y:a.top,w:n,h:c,radius:h},inner:{x:a.left+l.l,y:a.top+l.t,w:n-l.l-l.r,h:c-l.t-l.b,radius:{topLeft:Math.max(0,h.topLeft-Math.max(l.t,l.l)),topRight:Math.max(0,h.topRight-Math.max(l.t,l.r)),bottomLeft:Math.max(0,h.bottomLeft-Math.max(l.b,l.l)),bottomRight:Math.max(0,h.bottomRight-Math.max(l.b,l.r))}}}}(this),m=function Pu(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}(d.radius)?Aa:Mu;a.save(),(d.w!==h.w||d.h!==h.h)&&(a.beginPath(),m(a,Hc(d,n,h)),a.clip(),m(a,Hc(h,-n,d)),a.fillStyle=c,a.fill("evenodd")),a.beginPath(),m(a,Hc(h,n)),a.fillStyle=l,a.fill(),a.restore()}inRange(a,n,c){return Uc(this,a,n,c)}inXRange(a,n){return Uc(this,a,null,n)}inYRange(a,n){return Uc(this,null,a,n)}getCenterPoint(a){const{x:n,y:c,base:l,horizontal:h}=this.getProps(["x","y","base","horizontal"],a);return{x:h?(n+l)/2:n,y:h?c:(c+l)/2}}getRange(a){return"x"===a?this.width/2:this.height/2}},LineElement:To,PointElement:Fu});const Wc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],$0=Wc.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function G0(i){return Wc[i%Wc.length]}function j0(i){return $0[i%$0.length]}function Y0(i){let a;for(a in i)if(i[a].borderColor||i[a].backgroundColor)return!0;return!1}var Uu={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,a,n){if(!n.enabled)return;const{data:{datasets:c},options:l}=i.config,{elements:h}=l;if(!n.forceOverride&&(Y0(c)||function Z0(i){return i&&(i.borderColor||i.backgroundColor)}(l)||h&&Y0(h)))return;const d=function Bu(i){let a=0;return(n,c)=>{const l=i.getDatasetMeta(c).controller;l instanceof Tc?a=function Nu(i,a){return i.backgroundColor=i.data.map(()=>G0(a++)),a}(n,a):l instanceof Cc?a=function X0(i,a){return i.backgroundColor=i.data.map(()=>j0(a++)),a}(n,a):l&&(a=function Lu(i,a){return i.borderColor=G0(a),i.backgroundColor=j0(a),++a}(n,a))}}(i);c.forEach(d)}};function Vc(i){if(i._decimated){const a=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,writable:!0,value:a})}}function K0(i){i.data.datasets.forEach(a=>{Vc(a)})}var Vu={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,a,n)=>{if(!n.enabled)return void K0(i);const c=i.width;i.data.datasets.forEach((l,h)=>{const{_data:d,indexAxis:m}=l,g=i.getDatasetMeta(h),y=d||l.data;if("y"===jt([m,i.options.indexAxis])||!g.controller.supportsDecimation)return;const b=i.scales[g.xAxisID];if("linear"!==b.type&&"time"!==b.type||i.options.parsing)return;let j,{start:S,count:O}=function J0(i,a){const n=a.length;let l,c=0;const{iScale:h}=i,{min:d,max:m,minDefined:g,maxDefined:y}=h.getUserBounds();return g&&(c=Rt(mn(a,h.axis,d).lo,0,n-1)),l=y?Rt(mn(a,h.axis,m).hi+1,c,n)-c:n-c,{start:c,count:l}}(g,y);if(O<=(n.threshold||4*c))Vc(l);else{switch(Pt(d)&&(l._data=y,delete l.data,Object.defineProperty(l,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(Y){this._data=Y}})),n.algorithm){case"lttb":j=function Hu(i,a,n,c,l){const h=l.samples||c;if(h>=n)return i.slice(a,a+n);const d=[],m=(n-2)/(h-2);let g=0;const y=a+n-1;let S,O,P,j,Y,b=a;for(d[g++]=i[b],S=0;S<h-2;S++){let pe,K=0,xe=0;const Ie=Math.floor((S+1)*m)+1+a,Me=Math.min(Math.floor((S+2)*m)+1,n)+a,Ce=Me-Ie;for(pe=Ie;pe<Me;pe++)K+=i[pe].x,xe+=i[pe].y;K/=Ce,xe/=Ce;const Pe=Math.floor(S*m)+1+a,rt=Math.min(Math.floor((S+1)*m)+1,n)+a,{x:Ve,y:dt}=i[b];for(P=j=-1,pe=Pe;pe<rt;pe++)j=.5*Math.abs((Ve-K)*(i[pe].y-dt)-(Ve-i[pe].x)*(xe-dt)),j>P&&(P=j,O=i[pe],Y=pe);d[g++]=O,b=Y}return d[g++]=i[y],d}(y,S,O,c,n);break;case"min-max":j=function Wu(i,a,n,c){let d,m,g,y,b,S,O,P,j,Y,l=0,h=0;const K=[],pe=i[a].x,Me=i[a+n-1].x-pe;for(d=a;d<a+n;++d){m=i[d],g=(m.x-pe)/Me*c,y=m.y;const Ce=0|g;if(Ce===b)y<j?(j=y,S=d):y>Y&&(Y=y,O=d),l=(h*l+m.x)/++h;else{const Pe=d-1;if(!Pt(S)&&!Pt(O)){const rt=Math.min(S,O),Ve=Math.max(S,O);rt!==P&&rt!==Pe&&K.push({...i[rt],x:l}),Ve!==P&&Ve!==Pe&&K.push({...i[Ve],x:l})}d>0&&Pe!==P&&K.push(i[Pe]),K.push(m),b=Ce,h=0,j=Y=y,S=O=P=d}}return K}(y,S,O,c);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}l._decimated=j}})},destroy(i){K0(i)}};function Co(i,a,n,c){if(c)return;let l=a[i],h=n[i];return"angle"===i&&(l=lt(l),h=lt(h)),{property:i,start:l,end:h}}function zc(i,a,n){for(;a>i;a--){const c=n[a];if(!isNaN(c.x)&&!isNaN(c.y))break}return a}function q0(i,a,n,c){return i&&a?c(i[n],a[n]):i?i[n]:a?a[n]:0}function $c(i,a){let n=[],c=!1;return Vt(i)?(c=!0,n=i):n=function zu(i,a){const{x:n=null,y:c=null}=i||{},l=a.points,h=[];return a.segments.forEach(({start:d,end:m})=>{m=zc(d,m,l);const g=l[d],y=l[m];null!==c?(h.push({x:g.x,y:c}),h.push({x:y.x,y:c})):null!==n&&(h.push({x:n,y:g.y}),h.push({x:n,y:y.y}))}),h}(i,a),n.length?new To({points:n,options:{tension:0},_loop:c,_fullLoop:c}):null}function ef(i){return i&&!1!==i.fill}function $u(i,a,n){let l=i[a].fill;const h=[a];let d;if(!n)return l;for(;!1!==l&&-1===h.indexOf(l);){if(!ur(l))return l;if(d=i[l],!d)return!1;if(d.visible)return l;h.push(l),l=d.fill}return!1}function Gu(i,a,n){const c=function Zu(i){const a=i.options,n=a.fill;let c=Tt(n&&n.target,n);return void 0===c&&(c=!!a.backgroundColor),!1!==c&&null!==c&&(!0===c?"origin":c)}(i);if(It(c))return!isNaN(c.value)&&c;let l=parseFloat(c);return ur(l)&&Math.floor(l)===l?function ju(i,a,n,c){return("-"===i||"+"===i)&&(n=a+n),!(n===a||n<0||n>=c)&&n}(c[0],a,l,n):["origin","start","end","stack","shape"].indexOf(c)>=0&&c}function Qu(i,a,n){const c=[];for(let l=0;l<n.length;l++){const h=n[l],{first:d,last:m,point:g}=qu(h,a,"x");if(!(!g||d&&m))if(d)c.unshift(g);else if(i.push(g),!m)break}i.push(...c)}function qu(i,a,n){const c=i.interpolate(a,n);if(!c)return{};const l=c[n],h=i.segments,d=i.points;let m=!1,g=!1;for(let y=0;y<h.length;y++){const b=h[y],S=d[b.start][n],O=d[b.end][n];if(et(l,S,O)){m=l===S,g=l===O;break}}return{first:m,last:g,point:c}}class tf{constructor(a){this.x=a.x,this.y=a.y,this.radius=a.radius}pathSegment(a,n,c){const{x:l,y:h,radius:d}=this;return a.arc(l,h,d,(n=n||{start:0,end:ir}).end,n.start,!0),!c.bounds}interpolate(a){const{x:n,y:c,radius:l}=this,h=a.angle;return{x:n+Math.cos(h)*l,y:c+Math.sin(h)*l,angle:h}}}function Gc(i,a,n){const c=function ed(i){const{chart:a,fill:n,line:c}=i;if(ur(n))return function td(i,a){const n=i.getDatasetMeta(a);return n&&i.isDatasetVisible(a)?n.dataset:null}(a,n);if("stack"===n)return function Ku(i){const{scale:a,index:n,line:c}=i,l=[],h=c.segments,d=c.points,m=function Ju(i,a){const n=[],c=i.getMatchingVisibleMetas("line");for(let l=0;l<c.length;l++){const h=c[l];if(h.index===a)break;h.hidden||n.unshift(h.dataset)}return n}(a,n);m.push($c({x:null,y:a.bottom},c));for(let g=0;g<h.length;g++){const y=h[g];for(let b=y.start;b<=y.end;b++)Qu(l,d[b],m)}return new To({points:l,options:{}})}(i);if("shape"===n)return!0;const l=function rd(i){return(i.scale||{}).getPointPositionForValue?function id(i){const{scale:a,fill:n}=i,c=a.options,l=a.getLabels().length,h=c.reverse?a.max:a.min,d=function Yu(i,a,n){let c;return c="start"===i?n:"end"===i?a.options.reverse?a.min:a.max:It(i)?i.value:a.getBaseValue(),c}(n,a,h),m=[];if(c.grid.circular){const g=a.getPointPositionForValue(0,h);return new tf({x:g.x,y:g.y,radius:a.getDistanceFromCenterForValue(d)})}for(let g=0;g<l;++g)m.push(a.getPointPositionForValue(g,d));return m}(i):function nd(i){const{scale:a={},fill:n}=i,c=function Xu(i,a){let n=null;return"start"===i?n=a.bottom:"end"===i?n=a.top:It(i)?n=a.getPixelForValue(i.value):a.getBasePixel&&(n=a.getBasePixel()),n}(n,a);if(ur(c)){const l=a.isHorizontal();return{x:l?c:null,y:l?null:c}}return null}(i)}(i);return l instanceof tf?l:$c(l,c)}(a),{line:l,scale:h,axis:d}=a,m=l.options,g=m.fill,y=m.backgroundColor,{above:b=y,below:S=y}=g||{};c&&l.points.length&&(Cn(i,n),function rf(i,a){const{line:n,target:c,above:l,below:h,area:d,scale:m}=a,g=n._loop?"angle":a.axis;i.save(),"x"===g&&h!==l&&(nf(i,c,d.top),af(i,{line:n,target:c,color:l,scale:m,property:g}),i.restore(),i.save(),nf(i,c,d.bottom)),af(i,{line:n,target:c,color:h,scale:m,property:g}),i.restore()}(i,{line:l,target:c,above:b,below:S,area:n,scale:h,axis:d}),us(i))}function nf(i,a,n){const{segments:c,points:l}=a;let h=!0,d=!1;i.beginPath();for(const m of c){const{start:g,end:y}=m,b=l[g],S=l[zc(g,y,l)];h?(i.moveTo(b.x,b.y),h=!1):(i.lineTo(b.x,n),i.lineTo(b.x,b.y)),d=!!a.pathSegment(i,m,{move:d}),d?i.closePath():i.lineTo(S.x,n)}i.lineTo(a.first().x,n),i.closePath(),i.clip()}function af(i,a){const{line:n,target:c,property:l,color:h,scale:d}=a,m=function Q0(i,a,n){const c=i.segments,l=i.points,h=a.points,d=[];for(const m of c){let{start:g,end:y}=m;y=zc(g,y,l);const b=Co(n,l[g],l[y],m.loop);if(!a.segments){d.push({source:m,target:b,start:l[g],end:l[y]});continue}const S=Ma(a,b);for(const O of S){const P=Co(n,h[O.start],h[O.end],O.loop),j=Se(m,l,P);for(const Y of j)d.push({source:Y,target:O,start:{[n]:q0(b,P,"start",Math.max)},end:{[n]:q0(b,P,"end",Math.min)}})}}return d}(n,c,l);for(const{source:g,target:y,start:b,end:S}of m){const{style:{backgroundColor:O=h}={}}=g,P=!0!==c;i.save(),i.fillStyle=O,ad(i,d,P&&Co(l,b,S)),i.beginPath();const j=!!n.pathSegment(i,g);let Y;if(P){j?i.closePath():sf(i,c,S,l);const K=!!c.pathSegment(i,y,{move:j,reverse:!0});Y=j&&K,Y||sf(i,c,b,l)}i.closePath(),i.fill(Y?"evenodd":"nonzero"),i.restore()}}function ad(i,a,n){const{top:c,bottom:l}=a.chart.chartArea,{property:h,start:d,end:m}=n||{};"x"===h&&(i.beginPath(),i.rect(d,c,m-d,l-c),i.clip())}function sf(i,a,n,c){const l=a.interpolate(n,c);l&&i.lineTo(l.x,l.y)}var sd={id:"filler",afterDatasetsUpdate(i,a,n){const c=(i.data.datasets||[]).length,l=[];let h,d,m,g;for(d=0;d<c;++d)h=i.getDatasetMeta(d),m=h.dataset,g=null,m&&m.options&&m instanceof To&&(g={visible:i.isDatasetVisible(d),index:d,fill:Gu(m,d,c),chart:i,axis:h.controller.options.indexAxis,scale:h.vScale,line:m}),h.$filler=g,l.push(g);for(d=0;d<c;++d)g=l[d],g&&!1!==g.fill&&(g.fill=$u(l,d,n.propagate))},beforeDraw(i,a,n){const c="beforeDraw"===n.drawTime,l=i.getSortedVisibleDatasetMetas(),h=i.chartArea;for(let d=l.length-1;d>=0;--d){const m=l[d].$filler;m&&(m.line.updateControlPoints(h,m.axis),c&&m.fill&&Gc(i.ctx,m,h))}},beforeDatasetsDraw(i,a,n){if("beforeDatasetsDraw"!==n.drawTime)return;const c=i.getSortedVisibleDatasetMetas();for(let l=c.length-1;l>=0;--l){const h=c[l].$filler;ef(h)&&Gc(i.ctx,h,i.chartArea)}},beforeDatasetDraw(i,a,n){const c=a.meta.$filler;!ef(c)||"beforeDatasetDraw"!==n.drawTime||Gc(i.ctx,c,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const of=(i,a)=>{let{boxHeight:n=a,boxWidth:c=a}=i;return i.usePointStyle&&(n=Math.min(n,a),c=i.pointStyleWidth||Math.min(c,a)),{boxWidth:c,boxHeight:n,itemHeight:Math.max(a,n)}};class cf extends $n{constructor(a){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=a.chart,this.options=a.options,this.ctx=a.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(a,n,c){this.maxWidth=a,this.maxHeight=n,this._margins=c,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const a=this.options.labels||{};let n=Qt(a.generateLabels,[this.chart],this)||[];a.filter&&(n=n.filter(c=>a.filter(c,this.chart.data))),a.sort&&(n=n.sort((c,l)=>a.sort(c,l,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:a,ctx:n}=this;if(!a.display)return void(this.width=this.height=0);const c=a.labels,l=wr(c.font),h=l.size,d=this._computeTitleHeight(),{boxWidth:m,itemHeight:g}=of(c,h);let y,b;n.font=l.string,this.isHorizontal()?(y=this.maxWidth,b=this._fitRows(d,h,m,g)+10):(b=this.maxHeight,y=this._fitCols(d,l,m,g)+10),this.width=Math.min(y,a.maxWidth||this.maxWidth),this.height=Math.min(b,a.maxHeight||this.maxHeight)}_fitRows(a,n,c,l){const{ctx:h,maxWidth:d,options:{labels:{padding:m}}}=this,g=this.legendHitBoxes=[],y=this.lineWidths=[0],b=l+m;let S=a;h.textAlign="left",h.textBaseline="middle";let O=-1,P=-b;return this.legendItems.forEach((j,Y)=>{const K=c+n/2+h.measureText(j.text).width;(0===Y||y[y.length-1]+K+2*m>d)&&(S+=b,y[y.length-(Y>0?0:1)]=0,P+=b,O++),g[Y]={left:0,top:P,row:O,width:K,height:l},y[y.length-1]+=K+m}),S}_fitCols(a,n,c,l){const{ctx:h,maxHeight:d,options:{labels:{padding:m}}}=this,g=this.legendHitBoxes=[],y=this.columnSizes=[],b=d-a;let S=m,O=0,P=0,j=0,Y=0;return this.legendItems.forEach((K,xe)=>{const{itemWidth:pe,itemHeight:Ie}=function cd(i,a,n,c,l){const h=function ld(i,a,n,c){let l=i.text;return l&&"string"!=typeof l&&(l=l.reduce((h,d)=>h.length>d.length?h:d)),a+n.size/2+c.measureText(l).width}(c,i,a,n),d=function fd(i,a,n){let c=i;return"string"!=typeof a.text&&(c=lf(a,n)),c}(l,c,a.lineHeight);return{itemWidth:h,itemHeight:d}}(c,n,h,K,l);xe>0&&P+Ie+2*m>b&&(S+=O+m,y.push({width:O,height:P}),j+=O+m,Y++,O=P=0),g[xe]={left:j,top:P,col:Y,width:pe,height:Ie},O=Math.max(O,pe),P+=Ie+m}),S+=O,y.push({width:O,height:P}),S}adjustHitBoxes(){if(!this.options.display)return;const a=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:c,labels:{padding:l},rtl:h}}=this,d=ta(h,this.left,this.width);if(this.isHorizontal()){let m=0,g=Qr(c,this.left+l,this.right-this.lineWidths[m]);for(const y of n)m!==y.row&&(m=y.row,g=Qr(c,this.left+l,this.right-this.lineWidths[m])),y.top+=this.top+a+l,y.left=d.leftForLtr(d.x(g),y.width),g+=y.width+l}else{let m=0,g=Qr(c,this.top+a+l,this.bottom-this.columnSizes[m].height);for(const y of n)y.col!==m&&(m=y.col,g=Qr(c,this.top+a+l,this.bottom-this.columnSizes[m].height)),y.top=g,y.left+=this.left+l,y.left=d.leftForLtr(d.x(y.left),y.width),g+=y.height+l}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const a=this.ctx;Cn(a,this),this._draw(),us(a)}}_draw(){const{options:a,columnSizes:n,lineWidths:c,ctx:l}=this,{align:h,labels:d}=a,m=ar.color,g=ta(a.rtl,this.left,this.width),y=wr(d.font),{padding:b}=d,S=y.size,O=S/2;let P;this.drawTitle(),l.textAlign=g.textAlign("left"),l.textBaseline="middle",l.lineWidth=.5,l.font=y.string;const{boxWidth:j,boxHeight:Y,itemHeight:K}=of(d,S),Ie=this.isHorizontal(),Me=this._computeTitleHeight();P=Ie?{x:Qr(h,this.left+b,this.right-c[0]),y:this.top+b+Me,line:0}:{x:this.left+b,y:Qr(h,this.top+Me+b,this.bottom-n[0].height),line:0},Hr(this.ctx,a.textDirection);const Ce=K+b;this.legendItems.forEach((Pe,rt)=>{l.strokeStyle=Pe.fontColor,l.fillStyle=Pe.fontColor;const Ve=l.measureText(Pe.text).width,dt=g.textAlign(Pe.textAlign||(Pe.textAlign=d.textAlign)),Dt=j+O+Ve;let Ft=P.x,Mt=P.y;g.setWidth(this.width),Ie?rt>0&&Ft+Dt+b>this.right&&(Mt=P.y+=Ce,P.line++,Ft=P.x=Qr(h,this.left+b,this.right-c[P.line])):rt>0&&Mt+Ce>this.bottom&&(Ft=P.x=Ft+n[P.line].width+b,P.line++,Mt=P.y=Qr(h,this.top+Me+b,this.bottom-n[P.line].height)),function(Pe,rt,Ve){if(isNaN(j)||j<=0||isNaN(Y)||Y<0)return;l.save();const dt=Tt(Ve.lineWidth,1);if(l.fillStyle=Tt(Ve.fillStyle,m),l.lineCap=Tt(Ve.lineCap,"butt"),l.lineDashOffset=Tt(Ve.lineDashOffset,0),l.lineJoin=Tt(Ve.lineJoin,"miter"),l.lineWidth=dt,l.strokeStyle=Tt(Ve.strokeStyle,m),l.setLineDash(Tt(Ve.lineDash,[])),d.usePointStyle){const Dt={radius:Y*Math.SQRT2/2,pointStyle:Ve.pointStyle,rotation:Ve.rotation,borderWidth:dt},Ft=g.xPlus(Pe,j/2);Ll(l,Dt,Ft,rt+O,d.pointStyleWidth&&j)}else{const Dt=rt+Math.max((S-Y)/2,0),Ft=g.leftForLtr(Pe,j),Mt=Fi(Ve.borderRadius);l.beginPath(),Object.values(Mt).some(Wr=>0!==Wr)?Aa(l,{x:Ft,y:Dt,w:j,h:Y,radius:Mt}):l.rect(Ft,Dt,j,Y),l.fill(),0!==dt&&l.stroke()}l.restore()}(g.x(Ft),Mt,Pe),Ft=((i,a,n,c)=>i===(c?"left":"right")?n:"center"===i?(a+n)/2:a)(dt,Ft+j+O,Ie?Ft+Dt:this.right,a.rtl),function(Pe,rt,Ve){Ai(l,Ve.text,Pe,rt+K/2,y,{strikethrough:Ve.hidden,textAlign:g.textAlign(Ve.textAlign)})}(g.x(Ft),Mt,Pe),Ie?P.x+=Dt+b:P.y+="string"!=typeof Pe.text?lf(Pe,y.lineHeight)+b:Ce}),Xr(this.ctx,a.textDirection)}drawTitle(){const a=this.options,n=a.title,c=wr(n.font),l=Gr(n.padding);if(!n.display)return;const h=ta(a.rtl,this.left,this.width),d=this.ctx,m=n.position,y=l.top+c.size/2;let b,S=this.left,O=this.width;if(this.isHorizontal())O=Math.max(...this.lineWidths),b=this.top+y,S=Qr(a.align,S,this.right-O);else{const j=this.columnSizes.reduce((Y,K)=>Math.max(Y,K.height),0);b=y+Qr(a.align,this.top,this.bottom-j-a.labels.padding-this._computeTitleHeight())}const P=Qr(m,S,S+O);d.textAlign=h.textAlign(qs(m)),d.textBaseline="middle",d.strokeStyle=n.color,d.fillStyle=n.color,d.font=c.string,Ai(d,n.text,P,b,c)}_computeTitleHeight(){const a=this.options.title,n=wr(a.font),c=Gr(a.padding);return a.display?n.lineHeight+c.height:0}_getLegendItemAt(a,n){let c,l,h;if(et(a,this.left,this.right)&&et(n,this.top,this.bottom))for(h=this.legendHitBoxes,c=0;c<h.length;++c)if(l=h[c],et(a,l.left,l.left+l.width)&&et(n,l.top,l.top+l.height))return this.legendItems[c];return null}handleEvent(a){const n=this.options;if(!function hd(i,a){return!(("mousemove"!==i&&"mouseout"!==i||!a.onHover&&!a.onLeave)&&(!a.onClick||"click"!==i&&"mouseup"!==i))}(a.type,n))return;const c=this._getLegendItemAt(a.x,a.y);if("mousemove"===a.type||"mouseout"===a.type){const l=this._hoveredItem,h=((i,a)=>null!==i&&null!==a&&i.datasetIndex===a.datasetIndex&&i.index===a.index)(l,c);l&&!h&&Qt(n.onLeave,[a,l,this],this),this._hoveredItem=c,c&&!h&&Qt(n.onHover,[a,c,this],this)}else c&&Qt(n.onClick,[a,c,this],this)}}function lf(i,a){return a*(i.text?i.text.length:0)}var ud={id:"legend",_element:cf,start(i,a,n){const c=i.legend=new cf({ctx:i.ctx,options:n,chart:i});Ar.configure(i,c,n),Ar.addBox(i,c)},stop(i){Ar.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,a,n){const c=i.legend;Ar.configure(i,c,n),c.options=n},afterUpdate(i){const a=i.legend;a.buildLabels(),a.adjustHitBoxes()},afterEvent(i,a){a.replay||i.legend.handleEvent(a.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,a,n){const c=a.datasetIndex,l=n.chart;l.isDatasetVisible(c)?(l.hide(c),a.hidden=!0):(l.show(c),a.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const a=i.data.datasets,{labels:{usePointStyle:n,pointStyle:c,textAlign:l,color:h,useBorderRadius:d,borderRadius:m}}=i.legend.options;return i._getSortedDatasetMetas().map(g=>{const y=g.controller.getStyle(n?0:void 0),b=Gr(y.borderWidth);return{text:a[g.index].label,fillStyle:y.backgroundColor,fontColor:h,hidden:!g.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(b.width+b.height)/4,strokeStyle:y.borderColor,pointStyle:c||y.pointStyle,rotation:y.rotation,textAlign:l||y.textAlign,borderRadius:d&&(m||y.borderRadius),datasetIndex:g.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class jc extends $n{constructor(a){super(),this.chart=a.chart,this.options=a.options,this.ctx=a.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(a,n){const c=this.options;if(this.left=0,this.top=0,!c.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=a,this.height=this.bottom=n;const l=Vt(c.text)?c.text.length:1;this._padding=Gr(c.padding);const h=l*wr(c.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=h:this.width=h}isHorizontal(){const a=this.options.position;return"top"===a||"bottom"===a}_drawArgs(a){const{top:n,left:c,bottom:l,right:h,options:d}=this,m=d.align;let y,b,S,g=0;return this.isHorizontal()?(b=Qr(m,c,h),S=n+a,y=h-c):("left"===d.position?(b=c+a,S=Qr(m,l,n),g=-.5*qt):(b=h-a,S=Qr(m,n,l),g=.5*qt),y=l-n),{titleX:b,titleY:S,maxWidth:y,rotation:g}}draw(){const a=this.ctx,n=this.options;if(!n.display)return;const c=wr(n.font),h=c.lineHeight/2+this._padding.top,{titleX:d,titleY:m,maxWidth:g,rotation:y}=this._drawArgs(h);Ai(a,n.text,0,0,c,{color:n.color,maxWidth:g,rotation:y,textAlign:qs(n.align),textBaseline:"middle",translation:[d,m]})}}var pd={id:"title",_element:jc,start(i,a,n){!function dd(i,a){const n=new jc({ctx:i.ctx,options:a,chart:i});Ar.configure(i,n,a),Ar.addBox(i,n),i.titleBlock=n}(i,n)},stop(i){Ar.removeBox(i,i.titleBlock),delete i.titleBlock},beforeUpdate(i,a,n){const c=i.titleBlock;Ar.configure(i,c,n),c.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ha=new WeakMap;var ff={id:"subtitle",start(i,a,n){const c=new jc({ctx:i.ctx,options:n,chart:i});Ar.configure(i,c,n),Ar.addBox(i,c),Ha.set(i,c)},stop(i){Ar.removeBox(i,Ha.get(i)),Ha.delete(i)},beforeUpdate(i,a,n){const c=Ha.get(i);Ar.configure(i,c,n),c.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Wa={average(i){if(!i.length)return!1;let a,n,c=0,l=0,h=0;for(a=0,n=i.length;a<n;++a){const d=i[a].element;if(d&&d.hasValue()){const m=d.tooltipPosition();c+=m.x,l+=m.y,++h}}return{x:c/h,y:l/h}},nearest(i,a){if(!i.length)return!1;let h,d,m,n=a.x,c=a.y,l=Number.POSITIVE_INFINITY;for(h=0,d=i.length;h<d;++h){const g=i[h].element;if(g&&g.hasValue()){const b=Oe(a,g.getCenterPoint());b<l&&(l=b,m=g)}}if(m){const g=m.tooltipPosition();n=g.x,c=g.y}return{x:n,y:c}}};function Xn(i,a){return a&&(Vt(a)?Array.prototype.push.apply(i,a):i.push(a)),i}function _n(i){return("string"==typeof i||i instanceof String)&&i.indexOf("\n")>-1?i.split("\n"):i}function md(i,a){const{element:n,datasetIndex:c,index:l}=a,h=i.getDatasetMeta(c).controller,{label:d,value:m}=h.getLabelAndValue(l);return{chart:i,label:d,parsed:h.getParsed(l),raw:i.data.datasets[c].data[l],formattedValue:m,dataset:h.getDataset(),dataIndex:l,datasetIndex:c,element:n}}function Hi(i,a){const n=i.chart.ctx,{body:c,footer:l,title:h}=i,{boxWidth:d,boxHeight:m}=a,g=wr(a.bodyFont),y=wr(a.titleFont),b=wr(a.footerFont),S=h.length,O=l.length,P=c.length,j=Gr(a.padding);let Y=j.height,K=0,xe=c.reduce((Me,Ce)=>Me+Ce.before.length+Ce.lines.length+Ce.after.length,0);xe+=i.beforeBody.length+i.afterBody.length,S&&(Y+=S*y.lineHeight+(S-1)*a.titleSpacing+a.titleMarginBottom),xe&&(Y+=P*(a.displayColors?Math.max(m,g.lineHeight):g.lineHeight)+(xe-P)*g.lineHeight+(xe-1)*a.bodySpacing),O&&(Y+=a.footerMarginTop+O*b.lineHeight+(O-1)*a.footerSpacing);let pe=0;const Ie=function(Me){K=Math.max(K,n.measureText(Me).width+pe)};return n.save(),n.font=y.string,Xt(i.title,Ie),n.font=g.string,Xt(i.beforeBody.concat(i.afterBody),Ie),pe=a.displayColors?d+2+a.boxPadding:0,Xt(c,Me=>{Xt(Me.before,Ie),Xt(Me.lines,Ie),Xt(Me.after,Ie)}),pe=0,n.font=b.string,Xt(i.footer,Ie),n.restore(),K+=j.width,{width:K,height:Y}}function _d(i,a,n,c){const{x:l,width:h}=n,{width:d,chartArea:{left:m,right:g}}=i;let y="center";return"center"===c?y=l<=(m+g)/2?"left":"right":l<=h/2?y="left":l>=d-h/2&&(y="right"),function xd(i,a,n,c){const{x:l,width:h}=c,d=n.caretSize+n.caretPadding;if("left"===i&&l+h+d>a.width||"right"===i&&l-h-d<0)return!0}(y,i,a,n)&&(y="center"),y}function hf(i,a,n){const c=n.yAlign||a.yAlign||function gd(i,a){const{y:n,height:c}=a;return n<c/2?"top":n>i.height-c/2?"bottom":"center"}(i,n);return{xAlign:n.xAlign||a.xAlign||_d(i,a,n,c),yAlign:c}}function Eo(i,a,n,c){const{caretSize:l,caretPadding:h,cornerRadius:d}=i,{xAlign:m,yAlign:g}=n,y=l+h,{topLeft:b,topRight:S,bottomLeft:O,bottomRight:P}=Fi(d);let j=function vd(i,a){let{x:n,width:c}=i;return"right"===a?n-=c:"center"===a&&(n-=c/2),n}(a,m);const Y=function wd(i,a,n){let{y:c,height:l}=i;return"top"===a?c+=n:c-="bottom"===a?l+n:l/2,c}(a,g,y);return"center"===g?"left"===m?j+=y:"right"===m&&(j-=y):"left"===m?j-=Math.max(b,O)+l:"right"===m&&(j+=Math.max(S,P)+l),{x:Rt(j,0,c.width-a.width),y:Rt(Y,0,c.height-a.height)}}function So(i,a,n){const c=Gr(n.padding);return"center"===a?i.x+i.width/2:"right"===a?i.x+i.width-c.right:i.x+c.left}function uf(i){return Xn([],_n(i))}function df(i,a){const n=a&&a.dataset&&a.dataset.tooltip&&a.dataset.tooltip.callbacks;return n?i.override(n):i}const pf={beforeTitle:Fn,title(i){if(i.length>0){const a=i[0],n=a.chart.data.labels,c=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return a.dataset.label||"";if(a.label)return a.label;if(c>0&&a.dataIndex<c)return n[a.dataIndex]}return""},afterTitle:Fn,beforeBody:Fn,beforeLabel:Fn,label(i){if(this&&this.options&&"dataset"===this.options.mode)return i.label+": "+i.formattedValue||i.formattedValue;let a=i.dataset.label||"";a&&(a+=": ");const n=i.formattedValue;return Pt(n)||(a+=n),a},labelColor(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Fn,afterBody:Fn,beforeFooter:Fn,footer:Fn,afterFooter:Fn};function fn(i,a,n,c){const l=i[a].call(n,c);return typeof l>"u"?pf[a].call(n,c):l}let mf=(()=>class i extends $n{static positioners=Wa;constructor(n){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=n.chart,this.options=n.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(n){this.options=n,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const n=this._cachedAnimations;if(n)return n;const c=this.chart,l=this.options.setContext(this.getContext()),h=l.enabled&&c.options.animation&&l.animations,d=new pr(this.chart,h);return h._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=function yd(i,a,n){return In(i,{tooltip:a,tooltipItems:n,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(n,c){const{callbacks:l}=c,h=fn(l,"beforeTitle",this,n),d=fn(l,"title",this,n),m=fn(l,"afterTitle",this,n);let g=[];return g=Xn(g,_n(h)),g=Xn(g,_n(d)),g=Xn(g,_n(m)),g}getBeforeBody(n,c){return uf(fn(c.callbacks,"beforeBody",this,n))}getBody(n,c){const{callbacks:l}=c,h=[];return Xt(n,d=>{const m={before:[],lines:[],after:[]},g=df(l,d);Xn(m.before,_n(fn(g,"beforeLabel",this,d))),Xn(m.lines,fn(g,"label",this,d)),Xn(m.after,_n(fn(g,"afterLabel",this,d))),h.push(m)}),h}getAfterBody(n,c){return uf(fn(c.callbacks,"afterBody",this,n))}getFooter(n,c){const{callbacks:l}=c,h=fn(l,"beforeFooter",this,n),d=fn(l,"footer",this,n),m=fn(l,"afterFooter",this,n);let g=[];return g=Xn(g,_n(h)),g=Xn(g,_n(d)),g=Xn(g,_n(m)),g}_createItems(n){const c=this._active,l=this.chart.data,h=[],d=[],m=[];let y,b,g=[];for(y=0,b=c.length;y<b;++y)g.push(md(this.chart,c[y]));return n.filter&&(g=g.filter((S,O,P)=>n.filter(S,O,P,l))),n.itemSort&&(g=g.sort((S,O)=>n.itemSort(S,O,l))),Xt(g,S=>{const O=df(n.callbacks,S);h.push(fn(O,"labelColor",this,S)),d.push(fn(O,"labelPointStyle",this,S)),m.push(fn(O,"labelTextColor",this,S))}),this.labelColors=h,this.labelPointStyles=d,this.labelTextColors=m,this.dataPoints=g,g}update(n,c){const l=this.options.setContext(this.getContext()),h=this._active;let d,m=[];if(h.length){const g=Wa[l.position].call(this,h,this._eventPosition);m=this._createItems(l),this.title=this.getTitle(m,l),this.beforeBody=this.getBeforeBody(m,l),this.body=this.getBody(m,l),this.afterBody=this.getAfterBody(m,l),this.footer=this.getFooter(m,l);const y=this._size=Hi(this,l),b=Object.assign({},g,y),S=hf(this.chart,l,b),O=Eo(l,b,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,d={opacity:1,x:O.x,y:O.y,width:y.width,height:y.height,caretX:g.x,caretY:g.y}}else 0!==this.opacity&&(d={opacity:0});this._tooltipItems=m,this.$context=void 0,d&&this._resolveAnimations().update(this,d),n&&l.external&&l.external.call(this,{chart:this.chart,tooltip:this,replay:c})}drawCaret(n,c,l,h){const d=this.getCaretPosition(n,l,h);c.lineTo(d.x1,d.y1),c.lineTo(d.x2,d.y2),c.lineTo(d.x3,d.y3)}getCaretPosition(n,c,l){const{xAlign:h,yAlign:d}=this,{caretSize:m,cornerRadius:g}=l,{topLeft:y,topRight:b,bottomLeft:S,bottomRight:O}=Fi(g),{x:P,y:j}=n,{width:Y,height:K}=c;let xe,pe,Ie,Me,Ce,Pe;return"center"===d?(Ce=j+K/2,"left"===h?(xe=P,pe=xe-m,Me=Ce+m,Pe=Ce-m):(xe=P+Y,pe=xe+m,Me=Ce-m,Pe=Ce+m),Ie=xe):(pe="left"===h?P+Math.max(y,S)+m:"right"===h?P+Y-Math.max(b,O)-m:this.caretX,"top"===d?(Me=j,Ce=Me-m,xe=pe-m,Ie=pe+m):(Me=j+K,Ce=Me+m,xe=pe+m,Ie=pe-m),Pe=Me),{x1:xe,x2:pe,x3:Ie,y1:Me,y2:Ce,y3:Pe}}drawTitle(n,c,l){const h=this.title,d=h.length;let m,g,y;if(d){const b=ta(l.rtl,this.x,this.width);for(n.x=So(this,l.titleAlign,l),c.textAlign=b.textAlign(l.titleAlign),c.textBaseline="middle",m=wr(l.titleFont),g=l.titleSpacing,c.fillStyle=l.titleColor,c.font=m.string,y=0;y<d;++y)c.fillText(h[y],b.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+g,y+1===d&&(n.y+=l.titleMarginBottom-g)}}_drawColorBox(n,c,l,h,d){const m=this.labelColors[l],g=this.labelPointStyles[l],{boxHeight:y,boxWidth:b}=d,S=wr(d.bodyFont),O=So(this,"left",d),P=h.x(O),Y=c.y+(y<S.lineHeight?(S.lineHeight-y)/2:0);if(d.usePointStyle){const K={radius:Math.min(b,y)/2,pointStyle:g.pointStyle,rotation:g.rotation,borderWidth:1},xe=h.leftForLtr(P,b)+b/2,pe=Y+y/2;n.strokeStyle=d.multiKeyBackground,n.fillStyle=d.multiKeyBackground,sc(n,K,xe,pe),n.strokeStyle=m.borderColor,n.fillStyle=m.backgroundColor,sc(n,K,xe,pe)}else{n.lineWidth=It(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,n.strokeStyle=m.borderColor,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset||0;const K=h.leftForLtr(P,b),xe=h.leftForLtr(h.xPlus(P,1),b-2),pe=Fi(m.borderRadius);Object.values(pe).some(Ie=>0!==Ie)?(n.beginPath(),n.fillStyle=d.multiKeyBackground,Aa(n,{x:K,y:Y,w:b,h:y,radius:pe}),n.fill(),n.stroke(),n.fillStyle=m.backgroundColor,n.beginPath(),Aa(n,{x:xe,y:Y+1,w:b-2,h:y-2,radius:pe}),n.fill()):(n.fillStyle=d.multiKeyBackground,n.fillRect(K,Y,b,y),n.strokeRect(K,Y,b,y),n.fillStyle=m.backgroundColor,n.fillRect(xe,Y+1,b-2,y-2))}n.fillStyle=this.labelTextColors[l]}drawBody(n,c,l){const{body:h}=this,{bodySpacing:d,bodyAlign:m,displayColors:g,boxHeight:y,boxWidth:b,boxPadding:S}=l,O=wr(l.bodyFont);let P=O.lineHeight,j=0;const Y=ta(l.rtl,this.x,this.width),K=function(dt){c.fillText(dt,Y.x(n.x+j),n.y+P/2),n.y+=P+d},xe=Y.textAlign(m);let pe,Ie,Me,Ce,Pe,rt,Ve;for(c.textAlign=m,c.textBaseline="middle",c.font=O.string,n.x=So(this,xe,l),c.fillStyle=l.bodyColor,Xt(this.beforeBody,K),j=g&&"right"!==xe?"center"===m?b/2+S:b+2+S:0,Ce=0,rt=h.length;Ce<rt;++Ce){for(pe=h[Ce],Ie=this.labelTextColors[Ce],c.fillStyle=Ie,Xt(pe.before,K),Me=pe.lines,g&&Me.length&&(this._drawColorBox(c,n,Ce,Y,l),P=Math.max(O.lineHeight,y)),Pe=0,Ve=Me.length;Pe<Ve;++Pe)K(Me[Pe]),P=O.lineHeight;Xt(pe.after,K)}j=0,P=O.lineHeight,Xt(this.afterBody,K),n.y-=d}drawFooter(n,c,l){const h=this.footer,d=h.length;let m,g;if(d){const y=ta(l.rtl,this.x,this.width);for(n.x=So(this,l.footerAlign,l),n.y+=l.footerMarginTop,c.textAlign=y.textAlign(l.footerAlign),c.textBaseline="middle",m=wr(l.footerFont),c.fillStyle=l.footerColor,c.font=m.string,g=0;g<d;++g)c.fillText(h[g],y.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+l.footerSpacing}}drawBackground(n,c,l,h){const{xAlign:d,yAlign:m}=this,{x:g,y}=n,{width:b,height:S}=l,{topLeft:O,topRight:P,bottomLeft:j,bottomRight:Y}=Fi(h.cornerRadius);c.fillStyle=h.backgroundColor,c.strokeStyle=h.borderColor,c.lineWidth=h.borderWidth,c.beginPath(),c.moveTo(g+O,y),"top"===m&&this.drawCaret(n,c,l,h),c.lineTo(g+b-P,y),c.quadraticCurveTo(g+b,y,g+b,y+P),"center"===m&&"right"===d&&this.drawCaret(n,c,l,h),c.lineTo(g+b,y+S-Y),c.quadraticCurveTo(g+b,y+S,g+b-Y,y+S),"bottom"===m&&this.drawCaret(n,c,l,h),c.lineTo(g+j,y+S),c.quadraticCurveTo(g,y+S,g,y+S-j),"center"===m&&"left"===d&&this.drawCaret(n,c,l,h),c.lineTo(g,y+O),c.quadraticCurveTo(g,y,g+O,y),c.closePath(),c.fill(),h.borderWidth>0&&c.stroke()}_updateAnimationTarget(n){const c=this.chart,l=this.$animations,h=l&&l.x,d=l&&l.y;if(h||d){const m=Wa[n.position].call(this,this._active,this._eventPosition);if(!m)return;const g=this._size=Hi(this,n),y=Object.assign({},m,this._size),b=hf(c,n,y),S=Eo(n,y,b,c);(h._to!==S.x||d._to!==S.y)&&(this.xAlign=b.xAlign,this.yAlign=b.yAlign,this.width=g.width,this.height=g.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(n){const c=this.options.setContext(this.getContext());let l=this.opacity;if(!l)return;this._updateAnimationTarget(c);const h={width:this.width,height:this.height},d={x:this.x,y:this.y};l=Math.abs(l)<.001?0:l;const m=Gr(c.padding);c.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(n.save(),n.globalAlpha=l,this.drawBackground(d,n,h,c),Hr(n,c.textDirection),d.y+=m.top,this.drawTitle(d,n,c),this.drawBody(d,n,c),this.drawFooter(d,n,c),Xr(n,c.textDirection),n.restore())}getActiveElements(){return this._active||[]}setActiveElements(n,c){const l=this._active,h=n.map(({datasetIndex:g,index:y})=>{const b=this.chart.getDatasetMeta(g);if(!b)throw new Error("Cannot find a dataset at index "+g);return{datasetIndex:g,element:b.data[y],index:y}}),d=!Qn(l,h),m=this._positionChanged(h,c);(d||m)&&(this._active=h,this._eventPosition=c,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(n,c,l=!0){if(c&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const h=this.options,d=this._active||[],m=this._getActiveElements(n,d,c,l),g=this._positionChanged(m,n),y=c||!Qn(m,d)||g;return y&&(this._active=m,(h.enabled||h.external)&&(this._eventPosition={x:n.x,y:n.y},this.update(!0,c))),y}_getActiveElements(n,c,l,h){const d=this.options;if("mouseout"===n.type)return[];if(!h)return c.filter(g=>this.chart.data.datasets[g.datasetIndex]&&void 0!==this.chart.getDatasetMeta(g.datasetIndex).controller.getParsed(g.index));const m=this.chart.getElementsAtEventForMode(n,d.mode,d,l);return d.reverse&&m.reverse(),m}_positionChanged(n,c){const{caretX:l,caretY:h,options:d}=this,m=Wa[d.position].call(this,n,c);return!1!==m&&(l!==m.x||h!==m.y)}})();var bd={id:"tooltip",_element:mf,positioners:Wa,afterInit(i,a,n){n&&(i.tooltip=new mf({chart:i,options:n}))},beforeUpdate(i,a,n){i.tooltip&&i.tooltip.initialize(n)},reset(i,a,n){i.tooltip&&i.tooltip.initialize(n)},afterDraw(i){const a=i.tooltip;if(a&&a._willRender()){const n={tooltip:a};if(!1===i.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;a.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",n)}},afterEvent(i,a){i.tooltip&&i.tooltip.handleEvent(a.event,a.replay,a.inChartArea)&&(a.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,a)=>a.bodyFont.size,boxWidth:(i,a)=>a.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:pf},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>"filter"!==i&&"itemSort"!==i&&"external"!==i,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},kd=Object.freeze({__proto__:null,Colors:Uu,Decimation:Vu,Filler:sd,Legend:ud,SubTitle:ff,Title:pd,Tooltip:bd});function si(i){const a=this.getLabels();return i>=0&&i<a.length?a[i]:i}let Ed=(()=>class i extends Ri{static id="category";static defaults={ticks:{callback:si}};constructor(n){super(n),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(n){const c=this._addedLabels;if(c.length){const l=this.getLabels();for(const{index:h,label:d}of c)l[h]===d&&l.splice(h,1);this._addedLabels=[]}super.init(n)}parse(n,c){if(Pt(n))return null;const l=this.getLabels();return((i,a)=>null===i?null:Rt(Math.round(i),0,a))(c=isFinite(c)&&l[c]===n?c:function Cd(i,a,n,c){const l=i.indexOf(a);return-1===l?((i,a,n,c)=>("string"==typeof a?(n=i.push(a)-1,c.unshift({index:n,label:a})):isNaN(a)&&(n=null),n))(i,a,n,c):l!==i.lastIndexOf(a)?n:l}(l,n,Tt(c,n),this._addedLabels),l.length-1)}determineDataLimits(){const{minDefined:n,maxDefined:c}=this.getUserBounds();let{min:l,max:h}=this.getMinMax(!0);"ticks"===this.options.bounds&&(n||(l=0),c||(h=this.getLabels().length-1)),this.min=l,this.max=h}buildTicks(){const n=this.min,c=this.max,l=this.options.offset,h=[];let d=this.getLabels();d=0===n&&c===d.length-1?d:d.slice(n,c+1),this._valueRange=Math.max(d.length-(l?0:1),1),this._startValue=this.min-(l?.5:0);for(let m=n;m<=c;m++)h.push({value:m});return h}getLabelForValue(n){return si.call(this,n)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(n){return"number"!=typeof n&&(n=this.parse(n)),null===n?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getPixelForTick(n){const c=this.ticks;return n<0||n>c.length-1?null:this.getPixelForValue(c[n].value)}getValueForPixel(n){return Math.round(this._startValue+this.getDecimalForPixel(n)*this._valueRange)}getBasePixel(){return this.bottom}})();function xf(i,a,{horizontal:n,minRotation:c}){const l=M(c),h=(n?Math.sin(l):Math.cos(l))||.001;return Math.min(a/h,.75*a*(""+i).length)}class Ao extends Ri{constructor(a){super(a),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(a,n){return Pt(a)||("number"==typeof a||a instanceof Number)&&!isFinite(+a)?null:+a}handleTickRangeOptions(){const{beginAtZero:a}=this.options,{minDefined:n,maxDefined:c}=this.getUserBounds();let{min:l,max:h}=this;const d=g=>l=n?l:g,m=g=>h=c?h:g;if(a){const g=On(l),y=On(h);g<0&&y<0?m(0):g>0&&y>0&&d(0)}if(l===h){let g=0===h?1:Math.abs(.05*h);m(h+g),a||d(l-g)}this.min=l,this.max=h}getTickLimit(){const a=this.options.ticks;let l,{maxTicksLimit:n,stepSize:c}=a;return c?(l=Math.ceil(this.max/c)-Math.floor(this.min/c)+1,l>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${c} would result generating up to ${l} ticks. Limiting to 1000.`),l=1e3)):(l=this.computeTickLimit(),n=n||11),n&&(l=Math.min(n,l)),l}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const a=this.options,n=a.ticks;let c=this.getTickLimit();c=Math.max(2,c);const d=function Sd(i,a){const n=[],{bounds:l,step:h,min:d,max:m,precision:g,count:y,maxTicks:b,maxDigits:S,includeBounds:O}=i,P=h||1,j=b-1,{min:Y,max:K}=a,xe=!Pt(d),pe=!Pt(m),Ie=!Pt(y),Me=(K-Y)/(S+1);let Pe,rt,Ve,dt,Ce=ti((K-Y)/j/P)*P;if(Ce<1e-14&&!xe&&!pe)return[{value:Y},{value:K}];dt=Math.ceil(K/Ce)-Math.floor(Y/Ce),dt>j&&(Ce=ti(dt*Ce/j/P)*P),Pt(g)||(Pe=Math.pow(10,g),Ce=Math.ceil(Ce*Pe)/Pe),"ticks"===l?(rt=Math.floor(Y/Ce)*Ce,Ve=Math.ceil(K/Ce)*Ce):(rt=Y,Ve=K),xe&&pe&&h&&function me(i,a){const n=Math.round(i);return n-a<=i&&n+a>=i}((m-d)/h,Ce/1e3)?(dt=Math.round(Math.min((m-d)/Ce,b)),Ce=(m-d)/dt,rt=d,Ve=m):Ie?(rt=xe?d:rt,Ve=pe?m:Ve,dt=y-1,Ce=(Ve-rt)/dt):(dt=(Ve-rt)/Ce,dt=Ei(dt,Math.round(dt),Ce/1e3)?Math.round(dt):Math.ceil(dt));const Dt=Math.max(Z(Ce),Z(rt));Pe=Math.pow(10,Pt(g)?Dt:g),rt=Math.round(rt*Pe)/Pe,Ve=Math.round(Ve*Pe)/Pe;let Ft=0;for(xe&&(O&&rt!==d?(n.push({value:d}),rt<d&&Ft++,Ei(Math.round((rt+Ft*Ce)*Pe)/Pe,d,xf(d,Me,i))&&Ft++):rt<d&&Ft++);Ft<dt;++Ft){const Mt=Math.round((rt+Ft*Ce)*Pe)/Pe;if(pe&&Mt>m)break;n.push({value:Mt})}return pe&&O&&Ve!==m?n.length&&Ei(n[n.length-1].value,m,xf(m,Me,i))?n[n.length-1].value=m:n.push({value:m}):(!pe||Ve===m)&&n.push({value:Ve}),n}({maxTicks:c,bounds:a.bounds,min:a.min,max:a.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:!1!==n.includeBounds},this._range||this);return"ticks"===a.bounds&&gt(d,this,"value"),a.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const a=this.ticks;let n=this.min,c=this.max;if(super.configure(),this.options.offset&&a.length){const l=(c-n)/Math.max(a.length-1,1)/2;n-=l,c+=l}this._startValue=n,this._endValue=c,this._valueRange=c-n}getLabelForValue(a){return fs(a,this.chart.options.locale,this.options.ticks.format)}}const Ss=i=>Math.floor(Ur(i)),Wi=(i,a)=>Math.pow(10,Ss(i)+a);function Xc(i){return i/Math.pow(10,Ss(i))==1}function _f(i,a,n){const c=Math.pow(10,n),l=Math.floor(i/c);return Math.ceil(a/c)-l}function Yc(i){const a=i.ticks;if(a.display&&i.display){const n=Gr(a.backdropPadding);return Tt(a.font&&a.font.size,ar.font.size)+n.height}return 0}function Id(i,a,n){return n=Vt(n)?n:[n],{w:Rl(i,a.string,n),h:n.length*a.lineHeight}}function Fo(i,a,n,c,l){return i===c||i===l?{start:a-n/2,end:a+n/2}:i<c||i>l?{start:a-n,end:a}:{start:a,end:a+n}}function Pd(i,a,n,c,l){const h=Math.abs(Math.sin(n)),d=Math.abs(Math.cos(n));let m=0,g=0;c.start<a.l?(m=(a.l-c.start)/h,i.l=Math.min(i.l,a.l-m)):c.end>a.r&&(m=(c.end-a.r)/h,i.r=Math.max(i.r,a.r+m)),l.start<a.t?(g=(a.t-l.start)/d,i.t=Math.min(i.t,a.t-g)):l.end>a.b&&(g=(l.end-a.b)/d,i.b=Math.max(i.b,a.b+g))}function Md(i,a,n){const c=i.drawingArea,{extra:l,additionalAngle:h,padding:d,size:m}=n,g=i.getPointPosition(a,c+l+d,h),y=Math.round(Q(lt(g.angle+gr))),b=function Bd(i,a,n){return 90===n||270===n?i-=a/2:(n>270||n<90)&&(i-=a),i}(g.y,m.h,y),S=function Nd(i){return 0===i||180===i?"center":i<180?"left":"right"}(y),O=function wf(i,a,n){return"right"===n?i-=a:"center"===n&&(i-=a/2),i}(g.x,m.w,S);return{visible:!0,x:g.x,y:b,textAlign:S,left:O,top:b,right:O+m.w,bottom:b+m.h}}function Rd(i,a){if(!a)return!0;const{left:n,top:c,right:l,bottom:h}=i;return!(mt({x:n,y:c},a)||mt({x:n,y:h},a)||mt({x:l,y:c},a)||mt({x:l,y:h},a))}function As(i,a,n){const{left:c,top:l,right:h,bottom:d}=n,{backdropColor:m}=a;if(!Pt(m)){const g=Fi(a.borderRadius),y=Gr(a.backdropPadding);i.fillStyle=m;const b=c-y.left,S=l-y.top,O=h-c+y.width,P=d-l+y.height;Object.values(g).some(j=>0!==j)?(i.beginPath(),Aa(i,{x:b,y:S,w:O,h:P,radius:g}),i.fill()):i.fillRect(b,S,O,P)}}function yf(i,a,n,c){const{ctx:l}=i;if(n)l.arc(i.xCenter,i.yCenter,a,0,ir);else{let h=i.getPointPosition(0,a);l.moveTo(h.x,h.y);for(let d=1;d<c;d++)h=i.getPointPosition(d,a),l.lineTo(h.x,h.y)}}const Oo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Jt=Object.keys(Oo);function Va(i,a){return i-a}function za(i,a){if(Pt(a))return null;const n=i._adapter,{parser:c,round:l,isoWeekday:h}=i._parseOpts;let d=a;return"function"==typeof c&&(d=c(d)),ur(d)||(d="string"==typeof c?n.parse(d,c):n.parse(d)),null===d?null:(l&&(d="week"!==l||!di(h)&&!0!==h?n.startOf(d,l):n.startOf(d,"isoWeek",h)),+d)}function Fs(i,a,n,c){const l=Jt.length;for(let h=Jt.indexOf(i);h<l-1;++h){const d=Oo[Jt[h]];if(d.common&&Math.ceil((n-a)/((d.steps?d.steps:Number.MAX_SAFE_INTEGER)*d.size))<=c)return Jt[h]}return Jt[l-1]}function xi(i,a,n){if(n){if(n.length){const{lo:c,hi:l}=Jr(n,a);i[n[c]>=a?n[c]:n[l]]=!0}}else i[a]=!0}function Jc(i,a,n){const c=[],l={},h=a.length;let d,m;for(d=0;d<h;++d)m=a[d],l[m]=d,c.push({value:m,major:!1});return 0!==h&&n?function Wd(i,a,n,c){const l=i._adapter,h=+l.startOf(a[0].value,c),d=a[a.length-1].value;let m,g;for(m=h;m<=d;m=+l.add(m,1,c))g=n[m],g>=0&&(a[g].major=!0);return a}(i,c,l,n):c}let pa=(()=>class i extends Ri{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(n){super(n),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(n,c={}){const l=n.time||(n.time={}),h=this._adapter=new po__date(n.adapters.date);h.init(c),Ti(l.displayFormats,h.formats()),this._parseOpts={parser:l.parser,round:l.round,isoWeekday:l.isoWeekday},super.init(n),this._normalized=c.normalized}parse(n,c){return void 0===n?null:za(this,n)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const n=this.options,c=this._adapter,l=n.time.unit||"day";let{min:h,max:d,minDefined:m,maxDefined:g}=this.getUserBounds();function y(b){!m&&!isNaN(b.min)&&(h=Math.min(h,b.min)),!g&&!isNaN(b.max)&&(d=Math.max(d,b.max))}(!m||!g)&&(y(this._getLabelBounds()),("ticks"!==n.bounds||"labels"!==n.ticks.source)&&y(this.getMinMax(!1))),h=ur(h)&&!isNaN(h)?h:+c.startOf(Date.now(),l),d=ur(d)&&!isNaN(d)?d:+c.endOf(Date.now(),l)+1,this.min=Math.min(h,d-1),this.max=Math.max(h+1,d)}_getLabelBounds(){const n=this.getLabelTimestamps();let c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return n.length&&(c=n[0],l=n[n.length-1]),{min:c,max:l}}buildTicks(){const n=this.options,c=n.time,l=n.ticks,h="labels"===l.source?this.getLabelTimestamps():this._generate();"ticks"===n.bounds&&h.length&&(this.min=this._userMin||h[0],this.max=this._userMax||h[h.length-1]);const d=this.min,g=function Un(i,a,n){let c=0,l=i.length;for(;c<l&&i[c]<a;)c++;for(;l>c&&i[l-1]>n;)l--;return c>0||l<i.length?i.slice(c,l):i}(h,d,this.max);return this._unit=c.unit||(l.autoSkip?Fs(c.minUnit,this.min,this.max,this._getLabelCapacity(d)):function Zc(i,a,n,c,l){for(let h=Jt.length-1;h>=Jt.indexOf(n);h--){const d=Jt[h];if(Oo[d].common&&i._adapter.diff(l,c,d)>=a-1)return d}return Jt[n?Jt.indexOf(n):0]}(this,g.length,c.minUnit,this.min,this.max)),this._majorUnit=l.major.enabled&&"year"!==this._unit?function Kc(i){for(let a=Jt.indexOf(i)+1,n=Jt.length;a<n;++a)if(Oo[Jt[a]].common)return Jt[a]}(this._unit):void 0,this.initOffsets(h),n.reverse&&g.reverse(),Jc(this,g,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(n=>+n.value))}initOffsets(n=[]){let h,d,c=0,l=0;this.options.offset&&n.length&&(h=this.getDecimalForValue(n[0]),c=1===n.length?1-h:(this.getDecimalForValue(n[1])-h)/2,d=this.getDecimalForValue(n[n.length-1]),l=1===n.length?d:(d-this.getDecimalForValue(n[n.length-2]))/2);const m=n.length<3?.5:.25;c=Rt(c,0,m),l=Rt(l,0,m),this._offsets={start:c,end:l,factor:1/(c+1+l)}}_generate(){const n=this._adapter,c=this.min,l=this.max,h=this.options,d=h.time,m=d.unit||Fs(d.minUnit,c,l,this._getLabelCapacity(c)),g=Tt(h.ticks.stepSize,1),y="week"===m&&d.isoWeekday,b=di(y)||!0===y,S={};let P,j,O=c;if(b&&(O=+n.startOf(O,"isoWeek",y)),O=+n.startOf(O,b?"day":m),n.diff(l,c,m)>1e5*g)throw new Error(c+" and "+l+" are too far apart with stepSize of "+g+" "+m);const Y="data"===h.ticks.source&&this.getDataTimestamps();for(P=O,j=0;P<l;P=+n.add(P,g,m),j++)xi(S,P,Y);return(P===l||"ticks"===h.bounds||1===j)&&xi(S,P,Y),Object.keys(S).sort(Va).map(K=>+K)}getLabelForValue(n){const l=this.options.time;return this._adapter.format(n,l.tooltipFormat?l.tooltipFormat:l.displayFormats.datetime)}format(n,c){return this._adapter.format(n,c||this.options.time.displayFormats[this._unit])}_tickFormatFunction(n,c,l,h){const d=this.options,m=d.ticks.callback;if(m)return Qt(m,[n,c,l],this);const g=d.time.displayFormats,y=this._unit,b=this._majorUnit,O=b&&g[b],P=l[c];return this._adapter.format(n,h||(b&&O&&P&&P.major?O:y&&g[y]))}generateTickLabels(n){let c,l,h;for(c=0,l=n.length;c<l;++c)h=n[c],h.label=this._tickFormatFunction(h.value,c,n)}getDecimalForValue(n){return null===n?NaN:(n-this.min)/(this.max-this.min)}getPixelForValue(n){const c=this._offsets,l=this.getDecimalForValue(n);return this.getPixelForDecimal((c.start+l)*c.factor)}getValueForPixel(n){const c=this._offsets,l=this.getDecimalForPixel(n)/c.factor-c.end;return this.min+l*(this.max-this.min)}_getLabelSize(n){const c=this.options.ticks,l=this.ctx.measureText(n).width,h=M(this.isHorizontal()?c.maxRotation:c.minRotation),d=Math.cos(h),m=Math.sin(h),g=this._resolveTickFontOptions(0).size;return{w:l*d+g*m,h:l*m+g*d}}_getLabelCapacity(n){const c=this.options.time,l=c.displayFormats,h=l[c.unit]||l.millisecond,d=this._tickFormatFunction(n,0,Jc(this,[n],this._majorUnit),h),m=this._getLabelSize(d),g=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return g>0?g:1}getDataTimestamps(){let c,l,n=this._cache.data||[];if(n.length)return n;const h=this.getMatchingVisibleMetas();if(this._normalized&&h.length)return this._cache.data=h[0].controller.getAllParsedValues(this);for(c=0,l=h.length;c<l;++c)n=n.concat(h[c].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const n=this._cache.labels||[];let c,l;if(n.length)return n;const h=this.getLabels();for(c=0,l=h.length;c<l;++c)n.push(za(this,h[c]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(n){return ss(n.sort(Va))}})();function _i(i,a,n){let h,d,m,g,c=0,l=i.length-1;n?(a>=i[c].pos&&a<=i[l].pos&&({lo:c,hi:l}=mn(i,"pos",a)),({pos:h,time:m}=i[c]),({pos:d,time:g}=i[l])):(a>=i[c].time&&a<=i[l].time&&({lo:c,hi:l}=mn(i,"time",a)),({time:h,pos:m}=i[c]),({time:d,pos:g}=i[l]));const y=d-h;return y?m+(g-m)*(a-h)/y:m}var zd=Object.freeze({__proto__:null,CategoryScale:Ed,LinearScale:class Ad extends Ao{static id="linear";static defaults={ticks:{callback:xr.formatters.numeric}};determineDataLimits(){const{min:a,max:n}=this.getMinMax(!0);this.min=ur(a)?a:0,this.max=ur(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const a=this.isHorizontal(),n=a?this.width:this.height,c=M(this.options.ticks.minRotation),l=(a?Math.sin(c):Math.cos(c))||.001,h=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,h.lineHeight/l))}getPixelForValue(a){return null===a?NaN:this.getPixelForDecimal((a-this._startValue)/this._valueRange)}getValueForPixel(a){return this._startValue+this.getDecimalForPixel(a)*this._valueRange}},LogarithmicScale:class Od extends Ri{static id="logarithmic";static defaults={ticks:{callback:xr.formatters.logarithmic,major:{enabled:!0}}};constructor(a){super(a),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(a,n){const c=Ao.prototype.parse.apply(this,[a,n]);if(0!==c)return ur(c)&&c>0?c:null;this._zero=!0}determineDataLimits(){const{min:a,max:n}=this.getMinMax(!0);this.min=ur(a)?Math.max(0,a):null,this.max=ur(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ur(this._userMin)&&(this.min=a===Wi(this.min,0)?Wi(this.min,-1):Wi(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:a,maxDefined:n}=this.getUserBounds();let c=this.min,l=this.max;const h=m=>c=a?c:m,d=m=>l=n?l:m;c===l&&(c<=0?(h(1),d(10)):(h(Wi(c,-1)),d(Wi(l,1)))),c<=0&&h(Wi(l,-1)),l<=0&&d(Wi(c,1)),this.min=c,this.max=l}buildTicks(){const a=this.options,c=function Dd(i,{min:a,max:n}){a=an(i.min,a);const c=[],l=Ss(a);let h=function Fd(i,a){let c=Ss(a-i);for(;_f(i,a,c)>10;)c++;for(;_f(i,a,c)<10;)c--;return Math.min(c,Ss(i))}(a,n),d=h<0?Math.pow(10,Math.abs(h)):1;const m=Math.pow(10,h),g=l>h?Math.pow(10,l):0,y=Math.round((a-g)*d)/d,b=Math.floor((a-g)/m/10)*m*10;let S=Math.floor((y-b)/Math.pow(10,h)),O=an(i.min,Math.round((g+b+S*Math.pow(10,h))*d)/d);for(;O<n;)c.push({value:O,major:Xc(O),significand:S}),S>=10?S=S<15?15:20:S++,S>=20&&(h++,S=2,d=h>=0?1:d),O=Math.round((g+b+S*Math.pow(10,h))*d)/d;const P=an(i.max,O);return c.push({value:P,major:Xc(P),significand:S}),c}({min:this._userMin,max:this._userMax},this);return"ticks"===a.bounds&&gt(c,this,"value"),a.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}getLabelForValue(a){return void 0===a?"0":fs(a,this.chart.options.locale,this.options.ticks.format)}configure(){const a=this.min;super.configure(),this._startValue=Ur(a),this._valueRange=Ur(this.max)-Ur(a)}getPixelForValue(a){return(void 0===a||0===a)&&(a=this.min),null===a||isNaN(a)?NaN:this.getPixelForDecimal(a===this.min?0:(Ur(a)-this._startValue)/this._valueRange)}getValueForPixel(a){const n=this.getDecimalForPixel(a);return Math.pow(10,this._startValue+n*this._valueRange)}},RadialLinearScale:class Hd extends Ao{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:xr.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:a=>a,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(a){super(a),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const a=this._padding=Gr(Yc(this.options)/2),n=this.width=this.maxWidth-a.width,c=this.height=this.maxHeight-a.height;this.xCenter=Math.floor(this.left+n/2+a.left),this.yCenter=Math.floor(this.top+c/2+a.top),this.drawingArea=Math.floor(Math.min(n,c)/2)}determineDataLimits(){const{min:a,max:n}=this.getMinMax(!1);this.min=ur(a)&&!isNaN(a)?a:0,this.max=ur(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Yc(this.options))}generateTickLabels(a){Ao.prototype.generateTickLabels.call(this,a),this._pointLabels=this.getLabels().map((n,c)=>{const l=Qt(this.options.pointLabels.callback,[n,c],this);return l||0===l?l:""}).filter((n,c)=>this.chart.getDataVisibility(c))}fit(){const a=this.options;a.display&&a.pointLabels.display?function vf(i){const a={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},n=Object.assign({},a),c=[],l=[],h=i._pointLabels.length,d=i.options.pointLabels,m=d.centerPointLabels?qt/h:0;for(let g=0;g<h;g++){const y=d.setContext(i.getPointLabelContext(g));l[g]=y.padding;const b=i.getPointPosition(g,i.drawingArea+l[g],m),S=wr(y.font),O=Id(i.ctx,S,i._pointLabels[g]);c[g]=O;const P=lt(i.getIndexAngle(g)+m),j=Math.round(Q(P));Pd(n,a,P,Fo(j,b.x,O.w,0,180),Fo(j,b.y,O.h,90,270))}i.setCenterPoint(a.l-n.l,n.r-a.r,a.t-n.t,n.b-a.b),i._pointLabelItems=function Ld(i,a,n){const c=[],l=i._pointLabels.length,h=i.options,{centerPointLabels:d,display:m}=h.pointLabels,g={extra:Yc(h)/2,additionalAngle:d?qt/l:0};let y;for(let b=0;b<l;b++){g.padding=n[b],g.size=a[b];const S=Md(i,b,g);c.push(S),"auto"===m&&(S.visible=Rd(S,y),S.visible&&(y=S))}return c}(i,c,l)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(a,n,c,l){this.xCenter+=Math.floor((a-n)/2),this.yCenter+=Math.floor((c-l)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(a,n,c,l))}getIndexAngle(a){return lt(a*(ir/(this._pointLabels.length||1))+M(this.options.startAngle||0))}getDistanceFromCenterForValue(a){if(Pt(a))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-a)*n:(a-this.min)*n}getValueForDistanceFromCenter(a){if(Pt(a))return NaN;const n=a/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(a){const n=this._pointLabels||[];if(a>=0&&a<n.length){const c=n[a];return function bf(i,a,n){return In(i,{label:n,index:a,type:"pointLabel"})}(this.getContext(),a,c)}}getPointPosition(a,n,c=0){const l=this.getIndexAngle(a)-gr+c;return{x:Math.cos(l)*n+this.xCenter,y:Math.sin(l)*n+this.yCenter,angle:l}}getPointPositionForValue(a,n){return this.getPointPosition(a,this.getDistanceFromCenterForValue(n))}getBasePosition(a){return this.getPointPositionForValue(a||0,this.getBaseValue())}getPointLabelPosition(a){const{left:n,top:c,right:l,bottom:h}=this._pointLabelItems[a];return{left:n,top:c,right:l,bottom:h}}drawBackground(){const{backgroundColor:a,grid:{circular:n}}=this.options;if(a){const c=this.ctx;c.save(),c.beginPath(),yf(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),c.closePath(),c.fillStyle=a,c.fill(),c.restore()}}drawGrid(){const a=this.ctx,n=this.options,{angleLines:c,grid:l,border:h}=n,d=this._pointLabels.length;let m,g,y;if(n.pointLabels.display&&function Ud(i,a){const{ctx:n,options:{pointLabels:c}}=i;for(let l=a-1;l>=0;l--){const h=i._pointLabelItems[l];if(!h.visible)continue;const d=c.setContext(i.getPointLabelContext(l));As(n,d,h);const m=wr(d.font),{x:g,y,textAlign:b}=h;Ai(n,i._pointLabels[l],g,y+m.lineHeight/2,m,{color:d.color,textAlign:b,textBaseline:"middle"})}}(this,d),l.display&&this.ticks.forEach((b,S)=>{if(0!==S){g=this.getDistanceFromCenterForValue(b.value);const O=this.getContext(S),P=l.setContext(O),j=h.setContext(O);!function Do(i,a,n,c,l){const h=i.ctx,d=a.circular,{color:m,lineWidth:g}=a;!d&&!c||!m||!g||n<0||(h.save(),h.strokeStyle=m,h.lineWidth=g,h.setLineDash(l.dash),h.lineDashOffset=l.dashOffset,h.beginPath(),yf(i,n,d,c),h.closePath(),h.stroke(),h.restore())}(this,P,g,d,j)}}),c.display){for(a.save(),m=d-1;m>=0;m--){const b=c.setContext(this.getPointLabelContext(m)),{color:S,lineWidth:O}=b;!O||!S||(a.lineWidth=O,a.strokeStyle=S,a.setLineDash(b.borderDash),a.lineDashOffset=b.borderDashOffset,g=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),y=this.getPointPosition(m,g),a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(y.x,y.y),a.stroke())}a.restore()}}drawBorder(){}drawLabels(){const a=this.ctx,n=this.options,c=n.ticks;if(!c.display)return;const l=this.getIndexAngle(0);let h,d;a.save(),a.translate(this.xCenter,this.yCenter),a.rotate(l),a.textAlign="center",a.textBaseline="middle",this.ticks.forEach((m,g)=>{if(0===g&&!n.reverse)return;const y=c.setContext(this.getContext(g)),b=wr(y.font);if(h=this.getDistanceFromCenterForValue(this.ticks[g].value),y.showLabelBackdrop){a.font=b.string,d=a.measureText(m.label).width,a.fillStyle=y.backdropColor;const S=Gr(y.backdropPadding);a.fillRect(-d/2-S.left,-h-b.size/2-S.top,d+S.width,b.size+S.height)}Ai(a,m.label,0,-h,b,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),a.restore()}drawTitle(){}},TimeScale:pa,TimeSeriesScale:class Vd extends pa{static id="timeseries";static defaults=pa.defaults;constructor(a){super(a),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const a=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(a);this._minPos=_i(n,this.min),this._tableRange=_i(n,this.max)-this._minPos,super.initOffsets(a)}buildLookupTable(a){const{min:n,max:c}=this,l=[],h=[];let d,m,g,y,b;for(d=0,m=a.length;d<m;++d)y=a[d],y>=n&&y<=c&&l.push(y);if(l.length<2)return[{time:n,pos:0},{time:c,pos:1}];for(d=0,m=l.length;d<m;++d)b=l[d+1],g=l[d-1],y=l[d],Math.round((b+g)/2)!==y&&h.push({time:y,pos:d/(m-1)});return h}_generate(){const a=this.min,n=this.max;let c=super.getDataTimestamps();return(!c.includes(a)||!c.length)&&c.splice(0,0,a),(!c.includes(n)||1===c.length)&&c.push(n),c.sort((l,h)=>l-h)}_getTimestampsForTable(){let a=this._cache.all||[];if(a.length)return a;const n=this.getDataTimestamps(),c=this.getLabelTimestamps();return a=n.length&&c.length?this.normalize(n.concat(c)):n.length?n:c,a=this._cache.all=a,a}getDecimalForValue(a){return(_i(this._table,a)-this._minPos)/this._tableRange}getValueForPixel(a){const n=this._offsets,c=this.getDecimalForPixel(a)/n.factor-n.end;return _i(this._table,c*this._tableRange+this._minPos,!0)}}});const $d=[xn,z0,kd,zd];var Gd=ie(5619),jd=ie(3997);const Mo=function Po(i,a){return i===a||i!=i&&a!=a},Ro=function Yd(i,a){for(var n=i.length;n--;)if(Mo(i[n][0],a))return n;return-1};var Zd=Array.prototype.splice;function ma(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}ma.prototype.clear=function Xd(){this.__data__=[],this.size=0},ma.prototype.delete=function Kd(i){var a=this.__data__,n=Ro(a,i);return!(n<0||(n==a.length-1?a.pop():Zd.call(a,n,1),--this.size,0))},ma.prototype.get=function Qd(i){var a=this.__data__,n=Ro(a,i);return n<0?void 0:a[n][1]},ma.prototype.has=function Qc(i){return Ro(this.__data__,i)>-1},ma.prototype.set=function Tf(i,a){var n=this.__data__,c=Ro(n,i);return c<0?(++this.size,n.push([i,a])):n[c][1]=a,this};const Vi=ma,Cf="object"==typeof global&&global&&global.Object===Object&&global;var hp="object"==typeof self&&self&&self.Object===Object&&self;const $a=Cf||hp||Function("return this")();var dp=$a.Symbol,Ef=Object.prototype,pp=Ef.hasOwnProperty,mp=Ef.toString,Ds=dp?dp.toStringTag:void 0;var vp=Object.prototype.toString;var Af=dp?dp.toStringTag:void 0;const Lo=function bp(i){return null==i?void 0===i?"[object Undefined]":"[object Null]":Af&&Af in Object(i)?function gp(i){var a=pp.call(i,Ds),n=i[Ds];try{i[Ds]=void 0;var c=!0}catch{}var l=mp.call(i);return c&&(a?i[Ds]=n:delete i[Ds]),l}(i):function wp(i){return vp.call(i)}(i)},ga=function kp(i){var a=typeof i;return null!=i&&("object"==a||"function"==a)},tl=function Ap(i){if(!ga(i))return!1;var a=Lo(i);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a};var i,Fp=$a["__core-js_shared__"],Ff=(i=/[^.]+$/.exec(Fp&&Fp.keys&&Fp.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";var Pp=Function.prototype.toString;var Lp=/^\[object .+?Constructor\]$/,Of=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Up=function If(i){return!(!ga(i)||function Dp(i){return!!Ff&&Ff in i}(i))&&(tl(i)?Of:Lp).test(function Df(i){if(null!=i){try{return Pp.call(i)}catch{}try{return i+""}catch{}}return""}(i))},nl=function Wp(i,a){var n=function Pf(i,a){return i?.[a]}(i,a);return Up(n)?n:void 0},Mf=nl($a,"Map"),Os=nl(Object,"create");var Rf=Object.prototype.hasOwnProperty;var qp=Object.prototype.hasOwnProperty;function Xa(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}Xa.prototype.clear=function $p(){this.__data__=Os?Os(null):{},this.size=0},Xa.prototype.delete=function jp(i){var a=this.has(i)&&delete this.__data__[i];return this.size-=a?1:0,a},Xa.prototype.get=function Kp(i){var a=this.__data__;if(Os){var n=a[i];return"__lodash_hash_undefined__"===n?void 0:n}return Rf.call(a,i)?a[i]:void 0},Xa.prototype.has=function ja(i){var a=this.__data__;return Os?void 0!==a[i]:qp.call(a,i)},Xa.prototype.set=function Lf(i,a){var n=this.__data__;return this.size+=this.has(i)?0:1,n[i]=Os&&void 0===a?"__lodash_hash_undefined__":a,this};const sl=Xa,Is=function tm(i,a){var n=i.__data__;return function Nf(i){var a=typeof i;return"string"==a||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==i:null===i}(a)?n["string"==typeof a?"string":"hash"]:n.map};function Ya(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}Ya.prototype.clear=function Fr(){this.size=0,this.__data__={hash:new sl,map:new(Mf||Vi),string:new sl}},Ya.prototype.delete=function rm(i){var a=Is(this,i).delete(i);return this.size-=a?1:0,a},Ya.prototype.get=function im(i){return Is(this,i).get(i)},Ya.prototype.has=function sm(i){return Is(this,i).has(i)},Ya.prototype.set=function cm(i,a){var n=Is(this,i),c=n.size;return n.set(i,a),this.size+=n.size==c?0:1,this};const fm=Ya;function Za(i){var a=this.__data__=new Vi(i);this.size=a.size}Za.prototype.clear=function rp(){this.__data__=new Vi,this.size=0},Za.prototype.delete=function ip(i){var a=this.__data__,n=a.delete(i);return this.size=a.size,n},Za.prototype.get=function sp(i){return this.__data__.get(i)},Za.prototype.has=function cp(i){return this.__data__.has(i)},Za.prototype.set=function hm(i,a){var n=this.__data__;if(n instanceof Vi){var c=n.__data__;if(!Mf||c.length<199)return c.push([i,a]),this.size=++n.size,this;n=this.__data__=new fm(c)}return n.set(i,a),this.size=n.size,this};const dm=Za;var pm=function(){try{var i=nl(Object,"defineProperty");return i({},"",{}),i}catch{}}();const Ps=pm,ol=function mm(i,a,n){"__proto__"==a&&Ps?Ps(i,a,{configurable:!0,enumerable:!0,value:n,writable:!0}):i[a]=n},cl=function gm(i,a,n){(void 0!==n&&!Mo(i[a],n)||void 0===n&&!(a in i))&&ol(i,a,n)};var _m=function xm(i){return function(a,n,c){for(var l=-1,h=Object(a),d=c(a),m=d.length;m--;){var g=d[i?m:++l];if(!1===n(h[g],g,h))break}return a}}();const vm=_m;var Hf="object"==typeof exports&&exports&&!exports.nodeType&&exports,Wf=Hf&&"object"==typeof module&&module&&!module.nodeType&&module,Vf=Wf&&Wf.exports===Hf?$a.Buffer:void 0,zf=Vf?Vf.allocUnsafe:void 0;const $f=$a.Uint8Array,Sm=function Em(i,a){var n=a?function Tm(i){var a=new i.constructor(i.byteLength);return new $f(a).set(new $f(i)),a}(i.buffer):i.buffer;return new i.constructor(n,i.byteOffset,i.length)};var Gf=Object.create,Dm=function(){function i(){}return function(a){if(!ga(a))return{};if(Gf)return Gf(a);i.prototype=a;var n=new i;return i.prototype=void 0,n}}();const Om=Dm;var Ms=function Im(i,a){return function(n){return i(a(n))}}(Object.getPrototypeOf,Object);const No=Ms;var Pm=Object.prototype;const jf=function Mm(i){var a=i&&i.constructor;return i===("function"==typeof a&&a.prototype||Pm)},Rs=function Lm(i){return null!=i&&"object"==typeof i},Yf=function Bm(i){return Rs(i)&&"[object Arguments]"==Lo(i)};var Zf=Object.prototype,Um=Zf.hasOwnProperty,Hm=Zf.propertyIsEnumerable,Wm=Yf(function(){return arguments}())?Yf:function(i){return Rs(i)&&Um.call(i,"callee")&&!Hm.call(i,"callee")};const ll=Wm,fl=Array.isArray,Jf=function Kf(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=9007199254740991},hl=function $m(i){return null!=i&&Jf(i.length)&&!tl(i)};var Qf="object"==typeof exports&&exports&&!exports.nodeType&&exports,ul=Qf&&"object"==typeof module&&module&&!module.nodeType&&module,Yr=ul&&ul.exports===Qf?$a.Buffer:void 0;const eh=(Yr?Yr.isBuffer:void 0)||function Gm(){return!1};var Bo=Function.prototype.toString,Qm=Object.prototype.hasOwnProperty,Uo=Bo.call(Object);var hr={};hr["[object Float32Array]"]=hr["[object Float64Array]"]=hr["[object Int8Array]"]=hr["[object Int16Array]"]=hr["[object Int32Array]"]=hr["[object Uint8Array]"]=hr["[object Uint8ClampedArray]"]=hr["[object Uint16Array]"]=hr["[object Uint32Array]"]=!0,hr["[object Arguments]"]=hr["[object Array]"]=hr["[object ArrayBuffer]"]=hr["[object Boolean]"]=hr["[object DataView]"]=hr["[object Date]"]=hr["[object Error]"]=hr["[object Function]"]=hr["[object Map]"]=hr["[object Number]"]=hr["[object Object]"]=hr["[object RegExp]"]=hr["[object Set]"]=hr["[object String]"]=hr["[object WeakMap]"]=!1;var ah="object"==typeof exports&&exports&&!exports.nodeType&&exports,Hs=ah&&"object"==typeof module&&module&&!module.nodeType&&module,gl=Hs&&Hs.exports===ah&&Cf.process,gg=function(){try{return Hs&&Hs.require&&Hs.require("util").types||gl&&gl.binding&&gl.binding("util")}catch{}}(),oh=gg&&gg.isTypedArray;const ch=oh?function pg(i){return function(a){return i(a)}}(oh):function dg(i){return Rs(i)&&Jf(i.length)&&!!hr[Lo(i)]},xl=function _g(i,a){if(("constructor"!==a||"function"!=typeof i[a])&&"__proto__"!=a)return i[a]};var wg=Object.prototype.hasOwnProperty;const bg=function yg(i,a,n){var c=i[a];(!wg.call(i,a)||!Mo(c,n)||void 0===n&&!(a in i))&&ol(i,a,n)};var Ag=/^(?:0|[1-9]\d*)$/;const fh=function lh(i,a){var n=typeof i;return!!(a=a??9007199254740991)&&("number"==n||"symbol"!=n&&Ag.test(i))&&i>-1&&i%1==0&&i<a};var Dg=Object.prototype.hasOwnProperty;const Ig=function Og(i,a){var n=fl(i),c=!n&&ll(i),l=!n&&!c&&eh(i),h=!n&&!c&&!l&&ch(i),d=n||c||l||h,m=d?function Cg(i,a){for(var n=-1,c=Array(i);++n<i;)c[n]=a(n);return c}(i.length,String):[],g=m.length;for(var y in i)(a||Dg.call(i,y))&&(!d||!("length"==y||l&&("offset"==y||"parent"==y)||h&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||fh(y,g)))&&m.push(y);return m};var Lg=Object.prototype.hasOwnProperty;const Bg=function Ng(i){if(!ga(i))return function Pg(i){var a=[];if(null!=i)for(var n in Object(i))a.push(n);return a}(i);var a=jf(i),n=[];for(var c in i)"constructor"==c&&(a||!Lg.call(i,c))||n.push(c);return n},hh=function Ug(i){return hl(i)?Ig(i,!0):Bg(i)},Wg=function Hg(i){return function kg(i,a,n,c){var l=!n;n||(n={});for(var h=-1,d=a.length;++h<d;){var m=a[h],g=c?c(n[m],i[m],m,n,i):void 0;void 0===g&&(g=i[m]),l?ol(n,m,g):bg(n,m,g)}return n}(i,hh(i))},zg=function Vg(i,a,n,c,l,h,d){var m=xl(i,n),g=xl(a,n),y=d.get(g);if(y)cl(i,n,y);else{var b=h?h(m,g,n+"",i,a,d):void 0,S=void 0===b;if(S){var O=fl(g),P=!O&&eh(g),j=!O&&!P&&ch(g);b=g,O||P||j?fl(m)?b=m:function Ls(i){return Rs(i)&&hl(i)}(m)?b=function Am(i,a){var n=-1,c=i.length;for(a||(a=Array(c));++n<c;)a[n]=i[n];return a}(m):P?(S=!1,b=function ym(i,a){if(a)return i.slice();var n=i.length,c=zf?zf(n):new i.constructor(n);return i.copy(c),c}(g,!0)):j?(S=!1,b=Sm(g,!0)):b=[]:function qm(i){if(!Rs(i)||"[object Object]"!=Lo(i))return!1;var a=No(i);if(null===a)return!0;var n=Qm.call(a,"constructor")&&a.constructor;return"function"==typeof n&&n instanceof n&&Bo.call(n)==Uo}(g)||ll(g)?(b=m,ll(m)?b=Wg(m):(!ga(m)||tl(m))&&(b=function Rm(i){return"function"!=typeof i.constructor||jf(i)?{}:Om(No(i))}(g))):S=!1}S&&(d.set(g,b),l(b,g,c,h,d),d.delete(g)),cl(i,n,b)}},$g=function uh(i,a,n,c,l){i!==a&&vm(a,function(h,d){if(l||(l=new dm),ga(h))zg(i,a,d,n,uh,c,l);else{var m=c?c(xl(i,d),h,d+"",i,a,l):void 0;void 0===m&&(m=h),cl(i,d,m)}},hh)},dh=function Gg(i){return i};var ph=Math.max;const Kg=function mh(i){return function(){return i}};var Jg=Ps?function(i,a){return Ps(i,"toString",{configurable:!0,enumerable:!1,value:Kg(a),writable:!0})}:dh,t1=Date.now,n1=function r1(i){var a=0,n=0;return function(){var c=t1(),l=16-(c-n);if(n=c,l>0){if(++a>=800)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}(Jg);const i1=n1,s1=function a1(i,a){return i1(function Yg(i,a,n){return a=ph(void 0===a?i.length-1:a,0),function(){for(var c=arguments,l=-1,h=ph(c.length-a,0),d=Array(h);++l<h;)d[l]=c[a+l];l=-1;for(var m=Array(a+1);++l<a;)m[l]=c[l];return m[a]=n(d),function jg(i,a,n){switch(n.length){case 0:return i.call(a);case 1:return i.call(a,n[0]);case 2:return i.call(a,n[0],n[1]);case 3:return i.call(a,n[0],n[1],n[2])}return i.apply(a,n)}(i,this,m)}}(i,a,dh),i+"")};var f1=function l1(i){return s1(function(a,n){var c=-1,l=n.length,h=l>1?n[l-1]:void 0,d=l>2?n[2]:void 0;for(h=i.length>3&&"function"==typeof h?(l--,h):void 0,d&&function o1(i,a,n){if(!ga(n))return!1;var c=typeof a;return!!("number"==c?hl(n)&&fh(a,n.length):"string"==c&&a in n)&&Mo(n[a],i)}(n[0],n[1],d)&&(h=l<3?void 0:h,l=1),a=Object(a);++c<l;){var m=n[c];m&&i(a,m,c,h)}return a})}(function(i,a,n){$g(i,a,n)});const gh=f1;let h1=(()=>{class i{constructor(){this.colorschemesOptions=new Gd.X(void 0)}setColorschemesOptions(n){this.pColorschemesOptions=n,this.colorschemesOptions.next(n)}getColorschemesOptions(){return this.pColorschemesOptions}static#e=this.\u0275fac=function(c){return new(c||i)};static#t=this.\u0275prov=v.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),u1=(()=>{class i{constructor(n,c,l){this.zone=c,this.themeService=l,this.type="bar",this.plugins=[],this.chartClick=new v.vpe,this.chartHover=new v.vpe,this.subs=[],this.themeOverrides={},this.ctx=n.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe((0,jd.x)()).subscribe(h=>this.themeChanged(h)))}ngOnChanges(n){const c=["type"],l=Object.getOwnPropertyNames(n);if(l.some(h=>c.includes(h))||l.every(h=>n[h].isFirstChange()))this.render();else{const h=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,h.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,h.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,h.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(n=>n.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new Es(this.ctx,this.getChartConfiguration()))}update(n){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(n))}hideDataset(n,c){this.chart&&(this.chart.getDatasetMeta(n).hidden=c,this.update())}isDatasetHidden(n){return this.chart?.getDatasetMeta(n)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(n){this.themeOverrides=n,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return gh({onHover:(n,c)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:n,active:c}))},onClick:(n,c)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:n,active:c}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}static#e=this.\u0275fac=function(c){return new(c||i)(v.Y36(v.SBq),v.Y36(v.R0b),v.Y36(h1))};static#t=this.\u0275dir=v.lG2({type:i,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],features:[v.TTD]})}return i})();const d1=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]],p1={plugins:{colors:{enabled:!1}},datasets:{line:{backgroundColor:i=>Gi(ji(i.datasetIndex),.4),borderColor:i=>Gi(ji(i.datasetIndex),1),pointBackgroundColor:i=>Gi(ji(i.datasetIndex),1),pointBorderColor:"#fff"},bar:{backgroundColor:i=>Gi(ji(i.datasetIndex),.6),borderColor:i=>Gi(ji(i.datasetIndex),1)},get radar(){return this.line},doughnut:{backgroundColor:i=>Gi(ji(i.dataIndex),.6),borderColor:"#fff"},get pie(){return this.doughnut},polarArea:{backgroundColor:i=>Gi(ji(i.dataIndex),.6),borderColor:i=>Gi(ji(i.dataIndex),1)},get bubble(){return this.doughnut},get scatter(){return this.doughnut},get area(){return this.polarArea}}};function Gi(i,a){return"rgba("+i.concat(a).join(",")+")"}function Vo(i,a){return Math.floor(Math.random()*(a-i+1))+i}function ji(i=0){return d1[i]||function m1(){return[Vo(0,255),Vo(0,255),Vo(0,255)]}()}let xh=(()=>{class i{constructor(){this.generateColors=!0}static#e=this.\u0275fac=function(c){return new(c||i)};static#t=this.\u0275prov=v.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();Es.register(...$d);let g1=(()=>{class i{constructor(n){n?.plugins&&Es.register(...n.plugins);const c=gh(n?.generateColors?p1:{},n?.defaults||{});ar.set(c)}static forRoot(n){return{ngModule:i,providers:[{provide:xh,useValue:n}]}}static#e=this.\u0275fac=function(c){return new(c||i)(v.LFG(xh,8))};static#t=this.\u0275mod=v.oAB({type:i});static#r=this.\u0275inj=v.cJS({})}return i})()},1486:(Tr,kt,ie)=>{ie.d(kt,{NC:()=>Ev,P6:()=>Rv,ij:()=>vh});var v={version:"0.18.5"},U=1200,Ze=1252,ht=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Re={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ct=function(e){-1!=ht.indexOf(e)&&(Ze=Re[0]=e)},Fe=function(e){U=e,ct(e)};function Ne(){Fe(1200),function it(){ct(1252)}()}function Qe(e){for(var r=[],t=0,s=e.length;t<s;++t)r[t]=e.charCodeAt(t);return r}function at(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var ue,Be=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return 255==r&&254==t?function yt(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}(e.slice(2)):254==r&&255==t?at(e.slice(2)):65279==r?e.slice(1):e},De=function(r){return String.fromCharCode(r)},oe=function(r){return String.fromCharCode(r)},ut=null,Ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _t(e){for(var r="",t=0,s=0,o=0,f=0,u=0,p=0,x=0,_=0;_<e.length;)f=(t=e.charCodeAt(_++))>>2,u=(3&t)<<4|(s=e.charCodeAt(_++))>>4,p=(15&s)<<2|(o=e.charCodeAt(_++))>>6,x=63&o,isNaN(s)?p=x=64:isNaN(o)&&(x=64),r+=Ye.charAt(f)+Ye.charAt(u)+Ye.charAt(p)+Ye.charAt(x);return r}function Ut(e){var r="",f=0,u=0,p=0,x=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var _=0;_<e.length;)f=Ye.indexOf(e.charAt(_++)),u=Ye.indexOf(e.charAt(_++)),r+=String.fromCharCode(f<<2|u>>4),64!==(p=Ye.indexOf(e.charAt(_++)))&&(r+=String.fromCharCode((15&u)<<4|p>>2)),64!==(x=Ye.indexOf(e.charAt(_++)))&&(r+=String.fromCharCode((3&p)<<6|x));return r}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function un(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function js(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sr=function(r){return wt?hn(r,"binary"):r.split("").map(function(t){return 255&t.charCodeAt(0)})};function ui(e){if(typeof ArrayBuffer>"u")return Sr(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),s=0;s!=e.length;++s)t[s]=255&e.charCodeAt(s);return r}function Jn(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function nn(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nn(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var lr=wt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:hn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var s=new Uint8Array(t),o=0;for(r=0,t=0;r<e.length;t+=o,++r)if(o=e[r].length,e[r]instanceof Uint8Array)s.set(e[r],t);else{if("string"==typeof e[r])throw"wtf";s.set(new Uint8Array(e[r]),t)}return s}return[].concat.apply([],e.map(function(f){return Array.isArray(f)?f:[].slice.call(f)}))},Or=/\u0000/g,Ln=/[\u0001-\u0006]/g;function yi(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function dn(e,r){var t=""+e;return t.length>=r?t:dr("0",r-t.length)+t}function Ta(e,r){var t=""+e;return t.length>=r?t:dr(" ",r-t.length)+t}function Ca(e,r){var t=""+e;return t.length>=r?t:t+dr(" ",r-t.length)}var Xs=Math.pow(2,32);function Nn(e,r){return e>Xs||e<-Xs?function ts(e,r){var t=""+Math.round(e);return t.length>=r?t:dr("0",r-t.length)+t}(e,r):function bi(e,r){var t=""+e;return t.length>=r?t:dr("0",r-t.length)+t}(Math.round(e),r)}function Ji(e,r){return e.length>=7+(r=r||0)&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var rs=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ns=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Fn={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Xo={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pt(e,r,t){for(var s=e<0?-1:1,o=e*s,f=0,u=1,p=0,x=1,_=0,w=0,T=Math.floor(o);_<r&&(p=(T=Math.floor(o))*u+f,w=T*_+x,!(o-T<5e-8));)o=1/(o-T),f=u,u=p,x=_,_=w;if(w>r&&(_>r?(w=x,p=f):(w=_,p=u)),!t)return[0,s*p,w];var C=Math.floor(s*p/w);return[C,s*p-C*w,w]}function Vt(e,r,t){if(e>2958465||e<0)return null;var s=0|e,o=Math.floor(86400*(e-s)),f=0,u=[],p={D:s,T:o,u:86400*(e-s)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(p.u)<1e-6&&(p.u=0),r&&r.date1904&&(s+=1462),p.u>.9999&&(p.u=0,86400==++o&&(p.T=o=0,++s,++p.D)),60===s)u=t?[1317,10,29]:[1900,2,29],f=3;else if(0===s)u=t?[1317,8,29]:[1900,1,0],f=6;else{s>60&&--s;var x=new Date(1900,0,1);x.setDate(x.getDate()+s-1),u=[x.getFullYear(),x.getMonth()+1,x.getDate()],f=x.getDay(),s<60&&(f=(f+6)%7),t&&(f=function Zs(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}(x,u))}return p.y=u[0],p.m=u[1],p.d=u[2],p.S=o%60,o=Math.floor(o/60),p.M=o%60,o=Math.floor(o/60),p.H=o,p.q=f,p}var It=new Date(1899,11,31,0,0,0),ur=It.getTime(),an=new Date(1900,2,1,0,0,0);function Tt(e,r){var t=e.getTime();return r?t-=1262304e5:e>=an&&(t+=864e5),(t-(ur+6e4*(e.getTimezoneOffset()-It.getTimezoneOffset())))/864e5}function is(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qn(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function Qt(e){var r=e<0?12:11,t=is(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10)).length<=r?t:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function Xt(e){var r=is(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e),is(function Ys(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Dn(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Qn(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return M(14,Tt(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Yo(e,r,t,s){var x,o="",f=0,u=0,p=t.y,_=0;switch(e){case 98:p=t.y+543;case 121:switch(r.length){case 1:case 2:x=p%100,_=2;break;default:x=p%1e4,_=4}break;case 109:switch(r.length){case 1:case 2:x=t.m,_=r.length;break;case 3:return ns[t.m-1][1];case 5:return ns[t.m-1][0];default:return ns[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:x=t.d,_=r.length;break;case 3:return rs[t.q][0];default:return rs[t.q][1]}break;case 104:switch(r.length){case 1:case 2:x=1+(t.H+11)%12,_=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:x=t.H,_=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:x=t.M,_=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(u=s>=2?3===s?1e3:100:1===s?10:1,(f=Math.round(u*(t.S+t.u)))>=60*u&&(f=0),"s"===r?0===f?"0":""+f/u:(o=dn(f,2+s),"ss"===r?o.substr(0,2):"."+o.substr(2,r.length-1))):dn(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":x=24*t.D+t.H;break;case"[m]":case"[mm]":x=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":x=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}_=3===r.length?1:2;break;case 101:x=p,_=1}return _>0?dn(x,_):""}function pn(e){if(e.length<=3)return e;for(var t=e.length%3,s=e.substr(0,t);t!=e.length;t+=3)s+=(s.length>0?",":"")+e.substr(t,3);return s}var Ti=/%/g;function as(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+as(e,-r);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%o;if(f<0&&(f+=o),-1===(t=(r/Math.pow(10,f)).toPrecision(s+1+(o+f)%o)).indexOf("e")){var u=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,o)+"."+t.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,x,_,w){return x+_+w.substr(0,(o+f)%o)+"."+w.substr(f)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Ks=/# (\?+)( ?)\/( ?)(\d+)/,Ea=/^#*0*\.([0#]+)/,Ci=/\).*[0#]/,Bn=/\(###\) ###\\?-####/;function Br(e){for(var t,r="",s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Js(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function qt(e,r){var t=e-Math.floor(e),s=Math.pow(10,r);return r<(""+Math.round(t*s)).length?0:Math.round(t*s)}function zr(e,r,t){if(40===e.charCodeAt(0)&&!r.match(Ci)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zr("n",s,t):"("+zr("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function Al(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Ur(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function Zo(e,r,t){var s=r.replace(Ti,""),o=r.length-s.length;return Ur(e,s,t*Math.pow(10,2*o))+dr("%",o)}(e,r,t);if(-1!==r.indexOf("E"))return as(r,t);if(36===r.charCodeAt(0))return"$"+zr(e,r.substr(" "==r.charAt(1)?2:1),t);var o,f,u,p,x=Math.abs(t),_=t<0?"-":"";if(r.match(/^00+$/))return _+Nn(x,r.length);if(r.match(/^[#?]+$/))return"0"===(o=Nn(t,0))&&(o=""),o.length>r.length?o:Br(r.substr(0,r.length-o.length))+o;if(f=r.match(Ks))return function Ko(e,r,t){var s=parseInt(e[4],10),o=Math.round(r*s),f=Math.floor(o/s),u=o-f*s,p=s;return t+(0===f?"":""+f)+" "+(0===u?dr(" ",e[1].length+1+e[4].length):Ta(u,e[1].length)+e[2]+"/"+e[3]+dn(p,e[4].length))}(f,x,_);if(r.match(/^#+0+$/))return _+Nn(x,r.length-r.indexOf("0"));if(f=r.match(Ea))return o=Js(t,f[1].length).replace(/^([^\.]+)$/,"$1."+Br(f[1])).replace(/\.$/,"."+Br(f[1])).replace(/\.(\d*)$/,function(A,k){return"."+k+dr("0",Br(f[1]).length-k.length)}),-1!==r.indexOf("0.")?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return _+Js(x,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return _+pn(Nn(x,0));if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zr(e,r,-t):pn(""+(Math.floor(t)+function ir(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}(t,f[1].length)))+"."+dn(qt(t,f[1].length),f[1].length);if(f=r.match(/^#,#*,#0/))return zr(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=yi(zr(e,r.replace(/[\\-]/g,""),t)),u=0,yi(yi(r.replace(/\\/g,"")).replace(/[0#]/g,function(A){return u<o.length?o.charAt(u++):"0"===A?"0":""}));if(r.match(Bn))return"("+(o=zr(e,"##########",t)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var w="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),p=Pt(x,Math.pow(10,u)-1,!1),o=""+_," "==(w=Ur("n",f[1],p[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),o+=w+f[2]+"/"+f[3],(w=Ca(p[2],u)).length<f[4].length&&(w=Br(f[4].substr(f[4].length-w.length))+w),o+=w;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),_+((p=Pt(x,Math.pow(10,u)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?Ta(p[1],u)+f[2]+"/"+f[3]+Ca(p[2],u):dr(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return o=Nn(t,0),r.length<=o.length?o:Br(r.substr(0,r.length-o.length))+o;if(f=r.match(/^([#0?]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var T=r.indexOf(".")-u,C=r.length-o.length-T;return Br(r.substr(0,T)+o+r.substr(r.length-C))}if(f=r.match(/^00,000\.([#0]*0)$/))return u=qt(t,f[1].length),t<0?"-"+zr(e,r,-t):pn(function Jo(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?dn(0,3-A.length):"")+A})+"."+dn(u,f[1].length);switch(r){case"###,##0.00":return zr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var E=pn(Nn(x,0));return"0"!==E?_+E:"";case"###,###.00":return zr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return zr(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function ei(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+ei(e,-r);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%o;if(f<0&&(f+=o),!(t=(r/Math.pow(10,f)).toPrecision(s+1+(o+f)%o)).match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,x,_,w){return x+_+w.substr(0,(o+f)%o)+"."+w.substr(f)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function yn(e,r,t){if(40===e.charCodeAt(0)&&!r.match(Ci)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?yn("n",s,t):"("+yn("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function Qo(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Ur(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function gr(e,r,t){var s=r.replace(Ti,""),o=r.length-s.length;return Ur(e,s,t*Math.pow(10,2*o))+dr("%",o)}(e,r,t);if(-1!==r.indexOf("E"))return ei(r,t);if(36===r.charCodeAt(0))return"$"+yn(e,r.substr(" "==r.charAt(1)?2:1),t);var o,f,u,p,x=Math.abs(t),_=t<0?"-":"";if(r.match(/^00+$/))return _+dn(x,r.length);if(r.match(/^[#?]+$/))return o=""+t,0===t&&(o=""),o.length>r.length?o:Br(r.substr(0,r.length-o.length))+o;if(f=r.match(Ks))return function qn(e,r,t){return t+(0===r?"":""+r)+dr(" ",e[1].length+2+e[4].length)}(f,x,_);if(r.match(/^#+0+$/))return _+dn(x,r.length-r.indexOf("0"));if(f=r.match(Ea))return o=(o=(""+t).replace(/^([^\.]+)$/,"$1."+Br(f[1])).replace(/\.$/,"."+Br(f[1]))).replace(/\.(\d*)$/,function(A,k){return"."+k+dr("0",Br(f[1]).length-k.length)}),-1!==r.indexOf("0.")?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return _+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return _+pn(""+x);if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+yn(e,r,-t):pn(""+t)+"."+dr("0",f[1].length);if(f=r.match(/^#,#*,#0/))return yn(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=yi(yn(e,r.replace(/[\\-]/g,""),t)),u=0,yi(yi(r.replace(/\\/g,"")).replace(/[0#]/g,function(A){return u<o.length?o.charAt(u++):"0"===A?"0":""}));if(r.match(Bn))return"("+(o=yn(e,"##########",t)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var w="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),p=Pt(x,Math.pow(10,u)-1,!1),o=""+_," "==(w=Ur("n",f[1],p[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),o+=w+f[2]+"/"+f[3],(w=Ca(p[2],u)).length<f[4].length&&(w=Br(f[4].substr(f[4].length-w.length))+w),o+=w;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),_+((p=Pt(x,Math.pow(10,u)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?Ta(p[1],u)+f[2]+"/"+f[3]+Ca(p[2],u):dr(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return r.length<=(o=""+t).length?o:Br(r.substr(0,r.length-o.length))+o;if(f=r.match(/^([#0]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var T=r.indexOf(".")-u,C=r.length-o.length-T;return Br(r.substr(0,T)+o+r.substr(r.length-C))}if(f=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+yn(e,r,-t):pn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?dn(0,3-A.length):"")+A})+"."+dn(0,f[1].length);switch(r){case"###,###":case"##,###":case"#,###":var E=pn(""+x);return"0"!==E?_+E:"";default:if(r.match(/\.[0#?]*$/))return yn(e,r.slice(0,r.lastIndexOf(".")),t)+Br(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ur(e,r,t){return(0|t)===t?yn(e,r,t):zr(e,r,t)}var Ei=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ti(e){for(var r=0,t="",s="";r<e.length;)switch(t=e.charAt(r)){case"G":Ji(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(r,3).toUpperCase()||"AM/PM"===e.substr(r,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(s=t;"]"!==e.charAt(r++)&&r<e.length;)s+=e.charAt(r);if(s.match(Ei))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||"\\"==t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(" "==e.charAt(r)||"*"==e.charAt(r))&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;default:++r}return!1}var di=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function me(e,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function M(e,r,t){null==t&&(t={});var s="";switch(typeof e){case"string":s="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(s=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:vt)[e])&&(s=t.table&&t.table[Fn[e]]||vt[Fn[e]]),null==s&&(s=Xo[e]||"General")}if(Ji(s,0))return Dn(r,t);r instanceof Date&&(r=Tt(r,t.date1904));var o=function gt(e,r){var t=function On(e){for(var r=[],t=!1,s=0,o=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=e.substr(o,s-o),o=s+1}if(r[r.length]=e.substr(o),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}(e),s=t.length,o=t[s-1].indexOf("@");if(s<4&&o>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||o>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=o>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=o>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=o>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var f=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[s,f];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var u=t[0].match(di),p=t[1].match(di);return me(r,u)?[s,t[0]]:me(r,p)?[s,t[1]]:[s,t[null!=u&&null!=p?2:1]]}return[s,f]}(s,r);if(Ji(o[1]))return Dn(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return function qo(e,r,t,s){for(var _,w,T,o=[],f="",u=0,p="",x="t",C="H";u<e.length;)switch(p=e.charAt(u)){case"G":if(!Ji(e,u))throw new Error("unrecognized character "+p+" in "+e);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(f="";34!==(T=e.charCodeAt(++u))&&u<e.length;)f+=String.fromCharCode(T);o[o.length]={t:"t",v:f},++u;break;case"\\":var E=e.charAt(++u);o[o.length]={t:"("===E||")"===E?E:"t",v:E},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:r},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==_&&null==(_=Vt(r,t,"2"===e.charAt(u+1))))return"";o[o.length]={t:"X",v:e.substr(u,2)},x=p,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":p=p.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||null==_&&null==(_=Vt(r,t)))return"";for(f=p;++u<e.length&&e.charAt(u).toLowerCase()===p;)f+=p;"m"===p&&"h"===x.toLowerCase()&&(p="M"),"h"===p&&(p=C),o[o.length]={t:p,v:f},x=p;break;case"A":case"a":case"\u4e0a":var k={t:p,v:p};if(null==_&&(_=Vt(r,t)),"A/P"===e.substr(u,3).toUpperCase()?(null!=_&&(k.v=_.H>=12?"P":"A"),k.t="T",C="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=_&&(k.v=_.H>=12?"PM":"AM"),k.t="T",u+=5,C="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(u,5).toUpperCase()?(null!=_&&(k.v=_.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),k.t="T",u+=5,C="h"):(k.t="t",++u),null==_&&"T"===k.t)return"";o[o.length]=k,x=p;break;case"[":for(f=p;"]"!==e.charAt(u++)&&u<e.length;)f+=e.charAt(u);if("]"!==f.slice(-1))throw'unterminated "[" block: |'+f+"|";if(f.match(Ei)){if(null==_&&null==(_=Vt(r,t)))return"";o[o.length]={t:"Z",v:f.toLowerCase()},x=f.charAt(1)}else f.indexOf("$")>-1&&(f=(f.match(/\$([^-\[\]]*)/)||[])[1]||"$",ti(e)||(o[o.length]={t:"t",v:f}));break;case".":if(null!=_){for(f=p;++u<e.length&&"0"===(p=e.charAt(u));)f+=p;o[o.length]={t:"s",v:f};break}case"0":case"#":for(f=p;++u<e.length&&"0#?.,E+-%".indexOf(p=e.charAt(u))>-1;)f+=p;o[o.length]={t:"n",v:f};break;case"?":for(f=p;e.charAt(++u)===p;)f+=p;o[o.length]={t:p,v:f},x=p;break;case"*":++u,(" "==e.charAt(u)||"*"==e.charAt(u))&&++u;break;case"(":case")":o[o.length]={t:1===s?"t":p,v:p},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(f=p;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)f+=e.charAt(u);o[o.length]={t:"D",v:f};break;case" ":o[o.length]={t:p,v:p},++u;break;case"$":o[o.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(p))throw new Error("unrecognized character "+p+" in "+e);o[o.length]={t:"t",v:p},++u}var B,F=0,N=0;for(u=o.length-1,x="t";u>=0;--u)switch(o[u].t){case"h":case"H":o[u].t=C,x="h",F<1&&(F=1);break;case"s":(B=o[u].v.match(/\.0+$/))&&(N=Math.max(N,B[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":x=o[u].t;break;case"m":"s"===x&&(o[u].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&o[u].v.match(/[Hh]/)&&(F=1),F<2&&o[u].v.match(/[Mm]/)&&(F=2),F<3&&o[u].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M),_.M>=60&&(_.M=0,++_.H);break;case 2:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M)}var re,I="";for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=Yo(o[u].t.charCodeAt(0),o[u].v,_,N),o[u].t="t";break;case"n":case"?":for(re=u+1;null!=o[re]&&("?"===(p=o[re].t)||"D"===p||(" "===p||"t"===p)&&null!=o[re+1]&&("?"===o[re+1].t||"t"===o[re+1].t&&"/"===o[re+1].v)||"("===o[u].t&&(" "===p||"n"===p||")"===p)||"t"===p&&("/"===o[re].v||" "===o[re].v&&null!=o[re+1]&&"?"==o[re+1].t));)o[u].v+=o[re].v,o[re]={v:"",t:";"},++re;I+=o[u].v,u=re-1;break;case"G":o[u].t="t",o[u].v=Dn(r,t)}var ee,V,se="";if(I.length>0){40==I.charCodeAt(0)?(ee=r<0&&45===I.charCodeAt(0)?-r:r,V=Ur("n",I,ee)):(V=Ur("n",I,ee=r<0&&s>1?-r:r),ee<0&&o[0]&&"t"==o[0].t&&(V=V.substr(1),o[0].v="-"+o[0].v)),re=V.length-1;var ne=o.length;for(u=0;u<o.length;++u)if(null!=o[u]&&"t"!=o[u].t&&o[u].v.indexOf(".")>-1){ne=u;break}var te=o.length;if(ne===o.length&&-1===V.indexOf("E")){for(u=o.length-1;u>=0;--u)null==o[u]||-1==="n?".indexOf(o[u].t)||(re>=o[u].v.length-1?o[u].v=V.substr(1+(re-=o[u].v.length),o[u].v.length):re<0?o[u].v="":(o[u].v=V.substr(0,re+1),re=-1),o[u].t="t",te=u);re>=0&&te<o.length&&(o[te].v=V.substr(0,re+1)+o[te].v)}else if(ne!==o.length&&-1===V.indexOf("E")){for(re=V.indexOf(".")-1,u=ne;u>=0;--u)if(null!=o[u]&&-1!=="n?".indexOf(o[u].t)){for(w=o[u].v.indexOf(".")>-1&&u===ne?o[u].v.indexOf(".")-1:o[u].v.length-1,se=o[u].v.substr(w+1);w>=0;--w)re>=0&&("0"===o[u].v.charAt(w)||"#"===o[u].v.charAt(w))&&(se=V.charAt(re--)+se);o[u].v=se,o[u].t="t",te=u}for(re>=0&&te<o.length&&(o[te].v=V.substr(0,re+1)+o[te].v),re=V.indexOf(".")+1,u=ne;u<o.length;++u)if(null!=o[u]&&(-1!=="n?(".indexOf(o[u].t)||u===ne)){for(w=o[u].v.indexOf(".")>-1&&u===ne?o[u].v.indexOf(".")+1:0,se=o[u].v.substr(0,w);w<o[u].v.length;++w)re<V.length&&(se+=V.charAt(re++));o[u].v=se,o[u].t="t",te=u}}}for(u=0;u<o.length;++u)null!=o[u]&&"n?".indexOf(o[u].t)>-1&&(o[u].v=Ur(o[u].t,o[u].v,ee=s>1&&r<0&&u>0&&"-"===o[u-1].v?-r:r),o[u].t="t");var ge="";for(u=0;u!==o.length;++u)null!=o[u]&&(ge+=o[u].v);return ge}(o[1],r,t,o[0])}function Q(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=vt[t]){if(vt[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return vt[r]=e,r}function Z(e){for(var r=0;392!=r;++r)void 0!==e[r]&&Q(e[r],r)}function ve(){vt=function ki(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var st={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},lt=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,bn=function(){var e={version:"1.2.0"},t=function r(){for(var V=0,ne=new Array(256),te=0;256!=te;++te)ne[te]=V=1&(V=1&(V=1&(V=1&(V=1&(V=1&(V=1&(V=1&(V=te)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1)?-306674912^V>>>1:V>>>1;return typeof Int32Array<"u"?new Int32Array(ne):ne}(),o=function s(V){var ne=0,te=0,ge=0,_e=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ge=0;256!=ge;++ge)_e[ge]=V[ge];for(ge=0;256!=ge;++ge)for(te=V[ge],ne=256+ge;ne<4096;ne+=256)te=_e[ne]=te>>>8^V[255&te];var ae=[];for(ge=1;16!=ge;++ge)ae[ge-1]=typeof Int32Array<"u"?_e.subarray(256*ge,256*ge+256):_e.slice(256*ge,256*ge+256);return ae}(t),f=o[0],u=o[1],p=o[2],x=o[3],_=o[4],w=o[5],T=o[6],C=o[7],E=o[8],A=o[9],k=o[10],F=o[11],N=o[12],B=o[13],I=o[14];return e.table=t,e.bstr=function re(V,ne){for(var te=-1^ne,ge=0,_e=V.length;ge<_e;)te=te>>>8^t[255&(te^V.charCodeAt(ge++))];return~te},e.buf=function se(V,ne){for(var te=-1^ne,ge=V.length-15,_e=0;_e<ge;)te=I[V[_e++]^255&te]^B[V[_e++]^te>>8&255]^N[V[_e++]^te>>16&255]^F[V[_e++]^te>>>24]^k[V[_e++]]^A[V[_e++]]^E[V[_e++]]^C[V[_e++]]^T[V[_e++]]^w[V[_e++]]^_[V[_e++]]^x[V[_e++]]^p[V[_e++]]^u[V[_e++]]^f[V[_e++]]^t[V[_e++]];for(ge+=15;_e<ge;)te=te>>>8^t[255&(te^V[_e++])];return~te},e.str=function ee(V,ne){for(var te=-1^ne,ge=0,_e=V.length,ae=0,ze=0;ge<_e;)(ae=V.charCodeAt(ge++))<128?te=te>>>8^t[255&(te^ae)]:ae<2048?te=(te=te>>>8^t[255&(te^(192|ae>>6&31))])>>>8^t[255&(te^(128|63&ae))]:ae>=55296&&ae<57344?(ae=64+(1023&ae),ze=1023&V.charCodeAt(ge++),te=(te=(te=(te=te>>>8^t[255&(te^(240|ae>>8&7))])>>>8^t[255&(te^(128|ae>>2&63))])>>>8^t[255&(te^(128|ze>>6&15|(3&ae)<<4))])>>>8^t[255&(te^(128|63&ze))]):te=(te=(te=te>>>8^t[255&(te^(224|ae>>12&15))])>>>8^t[255&(te^(128|ae>>6&63))])>>>8^t[255&(te^(128|63&ae))];return~te},e}(),et=function(){var x,r={};function s(D){if("/"==D.charAt(D.length-1))return-1===D.slice(0,-1).indexOf("/")?D:s(D.slice(0,-1));var H=D.lastIndexOf("/");return-1===H?D:D.slice(0,H+1)}function o(D){if("/"==D.charAt(D.length-1))return o(D.slice(0,-1));var H=D.lastIndexOf("/");return-1===H?D:D.slice(H+1)}function f(D,H){"string"==typeof H&&(H=new Date(H));var R=H.getHours();R=(R=R<<6|H.getMinutes())<<5|H.getSeconds()>>>1,D.write_shift(2,R);var L=H.getFullYear()-1980;L=(L=L<<4|H.getMonth()+1)<<5|H.getDate(),D.write_shift(2,L)}function p(D){Hr(D,0);for(var H={},R=0;D.l<=D.length-4;){var L=D.read_shift(2),W=D.read_shift(2),z=D.l+W,ce={};21589===L&&(1&(R=D.read_shift(1))&&(ce.mtime=D.read_shift(4)),W>5&&(2&R&&(ce.atime=D.read_shift(4)),4&R&&(ce.ctime=D.read_shift(4))),ce.mtime&&(ce.mt=new Date(1e3*ce.mtime))),D.l=z,H[L]=ce}return H}function _(){return x||(x={})}function w(D,H){if(80==D[0]&&75==D[1])return Ax(D,H);if(109==(32|D[0])&&105==(32|D[1]))return function Zv(D,H){if("mime-version:"!=qe(D.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var R=H&&H.root||"",L=(wt&&Buffer.isBuffer(D)?D.toString("binary"):qe(D)).split("\r\n"),W=0,z="";for(W=0;W<L.length;++W)if(/^Content-Location:/i.test(z=L[W])&&(z=z.slice(z.indexOf("file")),R||(R=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,R.length)!=R))for(;R.length>0&&(R=(R=R.slice(0,R.length-1)).slice(0,R.lastIndexOf("/")+1),z.slice(0,R.length)!=R););var ce=(L[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ye="--"+(ce[1]||""),de={FileIndex:[],FullPaths:[]};V(de);var Le,je=0;for(W=0;W<L.length;++W){var ft=L[W];ft!==ye&&ft!==ye+"--"||(je++&&Yv(de,L.slice(Le,W),R),Le=W)}return de}(D,H);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var R,W,z,ce,ye,he,L=512,le=[],de=D.slice(0,512);Hr(de,0);var Le=function T(D){if(80==D[D.l]&&75==D[D.l+1])return[0,0];D.chk(nt,"Header Signature: "),D.l+=16;var H=D.read_shift(2,"u");return[D.read_shift(2,"u"),H]}(de);switch(R=Le[0]){case 3:L=512;break;case 4:L=4096;break;case 0:if(0==Le[1])return Ax(D,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}512!==L&&Hr(de=D.slice(0,L),28);var je=D.slice(0,L);!function C(D,H){var R;switch(D.l+=2,R=D.read_shift(2)){case 9:if(3!=H)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(4!=H)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}(de,R);var ft=de.read_shift(4,"i");if(3===R&&0!==ft)throw new Error("# Directory Sectors: Expected 0 saw "+ft);de.l+=4,ce=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ye=de.read_shift(4,"i"),W=de.read_shift(4,"i"),he=de.read_shift(4,"i"),z=de.read_shift(4,"i");for(var Xe=-1,Je=0;Je<109&&!((Xe=de.read_shift(4,"i"))<0);++Je)le[Je]=Xe;var At=function E(D,H){for(var R=Math.ceil(D.length/H)-1,L=[],W=1;W<R;++W)L[W-1]=D.slice(W*H,(W+1)*H);return L[R-1]=D.slice(R*H),L}(D,L);F(he,z,At,L,le);var _r=function B(D,H,R,L){var W=D.length,z=[],ce=[],ye=[],he=[],le=L-1,de=0,Le=0,je=0,ft=0;for(de=0;de<W;++de)if(ye=[],(je=de+H)>=W&&(je-=W),!ce[je]){he=[];var Xe=[];for(Le=je;Le>=0;){Xe[Le]=!0,ce[Le]=!0,ye[ye.length]=Le,he.push(D[Le]);var Je=R[Math.floor(4*Le/L)];if(L<4+(ft=4*Le&le))throw new Error("FAT boundary crossed: "+Le+" 4 "+L);if(!D[Je]||Xe[Le=ea(D[Je],ft)])break}z[je]={nodes:ye,data:uc([he])}}return z}(At,ce,le,L);_r[ce].name="!Directory",W>0&&ye!==ze&&(_r[ye].name="!MiniFAT"),_r[le[0]].name="!FAT",_r.fat_addrs=le,_r.ssz=L;var Vr=[],Kn=[],El=[];(function I(D,H,R,L,W,z,ce,ye){for(var ft,he=0,le=L.length?2:0,de=H[D].data,Le=0,je=0;Le<de.length;Le+=128){var Xe=de.slice(Le,Le+128);Hr(Xe,64),je=Xe.read_shift(2),ft=mi(Xe,0,je-le),L.push(ft);var Je={name:ft,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0};0!==Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)&&(Je.ct=re(Xe,Xe.l-8)),0!==Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)&&(Je.mt=re(Xe,Xe.l-8)),Je.start=Xe.read_shift(4,"i"),Je.size=Xe.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=ze,Je.name=""),5===Je.type?(he=Je.start,W>0&&he!==ze&&(H[he].name="!StreamData")):Je.size>=4096?(Je.storage="fat",void 0===H[Je.start]&&(H[Je.start]=N(R,Je.start,H.fat_addrs,H.ssz)),H[Je.start].name=Je.name,Je.content=H[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:he!==ze&&Je.start!==ze&&H[he]&&(Je.content=k(Je,H[he].data,(H[ye]||{}).data))),Je.content&&Hr(Je.content,0),z[ft]=Je,ce.push(Je)}})(ce,_r,At,Vr,W,{},Kn,ye),function A(D,H,R){for(var L=0,W=0,z=0,ce=0,ye=0,he=R.length,le=[],de=[];L<he;++L)le[L]=de[L]=L,H[L]=R[L];for(;ye<de.length;++ye)W=D[L=de[ye]].L,z=D[L].R,ce=D[L].C,le[L]===L&&(-1!==W&&le[W]!==W&&(le[L]=le[W]),-1!==z&&le[z]!==z&&(le[L]=le[z])),-1!==ce&&(le[ce]=L),-1!==W&&L!=le[L]&&(le[W]=le[L],de.lastIndexOf(W)<ye&&de.push(W)),-1!==z&&L!=le[L]&&(le[z]=le[L],de.lastIndexOf(z)<ye&&de.push(z));for(L=1;L<he;++L)le[L]===L&&(-1!==z&&le[z]!==z?le[L]=le[z]:-1!==W&&le[W]!==W&&(le[L]=le[W]));for(L=1;L<he;++L)if(0!==D[L].type){if((ye=L)!=le[ye])do{H[L]=H[ye=le[ye]]+"/"+H[L]}while(0!==ye&&-1!==le[ye]&&ye!=le[ye]);le[L]=-1}for(H[0]+="/",L=1;L<he;++L)2!==D[L].type&&(H[L]+="/")}(Kn,El,Vr),Vr.shift();var Sl={FileIndex:Kn,FullPaths:El};return H&&H.raw&&(Sl.raw={header:je,sectors:At}),Sl}function k(D,H,R){for(var W=D.size,z=[],ce=D.start;R&&W>0&&ce>=0;)z.push(H.slice(ce*ae,ce*ae+ae)),W-=ae,ce=ea(R,4*ce);return 0===z.length?we(0):lr(z).slice(0,D.size)}function F(D,H,R,L,W){var z=ze;if(D===ze){if(0!==H)throw new Error("DIFAT chain shorter than expected")}else if(-1!==D){var ce=R[D],ye=(L>>>2)-1;if(!ce)return;for(var he=0;he<ye&&(z=ea(ce,4*he))!==ze;++he)W.push(z);F(ea(ce,L-4),H-1,R,L,W)}}function N(D,H,R,L,W){var z=[],ce=[];W||(W=[]);var ye=L-1,he=0,le=0;for(he=H;he>=0;){W[he]=!0,z[z.length]=he,ce.push(D[he]);var de=R[Math.floor(4*he/L)];if(L<4+(le=4*he&ye))throw new Error("FAT boundary crossed: "+he+" 4 "+L);if(!D[de])break;he=ea(D[de],le)}return{nodes:z,data:uc([ce])}}function re(D,H){return new Date(1e3*(Pr(D,H+4)/1e7*Math.pow(2,32)+Pr(D,H)/1e7-11644473600))}function V(D,H){var R=H||{},L=R.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");0===D.FullPaths.length&&(D.FullPaths[0]=L+"/",D.FileIndex[0]={name:L,type:5}),R.CLSID&&(D.FileIndex[0].clsid=R.CLSID),function ne(D){var H="\x01Sh33tJ5";if(!et.find(D,"/"+H)){var R=we(4);R[0]=55,R[1]=R[3]=50,R[2]=54,D.FileIndex.push({name:H,type:2,content:R,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+H),te(D)}}(D)}function te(D,H){V(D);for(var R=!1,L=!1,W=D.FullPaths.length-1;W>=0;--W){var z=D.FileIndex[W];switch(z.type){case 0:L?R=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(z.R*z.L*z.C)&&(R=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(R=!0);break;default:R=!0}}if(R||H){var ce=new Date(1987,1,19),ye=0,he=Object.create?Object.create(null):{},le=[];for(W=0;W<D.FullPaths.length;++W)he[D.FullPaths[W]]=!0,0!==D.FileIndex[W].type&&le.push([D.FullPaths[W],D.FileIndex[W]]);for(W=0;W<le.length;++W){var de=s(le[W][0]);(L=he[de])||(le.push([de,{name:o(de).replace("/",""),type:1,clsid:xt,ct:ce,mt:ce,content:null}]),he[de]=!0)}for(le.sort(function(ft,Xe){return function t(D,H){for(var R=D.split("/"),L=H.split("/"),W=0,z=0,ce=Math.min(R.length,L.length);W<ce;++W){if(z=R[W].length-L[W].length)return z;if(R[W]!=L[W])return R[W]<L[W]?-1:1}return R.length-L.length}(ft[0],Xe[0])}),D.FullPaths=[],D.FileIndex=[],W=0;W<le.length;++W)D.FullPaths[W]=le[W][0],D.FileIndex[W]=le[W][1];for(W=0;W<le.length;++W){var Le=D.FileIndex[W],je=D.FullPaths[W];if(Le.name=o(je).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||xt,0===W)Le.C=le.length>1?1:-1,Le.size=0,Le.type=5;else if("/"==je.slice(-1)){for(ye=W+1;ye<le.length&&s(D.FullPaths[ye])!=je;++ye);for(Le.C=ye>=le.length?-1:ye,ye=W+1;ye<le.length&&s(D.FullPaths[ye])!=s(je);++ye);Le.R=ye>=le.length?-1:ye,Le.type=1}else s(D.FullPaths[W+1]||"")==s(je)&&(Le.R=W+1),Le.type=2}}}function ge(D,H){var R=H||{};if("mad"==R.fileType)return function Kv(D,H){for(var R=H||{},L=R.boundary||"SheetJS",W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(L="------="+L).slice(2)+'"',"","",""],z=D.FullPaths[0],ce=z,ye=D.FileIndex[0],he=1;he<D.FullPaths.length;++he)if(ce=D.FullPaths[he].slice(z.length),(ye=D.FileIndex[he]).size&&ye.content&&"\x01Sh33tJ5"!=ce){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(At){return"_x"+At.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(At){return"_u"+At.charCodeAt(0).toString(16)+"_"});for(var le=ye.content,de=wt&&Buffer.isBuffer(le)?le.toString("binary"):qe(le),Le=0,je=Math.min(1024,de.length),ft=0,Xe=0;Xe<=je;++Xe)(ft=de.charCodeAt(Xe))>=32&&ft<128&&++Le;var Je=Le>=4*je/5;W.push(L),W.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+ce),W.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),W.push("Content-Type: "+$v(ye,ce)),W.push(""),W.push(Je?jv(de):Gv(de))}return W.push(L+"--\r\n"),W.join("\r\n")}(D,R);if("zip"===(te(D),R.fileType))return function zv(D,H){var R=H||{},L=[],W=[],z=we(1),ce=R.compression?8:0,ye=0,le=0,de=0,Le=0,je=0,ft=D.FullPaths[0],Xe=ft,Je=D.FileIndex[0],At=[],_r=0;for(le=1;le<D.FullPaths.length;++le)if(Xe=D.FullPaths[le].slice(ft.length),(Je=D.FileIndex[le]).size&&Je.content&&"\x01Sh33tJ5"!=Xe){var Rn=Le,Vr=we(Xe.length);for(de=0;de<Xe.length;++de)Vr.write_shift(1,127&Xe.charCodeAt(de));Vr=Vr.slice(0,Vr.l),At[je]=bn.buf(Je.content,0);var Kn=Je.content;8==ce&&(Kn=q(Kn)),(z=we(30)).write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ye),z.write_shift(2,ce),Je.mt?f(z,Je.mt):z.write_shift(4,0),z.write_shift(-4,8&ye?0:At[je]),z.write_shift(4,8&ye?0:Kn.length),z.write_shift(4,8&ye?0:Je.content.length),z.write_shift(2,Vr.length),z.write_shift(2,0),Le+=z.length,L.push(z),Le+=Vr.length,L.push(Vr),Le+=Kn.length,L.push(Kn),8&ye&&((z=we(12)).write_shift(-4,At[je]),z.write_shift(4,Kn.length),z.write_shift(4,Je.content.length),Le+=z.l,L.push(z)),(z=we(46)).write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ye),z.write_shift(2,ce),z.write_shift(4,0),z.write_shift(-4,At[je]),z.write_shift(4,Kn.length),z.write_shift(4,Je.content.length),z.write_shift(2,Vr.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Rn),_r+=z.l,W.push(z),_r+=Vr.length,W.push(Vr),++je}return(z=we(22)).write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,je),z.write_shift(2,je),z.write_shift(4,_r),z.write_shift(4,Le),z.write_shift(2,0),lr([lr(L),lr(W),z])}(D,R);var L=function(ft){for(var Xe=0,Je=0,At=0;At<ft.FileIndex.length;++At){var _r=ft.FileIndex[At];if(_r.content){var Rn=_r.content.length;Rn>0&&(Rn<4096?Xe+=Rn+63>>6:Je+=Rn+511>>9)}}for(var Vr=ft.FullPaths.length+3>>2,El=Xe+127>>7,Sl=(Xe+7>>3)+Je+Vr+El,Gs=Sl+127>>7,R1=Gs<=109?0:Math.ceil((Gs-109)/127);Sl+Gs+R1+127>>7>Gs;)R1=++Gs<=109?0:Math.ceil((Gs-109)/127);var ka=[1,R1,Gs,El,Vr,Je,Xe,0];return ft.FileIndex[0].size=Xe<<6,ka[7]=(ft.FileIndex[0].start=ka[0]+ka[1]+ka[2]+ka[3]+ka[4]+ka[5])+(ka[6]+7>>3),ka}(D),W=we(L[7]<<9),z=0,ce=0;for(z=0;z<8;++z)W.write_shift(1,$e[z]);for(z=0;z<8;++z)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),z=0;z<3;++z)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,L[2]),W.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ze),W.write_shift(4,L[3]),W.write_shift(-4,L[1]?L[0]-1:ze),W.write_shift(4,L[1]),z=0;z<109;++z)W.write_shift(-4,z<L[2]?L[1]+z:-1);if(L[1])for(ce=0;ce<L[1];++ce){for(;z<236+127*ce;++z)W.write_shift(-4,z<L[2]?L[1]+z:-1);W.write_shift(-4,ce===L[1]-1?ze:ce+1)}var ye=function(ft){for(ce+=ft;z<ce-1;++z)W.write_shift(-4,z+1);ft&&(++z,W.write_shift(-4,ze))};for(ce=z=0,ce+=L[1];z<ce;++z)W.write_shift(-4,ot.DIFSECT);for(ce+=L[2];z<ce;++z)W.write_shift(-4,ot.FATSECT);ye(L[3]),ye(L[4]);for(var he=0,le=0,de=D.FileIndex[0];he<D.FileIndex.length;++he)(de=D.FileIndex[he]).content&&!((le=de.content.length)<4096)&&(de.start=ce,ye(le+511>>9));for(ye(L[6]+7>>3);511&W.l;)W.write_shift(-4,ot.ENDOFCHAIN);for(ce=z=0,he=0;he<D.FileIndex.length;++he)(de=D.FileIndex[he]).content&&(le=de.content.length)&&!(le>=4096)&&(de.start=ce,ye(le+63>>6));for(;511&W.l;)W.write_shift(-4,ot.ENDOFCHAIN);for(z=0;z<L[4]<<2;++z){var Le=D.FullPaths[z];if(Le&&0!==Le.length){de=D.FileIndex[z],0===z&&(de.start=de.size?de.start-1:ze);var je=0===z&&R.root||de.name;if(le=2*(je.length+1),W.write_shift(64,je,"utf16le"),W.write_shift(2,le),W.write_shift(1,de.type),W.write_shift(1,de.color),W.write_shift(-4,de.L),W.write_shift(-4,de.R),W.write_shift(-4,de.C),de.clsid)W.write_shift(16,de.clsid,"hex");else for(he=0;he<4;++he)W.write_shift(4,0);W.write_shift(4,de.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,de.start),W.write_shift(4,de.size),W.write_shift(4,0)}else{for(he=0;he<17;++he)W.write_shift(4,0);for(he=0;he<3;++he)W.write_shift(4,-1);for(he=0;he<12;++he)W.write_shift(4,0)}}for(z=1;z<D.FileIndex.length;++z)if((de=D.FileIndex[z]).size>=4096)if(W.l=de.start+1<<9,wt&&Buffer.isBuffer(de.content))de.content.copy(W,W.l,0,de.size),W.l+=de.size+511&-512;else{for(he=0;he<de.size;++he)W.write_shift(1,de.content[he]);for(;511&he;++he)W.write_shift(1,0)}for(z=1;z<D.FileIndex.length;++z)if((de=D.FileIndex[z]).size>0&&de.size<4096)if(wt&&Buffer.isBuffer(de.content))de.content.copy(W,W.l,0,de.size),W.l+=de.size+63&-64;else{for(he=0;he<de.size;++he)W.write_shift(1,de.content[he]);for(;63&he;++he)W.write_shift(1,0)}if(wt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}r.version="1.2.1";var Ee,ae=64,ze=-2,nt="d0cf11e0a1b11ae1",$e=[208,207,17,224,161,177,26,225],xt="00000000000000000000000000000000",ot={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ze,FREESECT:-1,HEADER_SIGNATURE:nt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:xt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function qe(D){for(var H=new Array(D.length),R=0;R<D.length;++R)H[R]=String.fromCharCode(D[R]);return H.join("")}function q(D){return Ee?Ee.deflateRawSync(D):Bt(D)}for(var D,H,J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ke=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],We=typeof Uint8Array<"u",Ae=We?new Uint8Array(256):[],Ot=0;Ot<256;++Ot)Ae[Ot]=(void 0,255&((H=139536&((D=Ot)<<1|D<<11)|558144&(D<<5|D<<15))>>16|H>>8|H));function G(D,H){var R=Ae[255&D];return H<=8?R>>>8-H:(R=R<<8|Ae[D>>8&255],H<=16?R>>>16-H:(R=R<<8|Ae[D>>16&255])>>>24-H)}function or(D,H){var R=7&H,L=H>>>3;return(D[L]|(R<=6?0:D[L+1]<<8))>>>R&3}function Ht(D,H){var R=7&H,L=H>>>3;return(D[L]|(R<=5?0:D[L+1]<<8))>>>R&7}function Wt(D,H){var R=7&H,L=H>>>3;return(D[L]|(R<=3?0:D[L+1]<<8))>>>R&31}function tt(D,H){var R=7&H,L=H>>>3;return(D[L]|(R<=1?0:D[L+1]<<8))>>>R&127}function Lr(D,H,R){var L=7&H,W=H>>>3,ce=D[W]>>>L;return R<8-L||(ce|=D[W+1]<<8-L,R<16-L)||(ce|=D[W+2]<<16-L,R<24-L)||(ce|=D[W+3]<<24-L),ce&(1<<R)-1}function fi(D,H,R){var L=7&H,W=H>>>3;return L<=5?D[W]|=(7&R)<<L:(D[W]|=R<<L&255,D[W+1]=(7&R)>>8-L),H+3}function Zi(D,H,R){return D[H>>>3]|=R=(1&R)<<(7&H),H+1}function ya(D,H,R){var W=H>>>3;return D[W]|=255&(R<<=7&H),D[W+1]=R>>>=8,H+8}function Tl(D,H,R){var W=H>>>3;return D[W]|=255&(R<<=7&H),D[W+1]=255&(R>>>=8),D[W+2]=R>>>8,H+16}function qa(D,H){var R=D.length,L=2*R>H?2*R:H+5,W=0;if(R>=H)return D;if(wt){var z=js(L);if(D.copy)D.copy(z);else for(;W<D.length;++W)z[W]=D[W];return z}if(We){var ce=new Uint8Array(L);if(ce.set)ce.set(D);else for(;W<R;++W)ce[W]=D[W];return ce}return D.length=L,D}function Zn(D){for(var H=new Array(D),R=0;R<D;++R)H[R]=0;return H}function ba(D,H,R){var L=1,W=0,z=0,ce=0,ye=0,he=D.length,le=We?new Uint16Array(32):Zn(32);for(z=0;z<32;++z)le[z]=0;for(z=he;z<R;++z)D[z]=0;he=D.length;var de=We?new Uint16Array(he):Zn(he);for(z=0;z<he;++z)le[W=D[z]]++,L<W&&(L=W),de[z]=0;for(le[0]=0,z=1;z<=L;++z)le[z+16]=ye=ye+le[z-1]<<1;for(z=0;z<he;++z)0!=(ye=D[z])&&(de[z]=le[ye+16]++);var Le=0;for(z=0;z<he;++z)if(0!=(Le=D[z]))for(ye=G(de[z],L)>>L-Le,ce=(1<<L+4-Le)-1;ce>=0;--ce)H[ye|ce<<Le]=15&Le|z<<4;return L}var es=We?new Uint16Array(512):Zn(512),Cl=We?new Uint16Array(32):Zn(32);if(!We){for(var An=0;An<512;++An)es[An]=0;for(An=0;An<32;++An)Cl[An]=0}!function(){for(var D=[],H=0;H<32;H++)D.push(5);ba(D,Cl,32);var R=[];for(H=0;H<=143;H++)R.push(8);for(;H<=255;H++)R.push(9);for(;H<=279;H++)R.push(7);for(;H<=287;H++)R.push(8);ba(R,es,288)}();var Ki=function(){for(var H=We?new Uint8Array(32768):[],R=0,L=0;R<Ke.length-1;++R)for(;L<Ke[R+1];++L)H[L]=R;for(;L<32768;++L)H[L]=29;var W=We?new Uint8Array(259):[];for(R=0,L=0;R<ke.length-1;++R)for(;L<ke[R+1];++L)W[L]=R;return function(he,le){return he.length<8?function z(ye,he){for(var le=0;le<ye.length;){var de=Math.min(65535,ye.length-le);for(he.write_shift(1,+(le+de==ye.length)),he.write_shift(2,de),he.write_shift(2,65535&~de);de-- >0;)he[he.l++]=ye[le++]}return he.l}(he,le):function ce(ye,he){for(var le=0,de=0,Le=We?new Uint16Array(32768):[];de<ye.length;){var je=Math.min(65535,ye.length-de);if(je<10){for(7&(le=fi(he,le,+(de+je==ye.length)))&&(le+=8-(7&le)),he.l=le/8|0,he.write_shift(2,je),he.write_shift(2,65535&~je);je-- >0;)he[he.l++]=ye[de++];le=8*he.l}else{le=fi(he,le,+(de+je==ye.length)+2);for(var ft=0;je-- >0;){var Xe=ye[de],Je=-1,At=0;if((Je=Le[ft=32767&(ft<<5^Xe)])&&((Je|=-32768&de)>de&&(Je-=32768),Je<de))for(;ye[Je+At]==ye[de+At]&&At<250;)++At;if(At>2){(Xe=W[At])<=22?le=ya(he,le,Ae[Xe+1]>>1)-1:(ya(he,le,3),ya(he,le+=5,Ae[Xe-23]>>5),le+=3);var _r=Xe<8?0:Xe-4>>2;_r>0&&(Tl(he,le,At-ke[Xe]),le+=_r),le=ya(he,le,Ae[Xe=H[de-Je]]>>3),le-=3;var Rn=Xe<4?0:Xe-2>>1;Rn>0&&(Tl(he,le,de-Je-Ke[Xe]),le+=Rn);for(var Vr=0;Vr<At;++Vr)Le[ft]=32767&de,ft=32767&(ft<<5^ye[de]),++de;je-=At-1}else Xe<=143?Xe+=48:le=Zi(he,le,1),le=ya(he,le,Ae[Xe]),Le[ft]=32767&de,++de}le=ya(he,le,0)-1}}return he.l=(le+7)/8|0,he.l}(he,le)}}();function Bt(D){var H=we(50+Math.floor(1.1*D.length)),R=Ki(D,H);return H.slice(0,R)}var Nr=We?new Uint16Array(32768):Zn(32768),hi=We?new Uint16Array(32768):Zn(32768),Kr=We?new Uint16Array(128):Zn(128),$s=1,Cx=1;function Hv(D,H){var R=Wt(D,H)+257,L=Wt(D,H+=5)+1,W=function cr(D,H){var R=7&H,L=H>>>3;return(D[L]|(R<=4?0:D[L+1]<<8))>>>R&15}(D,H+=5)+4;H+=4;for(var z=0,ce=We?new Uint8Array(19):Zn(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,le=We?new Uint8Array(8):Zn(8),de=We?new Uint8Array(8):Zn(8),Le=ce.length,je=0;je<W;++je)ce[J[je]]=z=Ht(D,H),he<z&&(he=z),le[z]++,H+=3;var ft=0;for(le[0]=0,je=1;je<=he;++je)de[je]=ft=ft+le[je-1]<<1;for(je=0;je<Le;++je)0!=(ft=ce[je])&&(ye[je]=de[ft]++);var Xe=0;for(je=0;je<Le;++je)if(0!=(Xe=ce[je])){ft=Ae[ye[je]]>>8-Xe;for(var Je=(1<<7-Xe)-1;Je>=0;--Je)Kr[ft|Je<<Xe]=7&Xe|je<<3}var At=[];for(he=1;At.length<R+L;)switch(ft=Kr[tt(D,H)],H+=7&ft,ft>>>=3){case 16:for(z=3+or(D,H),H+=2,ft=At[At.length-1];z-- >0;)At.push(ft);break;case 17:for(z=3+Ht(D,H),H+=3;z-- >0;)At.push(0);break;case 18:for(z=11+tt(D,H),H+=7;z-- >0;)At.push(0);break;default:At.push(ft),he<ft&&(he=ft)}var _r=At.slice(0,R),Rn=At.slice(R);for(je=R;je<286;++je)_r[je]=0;for(je=L;je<30;++je)Rn[je]=0;return $s=ba(_r,Nr,286),Cx=ba(Rn,hi,30),H}function Ex(D,H){var L=function Wv(D,H){if(3==D[0]&&!(3&D[1]))return[un(H),2];for(var R=0,L=0,W=js(H||1<<18),z=0,ce=W.length>>>0,ye=0,he=0;!(1&L);)if(L=Ht(D,R),R+=3,L>>>1)for(L>>1==1?(ye=9,he=5):(R=Hv(D,R),ye=$s,he=Cx);;){!H&&ce<z+32767&&(ce=(W=qa(W,z+32767)).length);var de=Lr(D,R,ye),Le=L>>>1==1?es[de]:Nr[de];if(R+=15&Le,(Le>>>=4)>>>8&255){if(256==Le)break;var je=(Le-=257)<8?0:Le-4>>2;je>5&&(je=0);var ft=z+ke[Le];je>0&&(ft+=Lr(D,R,je),R+=je),de=Lr(D,R,he),R+=15&(Le=L>>>1==1?Cl[de]:hi[de]);var Xe=(Le>>>=4)<4?0:Le-2>>1,Je=Ke[Le];for(Xe>0&&(Je+=Lr(D,R,Xe),R+=Xe),!H&&ce<ft&&(ce=(W=qa(W,ft+100)).length);z<ft;)W[z]=W[z-Je],++z}else W[z++]=Le}else{7&R&&(R+=8-(7&R));var le=D[R>>>3]|D[1+(R>>>3)]<<8;if(R+=32,le>0)for(!H&&ce<z+le&&(ce=(W=qa(W,z+le)).length);le-- >0;)W[z++]=D[R>>>3],R+=8}return H?[W,R+7>>>3]:[W.slice(0,z),R+7>>>3]}(D.slice(D.l||0),H);return D.l+=L[1],L[0]}function Sx(D,H){if(!D)throw new Error(H);typeof console<"u"&&console.error(H)}function Ax(D,H){var R=D;Hr(R,0);var z={FileIndex:[],FullPaths:[]};V(z,{root:H.root});for(var ce=R.length-4;(80!=R[ce]||75!=R[ce+1]||5!=R[ce+2]||6!=R[ce+3])&&ce>=0;)--ce;R.l=ce+4,R.l+=4;var ye=R.read_shift(2);R.l+=6;var he=R.read_shift(4);for(R.l=he,ce=0;ce<ye;++ce){R.l+=20;var le=R.read_shift(4),de=R.read_shift(4),Le=R.read_shift(2),je=R.read_shift(2),ft=R.read_shift(2);R.l+=8;var Xe=R.read_shift(4),Je=p(R.slice(R.l+Le,R.l+Le+je));R.l+=Le+je+ft;var At=R.l;R.l=Xe+4,Vv(R,le,de,z,Je),R.l=At}return z}function Vv(D,H,R,L,W){D.l+=2;var z=D.read_shift(2),ce=D.read_shift(2),ye=function u(D){var H=65535&D.read_shift(2),R=65535&D.read_shift(2),L=new Date,W=31&R,z=15&(R>>>=5);R>>>=4,L.setMilliseconds(0),L.setFullYear(R+1980),L.setMonth(z-1),L.setDate(W);var ce=31&H,ye=63&(H>>>=5);return L.setHours(H>>>=6),L.setMinutes(ye),L.setSeconds(ce<<1),L}(D);if(8257&z)throw new Error("Unsupported ZIP encryption");D.read_shift(4);for(var le=D.read_shift(4),de=D.read_shift(4),Le=D.read_shift(2),je=D.read_shift(2),ft="",Xe=0;Xe<Le;++Xe)ft+=String.fromCharCode(D[D.l++]);if(je){var Je=p(D.slice(D.l,D.l+je));(Je[21589]||{}).mt&&(ye=Je[21589].mt),((W||{})[21589]||{}).mt&&(ye=W[21589].mt)}D.l+=je;var At=D.slice(D.l,D.l+le);switch(ce){case 8:At=function fe(D,H){if(!Ee)return Ex(D,H);var L=new(0,Ee.InflateRaw),W=L._processChunk(D.slice(D.l),L._finishFlushFlag);return D.l+=L.bytesRead,W}(D,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var _r=!1;8&z&&(134695760==D.read_shift(4)&&(D.read_shift(4),_r=!0),le=D.read_shift(4),de=D.read_shift(4)),le!=H&&Sx(_r,"Bad compressed size: "+H+" != "+le),de!=R&&Sx(_r,"Bad uncompressed size: "+R+" != "+de),M1(L,ft,At,{unsafe:!0,mt:ye})}var kh={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $v(D,H){if(D.ctype)return D.ctype;var R=D.name||"",L=R.match(/\.([^\.]+)$/);return L&&kh[L[1]]||H&&(L=(R=H).match(/[\.\\]([^\.\\])+$/))&&kh[L[1]]?kh[L[1]]:"application/octet-stream"}function Gv(D){for(var H=_t(D),R=[],L=0;L<H.length;L+=76)R.push(H.slice(L,L+76));return R.join("\r\n")+"\r\n"}function jv(D){var H=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var de=le.charCodeAt(0).toString(16).toUpperCase();return"="+(1==de.length?"0"+de:de)});"\n"==(H=H.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(H="=0D"+H.slice(1));for(var R=[],L=(H=H.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),W=0;W<L.length;++W){var z=L[W];if(0!=z.length)for(var ce=0;ce<z.length;){var ye=76,he=z.slice(ce,ce+ye);"="==he.charAt(ye-1)?ye--:"="==he.charAt(ye-2)?ye-=2:"="==he.charAt(ye-3)&&(ye-=3),he=z.slice(ce,ce+ye),(ce+=ye)<z.length&&(he+="="),R.push(he)}else R.push("")}return R.join("\r\n")}function Yv(D,H,R){for(var ce,L="",W="",z="",ye=0;ye<10;++ye){var he=H[ye];if(!he||he.match(/^\s*$/))break;var le=he.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":L=le[2].trim();break;case"content-type":z=le[2].trim();break;case"content-transfer-encoding":W=le[2].trim()}}switch(++ye,W.toLowerCase()){case"base64":ce=Sr(Ut(H.slice(ye).join("")));break;case"quoted-printable":ce=function Xv(D){for(var H=[],R=0;R<D.length;++R){for(var L=D[R];R<=D.length&&"="==L.charAt(L.length-1);)L=L.slice(0,L.length-1)+D[++R];H.push(L)}for(var W=0;W<H.length;++W)H[W]=H[W].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Sr(H.join("\r\n"))}(H.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var de=M1(D,L.slice(R.length),ce,{unsafe:!0});z&&(de.ctype=z)}function M1(D,H,R,L){var W=L&&L.unsafe;W||V(D);var z=!W&&et.find(D,H);if(!z){var ce=D.FullPaths[0];H.slice(0,ce.length)==ce?ce=H:("/"!=ce.slice(-1)&&(ce+="/"),ce=(ce+H).replace("//","/")),z={name:o(H),type:2},D.FileIndex.push(z),D.FullPaths.push(ce),W||et.utils.cfb_gc(D)}return z.content=R,z.size=R?R.length:0,L&&(L.CLSID&&(z.clsid=L.CLSID),L.mt&&(z.mt=L.mt),L.ct&&(z.ct=L.ct)),z}return r.find=function _e(D,H){var R=D.FullPaths.map(function(he){return he.toUpperCase()}),L=R.map(function(he){var le=he.split("/");return le[le.length-("/"==he.slice(-1)?2:1)]}),W=!1;47===H.charCodeAt(0)?(W=!0,H=R[0].slice(0,-1)+H):W=-1!==H.indexOf("/");var z=H.toUpperCase(),ce=!0===W?R.indexOf(z):L.indexOf(z);if(-1!==ce)return D.FileIndex[ce];var ye=!z.match(Ln);for(z=z.replace(Or,""),ye&&(z=z.replace(Ln,"!")),ce=0;ce<R.length;++ce)if((ye?R[ce].replace(Ln,"!"):R[ce]).replace(Or,"")==z||(ye?L[ce].replace(Ln,"!"):L[ce]).replace(Or,"")==z)return D.FileIndex[ce];return null},r.read=function ee(D,H){var R=H&&H.type;switch(R||wt&&Buffer.isBuffer(D)&&(R="buffer"),R||"base64"){case"file":return function se(D,H){return _(),w(x.readFileSync(D),H)}(D,H);case"base64":return w(Sr(Ut(D)),H);case"binary":return w(Sr(D),H)}return w(D,H)},r.parse=w,r.write=function pt(D,H){var R=ge(D,H);switch(H&&H.type||"buffer"){case"file":return _(),x.writeFileSync(H.filename,R),R;case"binary":return"string"==typeof R?R:qe(R);case"base64":return _t("string"==typeof R?R:qe(R));case"buffer":if(wt)return Buffer.isBuffer(R)?R:hn(R);case"array":return"string"==typeof R?Sr(R):R}return R},r.writeFile=function Nt(D,H,R){_();var L=ge(D,R);x.writeFileSync(H,L)},r.utils={cfb_new:function Jv(D){var H={};return V(H,D),H},cfb_add:M1,cfb_del:function Qv(D,H){V(D);var R=et.find(D,H);if(R)for(var L=0;L<D.FileIndex.length;++L)if(D.FileIndex[L]==R)return D.FileIndex.splice(L,1),D.FullPaths.splice(L,1),!0;return!1},cfb_mov:function qv(D,H,R){V(D);var L=et.find(D,H);if(L)for(var W=0;W<D.FileIndex.length;++W)if(D.FileIndex[W]==L)return D.FileIndex[W].name=o(R),D.FullPaths[W]=R,!0;return!1},cfb_gc:function e2(D){te(D,!0)},ReadShift:Wn,CheckField:ta,prep_blob:Hr,bconcat:lr,use_zlib:function X(D){try{var R=new(0,D.InflateRaw);if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),!R.bytesRead)throw new Error("zlib does not expose bytesRead");Ee=D}catch(L){console.error("cannot use native zlib: "+(L.message||L))}},_deflateRaw:Bt,_inflateRaw:Ex,consts:ot},r}();let Jr;function ec(e){return"string"==typeof e?ui(e):Array.isArray(e)?function jo(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Un(e,r,t){if(typeof Jr<"u"&&Jr.writeFileSync)return t?Jr.writeFileSync(e,r,t):Jr.writeFileSync(e,r);if(typeof Deno<"u"){if(t&&"string"==typeof r)switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=ui(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var s="utf8"==t?ri(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var o=new Blob([ec(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var f=URL.createObjectURL(o);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),chrome.downloads.download({url:f,filename:e,saveAs:!0});var u=document.createElement("a");if(null!=u.download)return u.download=e,u.href=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),f}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var p=File(e);return p.open("w"),p.encoding="binary",Array.isArray(r)&&(r=Jn(r)),p.write(r),p.close(),r}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+e)}function fr(e){for(var r=Object.keys(e),t=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e,r[s])&&t.push(r[s]);return t}function tc(e,r){for(var t=[],s=fr(e),o=0;o!==s.length;++o)null==t[e[s[o]][r]]&&(t[e[s[o]][r]]=s[o]);return t}function ss(e){for(var r=[],t=fr(e),s=0;s!==t.length;++s)r[e[t[s]]]=t[s];return r}function rc(e){for(var r=[],t=fr(e),s=0;s!==t.length;++s)r[e[t[s]]]=parseInt(t[s],10);return r}var os=new Date(1899,11,30,0,0,0);function Ir(e,r){var t=e.getTime();return r&&(t-=1263168e5),(t-(os.getTime()+6e4*(e.getTimezoneOffset()-os.getTimezoneOffset())))/864e5}var qs=new Date,Qr=os.getTime()+6e4*(qs.getTimezoneOffset()-os.getTimezoneOffset()),Dl=qs.getTimezoneOffset();function cs(e){var r=new Date;return r.setTime(24*e*60*60*1e3+Qr),r.getTimezoneOffset()!==Dl&&r.setTime(r.getTime()+6e4*(r.getTimezoneOffset()-Dl)),r}function Ol(e){var r=0,t=0,s=!1,o=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!o)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var f=1;f!=o.length;++f)if(o[f]){switch(t=1,f>3&&(s=!0),o[f].slice(o[f].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+o[f].slice(o[f].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!s)throw new Error("Unsupported ISO Duration Field: M");t*=60}r+=t*parseInt(o[f],10)}return r}var ls=new Date("2017-02-19T19:06:09.000Z"),nc=isNaN(ls.getFullYear())?new Date("2/19/17"):ls,Il=2017==nc.getFullYear();function Zt(e,r){var t=new Date(e);if(Il)return r>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==nc.getFullYear()&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],f=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(f=new Date(f.getTime()-60*f.getTimezoneOffset()*1e3)),f}function pi(e,r){if(wt&&Buffer.isBuffer(e)){if(r){if(255==e[0]&&254==e[1])return ri(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return ri(at(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(255==e[0]&&254==e[1])return ri(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return ri(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(f){return t[f]||f})}catch{}for(var s=[],o=0;o!=e.length;++o)s.push(String.fromCharCode(e[o]));return s.join("")}function tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=tr(e[t]));return r}function dr(e,r){for(var t="";t.length<r;)t+=e;return t}function Hn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(s))&&(s=s.replace(/[(](.*)[)]/,function(o,f){return t=-t,f}),isNaN(r=Number(s)))?r:r/t}var Th=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sa(e){var r=new Date(e),t=new Date(NaN),s=r.getYear(),o=r.getMonth(),f=r.getDate();if(isNaN(f))return t;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Th.indexOf(u))return t}else if(u.match(/[a-z]/))return t;return s<0||s>8099?t:(o>0||f>1)&&101!=s?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Ch=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,s,o){if(e||"string"==typeof s)return t.split(s);for(var f=t.split(s),u=[f[0]],p=1;p<f.length;++p)u.push(o),u.push(f[p]);return u}}();function ic(e){return e?e.content&&e.type?pi(e.content,!0):e.data?Be(e.data):e.asNodeBuffer&&wt?Be(e.asNodeBuffer().toString("binary")):e.asBinary?Be(e.asBinary()):e._data&&e._data.getContent?Be(pi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Pl(e){if(!e)return null;if(e.data)return Qe(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return"string"==typeof r?Qe(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function kn(e,r){for(var t=e.FullPaths||fr(e.files),s=r.toLowerCase().replace(/[\/]/g,"\\"),o=s.replace(/\\/g,"/"),f=0;f<t.length;++f){var u=t[f].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==u||o==u)return e.files?e.files[t[f]]:e.FileIndex[f]}return null}function ac(e,r){var t=kn(e,r);if(null==t)throw new Error("Cannot find file "+r+" in zip");return t}function xr(e,r,t){if(!t)return function fs(e){return e&&".bin"===e.name.slice(-4)?Pl(e):ic(e)}(ac(e,r));if(!r)return null;try{return xr(e,r)}catch{return null}}function Tn(e,r,t){if(!t)return ic(ac(e,r));if(!r)return null;try{return Tn(e,r)}catch{return null}}function Si(e,r,t){if(!t)return Pl(ac(e,r));if(!r)return null;try{return Si(e,r)}catch{return null}}function eo(e){for(var r=e.FullPaths||fr(e.files),t=[],s=0;s<r.length;++s)"/"!=r[s].slice(-1)&&t.push(r[s].replace(/^Root Entry[\/]/,""));return t.sort()}function Ct(e,r,t){if(e.FullPaths){var s;if("string"==typeof t)return s=wt?hn(t):function wi(e){for(var r=[],t=0,s=e.length+250,o=un(e.length+255),f=0;f<e.length;++f){var u=e.charCodeAt(f);if(u<128)o[t++]=u;else if(u<2048)o[t++]=192|u>>6&31,o[t++]=128|63&u;else if(u>=55296&&u<57344){u=64+(1023&u);var p=1023&e.charCodeAt(++f);o[t++]=240|u>>8&7,o[t++]=128|u>>2&63,o[t++]=128|p>>6&15|(3&u)<<4,o[t++]=128|63&p}else o[t++]=224|u>>12&15,o[t++]=128|u>>6&63,o[t++]=128|63&u;t>s&&(r.push(o.slice(0,t)),t=0,o=un(65535),s=65530)}return r.push(o.slice(0,t)),lr(r)}(t),et.utils.cfb_add(e,r,s);et.utils.cfb_add(e,r,t)}else e.file(r,t)}function hs(){return et.utils.cfb_new()}function Ml(e,r){switch(r.type){case"base64":return et.read(e,{type:"base64"});case"binary":return et.read(e,{type:"binary"});case"buffer":case"array":return et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function ar(e,r){if("/"==e.charAt(0))return e.slice(1);var t=r.split("/");"/"!=r.slice(-1)&&t.pop();for(var s=e.split("/");0!==s.length;){var o=s.shift();".."===o?t.pop():"."!==o&&t.push(o)}return t.join("/")}var vr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',to=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Rl=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,$r=vr.match(Rl)?Rl:/<[^>]*>/g,sc=/<\w*:/,Ll=/<(\/?)\w+:/;function mt(e,r,t){for(var s={},o=0,f=0;o!==e.length&&32!==(f=e.charCodeAt(o))&&10!==f&&13!==f;++o);if(r||(s[0]=e.slice(0,o)),o===e.length)return s;var u=e.match(to),p=0,x="",_=0,w="",T="",C=1;if(u)for(_=0;_!=u.length;++_){for(T=u[_],f=0;f!=T.length&&61!==T.charCodeAt(f);++f);for(w=T.slice(0,f).trim();32==T.charCodeAt(f+1);)++f;for(C=34==(o=T.charCodeAt(f+1))||39==o?1:0,x=T.slice(f+1+C,T.length-C),p=0;p!=w.length&&58!==w.charCodeAt(p);++p);if(p===w.length)w.indexOf("_")>0&&(w=w.slice(0,w.indexOf("_"))),s[w]=x,t||(s[w.toLowerCase()]=x);else{var E=(5===p&&"xmlns"===w.slice(0,5)?"xmlns":"")+w.slice(p+1);if(s[E]&&"ext"==w.slice(p-3,p))continue;s[E]=x,t||(s[E.toLowerCase()]=x)}}return s}function Cn(e){return e.replace(Ll,"<$1")}var us={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oc=ss(us),zt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,r=/_x([\da-fA-F]{4})_/gi;return function t(s){var o=s+"",f=o.indexOf("<![CDATA[");if(-1==f)return o.replace(e,function(p,x){return us[p]||String.fromCharCode(parseInt(x,p.indexOf("x")>-1?16:10))||p}).replace(r,function(p,x){return String.fromCharCode(parseInt(x,16))});var u=o.indexOf("]]>");return t(o.slice(0,f))+o.slice(f+9,u)+t(o.slice(u+3))}}(),cc=/[&<>'"]/g,Eh=/[\u0000-\u0008\u000b-\u001f]/g;function Kt(e){return(e+"").replace(cc,function(t){return oc[t]}).replace(Eh,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ai(e){return Kt(e).replace(/ /g,"_x0020_")}var Aa=/[\u0000-\u001f]/g;function lc(e){return(e+"").replace(cc,function(t){return oc[t]}).replace(/\n/g,"<br/>").replace(Aa,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Nl=function(){var e=/&#(\d+);/g;function r(t,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,r)}}();function sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ro(e){for(var r="",t=0,s=0,o=0,f=0,u=0,p=0;t<e.length;)(s=e.charCodeAt(t++))<128?r+=String.fromCharCode(s):(o=e.charCodeAt(t++),s>191&&s<224?(u=(31&s)<<6,u|=63&o,r+=String.fromCharCode(u)):(f=e.charCodeAt(t++),s<240?r+=String.fromCharCode((15&s)<<12|(63&o)<<6|63&f):(p=((7&s)<<18|(63&o)<<12|(63&f)<<6|63&(u=e.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(p>>>10&1023)),r+=String.fromCharCode(56320+(1023&p)))));return r}function Fi(e){var t,s,p,r=un(2*e.length),o=1,f=0,u=0;for(s=0;s<e.length;s+=o)o=1,(p=e.charCodeAt(s))<128?t=p:p<224?(t=64*(31&p)+(63&e.charCodeAt(s+1)),o=2):p<240?(t=4096*(15&p)+64*(63&e.charCodeAt(s+1))+(63&e.charCodeAt(s+2)),o=3):(o=4,t=262144*(7&p)+4096*(63&e.charCodeAt(s+1))+64*(63&e.charCodeAt(s+2))+(63&e.charCodeAt(s+3)),u=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==u&&(r[f++]=255&u,r[f++]=u>>>8,u=0),r[f++]=t%256,r[f++]=t>>>8;return r.slice(0,f).toString("ucs2")}function Gr(e){return hn(e,"binary").toString("utf8")}var wr="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",jt=wt&&(Gr(wr)==ro(wr)&&Gr||Fi(wr)==ro(wr)&&Fi)||ro,ri=wt?function(e){return hn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,s=0,o=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(63&s)));break;case s>=55296&&s<57344:s-=55296,o=e.charCodeAt(t++)-56320+(s<<10),r.push(String.fromCharCode(240+(o>>18&7))),r.push(String.fromCharCode(144+(o>>12&63))),r.push(String.fromCharCode(128+(o>>6&63))),r.push(String.fromCharCode(128+(63&o)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(63&s)))}return r.join("")},In=function(){var e={};return function(t,s){var o=t+"|"+(s||"");return e[o]?e[o]:e[o]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",s||"")}}(),no=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),o=0;o<e.length;++o)s=s.replace(e[o][0],e[o][1]);return s}}(),Fa=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Bl=/<\/?(?:vt:)?variant>/g,Fh=/<(?:vt:)([^>]*)>([\s\S]*)</;function io(e,r){var t=mt(e),s=e.match(Fa(t.baseType))||[],o=[];if(s.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+s.length+" != "+t.size);return o}return s.forEach(function(f){var u=f.replace(Bl,"").match(Fh);u&&o.push({v:jt(u[2]),t:u[1]})}),o}var fc=/(^\s|\s$|\n)/;function jr(e,r){return"<"+e+(r.match(fc)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function ds(e){return fr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ue(e,r,t){return"<"+e+(null!=t?ds(t):"")+(null!=r?(r.match(fc)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function ao(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function hc(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return jt(Jn(nn(e)));throw new Error("Bad input format: expected Buffer or string")}var qi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Cr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Di=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],En={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},Wl=function(e){for(var r=[],s=0;s<e[0].length;++s)if(e[0][s])for(var o=0,f=e[0][s].length;o<f;o+=10240)r.push.apply(r,e[0][s].slice(o,o+10240));return r},uc=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:hn(r)})):Wl(e)}:Wl,Vl=function(e,r,t){for(var s=[],o=r;o<t;o+=2)s.push(String.fromCharCode(Pn(e,o)));return s.join("").replace(Or,"")},mi=wt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Or,""):Vl(e,r,t)}:Vl,dc=function(e,r,t){for(var s=[],o=r;o<r+t;++o)s.push(("0"+e[o].toString(16)).slice(-2));return s.join("")},zl=wt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):dc(e,r,t)}:dc,$l=function(e,r,t){for(var s=[],o=r;o<t;o++)s.push(String.fromCharCode(Pa(e,o)));return s.join("")},Da=wt?function(r,t,s){return Buffer.isBuffer(r)?r.toString("utf8",t,s):$l(r,t,s)}:$l,Gl=function(e,r){var t=Pr(e,r);return t>0?Da(e,r+4,r+4+t-1):""},Oa=Gl,jl=function(e,r){var t=Pr(e,r);return t>0?Da(e,r+4,r+4+t-1):""},pc=jl,so=function(e,r){var t=2*Pr(e,r);return t>0?Da(e,r+4,r+4+t-1):""},ps=so,ms=function(r,t){var s=Pr(r,t);return s>0?mi(r,t+4,t+4+s):""},Ia=ms,Xl=function(e,r){var t=Pr(e,r);return t>0?Da(e,r+4,r+4+t):""},mc=Xl,Oi=function(e,r){return function Ul(e,r){for(var t=1-2*(e[r+7]>>>7),s=((127&e[r+7])<<4)+(e[r+6]>>>4&15),o=15&e[r+6],f=5;f>=0;--f)o=256*o+e[r+f];return 2047==s?0==o?t*(1/0):NaN:(0==s?s=-1022:(s-=1023,o+=Math.pow(2,52)),t*Math.pow(2,s-52)*o)}(e,r)},oo=Oi,gc=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};wt&&(Oa=function(r,t){if(!Buffer.isBuffer(r))return Gl(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},pc=function(r,t){if(!Buffer.isBuffer(r))return jl(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},ps=function(r,t){if(!Buffer.isBuffer(r))return so(r,t);var s=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s-1)},Ia=function(r,t){if(!Buffer.isBuffer(r))return ms(r,t);var s=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s)},mc=function(r,t){if(!Buffer.isBuffer(r))return Xl(r,t);var s=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+s)},oo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Oi(r,t)},gc=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),typeof ue<"u"&&function Ii(){mi=function(e,r,t){return ue.utils.decode(1200,e.slice(r,t)).replace(Or,"")},Da=function(e,r,t){return ue.utils.decode(65001,e.slice(r,t))},Oa=function(e,r){var t=Pr(e,r);return t>0?ue.utils.decode(Ze,e.slice(r+4,r+4+t-1)):""},pc=function(e,r){var t=Pr(e,r);return t>0?ue.utils.decode(U,e.slice(r+4,r+4+t-1)):""},ps=function(e,r){var t=2*Pr(e,r);return t>0?ue.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},Ia=function(e,r){var t=Pr(e,r);return t>0?ue.utils.decode(1200,e.slice(r+4,r+4+t)):""},mc=function(e,r){var t=Pr(e,r);return t>0?ue.utils.decode(65001,e.slice(r+4,r+4+t)):""}}();var Pa=function(e,r){return e[r]},Pn=function(e,r){return 256*e[r+1]+e[r]},Oh=function(e,r){var t=256*e[r+1]+e[r];return t<32768?t:-1*(65535-t+1)},Pr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ea=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Yl=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Wn(e,r){var s,o,u,p,x,_,t="",f=[];switch(r){case"dbcs":if(_=this.l,wt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(x=0;x<e;++x)t+=String.fromCharCode(Pn(this,_)),_+=2;e*=2;break;case"utf8":t=Da(this,this.l,this.l+e);break;case"utf16le":t=mi(this,this.l,this.l+(e*=2));break;case"wstr":if(!(typeof ue<"u"))return Wn.call(this,e,"dbcs");t=ue.utils.decode(U,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":t=Oa(this,this.l),e=4+Pr(this,this.l);break;case"lpstr-cp":t=pc(this,this.l),e=4+Pr(this,this.l);break;case"lpwstr":t=ps(this,this.l),e=4+2*Pr(this,this.l);break;case"lpp4":e=4+Pr(this,this.l),t=Ia(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Pr(this,this.l),t=mc(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,t="";0!==(u=Pa(this,this.l+e++));)f.push(De(u));t=f.join("");break;case"_wstr":for(e=0,t="";0!==(u=Pn(this,this.l+e));)f.push(De(u)),e+=2;e+=2,t=f.join("");break;case"dbcs-cont":for(t="",_=this.l,x=0;x<e;++x){if(this.lens&&-1!==this.lens.indexOf(_))return u=Pa(this,_),this.l=_+1,p=Wn.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(De(Pn(this,_))),_+=2}t=f.join(""),e*=2;break;case"cpstr":if(typeof ue<"u"){t=ue.utils.decode(U,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",_=this.l,x=0;x!=e;++x){if(this.lens&&-1!==this.lens.indexOf(_))return u=Pa(this,_),this.l=_+1,p=Wn.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(De(Pa(this,_))),_+=1}t=f.join("");break;default:switch(e){case 1:return s=Pa(this,this.l),this.l++,s;case 2:return s=("i"===r?Oh:Pn)(this,this.l),this.l+=2,s;case 4:case-4:return"i"!==r&&128&this[this.l+3]?(o=Pr(this,this.l),this.l+=4,o):(s=(e>0?ea:Yl)(this,this.l),this.l+=4,s);case 8:case-8:if("f"===r)return o=8==e?oo(this,this.l):oo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:t=zl(this,this.l,e)}}return this.l+=e,t}var Ih=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Ph=function(e,r,t){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Mh=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255};function Rh(e,r,t){var s=0,o=0;if("dbcs"===t){for(o=0;o!=r.length;++o)Mh(this,r.charCodeAt(o),this.l+2*o);s=2*r.length}else if("sbcs"===t){if(typeof ue<"u"&&874==Ze)for(o=0;o!=r.length;++o){var f=ue.utils.encode(Ze,r.charAt(o));this[this.l+o]=f[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=r.length;++o)this[this.l+o]=255&r.charCodeAt(o);s=r.length}else{if("hex"===t){for(;o<e;++o)this[this.l++]=parseInt(r.slice(2*o,2*o+2),16)||0;return this}if("utf16le"===t){var u=Math.min(this.l+e,this.length);for(o=0;o<Math.min(r.length,e);++o){var p=r.charCodeAt(o);this[this.l++]=255&p,this[this.l++]=p>>8}for(;this.l<u;)this[this.l++]=0;return this}switch(e){case 1:s=1,this[this.l]=255&r;break;case 2:s=2,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8);break;case 3:s=3,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8),this[this.l+2]=255&(r>>>=8);break;case 4:s=4,Ih(this,r,this.l);break;case 8:if(s=8,"f"===t){!function Hl(e,r,t){var s=(r<0||1/r==-1/0?1:0)<<7,o=0,f=0,u=s?-r:r;isFinite(u)?0==u?o=f=0:(o=Math.floor(Math.log(u)/Math.LN2),f=u*Math.pow(2,52-o),o<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?o=-1022:(f-=Math.pow(2,52),o+=1023)):(o=2047,f=isNaN(r)?26985:0);for(var p=0;p<=5;++p,f/=256)e[t+p]=255&f;e[t+6]=(15&o)<<4|15&f,e[t+7]=o>>4|s}(this,r,this.l);break}case 16:break;case-4:s=4,Ph(this,r,this.l)}}return this.l+=s,this}function ta(e,r){var t=zl(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Hr(e,r){e.l=r,e.read_shift=Wn,e.chk=ta,e.write_shift=Rh}function Xr(e,r){e.l+=r}function we(e){var r=un(e);return Hr(r,0),r}function ni(e,r,t){if(e){var s,o,f;Hr(e,e.l||0);for(var u=e.length,p=0,x=0;e.l<u;){128&(p=e.read_shift(1))&&(p=(127&p)+((127&e.read_shift(1))<<7));var _=wl[p]||wl[65535];for(f=127&(s=e.read_shift(1)),o=1;o<4&&128&s;++o)f+=(127&(s=e.read_shift(1)))<<7*o;x=e.l+f;var w=_.f&&_.f(e,f,t);if(e.l=x,r(w,_,p))return}}}function sn(){var e=[],r=wt?256:2048,t=function(_){var w=we(_);return Hr(w,0),w},s=t(r),o=function(){s&&(s.length>s.l&&((s=s.slice(0,s.l)).l=s.length),s.length>0&&e.push(s),s=null)},f=function(_){return s&&_<s.length-s.l?s:(o(),s=t(Math.max(_+1,r)))};return{next:f,push:function(_){o(),null==(s=_).l&&(s.l=s.length),f(r)},end:function(){return o(),lr(e)},_bufs:e}}function Se(e,r,t,s){var f,o=+r;if(!isNaN(o)){s||(s=wl[o].p||(t||[]).length||0),f=1+(o>=128?1:0)+1,s>=128&&++f,s>=16384&&++f,s>=2097152&&++f;var u=e.next(f);o<=127?u.write_shift(1,o):(u.write_shift(1,128+(127&o)),u.write_shift(1,o>>7));for(var p=0;4!=p;++p){if(!(s>=128)){u.write_shift(1,s);break}u.write_shift(1,128+(127&s)),s>>=7}s>0&&gc(t)&&e.push(t)}}function Ma(e,r,t){var s=tr(e);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Zl(e,r,t){var s=tr(e);return s.s=Ma(s.s,r.s,t),s.e=Ma(s.e,r.s,t),s}function gs(e,r){if(e.cRel&&e.c<0)for(e=tr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=tr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=bt(e);return!e.cRel&&null!=e.cRel&&(t=function Jl(e){return e.replace(/^([A-Z])/,"$$$1")}(t)),!e.rRel&&null!=e.rRel&&(t=function Kl(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function xc(e,r){return 0!=e.s.r||e.s.rRel||e.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(r.biff>=12?16383:255)||e.e.cRel?gs(e.s,r.biff)+":"+gs(e.e,r.biff):(e.s.rRel?"":"$")+yr(e.s.r)+":"+(e.e.rRel?"":"$")+yr(e.e.r):(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c)}function co(e){return parseInt(function Lh(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1}function yr(e){return""+(e+1)}function _c(e){for(var r=function Nh(e){return e.replace(/^\$([A-Z])/,"$1")}(e),t=0,s=0;s!==r.length;++s)t=26*t+r.charCodeAt(s)-64;return t-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function pr(e){for(var r=0,t=0,s=0;s<e.length;++s){var o=e.charCodeAt(s);o>=48&&o<=57?r=10*r+(o-48):o>=65&&o<=90&&(t=26*t+(o-64))}return{c:t-1,r:r-1}}function bt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function on(e){var r=e.indexOf(":");return-1==r?{s:pr(e),e:pr(e)}:{s:pr(e.slice(0,r)),e:pr(e.slice(r+1))}}function Et(e,r){return typeof r>"u"||"number"==typeof r?Et(e.s,e.e):("string"!=typeof e&&(e=bt(e)),"string"!=typeof r&&(r=bt(r)),e==r?e:e+":"+r)}function Lt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,o=0,f=e.length;for(t=0;s<f&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)t=26*t+o;for(r.s.c=--t,t=0;s<f&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)t=10*t+o;if(r.s.r=--t,s===f||10!=o)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,t=0;s!=f&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)t=26*t+o;for(r.e.c=--t,t=0;s!=f&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)t=10*t+o;return r.e.r=--t,r}function Vn(e,r,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?ai[e.v]||e.v:function Ql(e,r){var t="d"==e.t&&r instanceof Date;if(null!=e.z)try{return e.w=M(e.z,t?Ir(r):r)}catch{}try{return e.w=M((e.XF||{}).numFmtId||(t?14:0),t?Ir(r):r)}catch{return""+r}}(e,null==r?e.v:r))}function gi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function ql(e,r,t){var s=t||{},o=e?Array.isArray(e):s.dense;null!=ut&&null==o&&(o=ut);var f=e||(o?[]:{}),u=0,p=0;if(f&&null!=s.origin){if("number"==typeof s.origin)u=s.origin;else{var x="string"==typeof s.origin?pr(s.origin):s.origin;u=x.r,p=x.c}f["!ref"]||(f["!ref"]="A1:A1")}var _={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var w=Lt(f["!ref"]);_.s.c=w.s.c,_.s.r=w.s.r,_.e.c=Math.max(_.e.c,w.e.c),_.e.r=Math.max(_.e.r,w.e.r),-1==u&&(_.e.r=u=w.e.r+1)}for(var T=0;T!=r.length;++T)if(r[T]){if(!Array.isArray(r[T]))throw new Error("aoa_to_sheet expects an array of arrays");for(var C=0;C!=r[T].length;++C)if(!(typeof r[T][C]>"u")){var E={v:r[T][C]},A=u+T,k=p+C;if(_.s.r>A&&(_.s.r=A),_.s.c>k&&(_.s.c=k),_.e.r<A&&(_.e.r=A),_.e.c<k&&(_.e.c=k),!r[T][C]||"object"!=typeof r[T][C]||Array.isArray(r[T][C])||r[T][C]instanceof Date)if(Array.isArray(E.v)&&(E.f=r[T][C][1],E.v=E.v[0]),null===E.v)if(E.f)E.t="n";else if(s.nullError)E.t="e",E.v=0;else{if(!s.sheetStubs)continue;E.t="z"}else"number"==typeof E.v?E.t="n":"boolean"==typeof E.v?E.t="b":E.v instanceof Date?(E.z=s.dateNF||vt[14],s.cellDates?(E.t="d",E.w=M(E.z,Ir(E.v))):(E.t="n",E.v=Ir(E.v),E.w=M(E.z,E.v))):E.t="s";else E=r[T][C];if(o)f[A]||(f[A]=[]),f[A][k]&&f[A][k].z&&(E.z=f[A][k].z),f[A][k]=E;else{var F=bt({c:k,r:A});f[F]&&f[F].z&&(E.z=f[F].z),f[F]=E}}}return _.s.c<1e7&&(f["!ref"]=Et(_)),f}function ra(e,r){return ql(null,e,r)}function zn(e,r){return r||(r=we(4)),r.write_shift(4,e),r}function qr(e){var r=e.read_shift(4);return 0===r?"":e.read_shift(r,"dbcs")}function Mr(e,r){var t=!1;return null==r&&(t=!0,r=we(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function e0(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function wc(e,r){var t=e.l,s=e.read_shift(1),o=qr(e),f=[],u={t:o,h:o};if(1&s){for(var p=e.read_shift(4),x=0;x!=p;++x)f.push(e0(e));u.r=f}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}var xs=wc;function Sn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function na(e,r){return null==r&&(r=we(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function gn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function ia(e,r){return null==r&&(r=we(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Wh=qr,t0=Mr;function bc(e){var r=e.read_shift(4);return 0===r||4294967295===r?"":e.read_shift(r,"dbcs")}function lo(e,r){var t=!1;return null==r&&(t=!0,r=we(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var r0=qr,fo=bc,_s=lo;function kc(e){var r=e.slice(e.l,e.l+4),t=1&r[0],s=2&r[0];e.l+=4;var o=0===s?oo([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):ea(r,0)>>2;return t?o/100:o}function n0(e,r){null==r&&(r=we(4));var t=0,s=0,o=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?s=1:o==(0|o)&&o>=-(1<<29)&&o<1<<29&&(s=1,t=1),!s)throw new Error("unsupported RkNumber "+e);r.write_shift(-4,((t?o:e)<<2)+(t+2))}function i0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var aa=i0,sa=function a0(e,r){return r||(r=we(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r};function en(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oa(e,r){return(r||we(8)).write_shift(8,e,"f")}function ho(e,r){if(r||(r=we(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;null!=e.index?(r.write_shift(1,2),r.write_shift(1,e.index)):null!=e.theme?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),e.rgb&&null==e.theme){var s=e.rgb||"FFFFFF";"number"==typeof s&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}else r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r}function Cc(e,r){var s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,1==r?"lpstr":"lpwstr")}var s0=2,xn=3,uo=12,o0=81,c0=[80,o0],ca={1:{n:"CodePage",t:s0},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:xn},5:{n:"LineCount",t:xn},6:{n:"ParagraphCount",t:xn},7:{n:"SlideCount",t:xn},8:{n:"NoteCount",t:xn},9:{n:"HiddenCount",t:xn},10:{n:"MultimediaClipCount",t:xn},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:xn},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:xn,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},mo={1:{n:"CodePage",t:s0},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:xn},15:{n:"WordCount",t:xn},16:{n:"CharCount",t:xn},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:xn},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Ra={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jh=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Xh(e){return e.map(function(r){return[r>>16&255,r>>8&255,255&r]})}var la=tr(Xh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ai={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ac={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},go={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ws(e,r){var o,t=function Fl(e){for(var r=[],t=fr(e),s=0;s!==t.length;++s)null==r[e[t[s]]]&&(r[e[t[s]]]=[]),r[e[t[s]]].push(t[s]);return r}(Fc),s=[];s[s.length]=vr,s[s.length]=Ue("Types",null,{xmlns:Cr.CT,"xmlns:xsd":Cr.xsd,"xmlns:xsi":Cr.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(x){return Ue("Default",null,{Extension:x[0],ContentType:x[1]})}));var f=function(x){e[x]&&e[x].length>0&&(s[s.length]=Ue("Override",null,{PartName:("/"==(o=e[x][0])[0]?"":"/")+o,ContentType:go[x][r.bookType]||go[x].xlsx}))},u=function(x){(e[x]||[]).forEach(function(_){s[s.length]=Ue("Override",null,{PartName:("/"==_[0]?"":"/")+_,ContentType:go[x][r.bookType]||go[x].xlsx})})},p=function(x){(e[x]||[]).forEach(function(_){s[s.length]=Ue("Override",null,{PartName:("/"==_[0]?"":"/")+_,ContentType:t[x][0]})})};return f("workbooks"),u("sheets"),u("charts"),p("themes"),["strs","styles"].forEach(f),["coreprops","extprops","custprops"].forEach(p),p("vba"),p("comments"),p("threadedcomments"),p("drawings"),u("metadata"),p("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ar(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function La(e,r){var t={"!id":{}};if(!e)return t;"/"!==r.charAt(0)&&(r="/"+r);var s={};return(e.match($r)||[]).forEach(function(o){var f=mt(o);if("<Relationship"===f[0]){var u={};u.Type=f.Type,u.Target=f.Target,u.Id=f.Id,f.TargetMode&&(u.TargetMode=f.TargetMode);var p="External"===f.TargetMode?f.Target:ar(f.Target,r);t[p]=u,s[f.Id]=u}}),t["!id"]=s,t}function Na(e){var r=[vr,Ue("Relationships",null,{xmlns:Cr.RELS})];return fr(e["!id"]).forEach(function(t){r[r.length]=Ue("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Gt(e,r,t,s,o,f){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,o.Id="rId"+r,o.Type=s,o.Target=t,f?o.TargetMode=f:[St.HLINK,St.XPATH,St.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,r}var Zh="application/vnd.oasis.opendocument.spreadsheet";function Oc(e,r,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Jh(e,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function f0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+v.version+"</meta:generator></office:meta></office:document-meta>"}var cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],qh=function(){for(var e=new Array(cn.length),r=0;r<cn.length;++r){var t=cn[r],s="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function h0(e){var r={};e=jt(e);for(var t=0;t<cn.length;++t){var s=cn[t],o=e.match(qh[t]);null!=o&&o.length>0&&(r[s[1]]=zt(o[1])),"date"===s[2]&&r[s[1]]&&(r[s[1]]=Zt(r[s[1]]))}return r}function fa(e,r,t,s,o){null!=o[e]||null==r||""===r||(o[e]=r,r=Kt(r),s[s.length]=t?Ue(e,r,t):jr(e,r))}function Ic(e,r){var t=r||{},s=[vr,Ue("cp:coreProperties",null,{"xmlns:cp":Cr.CORE_PROPS,"xmlns:dc":Cr.dc,"xmlns:dcterms":Cr.dcterms,"xmlns:dcmitype":Cr.dcmitype,"xmlns:xsi":Cr.xsi})],o={};if(!e&&!t.Props)return s.join("");e&&(null!=e.CreatedDate&&fa("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:ao(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o),null!=e.ModifiedDate&&fa("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:ao(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o));for(var f=0;f!=cn.length;++f){var u=cn[f],p=t.Props&&null!=t.Props[u[1]]?t.Props[u[1]]:e?e[u[1]]:null;!0===p?p="1":!1===p?p="0":"number"==typeof p&&(p=String(p)),null!=p&&fa(u[0],p,null,s,o)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Mi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],u0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function d0(e,r,t,s){var o=[];if("string"==typeof e)o=io(e,s);else for(var f=0;f<e.length;++f)o=o.concat(e[f].map(function(w){return{v:w}}));var u="string"==typeof r?io(r,s).map(function(w){return w.v}):r,p=0,x=0;if(u.length>0)for(var _=0;_!==o.length;_+=2){switch(x=+o[_+1].v,o[_].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":t.Worksheets=x,t.SheetNames=u.slice(p,p+x);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":t.NamedRanges=x,t.DefinedNames=u.slice(p,p+x);break;case"Charts":case"Diagramme":t.Chartsheets=x,t.ChartNames=u.slice(p,p+x)}p+=x}}function xo(e){var r=[],t=Ue;return e||(e={}),e.Application="SheetJS",r[r.length]=vr,r[r.length]=Ue("Properties",null,{xmlns:Cr.EXT_PROPS,"xmlns:vt":Cr.vt}),Mi.forEach(function(s){if(void 0!==e[s[1]]){var o;switch(s[2]){case"string":o=Kt(String(e[s[1]]));break;case"bool":o=e[s[1]]?"true":"false"}void 0!==o&&(r[r.length]=t(s[0],o))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Kt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var tu=/<[^>]+>[^<]*/g;function p0(e){var r=[vr,Ue("Properties",null,{xmlns:Cr.CUST_PROPS,"xmlns:vt":Cr.vt})];if(!e)return r.join("");var t=1;return fr(e).forEach(function(o){++t,r[r.length]=Ue("property",function Dh(e,r){switch(typeof e){case"string":var t=Ue("vt:lpwstr",Kt(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return Ue((0|e)==e?"vt:i4":"vt:r8",Kt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",ao(e));throw new Error("Unable to serialize "+e)}(e[o],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Kt(o)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Pc,$n={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function nu(e,r,t){Pc||(Pc=ss($n)),e[r=Pc[r]||r]=t}function Mc(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function m0(e,r,t){var s=e.l,o=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-s&3;)++e.l;return o}function g0(e,r,t){var s=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(s.length+1&3)&3),s}function Rc(e,r,t){return 31===r?g0(e):m0(e,0,t)}function vo(e,r,t){return Rc(e,r,!1===t?0:4)}function ys(e){var r=e.l,t=wo(e,o0);return 0==e[e.l]&&0==e[e.l+1]&&e.l-r&2&&(e.l+=2),[t,wo(e,xn)]}function v0(e,r){for(var t=e.read_shift(4),s={},o=0;o!=t;++o){var f=e.read_shift(4),u=e.read_shift(4);s[f]=e.read_shift(u,1200===r?"utf16le":"utf8").replace(Or,"").replace(Ln,"!"),1200===r&&u%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),s}function w0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(3&r)>0&&(e.l+=4-(3&r)&3),t}function wo(e,r,t){var o,s=e.read_shift(2),f=t||{};if(e.l+=2,r!==uo&&s!==r&&-1===c0.indexOf(r)&&(4126!=(65534&r)||4126!=(65534&s)))throw new Error("Expected type "+r+" saw "+s);switch(r===uo?s:r){case 2:return o=e.read_shift(2,"i"),f.raw||(e.l+=2),o;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return m0(e,0,4).replace(Or,"");case 31:return g0(e);case 64:return Mc(e);case 65:return w0(e);case 71:return function cu(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}(e);case 80:return vo(e,s,!f.raw).replace(Or,"");case 81:return function x0(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Rc(e,r,0)}(e,s).replace(Or,"");case 4108:return function _0(e){for(var r=e.read_shift(4),t=[],s=0;s<r/2;++s)t.push(ys(e));return t}(e);case 4126:case 4127:return 4127==s?function su(e){for(var r=e.read_shift(4),t=[],s=0;s!=r;++s){var o=e.l;t[s]=e.read_shift(0,"lpwstr").replace(Or,""),e.l-o&2&&(e.l+=2)}return t}(e):function ou(e){for(var r=e.read_shift(4),t=[],s=0;s!=r;++s)t[s]=e.read_shift(0,"lpstr-cp").replace(Or,"");return t}(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+s)}}function Ri(e,r){var t=we(4),s=we(4);switch(t.write_shift(4,80==e?31:e),e){case 3:s.write_shift(-4,r);break;case 5:(s=we(8)).write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=function _o(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,s=t%Math.pow(2,32),o=(t-s)/Math.pow(2,32);o*=1e7;var f=(s*=1e7)/Math.pow(2,32)|0;f>0&&(s%=Math.pow(2,32),o+=f);var u=we(8);return u.write_shift(4,s),u.write_shift(4,o),u}(r);break;case 31:case 80:for((s=we(4+2*(r.length+1)+(r.length%2?0:2))).write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return lr([t,s])}function bs(e,r){var t=e.l,s=e.read_shift(4),o=e.read_shift(4),f=[],u=0,p=0,x=-1,_={};for(u=0;u!=o;++u){var w=e.read_shift(4),T=e.read_shift(4);f[u]=[w,T+t]}f.sort(function(B,I){return B[1]-I[1]});var C={};for(u=0;u!=o;++u){if(e.l!==f[u][1]){var E=!0;if(u>0&&r)switch(r[f[u-1][0]].t){case 2:e.l+2===f[u][1]&&(e.l+=2,E=!1);break;case 80:case 4108:e.l<=f[u][1]&&(e.l=f[u][1],E=!1)}if((!r||0==u)&&e.l<=f[u][1]&&(E=!1,e.l=f[u][1]),E)throw new Error("Read Error: Expected address "+f[u][1]+" at "+e.l+" :"+u)}if(r){var A=r[f[u][0]];if(C[A.n]=wo(e,A.t,{raw:!0}),"version"===A.p&&(C[A.n]=String(C[A.n]>>16)+"."+("0000"+String(65535&C[A.n])).slice(-4)),"CodePage"==A.n)switch(C[A.n]){case 0:C[A.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fe(p=C[A.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+C[A.n])}}else if(1===f[u][0]){if(p=C.CodePage=wo(e,s0),Fe(p),-1!==x){var k=e.l;e.l=f[x][1],_=v0(e,p),e.l=k}}else if(0===f[u][0]){if(0===p){x=u,e.l=f[u+1][1];continue}_=v0(e,p)}else{var N,F=_[f[u][0]];switch(e[e.l]){case 65:e.l+=4,N=w0(e);break;case 30:case 31:e.l+=4,N=vo(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=Er(e,4);break;case 64:e.l+=4,N=Zt(Mc(e));break;default:throw new Error("unparsed value: "+e[e.l])}C[F]=N}}return e.l=t+s,C}var y0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function lu(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function b0(e,r,t){var s=we(8),o=[],f=[],u=8,p=0,x=we(8),_=we(8);if(x.write_shift(4,2),x.write_shift(4,1200),_.write_shift(4,1),f.push(x),o.push(_),u+=8+x.length,!r){(_=we(8)).write_shift(4,0),o.unshift(_);var w=[we(4)];for(w[0].write_shift(4,e.length),p=0;p<e.length;++p){var T=e[p][0];for((x=we(8+2*(T.length+1)+(T.length%2?0:2))).write_shift(4,p+2),x.write_shift(4,T.length+1),x.write_shift(0,T,"dbcs");x.l!=x.length;)x.write_shift(1,0);w.push(x)}x=lr(w),f.unshift(x),u+=8+x.length}for(p=0;p<e.length;++p)if((!r||r[e[p][0]])&&!(y0.indexOf(e[p][0])>-1||u0.indexOf(e[p][0])>-1)&&null!=e[p][1]){var C=e[p][1],E=0;if(r){var A=t[E=+r[e[p][0]]];if("version"==A.p&&"string"==typeof C){var k=C.split(".");C=(+k[0]<<16)+(+k[1]||0)}x=Ri(A.t,C)}else{var F=lu(C);-1==F&&(F=31,C=String(C)),x=Ri(F,C)}f.push(x),(_=we(8)).write_shift(4,r?E:2+p),o.push(_),u+=8+x.length}var N=8*(f.length+1);for(p=0;p<f.length;++p)o[p].write_shift(4,N),N+=f[p].length;return s.write_shift(4,u),s.write_shift(4,f.length),lr([s].concat(o).concat(f))}function k0(e,r,t){var s=e.content;if(!s)return{};Hr(s,0);var o,f,u,p,x=0;s.chk("feff","Byte Order: "),s.read_shift(2);var _=s.read_shift(4),w=s.read_shift(16);if(w!==et.utils.consts.HEADER_CLSID&&w!==t)throw new Error("Bad PropertySet CLSID "+w);if(1!==(o=s.read_shift(4))&&2!==o)throw new Error("Unrecognized #Sets: "+o);if(f=s.read_shift(16),p=s.read_shift(4),1===o&&p!==s.l)throw new Error("Length mismatch: "+p+" !== "+s.l);2===o&&(u=s.read_shift(16),x=s.read_shift(4));var A,T=bs(s,r),C={SystemIdentifier:_};for(var E in T)C[E]=T[E];if(C.FMTID=f,1===o)return C;if(x-s.l==2&&(s.l+=2),s.l!==x)throw new Error("Length mismatch 2: "+s.l+" !== "+x);try{A=bs(s,null)}catch{}for(E in A)C[E]=A[E];return C.FMTID=[f,u],C}function Gn(e,r,t,s,o,f){var u=we(o?68:48),p=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,o?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,o?68:48);var x=b0(e,t,s);if(p.push(x),o){var _=b0(o,null,null);u.write_shift(16,f,"hex"),u.write_shift(4,68+x.length),p.push(_)}return lr(p)}function Li(e,r){return e.read_shift(r),null}function Er(e,r){return 1===e.read_shift(r)}function ln(e,r){return r||(r=we(2)),r.write_shift(2,+!!e),r}function br(e){return e.read_shift(2,"u")}function Mn(e,r){return r||(r=we(2)),r.write_shift(2,e),r}function T0(e,r){return function hu(e,r,t){for(var s=[],o=e.l+r;e.l<o;)s.push(t(e,o-e.l));if(o!==e.l)throw new Error("Slurp error");return s}(e,r,br)}function E0(e,r,t){return t||(t=we(2)),t.write_shift(1,"e"==r?+e:+!!e),t.write_shift(1,"e"==r?1:0),t}function ha(e,r,t){var s=e.read_shift(t&&t.biff>=12?2:1),o="sbcs-cont",f=U;t&&t.biff>=8&&(U=1200),t&&8!=t.biff?12==t.biff&&(o="wstr"):e.read_shift(1)&&(o="dbcs-cont"),t.biff>=2&&t.biff<=5&&(o="cpstr");var p=s?e.read_shift(s,o):"";return U=f,p}function S0(e){var r=U;U=1200;var x,t=e.read_shift(2),s=e.read_shift(1),o=4&s,f=8&s,u=1+(1&s),p=0,_={};f&&(p=e.read_shift(2)),o&&(x=e.read_shift(4));var T=0===t?"":e.read_shift(t,2==u?"dbcs-cont":"sbcs-cont");return f&&(e.l+=4*p),o&&(e.l+=x),_.t=T,f||(_.raw="<t>"+_.t+"</t>",_.r=_.t),U=r,_}function uu(e){var r=e.t||"",s=we(3);s.write_shift(2,r.length),s.write_shift(1,1);var o=we(2*r.length);return o.write_shift(2*r.length,r,"utf16le"),lr([s,o])}function ua(e,r,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var o=e.read_shift(1);return e.read_shift(r,0===o?"sbcs-cont":"dbcs-cont")}function Ba(e,r,t){var s=e.read_shift(t&&2==t.biff?1:2);return 0===s?(e.l++,""):ua(e,s,t)}function Ni(e,r,t){if(t.biff>5)return Ba(e,0,t);var s=e.read_shift(1);return 0===s?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function A0(e,r,t){return t||(t=we(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function bo(e){var r=e.read_shift(4);return r>0?e.read_shift(r,"utf16le").replace(Or,""):""}function Lc(e,r){r||(r=we(6+2*e.length)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function pu(e){var r=we(512),t=0,s=e.Target;"file://"==s.slice(0,7)&&(s=s.slice(7));var o=s.indexOf("#"),f=o>-1?31:23;switch(s.charAt(0)){case"#":f=28;break;case".":f&=-3}r.write_shift(4,2),r.write_shift(4,f);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)r.write_shift(4,u[t]);if(28==f)Lc(s=s.slice(1),r);else if(2&f){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));var p=o>-1?s.slice(0,o):s;for(r.write_shift(4,2*(p.length+1)),t=0;t<p.length;++t)r.write_shift(2,p.charCodeAt(t));r.write_shift(2,0),8&f&&Lc(o>-1?s.slice(o+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));for(var x=0;"../"==s.slice(3*x,3*x+3)||"..\\"==s.slice(3*x,3*x+3);)++x;for(r.write_shift(2,x),r.write_shift(4,s.length-3*x+1),t=0;t<s.length-3*x;++t)r.write_shift(1,255&s.charCodeAt(t+3*x));for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function O0(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function I0(e,r){var t=O0(e);return t[3]=0,t}function jn(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Bi(e,r,t,s){return s||(s=we(6)),s.write_shift(2,e),s.write_shift(2,r),s.write_shift(2,t||0),s}function M0(e,r,t){var s=t.biff>8?4:2;return[e.read_shift(s),e.read_shift(s,"i"),e.read_shift(s,"i")]}function Ts(e){return[e.read_shift(2),kc(e)]}function ko(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r},e:{c:e.read_shift(2),r:t}}}function L0(e,r){return r||(r=we(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Cs(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(1),r},e:{c:e.read_shift(1),r:t}}}var gu=Cs;function Es(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[t,r,s]}function tn(e){e.l+=2,e.l+=e.read_shift(2)}var _u={0:tn,4:tn,5:tn,6:tn,7:function xu(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:tn,9:tn,10:tn,11:tn,12:tn,13:function N0(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r},14:tn,15:tn,16:tn,17:tn,18:tn,19:tn,20:tn,21:Es};function da(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),(r-=2)>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Nc(e,r,t){var s=1536,o=16;switch(t.bookType){case"biff8":case"xla":break;case"biff5":s=1280,o=8;break;case"biff4":s=4,o=6;break;case"biff3":s=3,o=6;break;case"biff2":s=2,o=4;break;default:throw new Error("unsupported BIFF version")}var f=we(o);return f.write_shift(2,s),f.write_shift(2,r),o>4&&f.write_shift(2,29282),o>6&&f.write_shift(2,1997),o>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function U0(e,r){var t=!r||r.biff>=8?2:1,s=we(8+t*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var o=s.slice(0,s.l);return o.l=s.l,o}function H0(e,r,t){var s=0;t&&2==t.biff||(s=e.read_shift(2));var o=e.read_shift(2);return t&&2==t.biff&&(s=1-(o>>15),o&=32767),[{Unsynced:1&s,DyZero:(2&s)>>1,ExAsc:(4&s)>>2,ExDsc:(8&s)>>3},o]}function Hc(e,r,t,s){var o=t&&5==t.biff;s||(s=we(o?3+r.length:5+2*r.length)),s.write_shift(2,e),s.write_shift(o?1:2,r.length),o||s.write_shift(1,1),s.write_shift((o?1:2)*r.length,r,o?"sbcs":"utf16le");var f=s.length>s.l?s.slice(0,s.l):s;return null==f.l&&(f.l=f.length),f}var Ru=Ni;function z0(e,r,t){var s=e.l+r,o=8!=t.biff&&t.biff?2:4,f=e.read_shift(o),u=e.read_shift(o),p=e.read_shift(2),x=e.read_shift(2);return e.l=s,{s:{r:f,c:p},e:{r:u,c:x}}}function X0(e,r,t,s){var o=t&&5==t.biff;s||(s=we(o?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,r<<4));var f=0;return e.numFmtId>0&&o&&(f|=1024),s.write_shift(4,f),s.write_shift(4,0),o||s.write_shift(4,0),s.write_shift(2,0),s}function Z0(e,r,t){var s=jn(e);(2==t.biff||9==r)&&++e.l;var o=function C0(e){var r=e.read_shift(1);return 1===e.read_shift(1)?r:1===r}(e);return s.val=o,s.t=!0===o||!1===o?"b":"e",s}var Vc=function mu(e,r,t){return 0===r?"":Ni(e,0,t)};function J0(e,r,t){var o,s=e.read_shift(2),f={fBuiltIn:1&s,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return 14849===t.sbcch&&(o=function R0(e,r,t){e.l+=4;var s=e.l+(r-=4),o=ha(e,0,t),f=e.read_shift(2);if(f!==(s-=e.l))throw new Error("Malformed AddinUdf: padding = "+s+" != "+f);return e.l+=f,o}(e,r-2,t)),f.body=o||e.read_shift(r-2),"string"==typeof o&&(f.Name=o),f}var Vu=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Q0(e,r,t){var s=e.l+r,o=e.read_shift(2),f=e.read_shift(1),u=e.read_shift(1),p=e.read_shift(t&&2==t.biff?1:2),x=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),x=e.read_shift(2),5==t.biff&&(e.l+=2),e.l+=4);var _=ua(e,u,t);32&o&&(_=Vu[_.charCodeAt(0)]);var w=s-e.l;t&&2==t.biff&&--w;var T=s!=e.l&&0!==p&&w>0?function eh(e,r,t,s){var u,o=e.l+r,f=Ns(e,s,t);return o!==e.l&&(u=Ls(e,o-e.l,f,t)),[f,u]}(e,w,t,p):[];return{chKey:f,Name:_,itab:x,rgce:T}}function Co(e,r,t){if(t.biff<8)return function zu(e,r,t){3==e[e.l+1]&&e[e.l]++;var s=ha(e,0,t);return 3==s.charCodeAt(0)?s.slice(1):s}(e,0,t);for(var s=[],o=e.l+r,f=e.read_shift(t.biff>8?4:2);0!=f--;)s.push(M0(e,0,t));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return s}function $c(e,r,t){var s=gu(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[s,Xm(e,r,t)]}var Zu={8:function(e,r){var t=e.l+r;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var o=e.read_shift(1);return e.l+=o,e.l=t,{fmt:s}}};function qu(e){var r=we(24),t=pr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)r.write_shift(1,parseInt(s[o],16));return lr([r,pu(e[1])])}function ed(e){var r=e[1].Tooltip,t=we(10+2*(r.length+1));t.write_shift(2,2048);var s=pr(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var o=0;o<r.length;++o)t.write_shift(2,r.charCodeAt(o));return t.write_shift(2,0),t}function rf(e,r,t){if(!t.cellStyles)return Xr(e,r);var s=t&&t.biff>=12?4:2,o=e.read_shift(s),f=e.read_shift(s),u=e.read_shift(s),p=e.read_shift(s),x=e.read_shift(2);2==s&&(e.l+=2);var _={s:o,e:f,w:u,ixfe:p,flags:x};return(t.biff>=5||!t.biff)&&(_.level=x>>8&7),_}var sd=jn,of=T0,od=Ba,pd=[2,3,48,49,131,139,140,245],Ha=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=ss({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(p,x){var _=x||{};_.dateNF||(_.dateNF="yyyymmdd");var w=ra(function t(p,x){var _=[],w=un(1);switch(x.type){case"base64":w=Sr(Ut(p));break;case"binary":w=Sr(p);break;case"buffer":case"array":w=p}Hr(w,0);var T=w.read_shift(1),C=!!(136&T),E=!1,A=!1;switch(T){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:E=!0,C=!0;break;case 140:A=!0;break;default:throw new Error("DBF Unsupported Version: "+T.toString(16))}var k=0,F=521;2==T&&(k=w.read_shift(2)),w.l+=3,2!=T&&(k=w.read_shift(4)),k>1048576&&(k=1e6),2!=T&&(F=w.read_shift(2));var N=w.read_shift(2),B=x.codepage||1252;2!=T&&(w.l+=16,w.read_shift(1),0!==w[w.l]&&(B=e[w[w.l]]),w.l+=1,w.l+=2),A&&(w.l+=36);for(var I=[],re={},se=Math.min(w.length,2==T?521:F-10-(E?264:0)),ee=A?32:11;w.l<se&&13!=w[w.l];)switch(re={},re.name=ue.utils.decode(B,w.slice(w.l,w.l+ee)).replace(/[\u0000\r\n].*$/g,""),w.l+=ee,re.type=String.fromCharCode(w.read_shift(1)),2!=T&&!A&&(re.offset=w.read_shift(4)),re.len=w.read_shift(1),2==T&&(re.offset=w.read_shift(2)),re.dec=w.read_shift(1),re.name.length&&I.push(re),2!=T&&(w.l+=A?13:14),re.type){case"B":(!E||8!=re.len)&&x.WTF&&console.log("Skipping "+re.name+":"+re.type);break;case"G":case"P":x.WTF&&console.log("Skipping "+re.name+":"+re.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+re.type)}if(13!==w[w.l]&&(w.l=F-1),13!==w.read_shift(1))throw new Error("DBF Terminator not found "+w.l+" "+w[w.l]);w.l=F;var V=0,ne=0;for(_[0]=[],ne=0;ne!=I.length;++ne)_[0][ne]=I[ne].name;for(;k-- >0;)if(42!==w[w.l])for(++w.l,_[++V]=[],ne=0,ne=0;ne!=I.length;++ne){var te=w.slice(w.l,w.l+I[ne].len);w.l+=I[ne].len,Hr(te,0);var ge=ue.utils.decode(B,te);switch(I[ne].type){case"C":ge.trim().length&&(_[V][ne]=ge.replace(/\s+$/,""));break;case"D":_[V][ne]=8===ge.length?new Date(+ge.slice(0,4),+ge.slice(4,6)-1,+ge.slice(6,8)):ge;break;case"F":_[V][ne]=parseFloat(ge.trim());break;case"+":case"I":_[V][ne]=A?2147483648^te.read_shift(-4,"i"):te.read_shift(4,"i");break;case"L":switch(ge.trim().toUpperCase()){case"Y":case"T":_[V][ne]=!0;break;case"N":case"F":_[V][ne]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ge+"|")}break;case"M":if(!C)throw new Error("DBF Unexpected MEMO for type "+T.toString(16));_[V][ne]="##MEMO##"+(A?parseInt(ge.trim(),10):te.read_shift(4));break;case"N":(ge=ge.replace(/\u0000/g,"").trim())&&"."!=ge&&(_[V][ne]=+ge||0);break;case"@":_[V][ne]=new Date(te.read_shift(-8,"f")-621356832e5);break;case"T":_[V][ne]=new Date(864e5*(te.read_shift(4)-2440588)+te.read_shift(4));break;case"Y":_[V][ne]=te.read_shift(4,"i")/1e4+te.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":_[V][ne]=-te.read_shift(-8,"f");break;case"B":if(E&&8==I[ne].len){_[V][ne]=te.read_shift(8,"f");break}case"G":case"P":te.l+=I[ne].len;break;case"0":if("_NullFlags"===I[ne].name)break;default:throw new Error("DBF Unsupported data type "+I[ne].type)}}else w.l+=N;if(2!=T&&w.l<w.length&&26!=w[w.l++])throw new Error("DBF EOF Marker missing "+(w.l-1)+" of "+w.length+" "+w[w.l-1].toString(16));return x&&x.sheetRows&&(_=_.slice(0,x.sheetRows)),x.DBF=I,_}(p,_),_);return w["!cols"]=_.DBF.map(function(T){return{wch:T.len,DBF:T}}),delete _.DBF,w}var f={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function o(p,x){try{return gi(s(p,x),x)}catch(_){if(x&&x.WTF)throw _}return{SheetNames:[],Sheets:{}}},to_sheet:s,from_sheet:function u(p,x){var _=x||{};if(+_.codepage>=0&&Fe(+_.codepage),"string"==_.type)throw new Error("Cannot write DBF to JS string");var w=sn(),T=yh(p,{header:1,raw:!0,cellDates:!0}),C=T[0],E=T.slice(1),A=p["!cols"]||[],k=0,F=0,N=0,B=1;for(k=0;k<C.length;++k)if(((A[k]||{}).DBF||{}).name)C[k]=A[k].DBF.name,++N;else if(null!=C[k]){if(++N,"number"==typeof C[k]&&(C[k]=C[k].toString(10)),"string"!=typeof C[k])throw new Error("DBF Invalid column name "+C[k]+" |"+typeof C[k]+"|");if(C.indexOf(C[k])!==k)for(F=0;F<1024;++F)if(-1==C.indexOf(C[k]+"_"+F)){C[k]+="_"+F;break}}var I=Lt(p["!ref"]),re=[],se=[],ee=[];for(k=0;k<=I.e.c-I.s.c;++k){var V="",ne="",te=0,ge=[];for(F=0;F<E.length;++F)null!=E[F][k]&&ge.push(E[F][k]);if(0!=ge.length&&null!=C[k]){for(F=0;F<ge.length;++F){switch(typeof ge[F]){case"number":ne="B";break;case"string":default:ne="C";break;case"boolean":ne="L";break;case"object":ne=ge[F]instanceof Date?"D":"C"}te=Math.max(te,String(ge[F]).length),V=V&&V!=ne?"C":ne}te>250&&(te=250),"C"==(ne=((A[k]||{}).DBF||{}).type)&&A[k].DBF.len>te&&(te=A[k].DBF.len),"B"==V&&"N"==ne&&(V="N",ee[k]=A[k].DBF.dec,te=A[k].DBF.len),se[k]="C"==V||"N"==ne?te:f[V]||0,B+=se[k],re[k]=V}else re[k]="?"}var _e=w.next(32);for(_e.write_shift(4,318902576),_e.write_shift(4,E.length),_e.write_shift(2,296+32*N),_e.write_shift(2,B),k=0;k<4;++k)_e.write_shift(4,0);for(_e.write_shift(4,0|(+r[Ze]||3)<<8),k=0,F=0;k<C.length;++k)if(null!=C[k]){var ae=w.next(32),ze=(C[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ae.write_shift(1,ze,"sbcs"),ae.write_shift(1,"?"==re[k]?"C":re[k],"sbcs"),ae.write_shift(4,F),ae.write_shift(1,se[k]||f[re[k]]||0),ae.write_shift(1,ee[k]||0),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(1,0),ae.write_shift(4,0),ae.write_shift(4,0),F+=se[k]||f[re[k]]||0}var nt=w.next(264);for(nt.write_shift(4,13),k=0;k<65;++k)nt.write_shift(4,0);for(k=0;k<E.length;++k){var $e=w.next(B);for($e.write_shift(1,0),F=0;F<C.length;++F)if(null!=C[F])switch(re[F]){case"L":$e.write_shift(1,null==E[k][F]?63:E[k][F]?84:70);break;case"B":$e.write_shift(8,E[k][F]||0,"f");break;case"N":var xt="0";for("number"==typeof E[k][F]&&(xt=E[k][F].toFixed(ee[F]||0)),N=0;N<se[F]-xt.length;++N)$e.write_shift(1,32);$e.write_shift(1,xt,"sbcs");break;case"D":E[k][F]?($e.write_shift(4,("0000"+E[k][F].getFullYear()).slice(-4),"sbcs"),$e.write_shift(2,("00"+(E[k][F].getMonth()+1)).slice(-2),"sbcs"),$e.write_shift(2,("00"+E[k][F].getDate()).slice(-2),"sbcs")):$e.write_shift(8,"00000000","sbcs");break;case"C":var ot=String(null!=E[k][F]?E[k][F]:"").slice(0,se[F]);for($e.write_shift(1,ot,"sbcs"),N=0;N<se[F]-ot.length;++N)$e.write_shift(1,32)}}return w.next(1).write_shift(1,26),w.end()}}}(),ff=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1bN("+fr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(C,E){var A=e[E];return"number"==typeof A?oe(A):A},s=function(C,E,A){var k=E.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return 59==k?C:oe(k)};function f(C,E){var _e,A=C.split(/[\n\r]+/),k=-1,F=-1,N=0,B=0,I=[],re=[],se=null,ee={},V=[],ne=[],te=[],ge=0;for(+E.codepage>=0&&Fe(+E.codepage);N!==A.length;++N){ge=0;var $e,ae=A[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,t),ze=ae.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")});if(ae.length>0)switch(ze[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==ze[1].charAt(0)&&re.push(ae.slice(3).replace(/;;/g,";"));break;case"C":var xt=!1,ot=!1,Nt=!1,qe=!1,pt=-1,Ee=-1;for(B=1;B<ze.length;++B)switch(ze[B].charAt(0)){case"A":case"G":break;case"X":F=parseInt(ze[B].slice(1))-1,ot=!0;break;case"Y":for(k=parseInt(ze[B].slice(1))-1,ot||(F=0),_e=I.length;_e<=k;++_e)I[_e]=[];break;case"K":'"'===($e=ze[B].slice(1)).charAt(0)?$e=$e.slice(1,$e.length-1):"TRUE"===$e?$e=!0:"FALSE"===$e?$e=!1:isNaN(Hn($e))?isNaN(Sa($e).getDate())||($e=Zt($e)):($e=Hn($e),null!==se&&ti(se)&&($e=cs($e))),typeof ue<"u"&&"string"==typeof $e&&"string"!=(E||{}).type&&(E||{}).codepage&&($e=ue.utils.decode(E.codepage,$e)),xt=!0;break;case"E":qe=!0;var X=ja(ze[B].slice(1),{r:k,c:F});I[k][F]=[I[k][F],X];break;case"S":Nt=!0,I[k][F]=[I[k][F],"S5S"];break;case"R":pt=parseInt(ze[B].slice(1))-1;break;case"C":Ee=parseInt(ze[B].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ae)}if(xt&&(I[k][F]&&2==I[k][F].length?I[k][F][0]=$e:I[k][F]=$e,se=null),Nt){if(qe)throw new Error("SYLK shared formula cannot have own formula");var fe=pt>-1&&I[pt][Ee];if(!fe||!fe[1])throw new Error("SYLK shared formula cannot find base");I[k][F][1]=Lf(fe[1],{r:k-pt,c:F-Ee})}break;case"F":var q=0;for(B=1;B<ze.length;++B)switch(ze[B].charAt(0)){case"X":F=parseInt(ze[B].slice(1))-1,++q;break;case"Y":for(k=parseInt(ze[B].slice(1))-1,_e=I.length;_e<=k;++_e)I[_e]=[];break;case"M":ge=parseInt(ze[B].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":se=re[parseInt(ze[B].slice(1))];break;case"W":for(te=ze[B].slice(1).split(" "),_e=parseInt(te[0],10);_e<=parseInt(te[1],10);++_e)ge=parseInt(te[2],10),ne[_e-1]=0===ge?{hidden:!0}:{wch:ge},xi(ne[_e-1]);break;case"C":ne[F=parseInt(ze[B].slice(1))-1]||(ne[F]={});break;case"R":V[k=parseInt(ze[B].slice(1))-1]||(V[k]={}),ge>0?(V[k].hpt=ge,V[k].hpx=_i(ge)):0===ge&&(V[k].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ae)}q<1&&(se=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ae)}}return V.length>0&&(ee["!rows"]=V),ne.length>0&&(ee["!cols"]=ne),E&&E.sheetRows&&(I=I.slice(0,E.sheetRows)),[I,ee]}function u(C,E){var A=function o(C,E){switch(E.type){case"base64":return f(Ut(C),E);case"binary":return f(C,E);case"buffer":return f(wt&&Buffer.isBuffer(C)?C.toString("binary"):Jn(C),E);case"array":return f(pi(C),E)}throw new Error("Unrecognized type "+E.type)}(C,E),F=A[1],N=ra(A[0],E);return fr(F).forEach(function(B){N[B]=F[B]}),N}function x(C,E,A,k){var F="C;Y"+(A+1)+";X"+(k+1)+";K";switch(C.t){case"n":F+=C.v||0,C.f&&!C.F&&(F+=";E"+al(C.f,{r:A,c:k}));break;case"b":F+=C.v?"TRUE":"FALSE";break;case"e":F+=C.w||C.v;break;case"d":F+='"'+(C.w||C.v)+'"';break;case"s":F+='"'+C.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return F}return e["|"]=254,{to_workbook:function p(C,E){return gi(u(C,E),E)},to_sheet:u,from_sheet:function T(C,E){var N,A=["ID;PWXL;N;E"],k=[],F=Lt(C["!ref"]),B=Array.isArray(C),I="\r\n";A.push("P;PGeneral"),A.push("F;P0;DG0G8;M255"),C["!cols"]&&function _(C,E){E.forEach(function(A,k){var F="F;W"+(k+1)+" "+(k+1)+" ";A.hidden?F+="0":("number"==typeof A.width&&!A.wpx&&(A.wpx=Va(A.width)),"number"==typeof A.wpx&&!A.wch&&(A.wch=za(A.wpx)),"number"==typeof A.wch&&(F+=Math.round(A.wch)))," "!=F.charAt(F.length-1)&&C.push(F)})}(A,C["!cols"]),C["!rows"]&&function w(C,E){E.forEach(function(A,k){var F="F;";A.hidden?F+="M0;":A.hpt?F+="M"+20*A.hpt+";":A.hpx&&(F+="M"+20*pa(A.hpx)+";"),F.length>2&&C.push(F+"R"+(k+1))})}(A,C["!rows"]),A.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var re=F.s.r;re<=F.e.r;++re)for(var se=F.s.c;se<=F.e.c;++se){var ee=bt({r:re,c:se});(N=B?(C[re]||[])[se]:C[ee])&&(null!=N.v||N.f&&!N.F)&&k.push(x(N,0,re,se))}return A.join(I)+I+k.join(I)+I+"E"+I}}}(),Wa=function(){function r(f,u){for(var p=f.split("\n"),x=-1,_=-1,w=0,T=[];w!==p.length;++w)if("BOT"!==p[w].trim()){if(!(x<0)){for(var C=p[w].trim().split(","),E=C[0],A=C[1],k=p[++w]||"";1&(k.match(/["]/g)||[]).length&&w<p.length-1;)k+="\n"+p[++w];switch(k=k.trim(),+E){case-1:if("BOT"===k){T[++x]=[],_=0;continue}if("EOD"!==k)throw new Error("Unrecognized DIF special command "+k);break;case 0:T[x][_]="TRUE"===k||"FALSE"!==k&&(isNaN(Hn(A))?isNaN(Sa(A).getDate())?A:Zt(A):Hn(A)),++_;break;case 1:(k=(k=k.slice(1,k.length-1)).replace(/""/g,'"'))&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),T[x][_++]=""!==k?k:null}if("EOD"===k)break}}else T[++x]=[],_=0;return u&&u.sheetRows&&(T=T.slice(0,u.sheetRows)),T}function t(f,u){return ra(function e(f,u){switch(u.type){case"base64":return r(Ut(f),u);case"binary":return r(f,u);case"buffer":return r(wt&&Buffer.isBuffer(f)?f.toString("binary"):Jn(f),u);case"array":return r(pi(f),u)}throw new Error("Unrecognized type "+u.type)}(f,u),u)}return{to_workbook:function s(f,u){return gi(t(f,u),u)},to_sheet:t,from_sheet:function(){var f=function(x,_,w,T,C){x.push(_),x.push(w+","+T),x.push('"'+C.replace(/"/g,'""')+'"')},u=function(x,_,w,T){x.push(_+","+w),x.push(1==_?'"'+T.replace(/"/g,'""')+'"':T)};return function(x){var T,_=[],w=Lt(x["!ref"]),C=Array.isArray(x);f(_,"TABLE",0,1,"sheetjs"),f(_,"VECTORS",0,w.e.r-w.s.r+1,""),f(_,"TUPLES",0,w.e.c-w.s.c+1,""),f(_,"DATA",0,0,"");for(var E=w.s.r;E<=w.e.r;++E){u(_,-1,0,"BOT");for(var A=w.s.c;A<=w.e.c;++A){var k=bt({r:E,c:A});if(T=C?(x[E]||[])[A]:x[k])switch(T.t){case"n":var F=T.w;!F&&null!=T.v&&(F=T.v),null==F?u(_,1,0,T.f&&!T.F?"="+T.f:""):u(_,0,F,"V");break;case"b":u(_,0,T.v?1:0,T.v?"TRUE":"FALSE");break;case"s":u(_,1,0,isNaN(T.v)?T.v:'="'+T.v+'"');break;case"d":T.w||(T.w=M(T.z||vt[14],Ir(Zt(T.v)))),u(_,0,T.w,"V");break;default:u(_,1,0,"")}else u(_,1,0,"")}}return u(_,-1,0,"EOD"),_.join("\r\n")}}()}}(),Xn=function(){function e(T){return T.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(T){return T.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(T,C){return ra(function t(T,C){for(var E=T.split("\n"),A=-1,k=-1,F=0,N=[];F!==E.length;++F){var B=E[F].trim().split(":");if("cell"===B[0]){var I=pr(B[1]);if(N.length<=I.r)for(A=N.length;A<=I.r;++A)N[A]||(N[A]=[]);switch(A=I.r,k=I.c,B[2]){case"t":N[A][k]=e(B[3]);break;case"v":N[A][k]=+B[3];break;case"vtf":var re=B[B.length-1];case"vtc":N[A][k]="nl"===B[3]?!!+B[4]:+B[4],"vtf"==B[2]&&(N[A][k]=[N[A][k],re])}}}return C&&C.sheetRows&&(N=N.slice(0,C.sheetRows)),N}(T,C),C)}var f=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",p=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),x="--SocialCalcSpreadsheetControlSave--";function _(T){if(!T||!T["!ref"])return"";for(var A,C=[],E=[],k="",F=on(T["!ref"]),N=Array.isArray(T),B=F.s.r;B<=F.e.r;++B)for(var I=F.s.c;I<=F.e.c;++I)if(k=bt({r:B,c:I}),(A=N?(T[B]||[])[I]:T[k])&&null!=A.v&&"z"!==A.t){switch(E=["cell",k,"t"],A.t){case"s":case"str":E.push(r(A.v));break;case"n":A.f?(E[2]="vtf",E[3]="n",E[4]=A.v,E[5]=r(A.f)):(E[2]="v",E[3]=A.v);break;case"b":E[2]="vt"+(A.f?"f":"c"),E[3]="nl",E[4]=A.v?"1":"0",E[5]=r(A.f||(A.v?"TRUE":"FALSE"));break;case"d":var re=Ir(Zt(A.v));E[2]="vtc",E[3]="nd",E[4]=""+re,E[5]=A.w||M(A.z||vt[14],re);break;case"e":continue}C.push(E.join(":"))}return C.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),C.push("valueformat:1:text-wiki"),C.join("\n")}return{to_workbook:function o(T,C){return gi(s(T,C),C)},to_sheet:s,from_sheet:function w(T){return[f,u,p,u,_(T),x].join("\n")}}}(),_n=function(){function e(w,T,C,E,A){A.raw?T[C][E]=w:""===w||(T[C][E]="TRUE"===w||"FALSE"!==w&&(isNaN(Hn(w))?isNaN(Sa(w).getDate())?w:Zt(w):Hn(w)))}var t={44:",",9:"\t",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function o(w){for(var T={},C=!1,E=0,A=0;E<w.length;++E)34==(A=w.charCodeAt(E))?C=!C:!C&&A in t&&(T[A]=(T[A]||0)+1);for(E in A=[],T)Object.prototype.hasOwnProperty.call(T,E)&&A.push([T[E],E]);if(!A.length)for(E in T=s)Object.prototype.hasOwnProperty.call(T,E)&&A.push([T[E],E]);return A.sort(function(k,F){return k[0]-F[0]||s[k[1]]-s[F[1]]}),t[A.pop()[1]]||44}function u(w,T){return!T||!T.PRN||T.FS||"sep="==w.slice(0,4)||w.indexOf("\t")>=0||w.indexOf(",")>=0||w.indexOf(";")>=0?function f(w,T){var C=T||{},E="";null!=ut&&null==C.dense&&(C.dense=ut);var A=C.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};"sep="==w.slice(0,4)?13==w.charCodeAt(5)&&10==w.charCodeAt(6)?(E=w.charAt(4),w=w.slice(7)):13==w.charCodeAt(5)||10==w.charCodeAt(5)?(E=w.charAt(4),w=w.slice(6)):E=o(w.slice(0,1024)):E=C&&C.FS?C.FS:o(w.slice(0,1024));var F=0,N=0,B=0,I=0,re=0,se=E.charCodeAt(0),ee=!1,V=0,ne=w.charCodeAt(0);w=w.replace(/\r\n/gm,"\n");var te=null!=C.dateNF?function er(e){var r="number"==typeof e?vt[e]:e;return r=r.replace(lt,"(\\d+)"),new RegExp("^"+r+"$")}(C.dateNF):null;function ge(){var _e=w.slice(I,re),ae={};if('"'==_e.charAt(0)&&'"'==_e.charAt(_e.length-1)&&(_e=_e.slice(1,-1).replace(/""/g,'"')),0===_e.length)ae.t="z";else if(C.raw)ae.t="s",ae.v=_e;else if(0===_e.trim().length)ae.t="s",ae.v=_e;else if(61==_e.charCodeAt(0))34==_e.charCodeAt(1)&&34==_e.charCodeAt(_e.length-1)?(ae.t="s",ae.v=_e.slice(2,-1).replace(/""/g,'"')):function Xa(e){return 1!=e.length}(_e)?(ae.t="n",ae.f=_e.slice(1)):(ae.t="s",ae.v=_e);else if("TRUE"==_e)ae.t="b",ae.v=!0;else if("FALSE"==_e)ae.t="b",ae.v=!1;else if(isNaN(B=Hn(_e)))if(!isNaN(Sa(_e).getDate())||te&&_e.match(te)){ae.z=C.dateNF||vt[14];var ze=0;te&&_e.match(te)&&(_e=function Rt(e,r,t){var s=-1,o=-1,f=-1,u=-1,p=-1,x=-1;(r.match(lt)||[]).forEach(function(T,C){var E=parseInt(t[C+1],10);switch(T.toLowerCase().charAt(0)){case"y":s=E;break;case"d":f=E;break;case"h":u=E;break;case"s":x=E;break;case"m":u>=0?p=E:o=E}}),x>=0&&-1==p&&o>=0&&(p=o,o=-1);var _=(""+(s>=0?s:(new Date).getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(f>=1?f:1)).slice(-2);7==_.length&&(_="0"+_),8==_.length&&(_="20"+_);var w=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2);return-1==u&&-1==p&&-1==x?_:-1==s&&-1==o&&-1==f?w:_+"T"+w}(0,C.dateNF,_e.match(te)||[]),ze=1),C.cellDates?(ae.t="d",ae.v=Zt(_e,ze)):(ae.t="n",ae.v=Ir(Zt(_e,ze))),!1!==C.cellText&&(ae.w=M(ae.z,ae.v instanceof Date?Ir(ae.v):ae.v)),C.cellNF||delete ae.z}else ae.t="s",ae.v=_e;else ae.t="n",!1!==C.cellText&&(ae.w=_e),ae.v=B;if("z"==ae.t||(C.dense?(A[F]||(A[F]=[]),A[F][N]=ae):A[bt({c:N,r:F})]=ae),ne=w.charCodeAt(I=re+1),k.e.c<N&&(k.e.c=N),k.e.r<F&&(k.e.r=F),V==se)++N;else if(N=0,++F,C.sheetRows&&C.sheetRows<=F)return!0}e:for(;re<w.length;++re)switch(V=w.charCodeAt(re)){case 34:34===ne&&(ee=!ee);break;case se:case 10:case 13:if(!ee&&ge())break e}return re-I>0&&ge(),A["!ref"]=Et(k),A}(w,T):ra(function r(w,T){var C=T||{},E=[];if(!w||0===w.length)return E;for(var A=w.split(/[\r\n]/),k=A.length-1;k>=0&&0===A[k].length;)--k;for(var F=10,N=0,B=0;B<=k;++B)-1==(N=A[B].indexOf(" "))?N=A[B].length:N++,F=Math.max(F,N);for(B=0;B<=k;++B){E[B]=[];var I=0;for(e(A[B].slice(0,F).trim(),E,B,I,C),I=1;I<=(A[B].length-F)/10+1;++I)e(A[B].slice(F+10*(I-1),F+10*I).trim(),E,B,I,C)}return C.sheetRows&&(E=E.slice(0,C.sheetRows)),E}(w,T),T)}function p(w,T){var C="",E="string"==T.type?[0,0,0,0]:S1(w,T);switch(T.type){case"base64":C=Ut(w);break;case"binary":case"string":C=w;break;case"buffer":C=65001==T.codepage?w.toString("utf8"):T.codepage&&typeof ue<"u"?ue.utils.decode(T.codepage,w):wt&&Buffer.isBuffer(w)?w.toString("binary"):Jn(w);break;case"array":C=pi(w);break;default:throw new Error("Unrecognized type "+T.type)}return 239==E[0]&&187==E[1]&&191==E[2]?C=jt(C.slice(3)):"string"!=T.type&&"buffer"!=T.type&&65001==T.codepage?C=jt(C):"binary"==T.type&&typeof ue<"u"&&T.codepage&&(C=ue.utils.decode(T.codepage,ue.utils.encode(28591,C))),"socialcalc:version:"==C.slice(0,19)?Xn.to_sheet("string"==T.type?C:jt(C),T):u(C,T)}return{to_workbook:function x(w,T){return gi(p(w,T),T)},to_sheet:p,from_sheet:function _(w){for(var E,T=[],C=Lt(w["!ref"]),A=Array.isArray(w),k=C.s.r;k<=C.e.r;++k){for(var F=[],N=C.s.c;N<=C.e.c;++N){var B=bt({r:k,c:N});if((E=A?(w[k]||[])[N]:w[B])&&null!=E.v){for(var I=(E.w||(Vn(E),E.w)||"").slice(0,10);I.length<10;)I+=" ";F.push(I+(0===N?" ":""))}else F.push("          ")}T.push(F.join(""))}return T.join("\n")}}}(),Hi=function(){function e(X,fe,q){if(X){Hr(X,X.l||0);for(var J=q.Enum||pt;X.l<X.length;){var ke=X.read_shift(2),Ke=J[ke]||J[65535],He=X.read_shift(2),We=X.l+He,Ae=Ke.f&&Ke.f(X,He,q);if(X.l=We,fe(Ae,Ke,ke))return}}}function t(X,fe){if(!X)return X;var q=fe||{};null!=ut&&null==q.dense&&(q.dense=ut);var J=q.dense?[]:{},ke="Sheet1",Ke="",He=0,We={},Ae=[],Ot=[],G={s:{r:0,c:0},e:{r:0,c:0}},or=q.sheetRows||0;if(0==X[2]&&(8==X[3]||9==X[3])&&X.length>=16&&5==X[14]&&108===X[15])throw new Error("Unsupported Works 3 for Mac file");if(2==X[2])q.Enum=pt,e(X,function(tt,Lr,fi){switch(fi){case 0:q.vers=tt,tt>=4096&&(q.qpro=!0);break;case 6:G=tt;break;case 204:tt&&(Ke=tt);break;case 222:Ke=tt;break;case 15:case 51:q.qpro||(tt[1].v=tt[1].v.slice(1));case 13:case 14:case 16:14==fi&&112==(112&tt[2])&&(15&tt[2])>1&&(15&tt[2])<15&&(tt[1].z=q.dateNF||vt[14],q.cellDates&&(tt[1].t="d",tt[1].v=cs(tt[1].v))),q.qpro&&tt[3]>He&&(J["!ref"]=Et(G),We[ke]=J,Ae.push(ke),J=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},He=tt[3],ke=Ke||"Sheet"+(He+1),Ke="");var Zi=q.dense?(J[tt[0].r]||[])[tt[0].c]:J[bt(tt[0])];if(Zi){Zi.t=tt[1].t,Zi.v=tt[1].v,null!=tt[1].z&&(Zi.z=tt[1].z),null!=tt[1].f&&(Zi.f=tt[1].f);break}q.dense?(J[tt[0].r]||(J[tt[0].r]=[]),J[tt[0].r][tt[0].c]=tt[1]):J[bt(tt[0])]=tt[1]}},q);else{if(26!=X[2]&&14!=X[2])throw new Error("Unrecognized LOTUS BOF "+X[2]);q.Enum=Ee,14==X[2]&&(q.qpro=!0,X.l=0),e(X,function(tt,Lr,fi){switch(fi){case 204:ke=tt;break;case 22:tt[1].v=tt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(tt[3]>He&&(J["!ref"]=Et(G),We[ke]=J,Ae.push(ke),J=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ke="Sheet"+((He=tt[3])+1)),or>0&&tt[0].r>=or)break;q.dense?(J[tt[0].r]||(J[tt[0].r]=[]),J[tt[0].r][tt[0].c]=tt[1]):J[bt(tt[0])]=tt[1],G.e.c<tt[0].c&&(G.e.c=tt[0].c),G.e.r<tt[0].r&&(G.e.r=tt[0].r);break;case 27:tt[14e3]&&(Ot[tt[14e3][0]]=tt[14e3][1]);break;case 1537:Ot[tt[0]]=tt[1],tt[0]==He&&(ke=tt[1])}},q)}if(J["!ref"]=Et(G),We[Ke||ke]=J,Ae.push(Ke||ke),!Ot.length)return{SheetNames:Ae,Sheets:We};for(var Ht={},cr=[],Wt=0;Wt<Ot.length;++Wt)We[Ae[Wt]]?(cr.push(Ot[Wt]||Ae[Wt]),Ht[Ot[Wt]]=We[Ot[Wt]]||We[Ae[Wt]]):(cr.push(Ot[Wt]),Ht[Ot[Wt]]={"!ref":"A1"});return{SheetNames:cr,Sheets:Ht}}function _(X,fe,q){var J=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&20768!=q.vers?(J[0].c=X.read_shift(1),J[3]=X.read_shift(1),J[0].r=X.read_shift(2),X.l+=2):(J[2]=X.read_shift(1),J[0].c=X.read_shift(2),J[0].r=X.read_shift(2)),J}function w(X,fe,q){var J=X.l+fe,ke=_(X,0,q);if(ke[1].t="s",20768==q.vers){X.l++;var Ke=X.read_shift(1);return ke[1].v=X.read_shift(Ke,"utf8"),ke}return q.qpro&&X.l++,ke[1].v=X.read_shift(J-X.l,"cstr"),ke}function T(X,fe,q){var J=we(7+q.length);J.write_shift(1,255),J.write_shift(2,fe),J.write_shift(2,X),J.write_shift(1,39);for(var ke=0;ke<J.length;++ke){var Ke=q.charCodeAt(ke);J.write_shift(1,Ke>=128?95:Ke)}return J.write_shift(1,0),J}function E(X,fe,q){var J=we(7);return J.write_shift(1,255),J.write_shift(2,fe),J.write_shift(2,X),J.write_shift(2,q,"i"),J}function k(X,fe,q){var J=we(13);return J.write_shift(1,255),J.write_shift(2,fe),J.write_shift(2,X),J.write_shift(8,q,"f"),J}function N(X,fe,q){var J=32768&fe;return fe=(J?X:0)+((fe&=-32769)>=8192?fe-16384:fe),(J?"":"$")+(q?$t(fe):yr(fe))}var B={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function se(X){var fe=[{c:0,r:0},{t:"n",v:0},0];return fe[0].r=X.read_shift(2),fe[3]=X[X.l++],fe[0].c=X[X.l++],fe}function V(X,fe,q,J){var ke=we(6+J.length);ke.write_shift(2,X),ke.write_shift(1,q),ke.write_shift(1,fe),ke.write_shift(1,39);for(var Ke=0;Ke<J.length;++Ke){var He=J.charCodeAt(Ke);ke.write_shift(1,He>=128?95:He)}return ke.write_shift(1,0),ke}function te(X,fe){var q=se(X),J=X.read_shift(4),ke=X.read_shift(4),Ke=X.read_shift(2);if(65535==Ke)return 0===J&&3221225472===ke?(q[1].t="e",q[1].v=15):0===J&&3489660928===ke?(q[1].t="e",q[1].v=42):q[1].v=0,q;var He=32768&Ke;return Ke=(32767&Ke)-16446,q[1].v=(1-2*He)*(ke*Math.pow(2,Ke+32)+J*Math.pow(2,Ke)),q}function ge(X,fe,q,J){var ke=we(14);if(ke.write_shift(2,X),ke.write_shift(1,q),ke.write_shift(1,fe),0==J)return ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(2,65535),ke;var Ke=0,He=0,Ae=0;return J<0&&(Ke=1,J=-J),He=0|Math.log2(J),2147483648&(Ae=(J/=Math.pow(2,He-31))>>>0)||(++He,Ae=(J/=2)>>>0),J-=Ae,Ae|=2147483648,Ae>>>=0,J*=Math.pow(2,32),ke.write_shift(4,J>>>0),ke.write_shift(4,Ae),ke.write_shift(2,He+=16383+(Ke?32768:0)),ke}function ze(X,fe){var q=se(X),J=X.read_shift(8,"f");return q[1].v=J,q}function $e(X,fe){return 0==X[X.l+fe-1]?X.read_shift(fe,"cstr"):""}function qe(X,fe){var q=we(5+X.length);q.write_shift(2,14e3),q.write_shift(2,fe);for(var J=0;J<X.length;++J){var ke=X.charCodeAt(J);q[q.l++]=ke>127?95:ke}return q[q.l++]=0,q}var pt={0:{n:"BOF",f:br},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function p(X,fe,q){var J={s:{c:0,r:0},e:{c:0,r:0}};return 8==fe&&q.qpro?(J.s.c=X.read_shift(1),X.l++,J.s.r=X.read_shift(2),J.e.c=X.read_shift(1),X.l++,J.e.r=X.read_shift(2),J):(J.s.c=X.read_shift(2),J.s.r=X.read_shift(2),12==fe&&q.qpro&&(X.l+=2),J.e.c=X.read_shift(2),J.e.r=X.read_shift(2),12==fe&&q.qpro&&(X.l+=2),65535==J.s.c&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function C(X,fe,q){var J=_(X,0,q);return J[1].v=X.read_shift(2,"i"),J}},14:{n:"NUMBER",f:function A(X,fe,q){var J=_(X,0,q);return J[1].v=X.read_shift(8,"f"),J}},15:{n:"LABEL",f:w},16:{n:"FORMULA",f:function F(X,fe,q){var J=X.l+fe,ke=_(X,0,q);if(ke[1].v=X.read_shift(8,"f"),q.qpro)X.l=J;else{var Ke=X.read_shift(2);(function re(X,fe){Hr(X,0);for(var q=[],J=0,ke="",Ke="",He="",We="";X.l<X.length;){var Ae=X[X.l++];switch(Ae){case 0:q.push(X.read_shift(8,"f"));break;case 1:Ke=N(fe[0].c,X.read_shift(2),!0),ke=N(fe[0].r,X.read_shift(2),!1),q.push(Ke+ke);break;case 2:var Ot=N(fe[0].c,X.read_shift(2),!0),G=N(fe[0].r,X.read_shift(2),!1);Ke=N(fe[0].c,X.read_shift(2),!0),ke=N(fe[0].r,X.read_shift(2),!1),q.push(Ot+G+":"+Ke+ke);break;case 3:if(X.l<X.length)return void console.error("WK1 premature formula end");break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(X.read_shift(2));break;case 6:for(var or="";Ae=X[X.l++];)or+=String.fromCharCode(Ae);q.push('"'+or.replace(/"/g,'""')+'"');break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:We=q.pop(),He=q.pop(),q.push(["AND","OR"][Ae-20]+"("+He+","+We+")");break;default:if(Ae<32&&I[Ae])We=q.pop(),He=q.pop(),q.push(He+I[Ae]+We);else{if(!B[Ae])return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16));if(69==(J=B[Ae][1])&&(J=X[X.l++]),J>q.length)return void console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+q.join("|")+"|");var Ht=q.slice(-J);q.length-=J,q.push(B[Ae][0]+"("+Ht.join(",")+")")}}}1==q.length?fe[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")})(X.slice(X.l,X.l+Ke),ke),X.l+=Ke}return ke}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:w},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:$e},222:{n:"SHEETNAMELP",f:function xt(X,fe){var q=X[X.l++];q>fe-1&&(q=fe-1);for(var J="";J.length<q;)J+=String.fromCharCode(X[X.l++]);return J}},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function ee(X,fe){var q=se(X);return q[1].t="s",q[1].v=X.read_shift(fe-4,"cstr"),q}},23:{n:"NUMBER17",f:te},24:{n:"NUMBER18",f:function ne(X,fe){var q=se(X);q[1].v=X.read_shift(2);var J=q[1].v>>1;if(1&q[1].v)switch(7&J){case 0:J=5e3*(J>>3);break;case 1:J=500*(J>>3);break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64}return q[1].v=J,q}},25:{n:"FORMULA19",f:function _e(X,fe){var q=te(X);return X.l+=fe-14,q}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Nt(X,fe){for(var q={},J=X.l+fe;X.l<J;){var ke=X.read_shift(2);if(14e3==ke){for(q[ke]=[0,""],q[ke][0]=X.read_shift(2);X[X.l];)q[ke][1]+=String.fromCharCode(X[X.l]),X.l++;X.l++}}return q}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function ae(X,fe){var q=se(X),J=X.read_shift(4);return q[1].v=J>>6,q}},38:{n:"??"},39:{n:"NUMBER27",f:ze},40:{n:"FORMULA28",f:function nt(X,fe){var q=ze(X);return X.l+=fe-10,q}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:$e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function ot(X,fe,q){if(q.qpro&&!(fe<21)){var J=X.read_shift(1);return X.l+=17,X.l+=1,X.l+=2,[J,X.read_shift(fe-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function s(X,fe){var q=fe||{};if(+q.codepage>=0&&Fe(+q.codepage),"string"==q.type)throw new Error("Cannot write WK1 to JS string");var J=sn(),ke=Lt(X["!ref"]),Ke=Array.isArray(X),He=[];Ge(J,0,function f(X){var fe=we(2);return fe.write_shift(2,X),fe}(1030)),Ge(J,6,function x(X){var fe=we(8);return fe.write_shift(2,X.s.c),fe.write_shift(2,X.s.r),fe.write_shift(2,X.e.c),fe.write_shift(2,X.e.r),fe}(ke));for(var We=Math.min(ke.e.r,8191),Ae=ke.s.r;Ae<=We;++Ae)for(var Ot=yr(Ae),G=ke.s.c;G<=ke.e.c;++G){Ae===ke.s.r&&(He[G]=$t(G));var Ht=Ke?(X[Ae]||[])[G]:X[He[G]+Ot];Ht&&"z"!=Ht.t&&("n"==Ht.t?(0|Ht.v)==Ht.v&&Ht.v>=-32768&&Ht.v<=32767?Ge(J,13,E(Ae,G,Ht.v)):Ge(J,14,k(Ae,G,Ht.v)):Ge(J,15,T(Ae,G,Vn(Ht).slice(0,239))))}return Ge(J,1),J.end()},book_to_wk3:function o(X,fe){var q=fe||{};if(+q.codepage>=0&&Fe(+q.codepage),"string"==q.type)throw new Error("Cannot write WK3 to JS string");var J=sn();Ge(J,0,function u(X){var fe=we(26);fe.write_shift(2,4096),fe.write_shift(2,4),fe.write_shift(4,0);for(var q=0,J=0,ke=0,Ke=0;Ke<X.SheetNames.length;++Ke){var We=X.Sheets[X.SheetNames[Ke]];if(We&&We["!ref"]){++ke;var Ae=on(We["!ref"]);q<Ae.e.r&&(q=Ae.e.r),J<Ae.e.c&&(J=Ae.e.c)}}return q>8191&&(q=8191),fe.write_shift(2,q),fe.write_shift(1,ke),fe.write_shift(1,J),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(1,1),fe.write_shift(1,2),fe.write_shift(4,0),fe.write_shift(4,0),fe}(X));for(var ke=0,Ke=0;ke<X.SheetNames.length;++ke)(X.Sheets[X.SheetNames[ke]]||{})["!ref"]&&Ge(J,27,qe(X.SheetNames[ke],Ke++));var He=0;for(ke=0;ke<X.SheetNames.length;++ke){var We=X.Sheets[X.SheetNames[ke]];if(We&&We["!ref"]){for(var Ae=Lt(We["!ref"]),Ot=Array.isArray(We),G=[],or=Math.min(Ae.e.r,8191),Ht=Ae.s.r;Ht<=or;++Ht)for(var cr=yr(Ht),Wt=Ae.s.c;Wt<=Ae.e.c;++Wt){Ht===Ae.s.r&&(G[Wt]=$t(Wt));var Lr=Ot?(We[Ht]||[])[Wt]:We[G[Wt]+cr];Lr&&"z"!=Lr.t&&("n"==Lr.t?Ge(J,23,ge(Ht,Wt,He,Lr.v)):Ge(J,22,V(Ht,Wt,He,Vn(Lr).slice(0,239))))}++He}}return Ge(J,1),J.end()},to_workbook:function r(X,fe){switch(fe.type){case"base64":return t(Sr(Ut(X)),fe);case"binary":return t(Sr(X),fe);case"buffer":case"array":return t(X,fe)}throw"Unsupported type "+fe.type}}}(),xd=function(){var e=In("t"),r=In("rPr");function t(f){var u=f.match(e);if(!u)return{t:"s",v:""};var p={t:"s",v:zt(u[1])},x=f.match(r);return x&&(p.s=function gd(e){var r={},t=e.match($r),s=0,o=!1;if(t)for(;s!=t.length;++s){var f=mt(t[s]);switch(f[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!f.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==f.val)break;r.cp=Re[parseInt(f.val,10)];break;case"<outline":if(!f.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=f.val;break;case"<sz":r.sz=f.val;break;case"<strike":if(!f.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!f.val)break;switch(f.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==f.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==f.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":f.rgb&&(r.color=f.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=f.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=f.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(47!==f[0].charCodeAt(1)&&!o)throw new Error("Unrecognized rich format "+f[0])}}return r}(x[1])),p}var s=/<(?:\w+:)?r>/g,o=/<\/(?:\w+:)?r>/;return function(u){return u.replace(s,"").split(o).map(t).filter(function(p){return p.v})}}(),_d=function(){var r=/(\r\n|\n)/g;function s(o){var f=[[],o.v,[]];return o.v?(o.s&&function t(o,f,u){var p=[];o.u&&p.push("text-decoration: underline;"),o.uval&&p.push("text-underline-style:"+o.uval+";"),o.sz&&p.push("font-size:"+o.sz+"pt;"),o.outline&&p.push("text-effect: outline;"),o.shadow&&p.push("text-shadow: auto;"),f.push('<span style="'+p.join("")+'">'),o.b&&(f.push("<b>"),u.push("</b>")),o.i&&(f.push("<i>"),u.push("</i>")),o.strike&&(f.push("<s>"),u.push("</s>"));var x=o.valign||"";"superscript"==x||"super"==x?x="sup":"subscript"==x&&(x="sub"),""!=x&&(f.push("<"+x+">"),u.push("</"+x+">")),u.push("</span>")}(o.s,f[0],f[2]),f[0].join("")+f[1].replace(r,"<br/>")+f[2].join("")):""}return function(f){return f.map(s).join("")}}(),hf=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,vd=/<(?:\w+:)?r>/,wd=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Eo(e,r){var t=!r||r.cellHTML,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=zt(jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=jt(e),t&&(s.h=lc(s.t))):e.match(vd)&&(s.r=jt(e),s.t=zt(jt((e.replace(wd,"").match(hf)||[]).join("").replace($r,""))),t&&(s.h=_d(xd(s.r)))),s):{t:""}}var So=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uf=/<(?:\w+:)?(?:si|sstItem)>/g,yd=/<\/(?:\w+:)?(?:si|sstItem)>/,pf=/^\s|\s$|[\t\n\r]/;function fn(e,r){if(!r.bookSST)return"";var t=[vr];t[t.length]=Ue("sst",null,{xmlns:Di[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(null!=e[s]){var o=e[s],f="<si>";o.r?f+=o.r:(f+="<t",o.t||(o.t=""),o.t.match(pf)&&(f+=' xml:space="preserve"'),f+=">"+Kt(o.t)+"</t>"),t[t.length]=f+="</si>"}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}var Td=function Hh(e,r){var t=!1;return null==r&&(t=!0,r=we(15+4*e.t.length)),r.write_shift(1,0),Mr(e.t,r),t?r.slice(0,r.l):r};function Cd(e){var r=sn();Se(r,159,function kd(e,r){return r||(r=we(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}(e));for(var t=0;t<e.length;++t)Se(r,19,Td(e[t]));return Se(r,160),r.end()}function gf(e){if(typeof ue<"u")return ue.utils.encode(Ze,e);for(var r=[],t=e.split(""),s=0;s<t.length;++s)r[s]=t[s].charCodeAt(0);return r}function si(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Sd(e){for(var r=e.read_shift(4),t=e.l+r-4,s={},o=e.read_shift(4),f=[];o-- >0;)f.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=f,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return s}function Wi(e,r){var t=e.l+r,s={};s.Flags=63&e.read_shift(4),e.l+=4,s.AlgID=e.read_shift(4);var o=!1;switch(s.AlgID){case 26126:case 26127:case 26128:o=36==s.Flags;break;case 26625:o=4==s.Flags;break;case 0:o=16==s.Flags||4==s.Flags||36==s.Flags;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!o)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,s}function Xc(e,r){var t={},s=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,s),e.l=s,t}function Fd(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Wi(e,t),v:Xc(e,e.length-e.l)}}function Dd(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Od(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),s={};return t.replace($r,function(f){var u=mt(f);switch(Cn(u[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(p){s[p]=u[p]});break;case"<dataIntegrity":s.encryptedHmacKey=u.encryptedHmacKey,s.encryptedHmacValue=u.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"<keyEncryptor":s.uri=u.uri;break;case"<encryptedKey":s.encs.push(u);break;default:throw u[0]}}),s}function Fo(e){var t,f,r=0,s=gf(e),o=s.length+1;for((t=un(o))[0]=s.length,f=1;f!=o;++f)t[f]=s[f-1];for(f=o-1;f>=0;--f)r=((16384&r?1:0)|r<<1&32767)^t[f];return 52811^r}var vf=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],o=function(u,p){return function(u){return 255&(u/2|128*u)}(u^p)};return function(u){for(var p=gf(u),x=function(u){for(var p=r[u.length-1],x=104,_=u.length-1;_>=0;--_)for(var w=u[_],T=0;7!=T;++T)64&w&&(p^=t[x]),w*=2,--x;return p}(p),_=p.length,w=un(16),T=0;16!=T;++T)w[T]=0;var A;for(1==(1&_)&&(w[_]=o(e[0],x>>8),w[--_]=o(p[p.length-1],255&x));_>0;)w[--_]=o(p[_],x>>8),w[--_]=o(p[_],255&x);for(_=15,A=15-p.length;A>0;)w[_]=o(e[A],x>>8),--A,w[--_]=o(p[_],255&x),--_,--A;return w}}();var wf=function(){function e(o,f){switch(f.type){case"base64":return r(Ut(o),f);case"binary":return r(o,f);case"buffer":return r(wt&&Buffer.isBuffer(o)?o.toString("binary"):Jn(o),f);case"array":return r(pi(o),f)}throw new Error("Unrecognized type "+f.type)}function r(o,f){var p=(f||{}).dense?[]:{},x=o.match(/\\trowd.*?\\row\b/g);if(!x.length)throw new Error("RTF missing table");var _={s:{c:0,r:0},e:{c:0,r:x.length-1}};return x.forEach(function(w,T){Array.isArray(p)&&(p[T]=[]);for(var A,C=/\\\w+\b/g,E=0,k=-1;A=C.exec(w);){if("\\cell"===A[0]){var F=w.slice(E,C.lastIndex-A[0].length);if(" "==F[0]&&(F=F.slice(1)),++k,F.length){var N={v:F,t:"s"};Array.isArray(p)?p[T][k]=N:p[bt({r:T,c:k})]=N}}E=C.lastIndex}k>_.e.c&&(_.e.c=k)}),p["!ref"]=Et(_),p}return{to_workbook:function t(o,f){return gi(e(o,f),f)},to_sheet:e,from_sheet:function s(o){for(var p,f=["{\\rtf1\\ansi"],u=Lt(o["!ref"]),x=Array.isArray(o),_=u.s.r;_<=u.e.r;++_){f.push("\\trowd\\trautofit1");for(var w=u.s.c;w<=u.e.c;++w)f.push("\\cellx"+(w+1));for(f.push("\\pard\\intbl"),w=u.s.c;w<=u.e.c;++w){var T=bt({r:_,c:w});(p=x?(o[_]||[])[w]:o[T])&&(null!=p.v||p.f&&!p.F)&&(f.push(" "+(p.w||(Vn(p),p.w))),f.push("\\cell"))}f.push("\\pard\\intbl\\row")}return f.join("")+"}"}}}();function As(e){for(var r=0,t=1;3!=r;++r)t=256*t+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Do(e,r){if(0===r)return e;var t=function Ud(e){var r=e[0]/255,t=e[1]/255,s=e[2]/255,o=Math.max(r,t,s),f=Math.min(r,t,s),u=o-f;if(0===u)return[0,0,r];var x,p=0,_=o+f;switch(x=u/(_>1?2-_:_),o){case r:p=((t-s)/u+6)%6;break;case t:p=(s-r)/u+2;break;case s:p=(r-t)/u+4}return[p/6,x,_/2]}(function Bd(e){var r=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}(e));return t[2]=r<0?t[2]*(1+r):1-(1-t[2])*(1-r),As(function yf(e){var x,t=e[1],s=e[2],o=2*t*(s<.5?s:1-s),f=s-o/2,u=[f,f,f],p=6*e[0];if(0!==t)switch(0|p){case 0:case 6:x=o*p,u[0]+=o,u[1]+=x;break;case 1:u[0]+=x=o*(2-p),u[1]+=o;break;case 2:x=o*(p-2),u[1]+=o,u[2]+=x;break;case 3:u[1]+=x=o*(4-p),u[2]+=o;break;case 4:x=o*(p-4),u[2]+=o,u[0]+=x;break;case 5:u[2]+=x=o*(6-p),u[0]+=o}for(var _=0;3!=_;++_)u[_]=Math.round(255*u[_]);return u}(t))}var bf=6,Hd=15,Oo=1,Jt=bf;function Va(e){return Math.floor((e+Math.round(128/Jt)/256)*Jt)}function za(e){return Math.floor((e-5)/Jt*100+.5)/100}function Fs(e){return Math.round((e*Jt+5)/Jt*256)/256}function Zc(e){return Fs(za(Va(e)))}function Kc(e){var r=Math.abs(e-Zc(e)),t=Jt;if(r>.005)for(Jt=Oo;Jt<Hd;++Jt)Math.abs(e-Zc(e))<=r&&(r=Math.abs(e-Zc(e)),t=Jt);Jt=t}function xi(e){e.width?(e.wpx=Va(e.width),e.wch=za(e.wpx),e.MDW=Jt):e.wpx?(e.wch=za(e.wpx),e.width=Fs(e.wch),e.MDW=Jt):"number"==typeof e.wch&&(e.width=Fs(e.wch),e.wpx=Va(e.width),e.MDW=Jt),e.customWidth&&delete e.customWidth}var Jc=96;function pa(e){return 96*e/Jc}function _i(e){return e*Jc/96}var Vd={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Io=["numFmtId","fillId","fontId","borderId","xfId"],Po=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Ro=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,o=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,f=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(p,x,_){var T,w={};return p?((T=(p=p.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(r))&&function jd(e,r,t){r.NumberFmt=[];for(var s=fr(vt),o=0;o<s.length;++o)r.NumberFmt[s[o]]=vt[s[o]];var f=e[0].match($r);if(f)for(o=0;o<f.length;++o){var u=mt(f[o]);switch(Cn(u[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var p=zt(jt(u.formatCode)),x=parseInt(u.numFmtId,10);if(r.NumberFmt[x]=p,x>0){if(x>392){for(x=392;x>60&&null!=r.NumberFmt[x];--x);r.NumberFmt[x]=p}Q(p,x)}break;default:if(t.WTF)throw new Error("unrecognized "+u[0]+" in numFmts")}}}(T,w,_),(T=p.match(o))&&function Gd(e,r,t,s){r.Fonts=[];var o={},f=!1;(e[0].match($r)||[]).forEach(function(u){var p=mt(u);switch(Cn(p[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":r.Fonts.push(o),o={};break;case"<name":p.val&&(o.name=jt(p.val));break;case"<b":o.bold=p.val?sr(p.val):1;break;case"<b/>":o.bold=1;break;case"<i":o.italic=p.val?sr(p.val):1;break;case"<i/>":o.italic=1;break;case"<u":switch(p.val){case"none":o.underline=0;break;case"single":o.underline=1;break;case"double":o.underline=2;break;case"singleAccounting":o.underline=33;break;case"doubleAccounting":o.underline=34}break;case"<u/>":o.underline=1;break;case"<strike":o.strike=p.val?sr(p.val):1;break;case"<strike/>":o.strike=1;break;case"<outline":o.outline=p.val?sr(p.val):1;break;case"<outline/>":o.outline=1;break;case"<shadow":o.shadow=p.val?sr(p.val):1;break;case"<shadow/>":o.shadow=1;break;case"<condense":o.condense=p.val?sr(p.val):1;break;case"<condense/>":o.condense=1;break;case"<extend":o.extend=p.val?sr(p.val):1;break;case"<extend/>":o.extend=1;break;case"<sz":p.val&&(o.sz=+p.val);break;case"<vertAlign":p.val&&(o.vertAlign=p.val);break;case"<family":p.val&&(o.family=parseInt(p.val,10));break;case"<scheme":p.val&&(o.scheme=p.val);break;case"<charset":if("1"==p.val)break;p.codepage=Re[parseInt(p.val,10)];break;case"<color":if(o.color||(o.color={}),p.auto&&(o.color.auto=sr(p.auto)),p.rgb)o.color.rgb=p.rgb.slice(-6);else if(p.indexed){o.color.index=parseInt(p.indexed,10);var x=la[o.color.index];81==o.color.index&&(x=la[1]),x||(x=la[1]),o.color.rgb=x[0].toString(16)+x[1].toString(16)+x[2].toString(16)}else p.theme&&(o.color.theme=parseInt(p.theme,10),p.tint&&(o.color.tint=parseFloat(p.tint)),p.theme&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=Do(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0)));break;case"<AlternateContent":case"<ext":f=!0;break;case"</AlternateContent>":case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in fonts")}})}(T,w,x,_),(T=p.match(s))&&function $d(e,r,t,s){r.Fills=[];var o={},f=!1;(e[0].match($r)||[]).forEach(function(u){var p=mt(u);switch(Cn(p[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r.Fills.push(o={});break;case"<gradientFill":case"</gradientFill>":r.Fills.push(o),o={};break;case"<patternFill":case"<patternFill>":p.patternType&&(o.patternType=p.patternType);break;case"<bgColor":o.bgColor||(o.bgColor={}),p.indexed&&(o.bgColor.indexed=parseInt(p.indexed,10)),p.theme&&(o.bgColor.theme=parseInt(p.theme,10)),p.tint&&(o.bgColor.tint=parseFloat(p.tint)),p.rgb&&(o.bgColor.rgb=p.rgb.slice(-6));break;case"<fgColor":o.fgColor||(o.fgColor={}),p.theme&&(o.fgColor.theme=parseInt(p.theme,10)),p.tint&&(o.fgColor.tint=parseFloat(p.tint)),null!=p.rgb&&(o.fgColor.rgb=p.rgb.slice(-6));break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in fills")}})}(T,w,0,_),(T=p.match(f))&&function zd(e,r,t,s){r.Borders=[];var o={},f=!1;(e[0].match($r)||[]).forEach(function(u){var p=mt(u);switch(Cn(p[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":o={},p.diagonalUp&&(o.diagonalUp=sr(p.diagonalUp)),p.diagonalDown&&(o.diagonalDown=sr(p.diagonalDown)),r.Borders.push(o);break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(s&&s.WTF&&!f)throw new Error("unrecognized "+p[0]+" in borders")}})}(T,w,0,_),(T=p.match(t))&&function Mo(e,r,t){r.CellXf=[];var s,o=!1;(e[0].match($r)||[]).forEach(function(f){var u=mt(f),p=0;switch(Cn(u[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(s=u)[0],p=0;p<Io.length;++p)s[Io[p]]&&(s[Io[p]]=parseInt(s[Io[p]],10));for(p=0;p<Po.length;++p)s[Po[p]]&&(s[Po[p]]=sr(s[Po[p]]));if(r.NumberFmt&&s.numFmtId>392)for(p=392;p>60;--p)if(r.NumberFmt[s.numFmtId]==r.NumberFmt[p]){s.numFmtId=p;break}r.CellXf.push(s);break;case"<alignment":case"<alignment/>":var x={};u.vertical&&(x.vertical=u.vertical),u.horizontal&&(x.horizontal=u.horizontal),null!=u.textRotation&&(x.textRotation=u.textRotation),u.indent&&(x.indent=u.indent),u.wrapText&&(x.wrapText=sr(u.wrapText)),s.alignment=x;break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(t&&t.WTF&&!o)throw new Error("unrecognized "+u[0]+" in cellXfs")}})}(T,w,_),w):w}}();function kf(e,r){var s,t=[vr,Ue("styleSheet",null,{xmlns:Di[0],"xmlns:vt":Cr.vt})];return e.SSF&&null!=(s=function Xd(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)null!=e[s]&&(r[r.length]=Ue("numFmt",null,{numFmtId:s,formatCode:Kt(e[s])}))}),1===r.length?"":(r[r.length]="</numFmts>",r[0]=Ue("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(e.SSF))&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=function Yd(e){var r=[];return r[r.length]=Ue("cellXfs",null),e.forEach(function(t){r[r.length]=Ue("xf",null,t)}),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=Ue("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(r.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Kd(e,r,t){t||(t=we(6+4*r.length)),t.write_shift(2,e),Mr(r,t);var s=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),s}var Qc,qd=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ep=Xr;function Tf(e,r){r||(r=we(84)),Qc||(Qc=ss(qd));var t=Qc[e.patternType];null==t&&(t=40),r.write_shift(4,t);var s=0;if(40!=t)for(ho({auto:1},r),ho({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function ma(e,r,t){return t||(t=we(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Vi(e,r){return r||(r=we(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var rp=Xr;function Ef(e,r){var t=sn();return Se(t,278),function op(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&++t}),0!=t&&(Se(e,615,zn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&Se(e,44,Kd(o,r[o]))}),Se(e,616))}}(t,e.SSF),function cp(e){Se(e,611,zn(1)),Se(e,43,function Qd(e,r){r||(r=we(153)),r.write_shift(2,20*e.sz),function zh(e,r){r||(r=we(2)),r.write_shift(1,(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0)),r.write_shift(1,0)}(e,r),r.write_shift(2,e.bold?700:400);var t=0;"superscript"==e.vertAlign?t=1:"subscript"==e.vertAlign&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),ho(e.color,r);var s=0;return"major"==e.scheme&&(s=1),"minor"==e.scheme&&(s=2),r.write_shift(1,s),Mr(e.name,r),r.length>r.l?r.slice(0,r.l):r}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Se(e,612)}(t),function lp(e){Se(e,603,zn(2)),Se(e,45,Tf({patternType:"none"})),Se(e,45,Tf({patternType:"gray125"})),Se(e,604)}(t),function fp(e){Se(e,613,zn(1)),Se(e,46,function np(e,r){return r||(r=we(51)),r.write_shift(1,0),Vi(0,r),Vi(0,r),Vi(0,r),Vi(0,r),Vi(0,r),r.length>r.l?r.slice(0,r.l):r}()),Se(e,614)}(t),function Cf(e){Se(e,626,zn(1)),Se(e,47,ma({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Se(e,627)}(t),function hp(e,r){Se(e,617,zn(r.length)),r.forEach(function(t){Se(e,47,ma(t,0))}),Se(e,618)}(t,r.cellXfs),function up(e){Se(e,619,zn(1)),Se(e,48,function ip(e,r){return r||(r=we(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),lo(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}({xfId:0,builtinId:0,name:"Normal"})),Se(e,620)}(t),function $a(e){Se(e,505,zn(0)),Se(e,506)}(t),function dp(e){Se(e,508,function ap(e,r,t){var s=we(2052);return s.write_shift(4,e),lo(r,s),lo(t,s),s.length>s.l?s.slice(0,s.l):s}(0,"TableStyleMedium9","PivotStyleMedium4")),Se(e,509)}(t),Se(t,279),t.end()}var pp=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mp(e,r,t){r.themeElements.clrScheme=[];var s={};(e[0].match($r)||[]).forEach(function(o){var f=mt(o);switch(f[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=f.val;break;case"<a:sysClr":s.rgb=f.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===f[0].charAt(1)?(r.themeElements.clrScheme[pp.indexOf(f[0])]=s,s={}):s.name=f[0].slice(3,f[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+f[0]+" in clrScheme")}})}function Ds(){}function gp(){}var xp=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_p=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vp=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,yp=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sf(e,r){(!e||0===e.length)&&(e=el());var t,s={};if(!(t=e.match(yp)))throw new Error("themeElements not found in theme");return function wp(e,r,t){var s;r.themeElements={},[["clrScheme",xp,mp],["fontScheme",_p,Ds],["fmtScheme",vp,gp]].forEach(function(o){if(!(s=e.match(o[1])))throw new Error(o[0]+" not found in themeElements");o[2](s,r,t)})}(t[0],s,r),s.raw=e,s}function el(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var t=[vr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Tp(e){var r=e.read_shift(2),t=e.read_shift(2)-4,s=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=function Lo(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:case 4:e.l+=4;break;case 1:r.xclrValue=function kp(e,r){return Xr(e,r)}(e,4);break;case 2:r.xclrValue=O0(e);break;case 3:r.xclrValue=function bp(e){return e.read_shift(4)}(e)}return e.l+=8,r}(e);break;case 6:s[1]=function ga(e,r){return Xr(e,r)}(e,t);break;case 14:case 15:s[1]=e.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return s}function Ep(e,r){r.forEach(function(t){})}function Ip(){var e=sn();return Se(e,332),Se(e,334,zn(1)),Se(e,335,function Ap(e){var r=we(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Mr(e.name,r),r.slice(0,r.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Se(e,336),Se(e,339,function rl(e,r){var t=we(8+2*r.length);return t.write_shift(4,e),Mr(r,t),t.slice(0,t.l)}(1,"XLDAPR")),Se(e,52),Se(e,35,zn(514)),Se(e,4096,zn(0)),Se(e,4097,Mn(1)),Se(e,36),Se(e,53),Se(e,340),Se(e,337,function Dp(e,r){var t=we(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}(1,!0)),Se(e,51,function Fp(e){var r=we(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}([[1,0]])),Se(e,338),Se(e,333),e.end()}function Df(){var e=[vr];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Ga=1024;function Of(e,r){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),o=[Ue("xml",null,{"xmlns:v":En.v,"xmlns:o":En.o,"xmlns:x":En.x,"xmlns:mv":En.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];Ga<1e3*e;)Ga+=1e3;return r.forEach(function(f){var u=pr(f[0]),p={color2:"#BEFF82",type:"gradient"};"gradient"==p.type&&(p.angle="-180");var x="gradient"==p.type?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,_=Ue("v:fill",x,p);++Ga,o=o.concat(["<v:shape"+ds({id:"_x0000_s"+Ga,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(f[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",_,Ue("v:shadow",null,{on:"t",obscured:"t"}),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),jr("x:AutoFill","False"),jr("x:Row",String(u.r)),jr("x:Column",String(u.c)),f[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function If(e,r,t,s){var f,o=Array.isArray(e);r.forEach(function(u){var p=pr(u.ref);if(o?(e[p.r]||(e[p.r]=[]),f=e[p.r][p.c]):f=e[u.ref],!f){f={t:"z"},o?e[p.r][p.c]=f:e[u.ref]=f;var x=Lt(e["!ref"]||"BDWGO1000001:A1");x.s.r>p.r&&(x.s.r=p.r),x.e.r<p.r&&(x.e.r=p.r),x.s.c>p.c&&(x.s.c=p.c),x.e.c<p.c&&(x.e.c=p.c);var _=Et(x);_!==e["!ref"]&&(e["!ref"]=_)}f.c||(f.c=[]);var w={a:u.author,t:u.t,r:u.r,T:t};u.h&&(w.h=u.h);for(var T=f.c.length-1;T>=0;--T){if(!t&&f.c[T].T)return;t&&!f.c[T].T&&f.c.splice(T,1)}if(t&&s)for(T=0;T<s.length;++T)if(w.a==s[T].id){w.a=s[T].name||w.a;break}f.c.push(w)})}function Pf(e){var r=[vr,Ue("comments",null,{xmlns:Di[0]})],t=[];return r.push("<authors>"),e.forEach(function(s){s[1].forEach(function(o){var f=Kt(o.a);-1==t.indexOf(f)&&(t.push(f),r.push("<author>"+f+"</author>")),o.T&&o.ID&&-1==t.indexOf("tc="+o.ID)&&(t.push("tc="+o.ID),r.push("<author>tc="+o.ID+"</author>"))})}),0==t.length&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(s){var o=0,f=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?o=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(x){x.a&&(o=t.indexOf(Kt(x.a))),f.push(x.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+o+'"><text>'),f.length<=1)r.push(jr("t",Kt(f[0]||"")));else{for(var u="Comment:\n    "+f[0]+"\n",p=1;p<f.length;++p)u+="Reply:\n    "+f[p]+"\n";r.push(jr("t",Kt(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Wp(e,r,t){var s=[vr,Ue("ThreadedComments",null,{xmlns:Cr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var f="";(o[1]||[]).forEach(function(u,p){if(u.T){u.a&&-1==r.indexOf(u.a)&&r.push(u.a);var x={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};0==p?f=x.id:x.parentId=f,u.ID=x.id,u.a&&(x.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),s.push(Ue("threadedComment",jr("text",u.t||""),x))}else delete u.ID})}),s.push("</ThreadedComments>"),s.join("")}var Os=qr;function jp(e){var r=sn(),t=[];return Se(r,628),Se(r,630),e.forEach(function(s){s[1].forEach(function(o){t.indexOf(o.a)>-1||(t.push(o.a.slice(0,54)),Se(r,632,function $p(e){return Mr(e.slice(0,54))}(o.a)))})}),Se(r,631),Se(r,633),e.forEach(function(s){s[1].forEach(function(o){o.iauthor=t.indexOf(o.a);var f={s:pr(s[0]),e:pr(s[0])};Se(r,635,function zp(e,r){return null==r&&(r=we(36)),r.write_shift(4,e[1].iauthor),sa(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}([f,o])),o.t&&o.t.length>0&&Se(r,637,function yc(e,r){var t=!1;return null==r&&(t=!0,r=we(23+4*e.t.length)),r.write_shift(1,1),Mr(e.t,r),r.write_shift(4,1),function vc(e,r){r||(r=we(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}(o)),Se(r,636),delete o.iauthor})}),Se(r,634),Se(r,629),r.end()}var Xp="application/vnd.ms-office.vbaProject",Rf=["xlsb","xlsm","xlam","biff8","xla"],ja=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(s,o,f,u){var p=!1,x=!1;0==f.length?x=!0:"["==f.charAt(0)&&(x=!0,f=f.slice(1,-1)),0==u.length?p=!0:"["==u.charAt(0)&&(p=!0,u=u.slice(1,-1));var _=f.length>0?0|parseInt(f,10):0,w=u.length>0?0|parseInt(u,10):0;return p?w+=r.c:--w,x?_+=r.r:--_,o+(p?"":"$")+$t(w)+(x?"":"$")+yr(_)}return function(o,f){return r=f,o.replace(e,t)}}(),il=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,al=function(){return function(r,t){return r.replace(il,function(s,o,f,u,p,x){var _=_c(u)-(f?0:t.c),w=co(x)-(p?0:t.r);return o+"R"+(0==w?"":p?w+1:"["+w+"]")+"C"+(0==_?"":f?_+1:"["+_+"]")})}}();function Lf(e,r){return e.replace(il,function(t,s,o,f,u,p){return s+("$"==o?o+f:$t(_c(f)+r.c))+("$"==u?u+p:yr(co(p)+r.r))})}function em(e,r,t){var o=on(r).s,f=pr(t);return Lf(e,{r:f.r-o.r,c:f.c-o.c})}function sl(e){return e.replace(/_xlfn\./g,"")}function Fr(e){e.l+=1}function zi(e,r){var t=e.read_shift(1==r?1:2);return[16383&t,t>>14&1,t>>15&1]}function Nf(e,r,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return Bf(e);12==t.biff&&(s=4)}var o=e.read_shift(s),f=e.read_shift(s),u=zi(e,2),p=zi(e,2);return{s:{r:o,c:u[0],cRel:u[1],rRel:u[2]},e:{r:f,c:p[0],cRel:p[1],rRel:p[2]}}}function Bf(e){var r=zi(e,2),t=zi(e,2),s=e.read_shift(1),o=e.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:t[0],c:o,cRel:t[1],rRel:t[2]}}}function Is(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return function rm(e){var r=zi(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}(e);var s=e.read_shift(t&&12==t.biff?4:2),o=zi(e,2);return{r:s,c:o[0],cRel:o[1],rRel:o[2]}}function nm(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function Uf(e){var r=1&e[e.l+1];return e.l+=4,[r,1]}function Ps(e){return[e.read_shift(1),e.read_shift(1)]}function km(e,r){var t=[e.read_shift(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=Er(e,1)?"TRUE":"FALSE",12!=r&&(e.l+=7);break;case 37:case 16:t[1]=ai[e[e.l]],e.l+=12==r?4:8;break;case 0:e.l+=8;break;case 1:t[1]=en(e);break;case 2:t[1]=Ni(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function $f(e,r,t){for(var s=e.read_shift(12==t.biff?4:2),o=[],f=0;f!=s;++f)o.push((12==t.biff?aa:ko)(e,8));return o}function Tm(e,r,t){var s=0,o=0;12==t.biff?(s=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,0==--o&&(o=256));for(var f=0,u=[];f!=s&&(u[f]=[]);++f)for(var p=0;p!=o;++p)u[f][p]=km(e,t.biff);return u}function Ms(e,r,t){return e.l+=2,[nm(e)]}function No(e){return e.l+=6,[]}function Xf(e){return e.l+=2,[br(e),1&e.read_shift(2)]}var Zf=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Kf={1:{n:"PtgExp",f:function Wf(e,r,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:Xr},3:{n:"PtgAdd",f:Fr},4:{n:"PtgSub",f:Fr},5:{n:"PtgMul",f:Fr},6:{n:"PtgDiv",f:Fr},7:{n:"PtgPower",f:Fr},8:{n:"PtgConcat",f:Fr},9:{n:"PtgLt",f:Fr},10:{n:"PtgLe",f:Fr},11:{n:"PtgEq",f:Fr},12:{n:"PtgGe",f:Fr},13:{n:"PtgGt",f:Fr},14:{n:"PtgNe",f:Fr},15:{n:"PtgIsect",f:Fr},16:{n:"PtgUnion",f:Fr},17:{n:"PtgRange",f:Fr},18:{n:"PtgUplus",f:Fr},19:{n:"PtgUminus",f:Fr},20:{n:"PtgPercent",f:Fr},21:{n:"PtgParen",f:Fr},22:{n:"PtgMissArg",f:Fr},23:{n:"PtgStr",f:function bm(e,r,t){return e.l++,ha(e,0,t)}},26:{n:"PtgSheet",f:function Wm(e,r,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function ll(e,r,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function wm(e){return e.l++,ai[e.read_shift(1)]}},29:{n:"PtgBool",f:function zf(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function Vf(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function ym(e){return e.l++,en(e)}},32:{n:"PtgArray",f:function fm(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[s]}},33:{n:"PtgFunc",f:function W1(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(t&&t.biff<=3?1:2);return[ng[o],th[o],s]}},34:{n:"PtgFuncVar",f:function _m(e,r,t){var s=e[e.l++],o=e.read_shift(1),f=t&&t.biff<=3?[88==s?-1:0,e.read_shift(1)]:function vm(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[o,(0===f[0]?th:rg)[f[1]]]}},35:{n:"PtgName",f:function Cm(e,r,t){var s=e.read_shift(1)>>>5&3,f=e.read_shift(!t||t.biff>=8?4:2);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[s,0,f]}},36:{n:"PtgRef",f:function gm(e,r,t){var s=(96&e[e.l])>>5;return e.l+=1,[s,Is(e,0,t)]}},37:{n:"PtgArea",f:function sm(e,r,t){return[(96&e[e.l++])>>5,Nf(e,0,t)]}},38:{n:"PtgMemArea",f:function Am(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[s,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:Xr},40:{n:"PtgMemNoMem",f:Xr},41:{n:"PtgMemFunc",f:function Fm(e,r,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function Gf(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[s]}},43:{n:"PtgAreaErr",f:function cm(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}},44:{n:"PtgRefN",f:function cl(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=function im(e,r,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return function am(e){var r=e.read_shift(2),t=e.read_shift(1),s=(32768&r)>>15,o=(16384&r)>>14;return r&=16383,1==s&&r>=8192&&(r-=16384),1==o&&t>=128&&(t-=256),{r,c:t,cRel:o,rRel:s}}(e);var o=e.read_shift(s>=12?4:2),f=e.read_shift(2),u=(16384&f)>>14,p=(32768&f)>>15;if(f&=16383,1==p)for(;o>524287;)o-=1048576;if(1==u)for(;f>8191;)f-=16384;return{r:o,c:f,cRel:u,rRel:p}}(e,0,t);return[s,o]}},45:{n:"PtgAreaN",f:function Ya(e,r,t){var s=(96&e[e.l++])>>5,o=function tm(e,r,t){if(t.biff<8)return Bf(e);var s=e.read_shift(12==t.biff?4:2),o=e.read_shift(12==t.biff?4:2),f=zi(e,2),u=zi(e,2);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}(e,0,t);return[s,o]}},46:{n:"PtgMemAreaN",f:function Vm(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function fl(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function Em(e,r,t){return 5==t.biff?function Sm(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[r,t,s]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function xm(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[s,o,Is(e,0,t)]}},59:{n:"PtgArea3d",f:function om(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2,"i");if(t&&5===t.biff)e.l+=12;return[s,o,Nf(e,0,t)]}},60:{n:"PtgRefErr3d",f:function Dm(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2),f=4;if(t)switch(t.biff){case 5:f=15;break;case 12:f=6}return e.l+=f,[s,o]}},61:{n:"PtgAreaErr3d",f:function lm(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2),f=8;if(t)switch(t.biff){case 5:e.l+=12,f=6;break;case 12:f=12}return e.l+=f,[s,o]}},255:{}},Jf={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$m={1:{n:"PtgElfLel",f:Xf},2:{n:"PtgElfRw",f:Ms},3:{n:"PtgElfCol",f:Ms},6:{n:"PtgElfRwV",f:Ms},7:{n:"PtgElfColV",f:Ms},10:{n:"PtgElfRadical",f:Ms},11:{n:"PtgElfRadicalS",f:No},13:{n:"PtgElfColS",f:No},15:{n:"PtgElfColSV",f:No},16:{n:"PtgElfRadicalLel",f:Xf},25:{n:"PtgList",f:function Um(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),o=e.read_shift(2),f=e.read_shift(2);return{ixti:r,coltype:3&t,rt:Zf[t>>2&31],idx:s,c:o,C:f}}},29:{n:"PtgSxName",f:function Hm(e){return e.l+=2,[e.read_shift(4)]}},255:{}},hl={0:{n:"PtgAttrNoop",f:function zm(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function pm(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[s]}},2:{n:"PtgAttrIf",f:function Za(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function hm(e,r,t){e.l+=2;for(var s=e.read_shift(t&&2==t.biff?1:2),o=[],f=0;f<=s;++f)o.push(e.read_shift(t&&2==t.biff?1:2));return o}},8:{n:"PtgAttrGoto",f:function um(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function Hf(e,r,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Uf},33:{n:"PtgAttrBaxcel",f:Uf},64:{n:"PtgAttrSpace",f:function mm(e){return e.read_shift(2),Ps(e)}},65:{n:"PtgAttrSpaceSemi",f:function ol(e){return e.read_shift(2),Ps(e)}},128:{n:"PtgAttrIfError",f:function dm(e){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(2)]}},255:{}};function Ls(e,r,t,s){if(s.biff<8)return Xr(e,r);for(var o=e.l+r,f=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=Tm(e,0,s),f.push(t[u][1]);break;case"PtgMemArea":t[u][2]=$f(e,0,s),f.push(t[u][2]);break;case"PtgExp":s&&12==s.biff&&(t[u][1][1]=e.read_shift(4),f.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return 0!=(r=o-e.l)&&f.push(Xr(e,r)),f}function Ns(e,r,t){for(var o,f,s=e.l+r,u=[];s!=e.l;)r=s-e.l,o=Kf[f=e[e.l]]||Kf[Jf[f]],(24===f||25===f)&&(o=(24===f?$m:hl)[e[e.l+1]]),o&&o.f?u.push([o.n,o.f(e,r,t)]):Xr(e,r);return u}function Gm(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t],o=[],f=0;f<s.length;++f){var u=s[f];o.push(u?2===u[0]?'"'+u[1].replace(/"/g,'""')+'"':u[1]:"")}r.push(o.join(","))}return r.join(";")}var jm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ul(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":e.XTI[r-1];if(!s)return"SH33TJSERR1";var o="";if(t.biff>8)switch(e[s[0]][0]){case 357:return o=-1==s[1]?"#REF":e.SheetNames[s[1]],s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return o=-1==s[1]?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(f){return f.Name}).join(";;");default:return e[s[0]][0][3]?(o=-1==s[1]?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?o:o+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function qf(e,r,t){var s=ul(e,r,t);return"#REF"==s?s:function Qf(e,r){if(!(e||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(s,t)}function Yr(e,r,t,s,o){var x,_,w,E,f=o&&o.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},p=[],T=0,C=0,A="";if(!e[0]||!e[0][0])return"";for(var k=-1,F="",N=0,B=e[0].length;N<B;++N){var I=e[0][N];switch(I[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(x=p.pop(),_=p.pop(),k>=0){switch(e[0][k][1][0]){case 0:F=dr(" ",e[0][k][1][1]);break;case 1:F=dr("\r",e[0][k][1][1]);break;default:if(F="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}_+=F,k=-1}p.push(_+jm[I[0]]+x);break;case"PtgIsect":x=p.pop(),_=p.pop(),p.push(_+" "+x);break;case"PtgUnion":x=p.pop(),_=p.pop(),p.push(_+","+x);break;case"PtgRange":x=p.pop(),_=p.pop(),p.push(_+":"+x);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":w=Ma(I[1][1],u,o),p.push(gs(w,f));break;case"PtgRefN":w=t?Ma(I[1][1],t,o):I[1][1],p.push(gs(w,f));break;case"PtgRef3d":T=I[1][1],w=Ma(I[1][2],u,o),A=qf(s,T,o),p.push(A+"!"+gs(w,f));break;case"PtgFunc":case"PtgFuncVar":var se=I[1][0],ee=I[1][1];se||(se=0);var V=0==(se&=127)?[]:p.slice(-se);p.length-=se,"User"===ee&&(ee=V.shift()),p.push(ee+"("+V.join(",")+")");break;case"PtgBool":p.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":p.push(I[1]);break;case"PtgNum":p.push(String(I[1]));break;case"PtgStr":p.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":E=Zl(I[1][1],t?{s:t}:u,o),p.push(xc(E,o));break;case"PtgArea":E=Zl(I[1][1],u,o),p.push(xc(E,o));break;case"PtgArea3d":E=I[1][2],A=qf(s,T=I[1][1],o),p.push(A+"!"+xc(E,o));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgName":var ne=(s.names||[])[(C=I[1][2])-1]||(s[0]||[])[C],te=ne?ne.Name:"SH33TJSNAME"+String(C);te&&"_xlfn."==te.slice(0,6)&&!o.xlfn&&(te=te.slice(6)),p.push(te);break;case"PtgNameX":var _e,ge=I[1][1];if(C=I[1][2],!(o.biff<=5)){var ae="";if(14849==((s[ge]||[])[0]||[])[0]||(1025==((s[ge]||[])[0]||[])[0]?s[ge][C]&&s[ge][C].itab>0&&(ae=s.SheetNames[s[ge][C].itab-1]+"!"):ae=s.SheetNames[C-1]+"!"),s[ge]&&s[ge][C])ae+=s[ge][C].Name;else if(s[0]&&s[0][C])ae+=s[0][C].Name;else{var ze=(ul(s,ge,o)||"").split(";;");ze[C-1]?ae=ze[C-1]:ae+="SH33TJSERRX"}p.push(ae);break}ge<0&&(ge=-ge),s[ge]&&(_e=s[ge][C]),_e||(_e={Name:"SH33TJSERRY"}),p.push(_e.Name);break;case"PtgParen":var nt="(",$e=")";if(k>=0){switch(F="",e[0][k][1][0]){case 2:nt=dr(" ",e[0][k][1][1])+nt;break;case 3:nt=dr("\r",e[0][k][1][1])+nt;break;case 4:$e=dr(" ",e[0][k][1][1])+$e;break;case 5:$e=dr("\r",e[0][k][1][1])+$e;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}k=-1}p.push(nt+p.pop()+$e);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":p.push("#REF!");break;case"PtgExp":var xt={c:t.c,r:t.r};if(s.sharedf[bt(w={c:I[1][1],r:I[1][0]})]){var ot=s.sharedf[bt(w)];p.push(Yr(ot,0,xt,s,o))}else{var Nt=!1;for(x=0;x!=s.arrayf.length;++x)if(!(w.c<(_=s.arrayf[x])[0].s.c||w.c>_[0].e.c||w.r<_[0].s.r||w.r>_[0].e.r)){p.push(Yr(_[1],0,xt,s,o)),Nt=!0;break}Nt||p.push(I[1])}break;case"PtgArray":p.push("{"+Gm(I[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=N;break;case"PtgMissArg":p.push("");break;case"PtgList":p.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(I))}if(3!=o.biff&&k>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][N][0])){var pt=!0;switch((I=e[0][k])[1][0]){case 4:pt=!1;case 0:F=dr(" ",I[1][1]);break;case 5:pt=!1;case 1:F=dr("\r",I[1][1]);break;default:if(F="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}p.push((pt?F:"")+p.pop()+(pt?"":F)),k=-1}}if(p.length>1&&o.WTF)throw new Error("bad formula stack");return p[0]}function Xm(e,r,t){var f,s=e.l+r,o=2==t.biff?1:2,u=e.read_shift(o);if(65535==u)return[[],Xr(e,r-2)];var p=Ns(e,u,t);return r!==u+o&&(f=Ls(e,r-u-o,p,t)),e.l=s,[p,f]}function Zm(e,r,t){var o,s=e.l+r,f=e.read_shift(2),u=Ns(e,f,t);return 65535==f?[[],Xr(e,r-2)]:(r!==f+2&&(o=Ls(e,s-f-2,u,t)),[u,o])}function Bo(e,r,t){var s=e.l+r,o=jn(e);2==t.biff&&++e.l;var f=function Km(e){var r;if(65535!==Pn(e,e.l+6))return[en(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=1===e[e.l+2],e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),u=e.read_shift(1);2!=t.biff&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var p=function Ym(e,r,t){var f,s=e.l+r,o=2==t.biff?1:2,u=e.read_shift(o);if(65535==u)return[[],Xr(e,r-2)];var p=Ns(e,u,t);return r!==u+o&&(f=Ls(e,r-u-o,p,t)),e.l=s,[p,f]}(e,s-e.l,t);return{cell:o,val:f[0],formula:p,shared:u>>3&1,tt:f[1]}}function Uo(e,r,t){var s=e.read_shift(4),o=Ns(e,s,t),f=e.read_shift(4);return[o,f>0?Ls(e,f,o,t):null]}var qm=Uo,Ho=Uo,eg=Uo,tg=Uo,rg={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},th={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ng={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function rh(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ig(e){return("of:="+e.replace(il,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function dl(e){var r=e.split(":");return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function ag(e){return e.replace(/\./,"!")}var Bs={},Ka={},Us=typeof Map<"u";function pl(e,r,t){var s=0,o=e.length;if(t){if(Us?t.has(r):Object.prototype.hasOwnProperty.call(t,r))for(var f=Us?t.get(r):t[r];s<f.length;++s)if(e[f[s]].t===r)return e.Count++,f[s]}else for(;s<o;++s)if(e[s].t===r)return e.Count++,s;return e[o]={t:r},e.Count++,e.Unique++,t&&(Us?(t.has(r)||t.set(r,[]),t.get(r).push(o)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(o))),o}function Wo(e,r){var t={min:e+1,max:e+1},s=-1;return r.MDW&&(Jt=r.MDW),null!=r.width?t.customWidth=1:null!=r.wpx?s=za(r.wpx):null!=r.wch&&(s=r.wch),s>-1?(t.width=Fs(s),t.customWidth=1):null!=r.width&&(t.width=r.width),r.hidden&&(t.hidden=!0),null!=r.level&&(t.outlineLevel=t.level=r.level),t}function xa(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function $i(e,r,t){var s=t.revssf[null!=r.z?r.z:"General"],o=60,f=e.length;if(null==s&&t.ssf)for(;o<392;++o)if(null==t.ssf[o]){Q(r.z,o),t.ssf[o]=r.z,t.revssf[r.z]=s=o;break}for(o=0;o!=f;++o)if(e[o].numFmtId===s)return o;return e[f]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function nh(e,r,t,s,o,f){try{s.cellNF&&(e.z=vt[r])}catch(p){if(s.WTF)throw p}if("z"!==e.t||s.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=Zt(e.v)),(!s||!1!==s.cellText)&&"z"!==e.t)try{if(null==vt[r]&&Q(st[r]||"General",r),"e"===e.t)e.w=e.w||ai[e.v];else if(0===r)if("n"===e.t)e.w=(0|e.v)===e.v?e.v.toString(10):Qn(e.v);else if("d"===e.t){var u=Ir(e.v);e.w=(0|u)===u?u.toString(10):Qn(u)}else{if(void 0===e.v)return"";e.w=Dn(e.v,Ka)}else e.w=M(r,"d"===e.t?Ir(e.v):e.v,Ka)}catch(p){if(s.WTF)throw p}if(s.cellStyles&&null!=t)try{e.s=f.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Do(o.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=o.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Do(o.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=o.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(p){if(s.WTF&&f.Fills)throw p}}}function sg(e,r,t){if(e&&e["!ref"]){var s=Lt(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}var cg=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lg=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fg=/<(?:\w:)?hyperlink [^>]*>/gm,hg=/"(\w*:\w*)"/,ug=/<(?:\w:)?col\b[^>]*[\/]?>/g,hr=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,dg=/<(?:\w:)?pageMargins[^>]*\/>/g,ih=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pg=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mg=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ml(e,r,t,s){var o=mt(e);t.Sheets[s]||(t.Sheets[s]={}),o.codeName&&(t.Sheets[s].CodeName=zt(jt(o.codeName)))}var sh=["objects","scenarios","selectLockedCells","selectUnlockedCells"],oh=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],kg=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Eg(e,r,t,s){if(e.c&&t["!comments"].push([r,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var o="",f=e.t,u=e.v;if("z"!==e.t)switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=ai[e.v];break;case"d":s&&s.cellDates?o=Zt(e.v,-1).toISOString():((e=tr(e)).t="n",o=""+(e.v=Ir(Zt(e.v)))),typeof e.z>"u"&&(e.z=vt[14]);break;default:o=e.v}var p=jr("v",Kt(o)),x={r},_=$i(s.cellXfs,e,s);switch(0!==_&&(x.s=_),e.t){case"n":case"z":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){p=jr("v",""+pl(s.Strings,e.v,s.revStrings)),x.t="s";break}x.t="str"}if(e.t!=f&&(e.t=f,e.v=u),"string"==typeof e.f&&e.f){var w=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;p=Ue("f",Kt(e.f),w)+(null!=e.v?p:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(x.cm=1),Ue("c",p,x)}var Sg=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,o=/ref=["']([^"']*)["']/,f=In("v"),u=In("f");return function(x,_,w,T,C,E){for(var ee,V,ge,_e,$e,A=0,k="",F=[],N=[],B=0,I=0,re=0,se="",ne=0,te=0,ae=0,ze=0,nt=Array.isArray(E.CellXf),xt=[],ot=[],Nt=Array.isArray(_),qe=[],pt={},Ee=!1,X=!!w.sheetStubs,fe=x.split(r),q=0,J=fe.length;q!=J;++q){var ke=(k=fe[q].trim()).length;if(0!==ke){var Ke=0;e:for(A=0;A<ke;++A)switch(k[A]){case">":if("/"!=k[A-1]){++A;break e}if(w&&w.cellStyles){if(ne=null!=(V=mt(k.slice(Ke,A),!0)).r?parseInt(V.r,10):ne+1,te=-1,w.sheetRows&&w.sheetRows<ne)continue;pt={},Ee=!1,V.ht&&(Ee=!0,pt.hpt=parseFloat(V.ht),pt.hpx=_i(pt.hpt)),"1"==V.hidden&&(Ee=!0,pt.hidden=!0),null!=V.outlineLevel&&(Ee=!0,pt.level=+V.outlineLevel),Ee&&(qe[ne-1]=pt)}break;case"<":Ke=A}if(Ke>=A)break;if(ne=null!=(V=mt(k.slice(Ke,A),!0)).r?parseInt(V.r,10):ne+1,te=-1,!(w.sheetRows&&w.sheetRows<ne)){T.s.r>ne-1&&(T.s.r=ne-1),T.e.r<ne-1&&(T.e.r=ne-1),w&&w.cellStyles&&(pt={},Ee=!1,V.ht&&(Ee=!0,pt.hpt=parseFloat(V.ht),pt.hpx=_i(pt.hpt)),"1"==V.hidden&&(Ee=!0,pt.hidden=!0),null!=V.outlineLevel&&(Ee=!0,pt.level=+V.outlineLevel),Ee&&(qe[ne-1]=pt)),F=k.slice(A).split(e);for(var He=0;He!=F.length&&"<"==F[He].trim().charAt(0);++He);for(F=F.slice(He),A=0;A!=F.length;++A)if(0!==(k=F[A].trim()).length){if(N=k.match(t),B=A,I=0,re=0,k="<c "+("<"==k.slice(0,1)?">":"")+k,null!=N&&2===N.length){for(B=0,se=N[1],I=0;I!=se.length&&!((re=se.charCodeAt(I)-64)<1||re>26);++I)B=26*B+re;te=--B}else++te;for(I=0;I!=k.length&&62!==k.charCodeAt(I);++I);if(++I,(V=mt(k.slice(0,I),!0)).r||(V.r=bt({r:ne-1,c:te})),ee={t:""},null!=(N=(se=k.slice(I)).match(f))&&""!==N[1]&&(ee.v=zt(N[1])),w.cellFormula){if(null!=(N=se.match(u))&&""!==N[1]){if(ee.f=zt(jt(N[1])).replace(/\r\n/g,"\n"),w.xlfn||(ee.f=sl(ee.f)),N[0].indexOf('t="array"')>-1)ee.F=(se.match(o)||[])[1],ee.F.indexOf(":")>-1&&xt.push([Lt(ee.F),ee.F]);else if(N[0].indexOf('t="shared"')>-1){_e=mt(N[0]);var We=zt(jt(N[1]));w.xlfn||(We=sl(We)),ot[parseInt(_e.si,10)]=[_e,We,V.r]}}else(N=se.match(/<f[^>]*\/>/))&&ot[(_e=mt(N[0])).si]&&(ee.f=em(ot[_e.si][1],ot[_e.si][2],V.r));var Ae=pr(V.r);for(I=0;I<xt.length;++I)Ae.r>=xt[I][0].s.r&&Ae.r<=xt[I][0].e.r&&Ae.c>=xt[I][0].s.c&&Ae.c<=xt[I][0].e.c&&(ee.F=xt[I][1])}if(null==V.t&&void 0===ee.v)if(ee.f||ee.F)ee.v=0,ee.t="n";else{if(!X)continue;ee.t="z"}else ee.t=V.t||"n";switch(T.s.c>te&&(T.s.c=te),T.e.c<te&&(T.e.c=te),ee.t){case"n":if(""==ee.v||null==ee.v){if(!X)continue;ee.t="z"}else ee.v=parseFloat(ee.v);break;case"s":if(typeof ee.v>"u"){if(!X)continue;ee.t="z"}else ge=Bs[parseInt(ee.v,10)],ee.v=ge.t,ee.r=ge.r,w.cellHTML&&(ee.h=ge.h);break;case"str":ee.t="s",ee.v=null!=ee.v?jt(ee.v):"",w.cellHTML&&(ee.h=lc(ee.v));break;case"inlineStr":N=se.match(s),ee.t="s",null!=N&&(ge=Eo(N[1]))?(ee.v=ge.t,w.cellHTML&&(ee.h=ge.h)):ee.v="";break;case"b":ee.v=sr(ee.v);break;case"d":w.cellDates?ee.v=Zt(ee.v,1):(ee.v=Ir(Zt(ee.v,1)),ee.t="n");break;case"e":(!w||!1!==w.cellText)&&(ee.w=ee.v),ee.v=Ac[ee.v]}if(ae=ze=0,$e=null,nt&&void 0!==V.s&&null!=($e=E.CellXf[V.s])&&(null!=$e.numFmtId&&(ae=$e.numFmtId),w.cellStyles&&null!=$e.fillId&&(ze=$e.fillId)),nh(ee,ae,ze,w,C,E),w.cellDates&&nt&&"n"==ee.t&&ti(vt[ae])&&(ee.t="d",ee.v=cs(ee.v)),V.cm&&w.xlmeta){var Ot=(w.xlmeta.Cell||[])[+V.cm-1];Ot&&"XLDAPR"==Ot.type&&(ee.D=!0)}if(Nt){var G=pr(V.r);_[G.r]||(_[G.r]=[]),_[G.r][G.c]=ee}else _[V.r]=ee}}}}qe.length>0&&(_["!rows"]=qe)}}();function lh(e,r,t,s){var u,o=[vr,Ue("worksheet",null,{xmlns:Di[0],"xmlns:r":Cr.r})],p="",x=t.Sheets[t.SheetNames[e]];null==x&&(x={});var _=x["!ref"]||"A1",w=Lt(_);if(w.e.c>16383||w.e.r>1048575){if(r.WTF)throw new Error("Range "+_+" exceeds format limit A1:XFD1048576");w.e.c=Math.min(w.e.c,16383),w.e.r=Math.min(w.e.c,1048575),_=Et(w)}s||(s={}),x["!comments"]=[];var T=[];(function gg(e,r,t,s,o){var f=!1,u={},p=null;if("xlsx"!==s.bookType&&r.vbaraw){var x=r.SheetNames[t];try{r.Workbook&&(x=r.Workbook.Sheets[t].CodeName||x)}catch{}f=!0,u.codeName=ri(Kt(x))}if(e&&e["!outline"]){var _={summaryBelow:1,summaryRight:1};e["!outline"].above&&(_.summaryBelow=0),e["!outline"].left&&(_.summaryRight=0),p=(p||"")+Ue("outlinePr",null,_)}!f&&!p||(o[o.length]=Ue("sheetPr",p,u))})(x,t,e,r,o),o[o.length]=Ue("dimension",null,{ref:_}),o[o.length]=function Cg(e,r,t,s){var o={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,o),{})}(0,0,0,t),r.sheetFormat&&(o[o.length]=Ue("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=x["!cols"]&&x["!cols"].length>0&&(o[o.length]=function wg(e,r){for(var s,t=["<cols>"],o=0;o!=r.length;++o)(s=r[o])&&(t[t.length]=Ue("col",null,Wo(o,s)));return t[t.length]="</cols>",t.join("")}(0,x["!cols"])),o[u=o.length]="<sheetData/>",x["!links"]=[],null!=x["!ref"]&&(p=function Ag(e,r,t,s){var x,F,o=[],f=[],u=Lt(e["!ref"]),p="",_="",w=[],T=0,C=0,E=e["!rows"],A=Array.isArray(e),k={r:_},N=-1;for(C=u.s.c;C<=u.e.c;++C)w[C]=$t(C);for(T=u.s.r;T<=u.e.r;++T){for(f=[],_=yr(T),C=u.s.c;C<=u.e.c;++C){x=w[C]+_;var B=A?(e[T]||[])[C]:e[x];void 0!==B&&null!=(p=Eg(B,x,e,r))&&f.push(p)}(f.length>0||E&&E[T])&&(k={r:_},E&&E[T]&&((F=E[T]).hidden&&(k.hidden=1),N=-1,F.hpx?N=pa(F.hpx):F.hpt&&(N=F.hpt),N>-1&&(k.ht=N,k.customHeight=1),F.level&&(k.outlineLevel=F.level)),o[o.length]=Ue("row",f.join(""),k))}if(E)for(;T<E.length;++T)E&&E[T]&&(k={r:T+1},(F=E[T]).hidden&&(k.hidden=1),N=-1,F.hpx?N=pa(F.hpx):F.hpt&&(N=F.hpt),N>-1&&(k.ht=N,k.customHeight=1),F.level&&(k.outlineLevel=F.level),o[o.length]=Ue("row","",k));return o.join("")}(x,r),p.length>0&&(o[o.length]=p)),o.length>u+1&&(o[o.length]="</sheetData>",o[u]=o[u].replace("/>",">")),x["!protect"]&&(o[o.length]=function xg(e){var r={sheet:1};return sh.forEach(function(t){null!=e[t]&&e[t]&&(r[t]="1")}),oh.forEach(function(t){null!=e[t]&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Fo(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,r)}(x["!protect"])),null!=x["!autofilter"]&&(o[o.length]=function bg(e,r,t,s){var o="string"==typeof e.ref?e.ref:Et(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,u=on(o);u.s.r==u.e.r&&(u.e.r=on(r["!ref"]).e.r,o=Et(u));for(var p=0;p<f.length;++p){var x=f[p];if("_xlnm._FilterDatabase"==x.Name&&x.Sheet==s){x.Ref="'"+t.SheetNames[s]+"'!"+o;break}}return p==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+o}),Ue("autoFilter",null,{ref:o})}(x["!autofilter"],x,t,e)),null!=x["!merges"]&&x["!merges"].length>0&&(o[o.length]=function Hs(e){if(0===e.length)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Et(e[t])+'"/>';return r+"</mergeCells>"}(x["!merges"]));var E,C=-1,A=-1;return x["!links"].length>0&&(o[o.length]="<hyperlinks>",x["!links"].forEach(function(k){k[1].Target&&(E={ref:k[0]},"#"!=k[1].Target.charAt(0)&&(A=Gt(s,-1,Kt(k[1].Target).replace(/#.*$/,""),St.HLINK),E["r:id"]="rId"+A),(C=k[1].Target.indexOf("#"))>-1&&(E.location=Kt(k[1].Target.slice(C+1))),k[1].Tooltip&&(E.tooltip=Kt(k[1].Tooltip)),o[o.length]=Ue("hyperlink",null,E))}),o[o.length]="</hyperlinks>"),delete x["!links"],null!=x["!margins"]&&(o[o.length]=function xl(e){return xa(e),Ue("pageMargins",null,e)}(x["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&(o[o.length]=jr("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:_}))),T.length>0&&(A=Gt(s,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),o[o.length]=Ue("drawing",null,{"r:id":"rId"+A}),x["!drawing"]=T),x["!comments"].length>0&&(A=Gt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),o[o.length]=Ue("legacyDrawing",null,{"r:id":"rId"+A}),x["!legacy"]=A),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function Dg(e,r,t,s){var o=function Fg(e,r,t){var s=we(145),o=(t["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var f=320;o.hpx?f=20*pa(o.hpx):o.hpt&&(f=20*o.hpt),s.write_shift(2,f),s.write_shift(1,0);var u=0;o.level&&(u|=o.level),o.hidden&&(u|=16),(o.hpx||o.hpt)&&(u|=32),s.write_shift(1,u),s.write_shift(1,0);var p=0,x=s.l;s.l+=4;for(var _={r:e,c:0},w=0;w<16;++w)if(!(r.s.c>w+1<<10||r.e.c<w<<10)){for(var T=-1,C=-1,E=w<<10;E<w+1<<10;++E)_.c=E,(Array.isArray(t)?(t[_.r]||[])[_.c]:t[bt(_)])&&(T<0&&(T=E),C=E);T<0||(++p,s.write_shift(4,T),s.write_shift(4,C))}var k=s.l;return s.l=x,s.write_shift(4,p),s.l=k,s.length>s.l?s.slice(0,s.l):s}(s,t,r);(o.length>17||(r["!rows"]||[])[s])&&Se(e,0,o)}var Og=aa,Ig=sa;function mh(e){return[gn(e),en(e),"n"]}var l1=aa,$1=sa,Vo=["left","right","top","bottom","header","footer"];function h(e,r,t,s,o,f,u){if(void 0===r.v)return!1;var p="";switch(r.t){case"b":p=r.v?"1":"0";break;case"d":(r=tr(r)).z=r.z||vt[14],r.v=Ir(Zt(r.v)),r.t="n";break;case"n":case"e":p=""+r.v;break;default:p=r.v}var x={r:t,c:s};switch(x.s=$i(o.cellXfs,r,o),r.l&&f["!links"].push([bt(x),r.l]),r.c&&f["!comments"].push([bt(x),r.c]),r.t){case"s":case"str":return o.bookSST?(p=pl(o.Strings,r.v,o.revStrings),x.t="s",x.v=p,u?Se(e,18,function ph(e,r,t){return null==t&&(t=we(8)),ia(r,t),t.write_shift(4,r.v),t}(0,x)):Se(e,7,function jg(e,r,t){return null==t&&(t=we(12)),na(r,t),t.write_shift(4,r.v),t}(0,x))):(x.t="str",u?Se(e,17,function i1(e,r,t){return null==t&&(t=we(8+4*e.v.length)),ia(r,t),Mr(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,x)):Se(e,6,function z1(e,r,t){return null==t&&(t=we(12+4*e.v.length)),na(r,t),Mr(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,x))),!0;case"n":return r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?u?Se(e,13,function e1(e,r,t){return null==t&&(t=we(8)),ia(r,t),n0(e.v,t),t}(r,x)):Se(e,2,function Qg(e,r,t){return null==t&&(t=we(12)),na(r,t),n0(e.v,t),t}(r,x)):u?Se(e,16,function Kg(e,r,t){return null==t&&(t=we(12)),ia(r,t),oa(e.v,t),t}(r,x)):Se(e,5,function Zg(e,r,t){return null==t&&(t=we(16)),na(r,t),oa(e.v,t),t}(r,x)),!0;case"b":return x.t="b",u?Se(e,15,function Vg(e,r,t){return null==t&&(t=we(5)),ia(r,t),t.write_shift(1,e.v?1:0),t}(r,x)):Se(e,4,function Hg(e,r,t){return null==t&&(t=we(9)),na(r,t),t.write_shift(1,e.v?1:0),t}(r,x)),!0;case"e":return x.t="e",u?Se(e,14,function Gg(e,r,t){return null==t&&(t=we(8)),ia(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}(r,x)):Se(e,3,function uh(e,r,t){return null==t&&(t=we(9)),na(r,t),t.write_shift(1,e.v),t}(r,x)),!0}return u?Se(e,12,function Ug(e,r,t){return null==t&&(t=we(4)),ia(r,t)}(0,x)):Se(e,1,function Ng(e,r,t){return null==t&&(t=we(8)),na(r,t)}(0,x)),!0}function K(e,r,t,s){var o=sn(),f=t.SheetNames[e],u=t.Sheets[f]||{},p=f;try{t&&t.Workbook&&(p=t.Workbook.Sheets[e].CodeName||p)}catch{}var x=Lt(u["!ref"]||"A1");if(x.e.c>16383||x.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Se(o,129),(t.vbaraw||u["!outline"])&&Se(o,147,function Rg(e,r,t){null==t&&(t=we(84+4*e.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),t.write_shift(1,s);for(var o=1;o<3;++o)t.write_shift(1,0);return ho({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),t0(e,t),t.slice(0,t.l)}(p,u["!outline"])),Se(o,148,Ig(x)),function P(e,r,t){Se(e,133),Se(e,137,function g1(e,r,t){null==t&&(t=we(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}(0,t)),Se(e,138),Se(e,134)}(o,0,t.Workbook),function g(e,r){!r||!r["!cols"]||(Se(e,390),r["!cols"].forEach(function(t,s){t&&Se(e,60,function Gi(e,r,t){null==t&&(t=we(18));var s=Wo(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,256*(s.width||10)),t.write_shift(4,0);var o=0;return r.hidden&&(o|=1),"number"==typeof s.width&&(o|=2),r.level&&(o|=r.level<<8),t.write_shift(2,o),t}(s,t))}),Se(e,391))}(o,u),function d(e,r,t,s){var o=Lt(r["!ref"]||"A1"),u="",p=[];Se(e,145);var x=Array.isArray(r),_=o.e.r;r["!rows"]&&(_=Math.max(o.e.r,r["!rows"].length-1));for(var w=o.s.r;w<=_;++w){u=yr(w),Dg(e,r,o,w);var T=!1;if(w<=o.e.r)for(var C=o.s.c;C<=o.e.c;++C){w===o.s.r&&(p[C]=$t(C));var E=x?(r[w]||[])[C]:r[p[C]+u];T=!!E&&h(e,E,w,C,s,r,T)}}Se(e,146)}(o,u,0,r),function Y(e,r){r["!protect"]&&Se(e,535,function a(e,r){return null==r&&(r=we(66)),r.write_shift(2,e.password?Fo(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){r.write_shift(4,t[1]?null==e[t[0]]||e[t[0]]?0:1:null!=e[t[0]]&&e[t[0]]?0:1)}),r}(r["!protect"]))}(o,u),function O(e,r,t,s){if(r["!autofilter"]){var o=r["!autofilter"],f="string"==typeof o.ref?o.ref:Et(o.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,p=on(f);p.s.r==p.e.r&&(p.e.r=on(r["!ref"]).e.r,f=Et(p));for(var x=0;x<u.length;++x){var _=u[x];if("_xlnm._FilterDatabase"==_.Name&&_.Sheet==s){_.Ref="'"+t.SheetNames[s]+"'!"+f;break}}x==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+f}),Se(e,161,sa(Lt(f))),Se(e,162)}}(o,u,t,e),function m(e,r){!r||!r["!merges"]||(Se(e,177,function f1(e,r){return null==r&&(r=we(4)),r.write_shift(4,e),r}(r["!merges"].length)),r["!merges"].forEach(function(t){Se(e,176,$1(t))}),Se(e,178))}(o,u),function b(e,r,t){r["!links"].forEach(function(s){if(s[1].Target){var o=Gt(t,-1,s[1].Target.replace(/#.*$/,""),St.HLINK);Se(e,494,function h1(e,r){var t=we(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));sa({s:pr(e[0]),e:pr(e[0])},t),_s("rId"+r,t);var s=e[1].Target.indexOf("#");return Mr((-1==s?"":e[1].Target.slice(s+1))||"",t),Mr(e[1].Tooltip||"",t),Mr("",t),t.slice(0,t.l)}(s,o))}}),delete r["!links"]}(o,u,s),u["!margins"]&&Se(o,476,function ji(e,r){return null==r&&(r=we(48)),xa(e),Vo.forEach(function(t){oa(e[t],r)}),r}(u["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&function y(e,r){!r||!r["!ref"]||(Se(e,648),Se(e,649,function i(e){var r=we(24);return r.write_shift(4,4),r.write_shift(4,1),sa(e,r),r}(Lt(r["!ref"]))),Se(e,650))}(o,u),function S(e,r,t,s){if(r["!comments"].length>0){var o=Gt(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML);Se(e,551,_s("rId"+o)),r["!legacy"]=o}}(o,u,e,s),Se(o,130),o.end()}var Ve=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dt=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Dt=[],Ft=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Mt(e,r){for(var t=0;t!=e.length;++t)for(var s=e[t],o=0;o!=r.length;++o){var f=r[o];if(null==s[f[0]])s[f[0]]=f[1];else switch(f[2]){case"bool":"string"==typeof s[f[0]]&&(s[f[0]]=sr(s[f[0]]));break;case"int":"string"==typeof s[f[0]]&&(s[f[0]]=parseInt(s[f[0]],10))}}}function Wr(e,r){for(var t=0;t!=r.length;++t){var s=r[t];if(null==e[s[0]])e[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof e[s[0]]&&(e[s[0]]=sr(e[s[0]]));break;case"int":"string"==typeof e[s[0]]&&(e[s[0]]=parseInt(e[s[0]],10))}}}function vn(e){Wr(e.WBProps,Ve),Wr(e.CalcPr,Ft),Mt(e.WBView,dt),Mt(e.Sheets,Dt),Ka.date1904=sr(e.WBProps.date1904)}var mr="][*?/\\".split("");function kr(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return mr.forEach(function(s){if(-1!=e.indexOf(s)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var Ja=/<\w+:workbook/;function _a(e){var r=[vr];r[r.length]=Ue("workbook",null,{xmlns:Di[0],"xmlns:r":Cr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ve.forEach(function(p){null!=e.Workbook.WBProps[p[0]]&&e.Workbook.WBProps[p[0]]!=p[1]&&(s[p[0]]=e.Workbook.WBProps[p[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=Ue("workbookPr",null,s);var o=e.Workbook&&e.Workbook.Sheets||[],f=0;if(o&&o[0]&&o[0].Hidden){for(r[r.length]="<bookViews>",f=0;f!=e.SheetNames.length&&o[f]&&o[f].Hidden;++f);f==e.SheetNames.length&&(f=0),r[r.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",f=0;f!=e.SheetNames.length;++f){var u={name:Kt(e.SheetNames[f].slice(0,31))};if(u.sheetId=""+(f+1),u["r:id"]="rId"+(f+1),o[f])switch(o[f].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden"}r[r.length]=Ue("sheet",null,u)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(p){var x={name:p.Name};p.Comment&&(x.comment=p.Comment),null!=p.Sheet&&(x.localSheetId=""+p.Sheet),p.Hidden&&(x.hidden="1"),p.Ref&&(r[r.length]=Ue("definedName",Kt(p.Ref),x))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function va(e,r){return r||(r=we(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),_s(e.strRelID,r),Mr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Fx(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function Lx(e,r){var t=sn();return Se(t,131),Se(t,128,function Px(e,r){r||(r=we(127));for(var t=0;4!=t;++t)r.write_shift(4,0);return Mr("SheetJS",r),Mr(v.version,r),Mr(v.version,r),Mr("7262",r),r.length>r.l?r.slice(0,r.l):r}()),Se(t,153,function wa(e,r){r||(r=we(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),t0(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}(e.Workbook&&e.Workbook.WBProps||null)),function Rx(e,r){if(r.Workbook&&r.Workbook.Sheets){for(var t=r.Workbook.Sheets,s=0,o=-1,f=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&-1==o?o=s:1==t[s].Hidden&&-1==f&&(f=s);f>o||(Se(e,135),Se(e,158,function Mx(e,r){return r||(r=we(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r}(o)),Se(e,136))}}(t,e),function Ix(e,r){Se(e,143);for(var t=0;t!=r.SheetNames.length;++t)Se(e,156,va({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]}));Se(e,144)}(t,e),Se(t,132),t.end()}function Bx(e,r,t,s,o,f,u,p){return".bin"===r.slice(-4)?function l(e,r,t,s,o,f,u){if(!e)return e;var p=r||{};s||(s={"!id":{}}),null!=ut&&null==p.dense&&(p.dense=ut);var _,A,k,F,N,B,I,re,se,ee,x=p.dense?[]:{},w={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=[],C=!1,E=!1,V=[];p.biff=12,p["!row"]=0;var ne=0,te=!1,ge=[],_e={},ae=p.supbooks||o.supbooks||[[]];if(ae.sharedf=_e,ae.arrayf=ge,ae.SheetNames=o.SheetNames||o.Sheets.map(function(pt){return pt.name}),!p.supbooks&&(p.supbooks=ae,o.Names))for(var ze=0;ze<o.Names.length;++ze)ae[0][ze+1]=o.Names[ze];var ot,Nt,nt=[],$e=[],xt=!1;if(wl[16]={n:"BrtShortReal",f:mh},ni(e,function(Ee,X,fe){if(!E)switch(fe){case 148:_=Ee;break;case 0:A=Ee,p.sheetRows&&p.sheetRows<=A.r&&(E=!0),se=yr(N=A.r),p["!row"]=A.r,(Ee.hidden||Ee.hpt||null!=Ee.level)&&(Ee.hpt&&(Ee.hpx=_i(Ee.hpt)),$e[Ee.r]=Ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:Ee[2]},Ee[2]){case"n":k.v=Ee[1];break;case"s":k.v=(re=Bs[Ee[1]]).t,k.r=re.r;break;case"b":k.v=!!Ee[1];break;case"e":k.v=Ee[1],!1!==p.cellText&&(k.w=ai[k.v]);break;case"str":k.t="s",k.v=Ee[1];break;case"is":k.t="s",k.v=Ee[1].t}if((F=u.CellXf[Ee[0].iStyleRef])&&nh(k,F.numFmtId,null,p,f,u),B=-1==Ee[0].c?B+1:Ee[0].c,p.dense?(x[N]||(x[N]=[]),x[N][B]=k):x[$t(B)+se]=k,p.cellFormula){for(te=!1,ne=0;ne<ge.length;++ne){var q=ge[ne];A.r>=q[0].s.r&&A.r<=q[0].e.r&&B>=q[0].s.c&&B<=q[0].e.c&&(k.F=Et(q[0]),te=!0)}!te&&Ee.length>3&&(k.f=Ee[3])}if(w.s.r>A.r&&(w.s.r=A.r),w.s.c>B&&(w.s.c=B),w.e.r<A.r&&(w.e.r=A.r),w.e.c<B&&(w.e.c=B),p.cellDates&&F&&"n"==k.t&&ti(vt[F.numFmtId])){var J=Vt(k.v);J&&(k.t="d",k.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ot&&("XLDAPR"==ot.type&&(k.D=!0),ot=void 0),Nt&&(Nt=void 0);break;case 1:case 12:if(!p.sheetStubs||C)break;k={t:"z",v:void 0},B=-1==Ee[0].c?B+1:Ee[0].c,p.dense?(x[N]||(x[N]=[]),x[N][B]=k):x[$t(B)+se]=k,w.s.r>A.r&&(w.s.r=A.r),w.s.c>B&&(w.s.c=B),w.e.r<A.r&&(w.e.r=A.r),w.e.c<B&&(w.e.c=B),ot&&("XLDAPR"==ot.type&&(k.D=!0),ot=void 0),Nt&&(Nt=void 0);break;case 176:V.push(Ee);break;case 49:ot=((p.xlmeta||{}).Cell||[])[Ee-1];break;case 494:var ke=s["!id"][Ee.relId];for(ke?(Ee.Target=ke.Target,Ee.loc&&(Ee.Target+="#"+Ee.loc),Ee.Rel=ke):""==Ee.relId&&(Ee.Target="#"+Ee.loc),N=Ee.rfx.s.r;N<=Ee.rfx.e.r;++N)for(B=Ee.rfx.s.c;B<=Ee.rfx.e.c;++B)p.dense?(x[N]||(x[N]=[]),x[N][B]||(x[N][B]={t:"z",v:void 0}),x[N][B].l=Ee):(I=bt({c:B,r:N}),x[I]||(x[I]={t:"z",v:void 0}),x[I].l=Ee);break;case 426:if(!p.cellFormula)break;ge.push(Ee),(ee=p.dense?x[N][B]:x[$t(B)+se]).f=Yr(Ee[1],0,{r:A.r,c:B},ae,p),ee.F=Et(Ee[0]);break;case 427:if(!p.cellFormula)break;_e[bt(Ee[0].s)]=Ee[1],(ee=p.dense?x[N][B]:x[$t(B)+se]).f=Yr(Ee[1],0,{r:A.r,c:B},ae,p);break;case 60:if(!p.cellStyles)break;for(;Ee.e>=Ee.s;)nt[Ee.e--]={width:Ee.w/256,hidden:!!(1&Ee.flags),level:Ee.level},xt||(xt=!0,Kc(Ee.w/256)),xi(nt[Ee.e+1]);break;case 161:x["!autofilter"]={ref:Et(Ee)};break;case 476:x["!margins"]=Ee;break;case 147:o.Sheets[t]||(o.Sheets[t]={}),Ee.name&&(o.Sheets[t].CodeName=Ee.name),(Ee.above||Ee.left)&&(x["!outline"]={above:Ee.above,left:Ee.left});break;case 137:o.Views||(o.Views=[{}]),o.Views[0]||(o.Views[0]={}),Ee.RTL&&(o.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:C=!0;break;case 36:C=!1;break;case 37:T.push(fe),C=!0;break;case 38:T.pop(),C=!1;break;default:if(!X.T&&(!C||p.WTF))throw new Error("Unexpected record 0x"+fe.toString(16))}},p),delete p.supbooks,delete p["!row"],!x["!ref"]&&(w.s.r<2e6||_&&(_.e.r>0||_.e.c>0||_.s.r>0||_.s.c>0))&&(x["!ref"]=Et(_||w)),p.sheetRows&&x["!ref"]){var qe=Lt(x["!ref"]);p.sheetRows<=+qe.e.r&&(qe.e.r=p.sheetRows-1,qe.e.r>w.e.r&&(qe.e.r=w.e.r),qe.e.r<qe.s.r&&(qe.s.r=qe.e.r),qe.e.c>w.e.c&&(qe.e.c=w.e.c),qe.e.c<qe.s.c&&(qe.s.c=qe.e.c),x["!fullref"]=x["!ref"],x["!ref"]=Et(qe))}return V.length>0&&(x["!merges"]=V),nt.length>0&&(x["!cols"]=nt),$e.length>0&&(x["!rows"]=$e),x}(e,s,t,o,f,u,p):function ah(e,r,t,s,o,f,u){if(!e)return e;s||(s={"!id":{}}),null!=ut&&null==r.dense&&(r.dense=ut);var p=r.dense?[]:{},x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_="",w="",T=e.match(lg);T?(_=e.slice(0,T.index),w=e.slice(T.index+T[0].length)):_=w=e;var C=_.match(ih);C?ml(C[0],0,o,t):(C=_.match(pg))&&function gl(e,r,t,s,o){ml(e.slice(0,e.indexOf(">")),0,s,o)}(C[0],0,0,o,t);var E=(_.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var A=_.slice(E,E+50).match(hg);A&&function og(e,r){var t=Lt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Et(t))}(p,A[1])}var k=_.match(mg);k&&k[1]&&function Tg(e,r){r.Views||(r.Views=[{}]),(e.match(kg)||[]).forEach(function(t,s){var o=mt(t);r.Views[s]||(r.Views[s]={}),+o.zoomScale&&(r.Views[s].zoom=+o.zoomScale),sr(o.rightToLeft)&&(r.Views[s].RTL=!0)})}(k[1],o);var F=[];if(r.cellStyles){var N=_.match(ug);N&&function vg(e,r){for(var t=!1,s=0;s!=r.length;++s){var o=mt(r[s],!0);o.hidden&&(o.hidden=sr(o.hidden));var f=parseInt(o.min,10)-1,u=parseInt(o.max,10)-1;for(o.outlineLevel&&(o.level=+o.outlineLevel||0),delete o.min,delete o.max,o.width=+o.width,!t&&o.width&&(t=!0,Kc(o.width)),xi(o);f<=u;)e[f++]=tr(o)}}(F,N)}T&&Sg(T[1],p,r,x,f,u);var B=w.match(hr);B&&(p["!autofilter"]=function yg(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(B[0]));var I=[],re=w.match(cg);if(re)for(E=0;E!=re.length;++E)I[E]=Lt(re[E].slice(re[E].indexOf('"')+1));var se=w.match(fg);se&&function ch(e,r,t){for(var s=Array.isArray(e),o=0;o!=r.length;++o){var f=mt(jt(r[o]),!0);if(!f.ref)return;var u=((t||{})["!id"]||[])[f.id];u?(f.Target=u.Target,f.location&&(f.Target+="#"+zt(f.location))):(f.Target="#"+zt(f.location),u={Target:f.Target,TargetMode:"Internal"}),f.Rel=u,f.tooltip&&(f.Tooltip=f.tooltip,delete f.tooltip);for(var p=Lt(f.ref),x=p.s.r;x<=p.e.r;++x)for(var _=p.s.c;_<=p.e.c;++_){var w=bt({c:_,r:x});s?(e[x]||(e[x]=[]),e[x][_]||(e[x][_]={t:"z",v:void 0}),e[x][_].l=f):(e[w]||(e[w]={t:"z",v:void 0}),e[w].l=f)}}}(p,se,s);var ee=w.match(dg);if(ee&&(p["!margins"]=function _g(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}(mt(ee[0]))),!p["!ref"]&&x.e.c>=x.s.c&&x.e.r>=x.s.r&&(p["!ref"]=Et(x)),r.sheetRows>0&&p["!ref"]){var V=Lt(p["!ref"]);r.sheetRows<=+V.e.r&&(V.e.r=r.sheetRows-1,V.e.r>x.e.r&&(V.e.r=x.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>x.e.c&&(V.e.c=x.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),p["!fullref"]=p["!ref"],p["!ref"]=Et(V))}return F.length>0&&(p["!cols"]=F),I.length>0&&(p["!merges"]=I),p}(e,s,t,o,f,u,p)}function Kx(e,r,t,s,o){return(".bin"===r.slice(-4)?K:lh)(e,t,s,o)}function qx(e,r,t){return(".bin"===r.slice(-4)?jp:Pf)(e,t)}var _l,G1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,j1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function vi(e,r){var t=e.split(/\s+/),s=[];if(r||(s[0]=t[0]),1===t.length)return s;var f,u,x,o=e.match(G1);if(o)for(x=0;x!=o.length;++x)-1===(u=(f=o[x].match(j1))[1].indexOf(":"))?s[f[1]]=f[2].slice(1,f[2].length-1):s["xmlns:"===f[1].slice(0,6)?"xmlns"+f[1].slice(6):f[1].slice(u+1)]=f[2].slice(1,f[2].length-1);return s}function t_(e){var t={};if(1===e.split(/\s+/).length)return t;var o,f,p,s=e.match(G1);if(s)for(p=0;p!=s.length;++p)-1===(f=(o=s[p].match(j1))[1].indexOf(":"))?t[o[1]]=o[2].slice(1,o[2].length-1):t["xmlns:"===o[1].slice(0,6)?"xmlns"+o[1].slice(6):o[1].slice(f+1)]=o[2].slice(1,o[2].length-1);return t}function n_(e,r,t,s){var o=s;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":o=sr(s);break;case"i2":case"int":o=parseInt(s,10);break;case"r4":case"float":o=parseFloat(s);break;case"date":case"dateTime.tz":o=Zt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[zt(r)]=o}function a_(e,r,t){if(t.cellStyles&&r.Interior){var s=r.Interior;s.Pattern&&(s.patternType=Vd[s.Pattern]||s.Pattern)}e[r.ID]=r}function s_(e,r,t,s,o,f,u,p,x,_){var w="General",T=s.StyleID,C={};_=_||{};var E=[],A=0;for(void 0===T&&p&&(T=p.StyleID),void 0===T&&u&&(T=u.StyleID);void 0!==f[T]&&(f[T].nf&&(w=f[T].nf),f[T].Interior&&E.push(f[T].Interior),f[T].Parent);)T=f[T].Parent;switch(t.Type){case"Boolean":s.t="b",s.v=sr(e);break;case"String":s.t="s",s.r=Nl(zt(e)),s.v=e.indexOf("<")>-1?zt(r||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),s.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/864e5,s.v!=s.v?s.v=zt(e):s.v<60&&(s.v=s.v-1),(!w||"General"==w)&&(w="yyyy-mm-dd");case"Number":void 0===s.v&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=Ac[e],!1!==_.cellText&&(s.w=e);break;default:""==e&&""==r?s.t="z":(s.t="s",s.v=Nl(r||e))}if(function i_(e,r,t){if("z"!==e.t){if(!t||!1!==t.cellText)try{e.w="e"===e.t?e.w||ai[e.v]:"General"===r?"n"===e.t?(0|e.v)===e.v?e.v.toString(10):Qn(e.v):Dn(e.v):function r_(e,r){var t=_l[e]||zt(e);return"General"===t?Dn(r):M(t,r)}(r||"General",e.v)}catch(f){if(t.WTF)throw f}try{var s=_l[r]||r||"General";if(t.cellNF&&(e.z=s),t.cellDates&&"n"==e.t&&ti(s)){var o=Vt(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(f){if(t.WTF)throw f}}}(s,w,_),!1!==_.cellFormula)if(s.Formula){var k=zt(s.Formula);61==k.charCodeAt(0)&&(k=k.slice(1)),s.f=ja(k,o),delete s.Formula,"RC"==s.ArrayRange?s.F=ja("RC:RC",o):s.ArrayRange&&(s.F=ja(s.ArrayRange,o),x.push([Lt(s.F),s.F]))}else for(A=0;A<x.length;++A)o.r>=x[A][0].s.r&&o.r<=x[A][0].e.r&&o.c>=x[A][0].s.c&&o.c<=x[A][0].e.c&&(s.F=x[A][1]);_.cellStyles&&(E.forEach(function(F){!C.patternType&&F.patternType&&(C.patternType=F.patternType)}),s.s=C),void 0!==s.StyleID&&(s.ixfe=s.StyleID)}function o_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function x1(e,r){var t=r||{};ve();var s=Be(hc(e));("binary"==t.type||"array"==t.type||"base64"==t.type)&&(s=typeof ue<"u"?ue.utils.decode(65001,Qe(s)):jt(s));var o=s.slice(0,1024).toLowerCase(),f=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";"))){var u=tr(t);return u.type="string",_n.to_workbook(s,u)}if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(Lr){o.indexOf("<"+Lr)>=0&&(f=!0)}),f)return function z_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length)return gi(K1(t[0],r),r);var s={SheetNames:[],Sheets:{}};return t.forEach(function(o,f){P1(s,K1(o,r),"Sheet"+(f+1))}),s}(s,t);_l={"General Number":"General","General Date":vt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":vt[15],"Short Date":vt[14],"Long Time":vt[19],"Medium Time":vt[18],"Short Time":vt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:vt[2],Standard:vt[4],Percent:vt[10],Scientific:vt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var p,_,x=[];null!=ut&&null==t.dense&&(t.dense=ut);var ot,w={},T=[],C=t.dense?[]:{},E="",A={},k={},F=vi('<Data ss:Type="String">'),N=0,B=0,I=0,re={s:{r:2e6,c:2e6},e:{r:0,c:0}},se={},ee={},V="",ne=0,te=[],ge={},_e={},ae=0,ze=[],nt=[],$e={},xt=[],Nt=!1,qe=[],pt=[],Ee={},X=0,fe=0,q={Sheets:[],WBProps:{date1904:!1}},J={};qi.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"");for(var ke="";p=qi.exec(s);)switch(p[3]=(ke=p[3]).toLowerCase()){case"data":if("data"==ke){if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else"/"!==p[0].charAt(p[0].length-2)&&x.push([p[3],!0]);break}if(x[x.length-1][1])break;"/"===p[1]?s_(s.slice(N,p.index),V,F,"comment"==x[x.length-1][0]?$e:A,{c:B,r:I},se,xt[B],k,qe,t):(V="",F=vi(p[0]),N=p.index+p[0].length);break;case"cell":if("/"===p[1])if(nt.length>0&&(A.c=nt),(!t.sheetRows||t.sheetRows>I)&&void 0!==A.v&&(t.dense?(C[I]||(C[I]=[]),C[I][B]=A):C[$t(B)+yr(I)]=A),A.HRef&&(A.l={Target:zt(A.HRef)},A.HRefScreenTip&&(A.l.Tooltip=A.HRefScreenTip),delete A.HRef,delete A.HRefScreenTip),(A.MergeAcross||A.MergeDown)&&(X=B+(0|parseInt(A.MergeAcross,10)),fe=I+(0|parseInt(A.MergeDown,10)),te.push({s:{c:B,r:I},e:{c:X,r:fe}})),t.sheetStubs)if(A.MergeAcross||A.MergeDown){for(var Ke=B;Ke<=X;++Ke)for(var He=I;He<=fe;++He)(Ke>B||He>I)&&(t.dense?(C[He]||(C[He]=[]),C[He][Ke]={t:"z"}):C[$t(Ke)+yr(He)]={t:"z"});B=X+1}else++B;else A.MergeAcross?B=X+1:++B;else(A=t_(p[0])).Index&&(B=+A.Index-1),B<re.s.c&&(re.s.c=B),B>re.e.c&&(re.e.c=B),"/>"===p[0].slice(-2)&&++B,nt=[];break;case"row":"/"===p[1]||"/>"===p[0].slice(-2)?(I<re.s.r&&(re.s.r=I),I>re.e.r&&(re.e.r=I),"/>"===p[0].slice(-2)&&(k=vi(p[0])).Index&&(I=+k.Index-1),B=0,++I):((k=vi(p[0])).Index&&(I=+k.Index-1),Ee={},("0"==k.AutoFitHeight||k.Height)&&(Ee.hpx=parseInt(k.Height,10),Ee.hpt=pa(Ee.hpx),pt[I]=Ee),"1"==k.Hidden&&(Ee.hidden=!0,pt[I]=Ee));break;case"worksheet":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"));T.push(E),re.s.r<=re.e.r&&re.s.c<=re.e.c&&(C["!ref"]=Et(re),t.sheetRows&&t.sheetRows<=re.e.r&&(C["!fullref"]=C["!ref"],re.e.r=t.sheetRows-1,C["!ref"]=Et(re))),te.length&&(C["!merges"]=te),xt.length>0&&(C["!cols"]=xt),pt.length>0&&(C["!rows"]=pt),w[E]=C}else re={s:{r:2e6,c:2e6},e:{r:0,c:0}},I=B=0,x.push([p[3],!1]),_=vi(p[0]),E=zt(_.Name),C=t.dense?[]:{},te=[],qe=[],pt=[],q.Sheets.push(J={name:E,Hidden:0});break;case"table":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else{if("/>"==p[0].slice(-2))break;x.push([p[3],!1]),xt=[],Nt=!1}break;case"style":"/"===p[1]?a_(se,ee,t):ee=vi(p[0]);break;case"numberformat":ee.nf=zt(vi(p[0]).Format||"General"),_l[ee.nf]&&(ee.nf=_l[ee.nf]);for(var We=0;392!=We&&vt[We]!=ee.nf;++We);if(392==We)for(We=57;392!=We;++We)if(null==vt[We]){Q(ee.nf,We);break}break;case"column":if("table"!==x[x.length-1][0])break;if((ot=vi(p[0])).Hidden&&(ot.hidden=!0,delete ot.Hidden),ot.Width&&(ot.wpx=parseInt(ot.Width,10)),!Nt&&ot.wpx>10){Nt=!0,Jt=bf;for(var Ae=0;Ae<xt.length;++Ae)xt[Ae]&&xi(xt[Ae])}Nt&&xi(ot),xt[ot.Index-1||xt.length]=ot;for(var Ot=0;Ot<+ot.Span;++Ot)xt[xt.length]=tr(ot);break;case"namedrange":if("/"===p[1])break;q.Names||(q.Names=[]);var G=mt(p[0]),or={Name:G.Name,Ref:ja(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(or.Sheet=q.Sheets.length-1),q.Names.push(or);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===p[0].slice(-2))break;"/"===p[1]?V+=s.slice(ne,p.index):ne=p.index+p[0].length;break;case"interior":if(!t.cellStyles)break;ee.Interior=vi(p[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===p[0].slice(-2))break;"/"===p[1]?nu(ge,ke,s.slice(ae,p.index)):ae=p.index+p[0].length;break;case"styles":case"workbook":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else x.push([p[3],!1]);break;case"comment":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"));o_($e),nt.push($e)}else x.push([p[3],!1]),$e={a:(_=vi(p[0])).Author};break;case"autofilter":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else if("/"!==p[0].charAt(p[0].length-2)){var Ht=vi(p[0]);C["!autofilter"]={ref:ja(Ht.Range).replace(/\$/g,"")},x.push([p[3],!0])}break;case"datavalidation":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else"/"!==p[0].charAt(p[0].length-2)&&x.push([p[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===p[1]){if((_=x.pop())[0]!==p[3])throw new Error("Bad state: "+_.join("|"))}else"/"!==p[0].charAt(p[0].length-2)&&x.push([p[3],!0]);break;default:if(0==x.length&&"document"==p[3]||0==x.length&&"uof"==p[3])return cx(s,t);var cr=!0;switch(x[x.length-1][0]){case"officedocumentsettings":switch(p[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:cr=!1}break;case"componentoptions":switch(p[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:cr=!1}break;case"excelworkbook":switch(p[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:cr=!1}break;case"workbookoptions":switch(p[3]){case"owcversion":case"height":case"width":break;default:cr=!1}break;case"worksheetoptions":switch(p[3]){case"visible":if("/>"!==p[0].slice(-2))if("/"===p[1])switch(s.slice(ae,p.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2}else ae=p.index+p[0].length;break;case"header":C["!margins"]||xa(C["!margins"]={},"xlml"),isNaN(+mt(p[0]).Margin)||(C["!margins"].header=+mt(p[0]).Margin);break;case"footer":C["!margins"]||xa(C["!margins"]={},"xlml"),isNaN(+mt(p[0]).Margin)||(C["!margins"].footer=+mt(p[0]).Margin);break;case"pagemargins":var Wt=mt(p[0]);C["!margins"]||xa(C["!margins"]={},"xlml"),isNaN(+Wt.Top)||(C["!margins"].top=+Wt.Top),isNaN(+Wt.Left)||(C["!margins"].left=+Wt.Left),isNaN(+Wt.Right)||(C["!margins"].right=+Wt.Right),isNaN(+Wt.Bottom)||(C["!margins"].bottom=+Wt.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].left=!0;break;default:cr=!1}break;case"pivottable":case"pivotcache":switch(p[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:cr=!1}break;case"pagebreaks":switch(p[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:cr=!1}break;case"autofilter":switch(p[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:cr=!1}break;case"querytable":switch(p[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:cr=!1}break;case"datavalidation":switch(p[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:cr=!1}break;case"sorting":case"conditionalformatting":switch(p[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:cr=!1}break;case"mapinfo":case"schema":case"data":switch(p[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:cr=!1}break;case"smarttags":break;default:cr=!1}if(cr||p[3].match(/!\[CDATA/))break;if(!x[x.length-1][1])throw"Unrecognized tag: "+p[3]+"|"+x.join("|");if("customdocumentproperties"===x[x.length-1][0]){if("/>"===p[0].slice(-2))break;"/"===p[1]?n_(_e,ke,ze,s.slice(ae,p.index)):(ze=p,ae=p.index+p[0].length);break}if(t.WTF)throw"Unrecognized tag: "+p[3]+"|"+x.join("|")}var tt={};return!t.bookSheets&&!t.bookProps&&(tt.Sheets=w),tt.SheetNames=T,tt.Workbook=q,tt.SSF=tr(vt),tt.Props=ge,tt.Custprops=_e,tt}function _1(e,r){switch(C1(r=r||{}),r.type||"base64"){case"base64":return x1(Ut(e),r);case"binary":case"buffer":case"file":return x1(e,r);case"array":return x1(Jn(e),r)}}function X1(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+al(e.Ref,{r:0,c:0})})}function m_(e,r,t,s,o,f,u){if(!e||null==e.v&&null==e.f)return"";var p={};if(e.f&&(p["ss:Formula"]="="+Kt(al(e.f,u))),e.F&&e.F.slice(0,r.length)==r){var x=pr(e.F.slice(r.length+1));p["ss:ArrayRange"]="RC:R"+(x.r==u.r?"":"["+(x.r-u.r)+"]")+"C"+(x.c==u.c?"":"["+(x.c-u.c)+"]")}if(e.l&&e.l.Target&&(p["ss:HRef"]=Kt(e.l.Target),e.l.Tooltip&&(p["x:HRefScreenTip"]=Kt(e.l.Tooltip))),t["!merges"])for(var _=t["!merges"],w=0;w!=_.length;++w)_[w].s.c!=u.c||_[w].s.r!=u.r||(_[w].e.c>_[w].s.c&&(p["ss:MergeAcross"]=_[w].e.c-_[w].s.c),_[w].e.r>_[w].s.r&&(p["ss:MergeDown"]=_[w].e.r-_[w].s.r));var T="",C="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":T="Number",C=String(e.v);break;case"b":T="Boolean",C=e.v?"1":"0";break;case"e":T="Error",C=ai[e.v];break;case"d":T="DateTime",C=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||vt[14]);break;case"s":T="String",C=function Sh(e){return(e+"").replace(cc,function(t){return oc[t]}).replace(Aa,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var E=$i(s.cellXfs,e,s);p["ss:StyleID"]="s"+(21+E),p["ss:Index"]=u.c+1;var k="z"==e.t?"":'<Data ss:Type="'+T+'">'+(null!=e.v?C:"")+"</Data>";return(e.c||[]).length>0&&(k+=function p_(e){return e.map(function(r){var t=function Ah(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}(r.t||""),s=Ue("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",s,{"ss:Author":r.a})}).join("")}(e.c)),Ue("Cell",k,p)}function g_(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=_i(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function __(e,r,t){var s=[],f=t.Sheets[t.SheetNames[e]],u=f?function u_(e,r,t,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var o=s.Workbook.Names,f=[],u=0;u<o.length;++u){var p=o[u];p.Sheet==t&&(p.Name.match(/^_xlfn\./)||f.push(X1(p)))}return f.join("")}(f,0,e,t):"";return u.length>0&&s.push("<Names>"+u+"</Names>"),u=f?function x_(e,r,t,s){if(!e["!ref"])return"";var o=Lt(e["!ref"]),f=e["!merges"]||[],u=0,p=[];e["!cols"]&&e["!cols"].forEach(function(F,N){xi(F);var B=!!F.width,I=Wo(N,F),re={"ss:Index":N+1};B&&(re["ss:Width"]=Va(I.width)),F.hidden&&(re["ss:Hidden"]="1"),p.push(Ue("Column",null,re))});for(var x=Array.isArray(e),_=o.s.r;_<=o.e.r;++_){for(var w=[g_(_,(e["!rows"]||[])[_])],T=o.s.c;T<=o.e.c;++T){var C=!1;for(u=0;u!=f.length;++u)if(!(f[u].s.c>T||f[u].s.r>_||f[u].e.c<T||f[u].e.r<_)){(f[u].s.c!=T||f[u].s.r!=_)&&(C=!0);break}if(!C){var E={r:_,c:T},A=bt(E);w.push(m_(x?(e[_]||[])[T]:e[A],A,e,r,0,0,E))}}w.push("</Row>"),w.length>2&&p.push(w.join(""))}return p.join("")}(f,r):"",u.length>0&&s.push("<Table>"+u+"</Table>"),s.push(function d_(e,r,t,s){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)o.push(Ue("Visible",1==s.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<t&&(!s.Workbook.Sheets[f]||s.Workbook.Sheets[f].Hidden);++f);f==t&&o.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(jr("ProtectContents","True")),e["!protect"].objects&&o.push(jr("ProtectObjects","True")),e["!protect"].scenarios&&o.push(jr("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null!=e["!protect"].selectUnlockedCells&&!e["!protect"].selectUnlockedCells&&o.push(jr("EnableSelection","UnlockedCells")):o.push(jr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&o.push("<"+u[1]+"/>")})),0==o.length?"":Ue("WorksheetOptions",o.join(""),{xmlns:En.x})}(f,0,e,t)),s.join("")}function v_(e,r){r||(r={}),e.SSF||(e.SSF=tr(vt)),e.SSF&&(ve(),Z(e.SSF),r.revssf=rc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],$i(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(function c_(e,r){var t=[];return e.Props&&t.push(function iu(e,r){var t=[];return fr($n).map(function(s){for(var o=0;o<cn.length;++o)if(cn[o][1]==s)return cn[o];for(o=0;o<Mi.length;++o)if(Mi[o][1]==s)return Mi[o];throw s}).forEach(function(s){if(null!=e[s[1]]){var o=r&&r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e[s[1]];"date"===s[2]&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof o?o=String(o):!0===o||!1===o?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),t.push(jr($n[s[1]]||s[1],o))}}),Ue("DocumentProperties",t.join(""),{xmlns:En.o})}(e.Props,r)),e.Custprops&&t.push(function au(e,r){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",o=[];return e&&fr(e).forEach(function(f){if(Object.prototype.hasOwnProperty.call(e,f)){for(var u=0;u<cn.length;++u)if(f==cn[u][1])return;for(u=0;u<Mi.length;++u)if(f==Mi[u][1])return;for(u=0;u<t.length;++u)if(f==t[u])return;var p=e[f],x="string";"number"==typeof p?(x="float",p=String(p)):!0===p||!1===p?(x="boolean",p=p?"1":"0"):p=String(p),o.push(Ue(Ai(f),p,{"dt:dt":x}))}}),r&&fr(r).forEach(function(f){if(Object.prototype.hasOwnProperty.call(r,f)&&(!e||!Object.prototype.hasOwnProperty.call(e,f))){var u=r[f],p="string";"number"==typeof u?(p="float",u=String(u)):!0===u||!1===u?(p="boolean",u=u?"1":"0"):u instanceof Date?(p="dateTime.tz",u=u.toISOString()):u=String(u),o.push(Ue(Ai(f),u,{"dt:dt":p}))}}),"<"+s+' xmlns="'+En.o+'">'+o.join("")+"</"+s+">"}(e.Props,e.Custprops)),t.join("")}(e,r)),t.push(""),t.push(""),t.push("");for(var s=0;s<e.SheetNames.length;++s)t.push(Ue("Worksheet",__(s,r,e),{"ss:Name":Kt(e.SheetNames[s])}));return t[2]=function f_(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,o){var f=[];f.push(Ue("NumberFormat",null,{"ss:Format":Kt(vt[s.numFmtId])}));var u={"ss:ID":"s"+(21+o)};t.push(Ue("Style",f.join(""),u))}),Ue("Styles",t.join(""))}(0,r),t[3]=function h_(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],s=0;s<r.length;++s){var o=r[s];null==o.Sheet&&(o.Name.match(/^_xlfn\./)||t.push(X1(o)))}return Ue("Names",t.join(""))}(e),vr+Ue("Workbook",t.join(""),{xmlns:En.ss,"xmlns:o":En.o,"xmlns:x":En.x,"xmlns:ss":En.ss,"xmlns:dt":En.dt,"xmlns:html":En.html})}var y_=[60,1084,2066,2165,2175];function b_(e,r,t,s,o){var f=s,u=[],p=t.slice(t.l,t.l+f);if(o&&o.enc&&o.enc.insitu&&p.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:o.enc.insitu(p)}u.push(p),t.l+=f;for(var x=Pn(t,t.l),_=v1[x],w=0;null!=_&&y_.indexOf(x)>-1;)f=Pn(t,t.l+2),w=t.l+4,2066==x?w+=4:(2165==x||2175==x)&&(w+=12),p=t.slice(w,t.l+4+f),u.push(p),t.l+=4+f,_=v1[x=Pn(t,t.l)];var T=lr(u);Hr(T,0);var C=0;T.lens=[];for(var E=0;E<u.length;++E)T.lens.push(C),C+=u[E].length;if(T.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+T.length+" < "+s;return r.f(T,T.length,o)}function Xi(e,r,t){if("z"!==e.t&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=vt[s])}catch(f){if(r.WTF)throw f}if(!r||!1!==r.cellText)try{e.w="e"===e.t?e.w||ai[e.v]:0===s||"General"==s?"n"===e.t?(0|e.v)===e.v?e.v.toString(10):Qn(e.v):Dn(e.v):M(s,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(f){if(r.WTF)throw f}if(r.cellDates&&s&&"n"==e.t&&ti(vt[s]||String(s))){var o=Vt(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}}function _h(e,r,t){return{v:e,ixfe:r,t}}var vl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Y1(e,r){var t,s,o,f;if(r||(r={}),C1(r),Ne(),r.codepage&&ct(r.codepage),e.FullPaths){if(et.find(e,"/encryption"))throw new Error("File is password-protected");t=et.find(e,"!CompObj"),s=et.find(e,"/Workbook")||et.find(e,"/Book")}else{switch(r.type){case"base64":e=Sr(Ut(e));break;case"binary":e=Sr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Hr(e,0),s={content:e}}if(t&&function w_(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=function L1(e){return Cc(e,1)}(t),t.length-t.l<=4)return r;var s=t.read_shift(4);if(0==s||s>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||1907505652!==(s=t.read_shift(4))||(r.UnicodeClipboardFormat=function N1(e){return Cc(e,2)}(t),0==(s=t.read_shift(4))||s>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}(t),r.bookProps&&!r.bookSheets)o={};else{var u=wt?"buffer":"array";if(s&&s.content)o=function k_(e,r){var t={opts:{}},s={};null!=ut&&null==r.dense&&(r.dense=ut);var T,E,k,F,I,re,o=r.dense?[]:{},f={},u={},p=null,x=[],_="",w={},C="",N={},B=[],se=[],ee=[],V={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ne={},te=function(Bt){return Bt<8?la[Bt]:Bt<64&&ee[Bt-8]||la[Bt]},_e=function(Bt,Nr,hi){if(!(Ee>1||hi.sheetRows&&Bt.r>=hi.sheetRows)){if(hi.cellStyles&&Nr.XF&&Nr.XF.data&&function(Bt,Nr,hi){var $s,Kr=Nr.XF.data;Kr&&Kr.patternType&&hi&&hi.cellStyles&&(Nr.s={},Nr.s.patternType=Kr.patternType,($s=As(te(Kr.icvFore)))&&(Nr.s.fgColor={rgb:$s}),($s=As(te(Kr.icvBack)))&&(Nr.s.bgColor={rgb:$s}))}(0,Nr,hi),delete Nr.ixfe,delete Nr.XF,T=Bt,C=bt(Bt),(!u||!u.s||!u.e)&&(u={s:{r:0,c:0},e:{r:0,c:0}}),Bt.r<u.s.r&&(u.s.r=Bt.r),Bt.c<u.s.c&&(u.s.c=Bt.c),Bt.r+1>u.e.r&&(u.e.r=Bt.r+1),Bt.c+1>u.e.c&&(u.e.c=Bt.c+1),hi.cellFormula&&Nr.f)for(var Kr=0;Kr<B.length;++Kr)if(!(B[Kr][0].s.c>Bt.c||B[Kr][0].s.r>Bt.r||B[Kr][0].e.c<Bt.c||B[Kr][0].e.r<Bt.r)){Nr.F=Et(B[Kr][0]),(B[Kr][0].s.c!=Bt.c||B[Kr][0].s.r!=Bt.r)&&delete Nr.f,Nr.f&&(Nr.f=""+Yr(B[Kr][1],0,Bt,qe,ae));break}hi.dense?(o[Bt.r]||(o[Bt.r]=[]),o[Bt.r][Bt.c]=Nr):o[C]=Nr}},ae={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(ae.password=r.password);var ze,nt=[],$e=[],xt=[],ot=[],Nt=!1,qe=[];qe.SheetNames=ae.snames,qe.sharedf=ae.sharedf,qe.arrayf=ae.arrayf,qe.names=[],qe.XTI=[];var J,pt=0,Ee=0,X=0,fe=[],q=[];ae.codepage=1200,Fe(1200);for(var ke=!1;e.l<e.length-1;){var Ke=e.l,He=e.read_shift(2);if(0===He&&10===pt)break;var We=e.l===e.length?0:e.read_shift(2),Ae=v1[He];if(Ae&&Ae.f){if(r.bookSheets&&133===pt&&133!==He)break;if(pt=He,2===Ae.r||12==Ae.r){var Ot=e.read_shift(2);if(We-=2,!ae.enc&&Ot!==He&&((255&Ot)<<8|Ot>>8)!==He)throw new Error("rt mismatch: "+Ot+"!="+He);12==Ae.r&&(e.l+=10,We-=10)}var G={};if(G=10===He?Ae.f(e,We,ae):b_(He,Ae,e,We,ae),0==Ee&&-1===[9,521,1033,2057].indexOf(pt))continue;switch(He){case 34:t.opts.Date1904=V.WBProps.date1904=G;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ae.enc||(e.l=0),ae.enc=G,!r.password)throw new Error("File is password-protected");if(null==G.valid)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:ae.lastuser=G;break;case 66:var or=Number(G);switch(or){case 21010:or=1200;break;case 32768:or=1e4;break;case 32769:or=1252}Fe(ae.codepage=or),ke=!0;break;case 317:ae.rrtabid=G;break;case 25:ae.winlocked=G;break;case 439:t.opts.RefreshAll=G;break;case 12:t.opts.CalcCount=G;break;case 16:t.opts.CalcDelta=G;break;case 17:t.opts.CalcIter=G;break;case 13:t.opts.CalcMode=G;break;case 14:t.opts.CalcPrecision=G;break;case 95:t.opts.CalcSaveRecalc=G;break;case 15:ae.CalcRefMode=G;break;case 2211:t.opts.FullCalc=G;break;case 129:G.fDialog&&(o["!type"]="dialog"),G.fBelow||((o["!outline"]||(o["!outline"]={})).above=!0),G.fRight||((o["!outline"]||(o["!outline"]={})).left=!0);break;case 224:se.push(G);break;case 430:qe.push([G]),qe[qe.length-1].XTI=[];break;case 35:case 547:qe[qe.length-1].push(G);break;case 24:case 536:J={Name:G.Name,Ref:Yr(G.rgce,0,null,qe,ae)},G.itab>0&&(J.Sheet=G.itab-1),qe.names.push(J),qe[0]||(qe[0]=[],qe[0].XTI=[]),qe[qe.length-1].push(G),"_xlnm._FilterDatabase"==G.Name&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&"PtgArea3d"==G.rgce[0][0][0]&&(q[G.itab-1]={ref:Et(G.rgce[0][0][1][2])});break;case 22:ae.ExternCount=G;break;case 23:0==qe.length&&(qe[0]=[],qe[0].XTI=[]),qe[qe.length-1].XTI=qe[qe.length-1].XTI.concat(G),qe.XTI=qe.XTI.concat(G);break;case 2196:if(ae.biff<8)break;null!=J&&(J.Comment=G[1]);break;case 18:o["!protect"]=G;break;case 19:0!==G&&ae.WTF&&console.error("Password verifier: "+G);break;case 133:f[G.pos]=G,ae.snames.push(G.name);break;case 10:if(--Ee)break;if(u.e){if(u.e.r>0&&u.e.c>0){if(u.e.r--,u.e.c--,o["!ref"]=Et(u),r.sheetRows&&r.sheetRows<=u.e.r){var Ht=u.e.r;u.e.r=r.sheetRows-1,o["!fullref"]=o["!ref"],o["!ref"]=Et(u),u.e.r=Ht}u.e.r++,u.e.c++}nt.length>0&&(o["!merges"]=nt),$e.length>0&&(o["!objects"]=$e),xt.length>0&&(o["!cols"]=xt),ot.length>0&&(o["!rows"]=ot),V.Sheets.push(ne)}""===_?w=o:s[_]=o,o=r.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===ae.biff&&(ae.biff={9:2,521:3,1033:4}[He]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),ae.biffguess=0==G.BIFFVer,0==G.BIFFVer&&4096==G.dt&&(ae.biff=5,ke=!0,Fe(ae.codepage=28591)),8==ae.biff&&0==G.BIFFVer&&16==G.dt&&(ae.biff=2),Ee++)break;if(o=r.dense?[]:{},ae.biff<8&&!ke&&(ke=!0,Fe(ae.codepage=r.codepage||1252)),ae.biff<5||0==G.BIFFVer&&4096==G.dt){""===_&&(_="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}};var cr={pos:e.l-We,name:_};f[cr.pos]=cr,ae.snames.push(_)}else _=(f[Ke]||{name:""}).name;32==G.dt&&(o["!type"]="chart"),64==G.dt&&(o["!type"]="macro"),nt=[],$e=[],ae.arrayf=B=[],xt=[],ot=[],Nt=!1,ne={Hidden:(f[Ke]||{hs:0}).hs,name:_};break;case 515:case 3:case 2:"chart"==o["!type"]&&(r.dense?(o[G.r]||[])[G.c]:o[bt({c:G.c,r:G.r})])&&++G.c,I={ixfe:G.ixfe,XF:se[G.ixfe]||{},v:G.val,t:"n"},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r);break;case 5:case 517:I={ixfe:G.ixfe,XF:se[G.ixfe],v:G.val,t:G.t},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r);break;case 638:I={ixfe:G.ixfe,XF:se[G.ixfe],v:G.rknum,t:"n"},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r);break;case 189:for(var Wt=G.c;Wt<=G.C;++Wt){var tt=G.rkrec[Wt-G.c][0];I={ixfe:tt,XF:se[tt],v:G.rkrec[Wt-G.c][1],t:"n"},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:Wt,r:G.r},I,r)}break;case 6:case 518:case 1030:if("String"==G.val){p=G;break}if((I=_h(G.val,G.cell.ixfe,G.tt)).XF=se[I.ixfe],r.cellFormula){var Lr=G.formula;if(Lr&&Lr[0]&&Lr[0][0]&&"PtgExp"==Lr[0][0][0]){var fi=Lr[0][0][1][0],Zi=Lr[0][0][1][1],ya=bt({r:fi,c:Zi});N[ya]?I.f=""+Yr(G.formula,0,G.cell,qe,ae):I.F=((r.dense?(o[fi]||[])[Zi]:o[ya])||{}).F}else I.f=""+Yr(G.formula,0,G.cell,qe,ae)}X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e(G.cell,I,r),p=G;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=G,(I=_h(G,p.cell.ixfe,"s")).XF=se[I.ixfe],r.cellFormula&&(I.f=""+Yr(p.formula,0,p.cell,qe,ae)),X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e(p.cell,I,r),p=null;break;case 33:case 545:B.push(G);var Tl=bt(G[0].s);if(E=r.dense?(o[G[0].s.r]||[])[G[0].s.c]:o[Tl],r.cellFormula&&E){if(!p||!Tl||!E)break;E.f=""+Yr(G[1],0,G[0],qe,ae),E.F=Et(G[0])}break;case 1212:if(!r.cellFormula)break;if(C){if(!p)break;N[bt(p.cell)]=G[0],((E=r.dense?(o[p.cell.r]||[])[p.cell.c]:o[bt(p.cell)])||{}).f=""+Yr(G[0],0,T,qe,ae)}break;case 253:I=_h(x[G.isst].t,G.ixfe,"s"),x[G.isst].h&&(I.h=x[G.isst].h),I.XF=se[I.ixfe],X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r);break;case 513:r.sheetStubs&&(I={ixfe:G.ixfe,XF:se[G.ixfe],t:"z"},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r));break;case 190:if(r.sheetStubs)for(var qa=G.c;qa<=G.C;++qa){var Zn=G.ixfe[qa-G.c];I={ixfe:Zn,XF:se[Zn],t:"z"},X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:qa,r:G.r},I,r)}break;case 214:case 516:case 4:(I=_h(G.val,G.ixfe,"s")).XF=se[I.ixfe],X>0&&(I.z=fe[I.ixfe>>8&63]),Xi(I,r,t.opts.Date1904),_e({c:G.c,r:G.r},I,r);break;case 0:case 512:1===Ee&&(u=G);break;case 252:x=G;break;case 1054:if(4==ae.biff){fe[X++]=G[1];for(var ba=0;ba<X+163&&vt[ba]!=G[1];++ba);ba>=163&&Q(G[1],X+163)}else Q(G[1],G[0]);break;case 30:fe[X++]=G;for(var es=0;es<X+163&&vt[es]!=G;++es);es>=163&&Q(G,X+163);break;case 229:nt=nt.concat(G);break;case 93:$e[G.cmo[0]]=ae.lastobj=G;break;case 438:ae.lastobj.TxO=G;break;case 127:ae.lastobj.ImData=G;break;case 440:for(F=G[0].s.r;F<=G[0].e.r;++F)for(k=G[0].s.c;k<=G[0].e.c;++k)(E=r.dense?(o[F]||[])[k]:o[bt({c:k,r:F})])&&(E.l=G[1]);break;case 2048:for(F=G[0].s.r;F<=G[0].e.r;++F)for(k=G[0].s.c;k<=G[0].e.c;++k)(E=r.dense?(o[F]||[])[k]:o[bt({c:k,r:F})])&&E.l&&(E.l.Tooltip=G[1]);break;case 28:if(ae.biff<=5&&ae.biff>=2)break;E=r.dense?(o[G[0].r]||[])[G[0].c]:o[bt(G[0])];var Cl=$e[G[2]];E||(r.dense?(o[G[0].r]||(o[G[0].r]=[]),E=o[G[0].r][G[0].c]={t:"z"}):E=o[bt(G[0])]={t:"z"},u.e.r=Math.max(u.e.r,G[0].r),u.s.r=Math.min(u.s.r,G[0].r),u.e.c=Math.max(u.e.c,G[0].c),u.s.c=Math.min(u.s.c,G[0].c)),E.c||(E.c=[]),E.c.push({a:G[1],t:Cl.TxO.t});break;case 2173:Ep(0,G.ext);break;case 125:if(!ae.cellStyles)break;for(;G.e>=G.s;)xt[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(1&G.flags)},Nt||(Nt=!0,Kc(G.w/256)),xi(xt[G.e+1]);break;case 520:var An={};null!=G.level&&(ot[G.r]=An,An.level=G.level),G.hidden&&(ot[G.r]=An,An.hidden=!0),G.hpt&&(ot[G.r]=An,An.hpt=G.hpt,An.hpx=_i(G.hpt));break;case 38:case 39:case 40:case 41:o["!margins"]||xa(o["!margins"]={}),o["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[He]]=G;break;case 161:o["!margins"]||xa(o["!margins"]={}),o["!margins"].header=G.header,o["!margins"].footer=G.footer;break;case 574:G.RTL&&(V.Views[0].RTL=!0);break;case 146:ee=G;break;case 2198:ze=G;break;case 140:re=G;break;case 442:_?ne.CodeName=G||ne.name:V.WBProps.CodeName=G||"ThisWorkbook"}}else Ae||console.error("Missing Info for XLS Record 0x"+He.toString(16)),e.l+=We}return t.SheetNames=fr(f).sort(function(Ki,Bt){return Number(Ki)-Number(Bt)}).map(function(Ki){return f[Ki].name}),r.bookSheets||(t.Sheets=s),!t.SheetNames.length&&w["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=w)):t.Preamble=w,t.Sheets&&q.forEach(function(Ki,Bt){t.Sheets[t.SheetNames[Bt]]["!autofilter"]=Ki}),t.Strings=x,t.SSF=tr(vt),ae.enc&&(t.Encryption=ae.enc),ze&&(t.Themes=ze),t.Metadata={},void 0!==re&&(t.Metadata.Country=re),qe.names.length>0&&(V.Names=qe.names),t.Workbook=V,t}(s.content,r);else if((f=et.find(e,"PerfectOffice_MAIN"))&&f.content)o=Hi.to_workbook(f.content,(r.type=u,r));else{if(!(f=et.find(e,"NativeContent_MAIN"))||!f.content)throw(f=et.find(e,"MN0"))&&f.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");o=Hi.to_workbook(f.content,(r.type=u,r))}r.bookVBA&&e.FullPaths&&et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(o.vbaraw=function Yp(e){var r=et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,s){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var o=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(r,o,e.FileIndex[s].content)}}),et.write(r)}(e))}var p={};return e.FullPaths&&function T_(e,r,t){var s=et.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var o=k0(s,ca,vl.DSI);for(var f in o)r[f]=o[f]}catch(_){if(t.WTF)throw _}var u=et.find(e,"/!SummaryInformation");if(u&&u.size>0)try{var p=k0(u,mo,vl.SI);for(var x in p)null==r[x]&&(r[x]=p[x])}catch(_){if(t.WTF)throw _}r.HeadingPairs&&r.TitlesOfParts&&(d0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}(e,p,r),o.Props=o.Custprops=p,r.bookFiles&&(o.cfb=e),o}var wl={0:{f:function fh(e,r){var t={},s=e.l+r;t.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var f=e.read_shift(1);return e.l=s,7&f&&(t.level=7&f),16&f&&(t.hidden=!0),32&f&&(t.hpt=o/20),t}},1:{f:function Lg(e){return[Sn(e)]}},2:{f:function Jg(e){return[Sn(e),kc(e),"n"]}},3:{f:function zg(e){return[Sn(e),e.read_shift(1),"e"]}},4:{f:function hh(e){return[Sn(e),e.read_shift(1),"b"]}},5:{f:function Yg(e){return[Sn(e),en(e),"n"]}},6:{f:function r1(e){return[Sn(e),qr(e),"str"]}},7:{f:function dh(e){return[Sn(e),e.read_shift(4),"s"]}},8:{f:function c1(e,r,t){var s=e.l+r,o=Sn(e);o.r=t["!row"];var u=[o,qr(e),"str"];if(t.cellFormula){e.l+=2;var p=Ho(e,s-e.l,t);u[3]=Yr(p,0,o,t.supbooks,t)}else e.l=s;return u}},9:{f:function o1(e,r,t){var s=e.l+r,o=Sn(e);o.r=t["!row"];var u=[o,en(e),"n"];if(t.cellFormula){e.l+=2;var p=Ho(e,s-e.l,t);u[3]=Yr(p,0,o,t.supbooks,t)}else e.l=s;return u}},10:{f:function a1(e,r,t){var s=e.l+r,o=Sn(e);o.r=t["!row"];var u=[o,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var p=Ho(e,s-e.l,t);u[3]=Yr(p,0,o,t.supbooks,t)}else e.l=s;return u}},11:{f:function s1(e,r,t){var s=e.l+r,o=Sn(e);o.r=t["!row"];var u=[o,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var p=Ho(e,s-e.l,t);u[3]=Yr(p,0,o,t.supbooks,t)}else e.l=s;return u}},12:{f:function Bg(e){return[gn(e)]}},13:{f:function qg(e){return[gn(e),kc(e),"n"]}},14:{f:function $g(e){return[gn(e),e.read_shift(1),"e"]}},15:{f:function Wg(e){return[gn(e),e.read_shift(1),"b"]}},16:{f:mh},17:{f:function n1(e){return[gn(e),qr(e),"str"]}},18:{f:function Xg(e){return[gn(e),e.read_shift(4),"s"]}},19:{f:wc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function Dx(e,r,t){var s=e.l+r;e.l+=4,e.l+=1;var o=e.read_shift(4),f=r0(e),u=eg(e,0,t),p=bc(e);e.l=s;var x={Name:f,Ptg:u};return o<268435455&&(x.Sheet=o),p&&(x.Comment=p),x}},40:{},42:{},43:{f:function Jd(e,r,t){var s={};s.sz=e.read_shift(2)/20;var o=function Tc(e){var r=e.read_shift(1);return e.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(e);switch(o.fItalic&&(s.italic=1),o.fCondense&&(s.condense=1),o.fExtend&&(s.extend=1),o.fShadow&&(s.shadow=1),o.fOutline&&(s.outline=1),o.fStrikeout&&(s.strike=1),700===e.read_shift(2)&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript"}var u=e.read_shift(1);0!=u&&(s.underline=u);var p=e.read_shift(1);p>0&&(s.family=p);var x=e.read_shift(1);switch(x>0&&(s.charset=x),e.l++,s.color=function Vh(e){var r={},s=e.read_shift(1)>>>1,o=e.read_shift(1),f=e.read_shift(2,"i"),u=e.read_shift(1),p=e.read_shift(1),x=e.read_shift(1);switch(e.l++,s){case 0:r.auto=1;break;case 1:r.index=o;var _=la[o];_&&(r.rgb=As(_));break;case 2:r.rgb=As([u,p,x]);break;case 3:r.theme=o}return 0!=f&&(r.tint=f>0?f/32767:f/32768),r}(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor"}return s.name=qr(e),s}},44:{f:function Zd(e,r){return[e.read_shift(2),qr(e)]}},45:{f:ep},46:{f:rp},47:{f:function tp(e,r){var t=e.l+r,s=e.read_shift(2),o=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:o}}},48:{},49:{f:function Uh(e){return e.read_shift(4,"i")}},50:{},51:{f:function tl(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rf},62:{f:function t1(e){return[Sn(e),wc(e),"is"]}},63:{f:function Rp(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=bt(t);var s=e.read_shift(1);return 2&s&&(r.l="1"),8&s&&(r.a="1"),r}},64:{f:function n(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function xh(e){var r=e.read_shift(2);return e.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function Mg(e,r){var t={},s=e[e.l];return++e.l,t.above=!(64&s),t.left=!(128&s),e.l+=18,t.name=Wh(e,r-19),t}},148:{f:Og,p:16},151:{f:function u1(){}},152:{},153:{f:function Vs(e,r){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var o=r>8?qr(e):"";return o.length>0&&(t.CodeName=o),t.autoCompressPictures=!!(65536&s),t.backupFile=!!(64&s),t.checkCompatibility=!!(4096&s),t.date1904=!!(1&s),t.filterPrivacy=!!(8&s),t.hidePivotFieldList=!!(1024&s),t.promptedSolutions=!!(16&s),t.publishItems=!!(2048&s),t.refreshAllConnections=!!(262144&s),t.saveExternalLinkValues=!!(128&s),t.showBorderUnselectedTables=!!(4&s),t.showInkAnnotation=!!(32&s),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(32768&s),t.updateLinks=["userSet","never","always"][s>>8&3],t}},154:{},155:{},156:{f:function Ws(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=fo(e,r-8),t.name=qr(e),t}},157:{},158:{},159:{T:1,f:function mf(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:aa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:l1},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function Sp(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:qr(e)}}},336:{T:-1},337:{f:function Ff(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Co},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function d1(e,r,t){var s=e.l+r,o=i0(e),f=e.read_shift(1),u=[o];if(u[2]=f,t.cellFormula){var p=qm(e,s-e.l,t);u[1]=p}else e.l=s;return u}},427:{f:function p1(e,r,t){var s=e.l+r,f=[aa(e,16)];if(t.cellFormula){var u=tg(e,s-e.l,t);f[1]=u,e.l=s}else e.l=s;return f}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function m1(e){var r={};return Vo.forEach(function(t){r[t]=en(e)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function Pg(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function gh(e,r){var t=e.l+r,s=aa(e,16),o=bc(e),f=qr(e),u=qr(e),p=qr(e);e.l=t;var x={rfx:s,relId:o,loc:f,display:p};return u&&(x.Tooltip=u),x}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Os},633:{T:1},634:{T:-1},635:{T:1,f:function Mf(e){var r={};r.iauthor=e.read_shift(4);var t=aa(e,16);return r.rfx=t.s,r.ref=bt(t.s),e.l+=16,r}},636:{T:-1},637:{f:xs},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function Ce(e,r){return e.l+=10,{name:qr(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function c(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},v1={6:{f:Bo},10:{f:Li},12:{f:br},13:{f:br},14:{f:Er},15:{f:Er},16:{f:en},17:{f:Er},18:{f:Er},19:{f:br},20:{f:Vc},21:{f:Vc},23:{f:Co},24:{f:Q0},25:{f:Er},26:{},27:{},28:{f:function Gu(e,r,t){return function $u(e,r,t){if(!(t.biff<8)){var s=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),u=e.read_shift(2),p=Ni(e,0,t);return t.biff<8&&e.read_shift(1),[{r:s,c:o},p,u,f]}}(e,0,t)}},29:{},34:{f:Er},35:{f:J0},38:{f:en},39:{f:en},40:{f:en},41:{f:en},42:{f:Er},43:{f:Er},47:{f:function Nd(e,r,t){var s={Type:t.biff>=8?e.read_shift(2):0};return s.Type?function Ld(e,r,t){var s=t||{};return s.Info=e.read_shift(2),e.l-=2,s.Data=1===s.Info?function Id(e){var r={},t=r.EncryptionVersionInfo=si(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}(e):function Yc(e,r){var t={},s=t.EncryptionVersionInfo=si(e,4);if(r-=4,2!=s.Minor)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);t.Flags=e.read_shift(4),r-=4;var o=e.read_shift(4);return r-=4,t.EncryptionHeader=Wi(e,o),t.EncryptionVerifier=Xc(e,r-=o),t}(e,r),s}(e,r-2,s):function Rd(e,r,t,s){var o={key:br(e),verificationBytes:br(e)};t.password&&(o.verifier=Fo(t.password)),s.valid=o.verificationBytes===o.verifier,s.valid&&(s.insitu=function(e){var r=0,t=vf(e);return function(s){var o=function(e,r,t,s,o){var f,u;for(o||(o=r),s||(s=vf("")),f=0;f!=r.length;++f)u=r[f],o[f]=u=255&((u^=s[t])>>5|u<<3),++t;return[o,t,s]}(0,s,r,t);return r=o[1],o[0]}}(t.password))}(e,0,t,s),s}},49:{f:function Ui(e,r,t){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return s.name=ha(e,0,t),s}},51:{f:br},60:{},61:{f:function Au(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Er},65:{f:function V0(){}},66:{f:br},77:{},80:{},81:{},82:{},85:{f:br},89:{},90:{},91:{},92:{f:function wu(e,r,t){if(t.enc)return e.l+=r,"";var s=e.l,o=Ni(e,0,t);return e.read_shift(r+s-e.l),o}},93:{f:function Yu(e,r,t){if(t&&t.biff<8)return function Ku(e,r,t){e.l+=4;var s=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6;var u=[];return u.push((Zu[s]||Xr)(e,r-=36,t)),{cmo:[o,s,f],ft:u}}(e,r,t);var s=Es(e),o=function Ua(e,r){for(var t=e.l+r,s=[];e.l<t;){var o=e.read_shift(2);e.l-=2;try{s.push(_u[o](e,t-e.l))}catch{return e.l=t,s}}return e.l!=t&&(e.l=t),s}(e,r-22);return{cmo:s,ft:o}}},94:{},95:{f:Er},96:{},97:{},99:{f:Er},125:{f:rf},128:{f:function Bu(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function yu(e,r,t){var s=t&&8==t.biff||2==r?e.read_shift(2):(e.l+=r,0);return{fDialog:16&s,fBelow:64&s,fRight:128&s}}},130:{f:br},131:{f:Er},132:{f:Er},133:{f:function bu(e,r,t){var s=e.read_shift(4),o=3&e.read_shift(1),f=e.read_shift(1);switch(f){case 0:f="Worksheet";break;case 1:f="Macrosheet";break;case 2:f="Chartsheet";break;case 6:f="VBAModule"}var u=ha(e,0,t);return 0===u.length&&(u="Sheet1"),{pos:s,hs:o,dt:f,name:u}}},134:{},140:{f:function td(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Ra[t]||t,t=e.read_shift(2),r[1]=Ra[t]||t,r}},141:{f:br},144:{},146:{f:function id(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(I0(e));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:br},157:{},158:{},160:{f:of},161:{f:function af(e,r){var t={};return r<32||(e.l+=16,t.header=en(e),t.footer=en(e),e.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function G0(e,r){for(var t=e.l+r-2,s=e.read_shift(2),o=e.read_shift(2),f=[];e.l<t;)f.push(Ts(e));if(e.l!==t)throw new Error("MulRK read error");var u=e.read_shift(2);if(f.length!=u-o+1)throw new Error("MulRK length mismatch");return{r:s,c:o,C:u,rkrec:f}}},190:{f:function j0(e,r){for(var t=e.l+r-2,s=e.read_shift(2),o=e.read_shift(2),f=[];e.l<t;)f.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var u=e.read_shift(2);if(f.length!=u-o+1)throw new Error("MulBlank length mismatch");return{r:s,c:o,C:u,ixfe:f}}},193:{f:Li},197:{},198:{},199:{},200:{},201:{},202:{f:Er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:br},220:{},221:{f:Er},222:{},224:{f:function Nu(e,r,t){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,s.data=function Lu(e,r,t,s){var o={},f=e.read_shift(4),u=e.read_shift(4),p=e.read_shift(4),x=e.read_shift(2);return o.patternType=jh[p>>26],s.cellStyles&&(o.alc=7&f,o.fWrap=f>>3&1,o.alcV=f>>4&7,o.fJustLast=f>>7&1,o.trot=f>>8&255,o.cIndent=f>>16&15,o.fShrinkToFit=f>>20&1,o.iReadOrder=f>>22&2,o.fAtrNum=f>>26&1,o.fAtrFnt=f>>27&1,o.fAtrAlc=f>>28&1,o.fAtrBdr=f>>29&1,o.fAtrPat=f>>30&1,o.fAtrProt=f>>31&1,o.dgLeft=15&u,o.dgRight=u>>4&15,o.dgTop=u>>8&15,o.dgBottom=u>>12&15,o.icvLeft=u>>16&127,o.icvRight=u>>23&127,o.grbitDiag=u>>30&3,o.icvTop=127&p,o.icvBottom=p>>7&127,o.icvDiag=p>>14&127,o.dgDiag=p>>21&15,o.icvFore=127&x,o.icvBack=x>>7&127,o.fsxButton=x>>14&1),o}(e,0,0,t),s}},225:{f:function vu(e,r){return 0===r||e.read_shift(2),1200}},226:{f:Li},227:{},229:{f:function ju(e,r){for(var t=[],s=e.read_shift(2);s--;)t.push(ko(e));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function ku(e,r){for(var t=e.l+r,s=e.read_shift(4),o=e.read_shift(4),f=[],u=0;u!=o&&e.l<t;++u)f.push(S0(e));return f.Count=s,f.Unique=o,f}},253:{f:function Ou(e){var r=jn(e);return r.isst=e.read_shift(4),r}},255:{f:function Bc(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:T0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Er},353:{f:Li},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function K0(e,r,t){var s=e.l+r,o=e.read_shift(2),f=e.read_shift(2);if(t.sbcch=f,1025==f||14849==f)return[f,o];if(f<1||f>255)throw new Error("Unexpected SupBook type: "+f);for(var u=ua(e,f),p=[];s>e.l;)p.push(Ba(e));return[f,o,u,p]}},431:{f:Er},432:{},433:{},434:{},437:{},438:{f:function Ju(e,r,t){var s=e.l,o="";try{e.l+=4,-1==[0,5,7,11,12,14].indexOf((t.lastobj||{cmo:[0,0]}).cmo[1])?e.l+=6:function F0(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);e.l+=2}(e);var p=e.read_shift(2);e.read_shift(2),br(e);var x=e.read_shift(2);e.l+=x;for(var _=1;_<e.lens.length-1;++_){if(e.l-s!=e.lens[_])throw new Error("TxO: bad continue record");var w=e[e.l];if((o+=ua(e,e.lens[_+1]-e.lens[_]-1)).length>=(w?p:2*p))break}if(o.length!==p&&o.length!==2*p)throw new Error("cchText: "+p+" != "+o.length);return e.l=s+r,{t:o}}catch{return e.l=s+r,{t:o}}}},439:{f:Er},440:{f:function Qu(e,r){var t=ko(e);e.l+=16;var s=function du(e,r){var t=e.l+r,s=e.read_shift(4);if(2!==s)throw new Error("Unrecognized streamVersion: "+s);var o=e.read_shift(2);e.l+=2;var f,u,p,x,w,T,_="";16&o&&(f=bo(e)),128&o&&(u=bo(e)),257==(257&o)&&(p=bo(e)),1==(257&o)&&(x=function ks(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function D0(e){var r=e.read_shift(4),t=e.l,s=!1;r>24&&(e.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(s=!0),e.l=t);var o=e.read_shift((s?r-24:r)>>1,"utf16le").replace(Or,"");return s&&(e.l+=24),o}(e);case"0303000000000000c000000000000046":return function yo(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t+s.replace(/\\/g,"/");var f=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return t+e.read_shift(f>>1,"utf16le").replace(Or,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}(e)),8&o&&(_=bo(e)),32&o&&(w=e.read_shift(16)),64&o&&(T=Mc(e)),e.l=t;var C=u||p||x||"";C&&_&&(C+="#"+_),C||(C="#"+_),2&o&&"/"==C.charAt(0)&&"/"!=C.charAt(1)&&(C="file://"+C);var E={Target:C};return w&&(E.guid=w),T&&(E.time=T),f&&(E.Tooltip=f),E}(e,r-24);return[t,s]}},441:{},442:{f:Ba},443:{},444:{f:br},445:{},446:{},448:{f:Li},449:{f:function Su(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Li},512:{f:z0},513:{f:sd},515:{f:function Hu(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var s=jn(e),o=en(e);return s.val=o,s}},516:{f:function Uc(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var o=jn(e);2==t.biff&&e.l++;var f=Ba(e,0,t);return o.val=f,o}},517:{f:Z0},519:{f:od},520:{f:function Cu(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,7&s&&(r.level=7&s),32&s&&(r.hidden=!0),64&s&&(r.hpt=t/20),r}},523:{},545:{f:$c},549:{f:H0},566:{},574:{f:function W0(e,r,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function $0(e){var r=e.read_shift(2),t=e.read_shift(2),s=Ts(e);return{r,c:t,ixfe:s[0],rknum:s[1]}}},659:{},1048:{},1054:{f:function Mu(e,r,t){return[e.read_shift(2),Ni(e,0,t)]}},1084:{},1212:{f:function q0(e,r,t){var s=Cs(e);e.l++;var o=e.read_shift(1);return[Zm(e,r-=8,t),o,s]}},2048:{f:function tf(e,r){e.read_shift(2);var t=ko(e),s=e.read_shift((r-10)/2,"dbcs-cont");return[t,s=s.replace(Or,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:da},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Li},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function Gc(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r},r:12},2173:{f:function Cp(e,r){e.l+=2;var s=e.read_shift(2);e.l+=2;for(var o=e.read_shift(2),f=[];o-- >0;)f.push(Tp(e));return{ixfe:s,ext:f}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function zc(e,r,t){if(!(t.biff<8)){var s=e.read_shift(2),o=e.read_shift(2);return[ua(e,s,t),ua(e,o,t)]}e.l+=r},r:12},2197:{},2198:{f:function Af(e,r,t){var s=e.l+r;if(124226!==e.read_shift(4)){if(!t.cellStyles)return void(e.l=s);var u,f=e.slice(e.l);e.l=s;try{u=Ml(f,{type:"array"})}catch{return}var p=Tn(u,"theme/theme/theme1.xml",!0);if(p)return Sf(p,t)}},r:12},2199:{},2200:{},2201:{},2202:{f:function ef(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Li},2204:{},2205:{},2206:{},2207:{},2211:{f:function Eu(e){var r=function P0(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}(e);if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:br},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function ad(e,r,t){var s={area:!1};if(5!=t.biff)return e.l+=r,s;var o=e.read_shift(1);return e.l+=3,16&o&&(s.area=!0),s}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function nd(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(I0(e));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:z0},1:{},2:{f:function lf(e){var r=jn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}},3:{f:function ld(e){var r=jn(e);++e.l;var t=en(e);return r.t="n",r.val=t,r}},4:{f:function cd(e,r,t){t.biffguess&&5==t.biff&&(t.biff=2);var s=jn(e);++e.l;var o=Ni(e,0,t);return s.t="str",s.val=o,s}},5:{f:Z0},7:{f:function ud(e){var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,"sbcs-cont")}},8:{},9:{f:da},11:{},22:{f:br},30:{f:Ru},31:{},32:{},33:{f:$c},36:{},37:{f:H0},50:{f:function jc(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}},62:{},52:{},67:{},68:{f:br},69:{},86:{},126:{},127:{f:function cf(e){var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),o={fmt:r,env:t,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,o}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function dd(e,r,t){var s=e.l+r,o=jn(e),f=e.read_shift(2),u=ua(e,f,t);return e.l=s,o.t="str",o.val=u,o}},223:{},234:{},354:{},421:{},518:{f:Bo},521:{f:da},536:{f:Q0},547:{f:J0},561:{},579:{},1030:{f:Bo},1033:{f:da},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ge(e,r,t,s){var o=r;if(!isNaN(o)){var f=s||(t||[]).length||0,u=e.next(4);u.write_shift(2,o),u.write_shift(2,f),f>0&&gc(t)&&e.push(t)}}function yl(e,r,t){return e||(e=we(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function D_(e,r,t,s){if(null!=r.v)switch(r.t){case"d":case"n":var o="d"==r.t?Ir(Zt(r.v)):r.v;return void(o==(0|o)&&o>=0&&o<65536?Ge(e,2,function hd(e,r,t){var s=we(9);return yl(s,e,r),s.write_shift(2,t),s}(t,s,o)):Ge(e,3,function fd(e,r,t){var s=we(15);return yl(s,e,r),s.write_shift(8,t,"f"),s}(t,s,o)));case"b":case"e":return void Ge(e,5,function A_(e,r,t,s){var o=we(9);return yl(o,e,r),E0(t,s||"b",o),o}(t,s,r.v,r.t));case"s":case"str":return void Ge(e,4,function F_(e,r,t){var s=we(8+2*t.length);return yl(s,e,r),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}(t,s,(r.v||"").slice(0,255)))}Ge(e,1,yl(null,t,s))}function U_(e,r,t,s,o){var f=16+$i(o.cellXfs,r,o);if(null!=r.v||r.bf)if(r.bf)Ge(e,6,function Qm(e,r,t,s,o){var f=Bi(r,t,o),u=function Jm(e){if(null==e){var r=we(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}return oa("number"==typeof e?e:0)}(e.v),p=we(6);p.write_shift(2,33),p.write_shift(4,0);for(var _=we(e.bf.length),w=0;w<e.bf.length;++w)_[w]=e.bf[w];return lr([f,u,p,_])}(r,t,s,0,f));else switch(r.t){case"d":case"n":Ge(e,515,function Wu(e,r,t,s){var o=we(14);return Bi(e,r,s,o),oa(t,o),o}(t,s,"d"==r.t?Ir(Zt(r.v)):r.v,f));break;case"b":case"e":Ge(e,517,function Uu(e,r,t,s,o,f){var u=we(8);return Bi(e,r,s,u),E0(t,f,u),u}(t,s,r.v,f,0,r.t));break;case"s":case"str":o.bookSST?Ge(e,253,function Iu(e,r,t,s){var o=we(10);return Bi(e,r,s,o),o.write_shift(4,t),o}(t,s,pl(o.Strings,r.v,o.revStrings),f)):Ge(e,516,function Pu(e,r,t,s,o){var f=!o||8==o.biff,u=we(+f+8+(1+f)*t.length);return Bi(e,r,s,u),u.write_shift(2,t.length),f&&u.write_shift(1,1),u.write_shift((1+f)*t.length,t,f?"utf16le":"sbcs"),u}(t,s,(r.v||"").slice(0,255),f,o));break;default:Ge(e,513,Bi(t,s,f))}else Ge(e,513,Bi(t,s,f))}function H_(e,r,t){var w,s=sn(),o=t.SheetNames[e],f=t.Sheets[o]||{},u=(t||{}).Workbook||{},p=(u.Sheets||[])[e]||{},x=Array.isArray(f),_=8==r.biff,T="",C=[],E=Lt(f["!ref"]||"A1"),A=_?65536:16384;if(E.e.c>255||E.e.r>=A){if(r.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,A-1)}Ge(s,2057,Nc(0,16,r)),Ge(s,13,Mn(1)),Ge(s,12,Mn(100)),Ge(s,15,ln(!0)),Ge(s,17,ln(!1)),Ge(s,16,oa(.001)),Ge(s,95,ln(!0)),Ge(s,42,ln(!1)),Ge(s,43,ln(!1)),Ge(s,130,Mn(1)),Ge(s,128,function Y0(e){var r=we(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}([0,0])),Ge(s,131,ln(!1)),Ge(s,132,ln(!1)),_&&function B_(e,r){if(r){var t=0;r.forEach(function(s,o){++t<=256&&s&&Ge(e,125,function nf(e,r){var t=we(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,256*e.width),t.write_shift(2,0);var s=0;return e.hidden&&(s|=1),t.write_shift(1,s),t.write_shift(1,s=e.level||0),t.write_shift(2,0),t}(Wo(o,s),o))})}}(s,f["!cols"]),Ge(s,512,function Wc(e,r){var t=8!=r.biff&&r.biff?2:4,s=we(2*t+6);return s.write_shift(t,e.s.r),s.write_shift(t,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}(E,r)),_&&(f["!links"]=[]);for(var k=E.s.r;k<=E.e.r;++k){T=yr(k);for(var F=E.s.c;F<=E.e.c;++F){k===E.s.r&&(C[F]=$t(F)),w=C[F]+T;var N=x?(f[k]||[])[F]:f[w];N&&(U_(s,N,k,F,r),_&&N.l&&f["!links"].push([w,N.l]))}}var B=p.CodeName||p.name||o;return _&&Ge(s,574,function Fu(e){var r=we(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}((u.Views||[])[0])),_&&(f["!merges"]||[]).length&&Ge(s,229,function Xu(e){var r=we(2+8*e.length);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)L0(e[t],r);return r}(f["!merges"])),_&&function N_(e,r){for(var t=0;t<r["!links"].length;++t){var s=r["!links"][t];Ge(e,440,qu(s)),s[1].Tooltip&&Ge(e,2048,ed(s))}delete r["!links"]}(s,f),Ge(s,442,A0(B)),_&&function R_(e,r){var t=we(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ge(e,2151,t),(t=we(39)).write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),L0(Lt(r["!ref"]||"A1"),t),t.write_shift(4,4),Ge(e,2152,t)}(s,f),Ge(s,10),s.end()}function W_(e,r,t){var s=sn(),o=(e||{}).Workbook||{},f=o.Sheets||[],u=o.WBProps||{},p=8==t.biff,x=5==t.biff;Ge(s,2057,Nc(0,5,t)),"xla"==t.bookType&&Ge(s,135),Ge(s,225,p?Mn(1200):null),Ge(s,193,function fu(e,r){r||(r=we(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}(2)),x&&Ge(s,191),x&&Ge(s,192),Ge(s,226),Ge(s,92,function B0(e,r){var t=!r||8==r.biff,s=we(t?112:54);for(s.write_shift(8==r.biff?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}(0,t)),Ge(s,66,Mn(p?1200:1252)),p&&Ge(s,353,Mn(0)),p&&Ge(s,448),Ge(s,317,function sf(e){for(var r=we(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}(e.SheetNames.length)),p&&e.vbaraw&&Ge(s,211),p&&e.vbaraw&&Ge(s,442,A0(u.CodeName||"ThisWorkbook")),Ge(s,156,Mn(17)),Ge(s,25,ln(!1)),Ge(s,18,ln(!1)),Ge(s,19,Mn(0)),p&&Ge(s,431,ln(!1)),p&&Ge(s,444,Mn(0)),Ge(s,61,function To(){var e=we(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Ge(s,64,ln(!1)),Ge(s,141,Mn(0)),Ge(s,34,ln("true"==function rr(e){return e.Workbook&&e.Workbook.WBProps&&sr(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Ge(s,14,ln(!0)),p&&Ge(s,439,ln(!1)),Ge(s,218,Mn(0)),function P_(e,r,t){Ge(e,49,function Du(e,r){var t=e.name||"Arial",s=r&&5==r.biff,f=we(s?15+t.length:16+2*t.length);return f.write_shift(2,20*(e.sz||12)),f.write_shift(4,0),f.write_shift(2,400),f.write_shift(4,0),f.write_shift(2,0),f.write_shift(1,t.length),s||f.write_shift(1,1),f.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),f}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}(s,0,t),function M_(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&Ge(e,1054,Hc(o,r[o],t))})}(s,e.SSF,t),function L_(e,r){for(var t=0;t<16;++t)Ge(e,224,X0({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){Ge(e,224,X0(s,0,r))})}(s,t),p&&Ge(s,352,ln(!1));var w=s.end(),T=sn();p&&Ge(T,140,function rd(e){return e||(e=we(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),p&&t.Strings&&function S_(e,r,t,s){var o=s||(t||[]).length||0;if(o<=8224)return Ge(e,r,t,o);var f=r;if(!isNaN(f)){for(var u=t.parts||[],p=0,x=0,_=0;_+(u[p]||8224)<=8224;)_+=u[p]||8224,p++;var w=e.next(4);for(w.write_shift(2,f),w.write_shift(2,_),e.push(t.slice(x,x+_)),x+=_;x<o;){for((w=e.next(4)).write_shift(2,60),_=0;_+(u[p]||8224)<=8224;)_+=u[p]||8224,p++;w.write_shift(2,_),e.push(t.slice(x,x+_)),x+=_}}}(T,252,function Tu(e,r){var t=we(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var s=[],o=0;o<e.length;++o)s[o]=uu(e[o]);var f=lr([t].concat(s));return f.parts=[t.length].concat(s.map(function(u){return u.length})),f}(t.Strings)),Ge(T,10);var C=T.end(),E=sn(),A=0,k=0;for(k=0;k<e.SheetNames.length;++k)A+=(p?12:11)+(p?2:1)*e.SheetNames[k].length;var F=w.length+A+C.length;for(k=0;k<e.SheetNames.length;++k)Ge(E,133,U0({pos:F,hs:(f[k]||{}).Hidden||0,dt:0,name:e.SheetNames[k]},t)),F+=r[k].length;var B=E.end();if(A!=B.length)throw new Error("BS8 "+A+" != "+B.length);var I=[];return w.length&&I.push(w),B.length&&I.push(B),C.length&&I.push(C),lr(I)}function Z1(e,r){for(var t=0;t<=e.SheetNames.length;++t){var s=e.Sheets[e.SheetNames[t]];s&&s["!ref"]&&on(s["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}var f=r||{};switch(f.biff||2){case 8:case 5:return function V_(e,r){var t=r||{},s=[];e&&!e.SSF&&(e.SSF=tr(vt)),e&&e.SSF&&(ve(),Z(e.SSF),t.revssf=rc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,E1(t),t.cellXfs=[],$i(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)s[s.length]=H_(o,t,e);return s.unshift(W_(e,s,t)),lr(s)}(e,r);case 4:case 3:case 2:return function I_(e,r){var t=r||{};null!=ut&&null==t.dense&&(t.dense=ut);for(var s=sn(),o=0,f=0;f<e.SheetNames.length;++f)e.SheetNames[f]==t.sheet&&(o=f);if(0==o&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ge(s,4==t.biff?1033:3==t.biff?521:9,Nc(0,16,t)),function O_(e,r,t,s){var u,o=Array.isArray(r),f=Lt(r["!ref"]||"A1"),p="",x=[];if(f.e.c>255||f.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,16383),u=Et(f)}for(var _=f.s.r;_<=f.e.r;++_){p=yr(_);for(var w=f.s.c;w<=f.e.c;++w){_===f.s.r&&(x[w]=$t(w)),u=x[w]+p;var T=o?(r[_]||[])[w]:r[u];T&&D_(e,T,_,w)}}}(s,e.Sheets[e.SheetNames[o]],0,t),Ge(s,10),s.end()}(e,r)}throw new Error("invalid type "+f.bookType+" for BIFF")}function K1(e,r){var t=r||{};null!=ut&&null==t.dense&&(t.dense=ut);var s=t.dense?[]:{},o=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!o)throw new Error("Invalid HTML: could not find <table>");var f=e.match(/<\/table/i),u=o.index,p=f&&f.index||e.length,x=Ch(e.slice(u,p),/(:?<tr[^>]*>)/i,"<tr>"),_=-1,w=0,T=0,C=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},A=[];for(u=0;u<x.length;++u){var k=x[u].trim(),F=k.slice(0,3).toLowerCase();if("<tr"!=F){if("<td"==F||"<th"==F){var N=k.split(/<\/t[dh]>/i);for(p=0;p<N.length;++p){var B=N[p].trim();if(B.match(/<t[dh]/i)){for(var I=B,re=0;"<"==I.charAt(0)&&(re=I.indexOf(">"))>-1;)I=I.slice(re+1);for(var se=0;se<A.length;++se){var ee=A[se];ee.s.c==w&&ee.s.r<_&&_<=ee.e.r&&(w=ee.e.c+1,se=-1)}var V=mt(B.slice(0,B.indexOf(">")));C=V.colspan?+V.colspan:1,((T=+V.rowspan)>1||C>1)&&A.push({s:{r:_,c:w},e:{r:_+(T||1)-1,c:w+C-1}});var ne=V.t||V["data-t"]||"";if(!I.length){w+=C;continue}if(I=no(I),E.s.r>_&&(E.s.r=_),E.e.r<_&&(E.e.r=_),E.s.c>w&&(E.s.c=w),E.e.c<w&&(E.e.c=w),!I.length){w+=C;continue}var te={t:"s",v:I};t.raw||!I.trim().length||"s"==ne||("TRUE"===I?te={t:"b",v:!0}:"FALSE"===I?te={t:"b",v:!1}:isNaN(Hn(I))?isNaN(Sa(I).getDate())||(te={t:"d",v:Zt(I)},t.cellDates||(te={t:"n",v:Ir(te.v)}),te.z=t.dateNF||vt[14]):te={t:"n",v:Hn(I)}),t.dense?(s[_]||(s[_]=[]),s[_][w]=te):s[bt({r:_,c:w})]=te,w+=C}}}}else{if(++_,t.sheetRows&&t.sheetRows<=_){--_;break}w=0}}return s["!ref"]=Et(E),A.length&&(s["!merges"]=A),s}function J1(e,r,t,s){for(var o=e["!merges"]||[],f=[],u=r.s.c;u<=r.e.c;++u){for(var p=0,x=0,_=0;_<o.length;++_)if(!(o[_].s.r>t||o[_].s.c>u||o[_].e.r<t||o[_].e.c<u)){if(o[_].s.r<t||o[_].s.c<u){p=-1;break}p=o[_].e.r-o[_].s.r+1,x=o[_].e.c-o[_].s.c+1;break}if(!(p<0)){var w=bt({r:t,c:u}),T=s.dense?(e[t]||[])[u]:e[w],C=T&&null!=T.v&&(T.h||lc(T.w||(Vn(T),T.w)||""))||"",E={};p>1&&(E.rowspan=p),x>1&&(E.colspan=x),s.editable?C='<span contenteditable="true">'+C+"</span>":T&&(E["data-t"]=T&&T.t||"z",null!=T.v&&(E["data-v"]=T.v),null!=T.z&&(E["data-z"]=T.z),T.l&&"#"!=(T.l.Target||"#").charAt(0)&&(C='<a href="'+T.l.Target+'">'+C+"</a>")),E.id=(s.id||"sjs")+"-"+w,f.push(Ue("td",C,E))}}return"<tr>"+f.join("")+"</tr>"}var Q1='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',q1="</body></html>";function tx(e,r){var t=r||{},o=null!=t.footer?t.footer:q1,f=[null!=t.header?t.header:Q1],u=on(e["!ref"]);t.dense=Array.isArray(e),f.push(function ex(e,r,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var p=u.s.r;p<=u.e.r;++p)f.push(J1(e,u,p,t));return f.push("</table>"+o),f.join("")}function rx(e,r,t){var s=t||{};null!=ut&&(s.dense=ut);var o=0,f=0;if(null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var u="string"==typeof s.origin?pr(s.origin):s.origin;o=u.r,f=u.c}var p=r.getElementsByTagName("tr"),x=Math.min(s.sheetRows||1e7,p.length),_={s:{r:0,c:0},e:{r:o,c:f}};if(e["!ref"]){var w=on(e["!ref"]);_.s.r=Math.min(_.s.r,w.s.r),_.s.c=Math.min(_.s.c,w.s.c),_.e.r=Math.max(_.e.r,w.e.r),_.e.c=Math.max(_.e.c,w.e.c),-1==o&&(_.e.r=o=w.e.r+1)}var T=[],C=0,E=e["!rows"]||(e["!rows"]=[]),A=0,k=0,F=0,N=0,B=0,I=0;for(e["!cols"]||(e["!cols"]=[]);A<p.length&&k<x;++A){var re=p[A];if(ix(re)){if(s.display)continue;E[k]={hidden:!0}}var se=re.children;for(F=N=0;F<se.length;++F){var ee=se[F];if(!s.display||!ix(ee)){var V=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):no(ee.innerHTML),ne=ee.getAttribute("data-z")||ee.getAttribute("z");for(C=0;C<T.length;++C){var te=T[C];te.s.c==N+f&&te.s.r<k+o&&k+o<=te.e.r&&(N=te.e.c+1-f,C=-1)}I=+ee.getAttribute("colspan")||1,((B=+ee.getAttribute("rowspan")||1)>1||I>1)&&T.push({s:{r:k+o,c:N+f},e:{r:k+o+(B||1)-1,c:N+f+(I||1)-1}});var ge={t:"s",v:V},_e=ee.getAttribute("data-t")||ee.getAttribute("t")||"";null!=V&&(0==V.length?ge.t=_e||"z":s.raw||0==V.trim().length||"s"==_e||("TRUE"===V?ge={t:"b",v:!0}:"FALSE"===V?ge={t:"b",v:!1}:isNaN(Hn(V))?isNaN(Sa(V).getDate())||(ge={t:"d",v:Zt(V)},s.cellDates||(ge={t:"n",v:Ir(ge.v)}),ge.z=s.dateNF||vt[14]):ge={t:"n",v:Hn(V)})),void 0===ge.z&&null!=ne&&(ge.z=ne);var ae="",ze=ee.getElementsByTagName("A");if(ze&&ze.length)for(var nt=0;nt<ze.length&&(!ze[nt].hasAttribute("href")||"#"==(ae=ze[nt].getAttribute("href")).charAt(0));++nt);ae&&"#"!=ae.charAt(0)&&(ge.l={Target:ae}),s.dense?(e[k+o]||(e[k+o]=[]),e[k+o][N+f]=ge):e[bt({c:N+f,r:k+o})]=ge,_.e.c<N+f&&(_.e.c=N+f),N+=I}}++k}return T.length&&(e["!merges"]=(e["!merges"]||[]).concat(T)),_.e.r=Math.max(_.e.r,k-1+o),e["!ref"]=Et(_),k>=x&&(e["!fullref"]=Et((_.e.r=p.length-A+k-1+o,_))),e}function nx(e,r){return rx((r||{}).dense?[]:{},e,r)}function ix(e){var r="",t=function G_(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),"none"===r}function j_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,o){return Array(parseInt(o,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[zt(r.replace(/<[^>]*>/g,""))]}var ax={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sx(e,r){var t=r||{};null!=ut&&null==t.dense&&(t.dense=ut);var f,u,w,T,k,F,s=hc(e),o=[],p={name:""},x="",_=0,C={},E=[],A=t.dense?[]:{},N={value:""},B="",I=0,se=[],ee=-1,V=-1,ne={s:{r:1e6,c:1e7},e:{r:0,c:0}},te=0,ge={},_e=[],ae={},ze=0,nt=0,$e=[],xt=1,ot=1,Nt=[],qe={Names:[]},pt={},Ee=["",""],X=[],fe={},q="",J=0,ke=!1,Ke=!1,He=0;for(qi.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");k=qi.exec(s);)switch(k[3]=k[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===k[1]?(A["!ref"]=ne.e.c>=ne.s.c&&ne.e.r>=ne.s.r?Et(ne):"A1:A1",t.sheetRows>0&&t.sheetRows<=ne.e.r&&(A["!fullref"]=A["!ref"],ne.e.r=t.sheetRows-1,A["!ref"]=Et(ne)),_e.length&&(A["!merges"]=_e),$e.length&&(A["!rows"]=$e),w.name=w.\u540d\u79f0||w.name,typeof JSON<"u"&&JSON.stringify(w),E.push(w.name),C[w.name]=A,Ke=!1):"/"!==k[0].charAt(k[0].length-2)&&(w=mt(k[0],!1),ee=V=-1,ne.s.r=ne.s.c=1e7,ne.e.r=ne.e.c=0,A=t.dense?[]:{},_e=[],$e=[],Ke=!0);break;case"table-row-group":"/"===k[1]?--te:++te;break;case"table-row":case"\u884c":if("/"===k[1]){ee+=xt,xt=1;break}if((T=mt(k[0],!1)).\u884c\u53f7?ee=T.\u884c\u53f7-1:-1==ee&&(ee=0),(xt=+T["number-rows-repeated"]||1)<10)for(He=0;He<xt;++He)te>0&&($e[ee+He]={level:te});V=-1;break;case"covered-table-cell":"/"!==k[1]&&++V,t.sheetStubs&&(t.dense?(A[ee]||(A[ee]=[]),A[ee][V]={t:"z"}):A[bt({r:ee,c:V})]={t:"z"}),B="",se=[];break;case"table-cell":case"\u6570\u636e":if("/"===k[0].charAt(k[0].length-2))++V,N=mt(k[0],!1),ot=parseInt(N["number-columns-repeated"]||"1",10),F={t:"z",v:null},N.formula&&0!=t.cellFormula&&(F.f=rh(zt(N.formula))),"string"==(N.\u6570\u636e\u7c7b\u578b||N["value-type"])&&(F.t="s",F.v=zt(N["string-value"]||""),t.dense?(A[ee]||(A[ee]=[]),A[ee][V]=F):A[bt({r:ee,c:V})]=F),V+=ot-1;else if("/"!==k[1]){B="",I=0,se=[],ot=1;var We=xt?ee+xt-1:ee;if(++V>ne.e.c&&(ne.e.c=V),V<ne.s.c&&(ne.s.c=V),ee<ne.s.r&&(ne.s.r=ee),We>ne.e.r&&(ne.e.r=We),X=[],fe={},F={t:(N=mt(k[0],!1)).\u6570\u636e\u7c7b\u578b||N["value-type"],v:null},t.cellFormula)if(N.formula&&(N.formula=zt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(ze=parseInt(N["number-matrix-rows-spanned"],10)||0,nt=parseInt(N["number-matrix-columns-spanned"],10)||0,F.F=Et(ae={s:{r:ee,c:V},e:{r:ee+ze-1,c:V+nt-1}}),Nt.push([ae,F.F])),N.formula)F.f=rh(N.formula);else for(He=0;He<Nt.length;++He)ee>=Nt[He][0].s.r&&ee<=Nt[He][0].e.r&&V>=Nt[He][0].s.c&&V<=Nt[He][0].e.c&&(F.F=Nt[He][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(ze=parseInt(N["number-rows-spanned"],10)||0,nt=parseInt(N["number-columns-spanned"],10)||0,_e.push(ae={s:{r:ee,c:V},e:{r:ee+ze-1,c:V+nt-1}})),N["number-columns-repeated"]&&(ot=parseInt(N["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=sr(N["boolean-value"]);break;case"float":case"percentage":case"currency":F.t="n",F.v=parseFloat(N.value);break;case"date":F.t="d",F.v=Zt(N["date-value"]),t.cellDates||(F.t="n",F.v=Ir(F.v)),F.z="m/d/yy";break;case"time":F.t="n",F.v=Ol(N["time-value"])/86400,t.cellDates&&(F.t="d",F.v=cs(F.v)),F.z="HH:MM:SS";break;case"number":F.t="n",F.v=parseFloat(N.\u6570\u636e\u6570\u503c);break;default:if("string"!==F.t&&"text"!==F.t&&F.t)throw new Error("Unsupported value type "+F.t);F.t="s",null!=N["string-value"]&&(B=zt(N["string-value"]),se=[])}}else{if(ke=!1,"s"===F.t&&(F.v=B||"",se.length&&(F.R=se),ke=0==I),pt.Target&&(F.l=pt),X.length>0&&(F.c=X,X=[]),B&&!1!==t.cellText&&(F.w=B),ke&&(F.t="z",delete F.v),(!ke||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=ee))for(var Ae=0;Ae<xt;++Ae){if(ot=parseInt(N["number-columns-repeated"]||"1",10),t.dense)for(A[ee+Ae]||(A[ee+Ae]=[]),A[ee+Ae][V]=0==Ae?F:tr(F);--ot>0;)A[ee+Ae][V+ot]=tr(F);else for(A[bt({r:ee+Ae,c:V})]=F;--ot>0;)A[bt({r:ee+Ae,c:V+ot})]=tr(F);ne.e.c<=V&&(ne.e.c=V)}V+=(ot=parseInt(N["number-columns-repeated"]||"1",10))-1,ot=0,F={},B="",se=[]}pt={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===k[1]){if((f=o.pop())[0]!==k[3])throw"Bad state: "+f}else"/"!==k[0].charAt(k[0].length-2)&&o.push([k[3],!0]);break;case"annotation":if("/"===k[1]){if((f=o.pop())[0]!==k[3])throw"Bad state: "+f;fe.t=B,se.length&&(fe.R=se),fe.a=q,X.push(fe)}else"/"!==k[0].charAt(k[0].length-2)&&o.push([k[3],!1]);q="",J=0,B="",I=0,se=[];break;case"creator":"/"===k[1]?q=s.slice(J,k.index):J=k.index+k[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===k[1]){if((f=o.pop())[0]!==k[3])throw"Bad state: "+f}else"/"!==k[0].charAt(k[0].length-2)&&o.push([k[3],!1]);B="",I=0,se=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===k[1]){if(ge[p.name]=x,(f=o.pop())[0]!==k[3])throw"Bad state: "+f}else"/"!==k[0].charAt(k[0].length-2)&&(x="",p=mt(k[0],!1),o.push([k[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(o[o.length-1][0]){case"time-style":case"date-style":u=mt(k[0],!1),x+=ax[k[3]]["long"===u.style?1:0]}break;case"text":if("/>"===k[0].slice(-2))break;if("/"===k[1])switch(o[o.length-1][0]){case"number-style":case"date-style":case"time-style":x+=s.slice(_,k.index)}else _=k.index+k[0].length;break;case"named-range":Ee=dl((u=mt(k[0],!1))["cell-range-address"]);var Ot={Name:u.name,Ref:Ee[0]+"!"+Ee[1]};Ke&&(Ot.Sheet=E.length),qe.Names.push(Ot);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(o[o.length-1][0])>-1)break;if("/"!==k[1]||N&&N["string-value"])mt(k[0],!1),I=k.index+k[0].length;else{var G=j_(s.slice(I,k.index));B=(B.length>0?B+"\n":"")+G[0]}break;case"database-range":if("/"===k[1])break;try{C[(Ee=dl(mt(k[0])["target-range-address"]))[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"a":if("/"!==k[1]){if(!(pt=mt(k[0],!1)).href)break;pt.Target=zt(pt.href),delete pt.href,"#"==pt.Target.charAt(0)&&pt.Target.indexOf(".")>-1?(Ee=dl(pt.Target.slice(1)),pt.Target="#"+Ee[0]+"!"+Ee[1]):pt.Target.match(/^\.\.[\\\/]/)&&(pt.Target=pt.Target.slice(3))}break;default:switch(k[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(t.WTF)throw new Error(k)}}var or={Sheets:C,SheetNames:E,Workbook:qe};return t.bookSheets&&delete or.Sheets,or}function cx(e,r){return sx(e,r)}var X_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+ds({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return vr+r}}(),lx=function(){var e=function(f){return Kt(f).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",s=function(f,u,p){var x=[];x.push('      <table:table table:name="'+Kt(u.SheetNames[p])+'" table:style-name="ta1">\n');var _=0,w=0,T=on(f["!ref"]||"A1"),C=f["!merges"]||[],E=0,A=Array.isArray(f);if(f["!cols"])for(w=0;w<=T.e.c;++w)x.push("        <table:table-column"+(f["!cols"][w]?' table:style-name="co'+f["!cols"][w].ods+'"':"")+"></table:table-column>\n");var F=f["!rows"]||[];for(_=0;_<T.s.r;++_)x.push("        <table:table-row"+(F[_]?' table:style-name="ro'+F[_].ods+'"':"")+"></table:table-row>\n");for(;_<=T.e.r;++_){for(x.push("        <table:table-row"+(F[_]?' table:style-name="ro'+F[_].ods+'"':"")+">\n"),w=0;w<T.s.c;++w)x.push(r);for(;w<=T.e.c;++w){var N=!1,B={},I="";for(E=0;E!=C.length;++E)if(!(C[E].s.c>w||C[E].s.r>_||C[E].e.c<w||C[E].e.r<_)){(C[E].s.c!=w||C[E].s.r!=_)&&(N=!0),B["table:number-columns-spanned"]=C[E].e.c-C[E].s.c+1,B["table:number-rows-spanned"]=C[E].e.r-C[E].s.r+1;break}if(N)x.push("          <table:covered-table-cell/>\n");else{var re=bt({r:_,c:w}),se=A?(f[_]||[])[w]:f[re];if(se&&se.f&&(B["table:formula"]=Kt(ig(se.f)),se.F&&se.F.slice(0,re.length)==re)){var ee=on(se.F);B["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,B["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(se){switch(se.t){case"b":I=se.v?"TRUE":"FALSE",B["office:value-type"]="boolean",B["office:boolean-value"]=se.v?"true":"false";break;case"n":I=se.w||String(se.v||0),B["office:value-type"]="float",B["office:value"]=se.v||0;break;case"s":case"str":I=null==se.v?"":se.v,B["office:value-type"]="string";break;case"d":I=se.w||Zt(se.v).toISOString(),B["office:value-type"]="date",B["office:date-value"]=Zt(se.v).toISOString(),B["table:style-name"]="ce1";break;default:x.push(r);continue}var V=e(I);if(se.l&&se.l.Target){var ne=se.l.Target;"#"!=(ne="#"==ne.charAt(0)?"#"+ag(ne.slice(1)):ne).charAt(0)&&!ne.match(/^\w+:/)&&(ne="../"+ne),V=Ue("text:a",V,{"xlink:href":ne.replace(/&/g,"&amp;")})}x.push("          "+Ue("table:table-cell",Ue("text:p",V,{}),B)+"\n")}else x.push(r)}}x.push("        </table:table-row>\n")}return x.push("      </table:table>\n"),x.join("")};return function(u,p){var x=[vr],_=ds({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),w=ds({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==p.bookType?(x.push("<office:document"+_+w+">\n"),x.push(f0().replace(/office:document-meta/g,"office:meta"))):x.push("<office:document-content"+_+">\n"),function(f,u){f.push(" <office:automatic-styles>\n"),f.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),f.push('   <number:month number:style="long"/>\n'),f.push("   <number:text>/</number:text>\n"),f.push('   <number:day number:style="long"/>\n'),f.push("   <number:text>/</number:text>\n"),f.push("   <number:year/>\n"),f.push("  </number:date-style>\n");var p=0;u.SheetNames.map(function(_){return u.Sheets[_]}).forEach(function(_){if(_&&_["!cols"])for(var w=0;w<_["!cols"].length;++w)if(_["!cols"][w]){var T=_["!cols"][w];if(null==T.width&&null==T.wpx&&null==T.wch)continue;xi(T),T.ods=p;var C=_["!cols"][w].wpx+"px";f.push('  <style:style style:name="co'+p+'" style:family="table-column">\n'),f.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+C+'"/>\n'),f.push("  </style:style>\n"),++p}});var x=0;u.SheetNames.map(function(_){return u.Sheets[_]}).forEach(function(_){if(_&&_["!rows"])for(var w=0;w<_["!rows"].length;++w)if(_["!rows"][w]){_["!rows"][w].ods=x;var T=_["!rows"][w].hpx+"px";f.push('  <style:style style:name="ro'+x+'" style:family="table-row">\n'),f.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+T+'"/>\n'),f.push("  </style:style>\n"),++x}}),f.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),f.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),f.push("  </style:style>\n"),f.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),f.push(" </office:automatic-styles>\n")}(x,u),x.push("  <office:body>\n"),x.push("    <office:spreadsheet>\n");for(var T=0;T!=u.SheetNames.length;++T)x.push(s(u.Sheets[u.SheetNames[T]],u,T));return x.push("    </office:spreadsheet>\n"),x.push("  </office:body>\n"),x.push("fods"==p.bookType?"</office:document>":"</office:document-content>"),x.join("")}}();function fx(e,r){if("fods"==r.bookType)return lx(e,r);var t=hs(),s="",o=[],f=[];return Ct(t,s="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ct(t,s="content.xml",lx(e,r)),o.push([s,"text/xml"]),f.push([s,"ContentFile"]),Ct(t,s="styles.xml",X_(e,r)),o.push([s,"text/xml"]),f.push([s,"StylesFile"]),Ct(t,s="meta.xml",vr+f0()),o.push([s,"text/xml"]),f.push([s,"MetadataFile"]),Ct(t,s="manifest.rdf",function Qh(e){var r=[vr];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=e.length;++t)r.push(Oc(e[t][0],e[t][1])),r.push(Jh("",e[t][0]));return r.push(Oc("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(f)),o.push([s,"application/rdf+xml"]),Ct(t,s="META-INF/manifest.xml",function Kh(e){var r=[vr];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}(o)),t}function zs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function w1(e){return typeof TextDecoder<"u"?(new TextDecoder).decode(e):jt(Jn(e))}function Y_(e){return typeof TextEncoder<"u"?(new TextEncoder).encode(e):Sr(ri(e))}function Qa(e){var r=e.reduce(function(o,f){return o+f.length},0),t=new Uint8Array(r),s=0;return e.forEach(function(o){t.set(o,s),s+=o.length}),t}function hx(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function bl(e,r){var t=r?r[0]:0,s=127&e[t];e:if(e[t++]>=128&&(s|=(127&e[t])<<7,e[t++]<128||(s|=(127&e[t])<<14,e[t++]<128)||(s|=(127&e[t])<<21,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),s}function nr(e){var r=new Uint8Array(7);r[0]=127&e;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Dr(e){var r=0,t=127&e[r];e:if(e[r++]>=128){if(t|=(127&e[r])<<7,e[r++]<128||(t|=(127&e[r])<<14,e[r++]<128)||(t|=(127&e[r])<<21,e[r++]<128))break e;t|=(127&e[r])<<28}return t}function Yt(e){for(var r=[],t=[0];t[0]<e.length;){var p,s=t[0],o=bl(e,t),f=7&o,u=0;if(0==(o=Math.floor(o/8)))break;switch(f){case 0:for(var x=t[0];e[t[0]++]>=128;);p=e.slice(x,t[0]);break;case 5:p=e.slice(t[0],t[0]+(u=4)),t[0]+=u;break;case 1:p=e.slice(t[0],t[0]+(u=8)),t[0]+=u;break;case 2:u=bl(e,t),p=e.slice(t[0],t[0]+u),t[0]+=u;break;default:throw new Error("PB Type ".concat(f," for Field ").concat(o," at offset ").concat(s))}var _={data:p,type:f};null==r[o]?r[o]=[_]:r[o].push(_)}return r}function rn(e){var r=[];return e.forEach(function(t,s){t.forEach(function(o){o.data&&(r.push(nr(8*s+o.type)),2==o.type&&r.push(nr(o.data.length)),r.push(o.data))})}),Qa(r)}function y1(e,r){return e?.map(function(t){return r(t.data)})||[]}function oi(e){for(var r,t=[],s=[0];s[0]<e.length;){var o=bl(e,s),f=Yt(e.slice(s[0],s[0]+o));s[0]+=o;var u={id:Dr(f[1][0].data),messages:[]};f[2].forEach(function(p){var x=Yt(p.data),_=Dr(x[3][0].data);u.messages.push({meta:x,data:e.slice(s[0],s[0]+_)}),s[0]+=_}),null!=(r=f[3])&&r[0]&&(u.merge=Dr(f[3][0].data)>>>0>0),t.push(u)}return t}function $o(e){var r=[];return e.forEach(function(t){var s=[];s[1]=[{data:nr(t.id),type:0}],s[2]=[],null!=t.merge&&(s[3]=[{data:nr(+!!t.merge),type:0}]);var o=[];t.messages.forEach(function(u){o.push(u.data),u.meta[3]=[{type:0,data:nr(u.data.length)}],s[2].push({data:rn(u.meta),type:2})});var f=rn(s);r.push(nr(f.length)),r.push(f),o.forEach(function(u){return r.push(u)})}),Qa(r)}function Q_(e,r){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=bl(r,t),o=[];t[0]<r.length;){var f=3&r[t[0]];if(0!=f){var x=0,_=0;if(1==f?(_=4+(r[t[0]]>>2&7),x=(224&r[t[0]++])<<3,x|=r[t[0]++]):(_=1+(r[t[0]++]>>2),2==f?(x=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(x=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),o=[Qa(o)],0==x)throw new Error("Invalid offset 0");if(x>o[0].length)throw new Error("Invalid offset beyond length");if(_>=x)for(o.push(o[0].slice(-x)),_-=x;_>=o[o.length-1].length;)o.push(o[o.length-1]),_-=o[o.length-1].length;o.push(o[0].slice(-x,-x+_))}else{var u=r[t[0]++]>>2;if(u<60)++u;else{var p=u-59;u=r[t[0]],p>1&&(u|=r[t[0]+1]<<8),p>2&&(u|=r[t[0]+2]<<16),p>3&&(u|=r[t[0]+3]<<24),u>>>=0,u++,t[0]+=p}o.push(r.slice(t[0],t[0]+u)),t[0]+=u}}var w=Qa(o);if(w.length!=s)throw new Error("Unexpected length: ".concat(w.length," != ").concat(s));return w}function ci(e){for(var r=[],t=0;t<e.length;){var s=e[t++],o=e[t]|e[t+1]<<8|e[t+2]<<16;r.push(Q_(s,e.slice(t+=3,t+o))),t+=o}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Qa(r)}function Go(e){for(var r=[],t=0;t<e.length;){var s=Math.min(e.length-t,268435455),o=new Uint8Array(4);r.push(o);var f=nr(s),u=f.length;r.push(f),s<=60?(u++,r.push(new Uint8Array([s-1<<2]))):s<=256?(u+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(u+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(u+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(u+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(e.slice(t,t+s)),u+=s,o[0]=0,o[1]=255&u,o[2]=u>>8&255,o[3]=u>>16&255,t+=s}return Qa(r)}function b1(e,r){var t=new Uint8Array(32),s=zs(t),o=12,f=0;switch(t[0]=5,e.t){case"n":t[1]=2,function J_(e,r,t){var s=Math.floor(0==t?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,o=t/Math.pow(10,s-6176);e[r+15]|=s>>7,e[r+14]|=(127&s)<<1;for(var f=0;o>=1;++f,o/=256)e[r+f]=255&o;e[r+15]|=t>=0?0:128}(t,o,e.v),f|=1,o+=16;break;case"b":t[1]=6,s.setFloat64(o,e.v?1:0,!0),f|=2,o+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,s.setUint32(o,r.indexOf(e.v),!0),f|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,f,!0),t.slice(0,o)}function k1(e,r){var t=new Uint8Array(32),s=zs(t),o=12,f=0;switch(t[0]=3,e.t){case"n":t[2]=2,s.setFloat64(o,e.v,!0),f|=32,o+=8;break;case"b":t[2]=6,s.setFloat64(o,e.v?1:0,!0),f|=32,o+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,s.setUint32(o,r.indexOf(e.v),!0),f|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,f,!0),t.slice(0,o)}function tv(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return function q_(e,r,t,s){var T,o=zs(e),f=o.getUint32(4,!0),u=(s>1?12:8)+4*hx(f&(s>1?3470:398)),p=-1,x=-1,_=NaN,w=new Date(2001,0,1);switch(512&f&&(p=o.getUint32(u,!0),u+=4),u+=4*hx(f&(s>1?12288:4096)),16&f&&(x=o.getUint32(u,!0),u+=4),32&f&&(_=o.getFloat64(u,!0),u+=8),64&f&&(w.setTime(w.getTime()+1e3*o.getFloat64(u,!0)),u+=8),e[2]){case 0:break;case 2:T={t:"n",v:_};break;case 3:T={t:"s",v:r[x]};break;case 5:T={t:"d",v:w};break;case 6:T={t:"b",v:_>0};break;case 7:T={t:"n",v:_/86400};break;case 8:T={t:"e",v:0};break;case 9:if(p>-1)T={t:"s",v:t[p]};else if(x>-1)T={t:"s",v:r[x]};else{if(isNaN(_))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));T={t:"n",v:_}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return T}(e,r,t,e[0]);case 5:return function ev(e,r,t){var T,s=zs(e),o=s.getUint32(8,!0),f=12,u=-1,p=-1,x=NaN,_=NaN,w=new Date(2001,0,1);switch(1&o&&(x=function K_(e,r){for(var t=(127&e[r+15])<<7|e[r+14]>>1,s=1&e[r+14],o=r+13;o>=r;--o)s=256*s+e[o];return(128&e[r+15]?-s:s)*Math.pow(10,t-6176)}(e,f),f+=16),2&o&&(_=s.getFloat64(f,!0),f+=8),4&o&&(w.setTime(w.getTime()+1e3*s.getFloat64(f,!0)),f+=8),8&o&&(p=s.getUint32(f,!0),f+=4),16&o&&(u=s.getUint32(f,!0),f+=4),e[1]){case 0:break;case 2:case 10:T={t:"n",v:x};break;case 3:T={t:"s",v:r[p]};break;case 5:T={t:"d",v:w};break;case 6:T={t:"b",v:_>0};break;case 7:T={t:"n",v:_/86400};break;case 8:T={t:"e",v:0};break;case 9:if(!(u>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)));T={t:"s",v:t[u]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)))}return T}(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function wn(e){return bl(Yt(e)[1][0].data)}function ux(e,r){var t=Yt(r.data),s=Dr(t[1][0].data),f=[];return(t[3]||[]).forEach(function(u){var p=Yt(u.data),x=Dr(p[1][0].data)>>>0;switch(s){case 1:f[x]=w1(p[3][0].data);break;case 8:var w=Yt(e[wn(p[9][0].data)][0].data),T=e[wn(w[1][0].data)][0],C=Dr(T.meta[1][0].data);if(2001!=C)throw new Error("2000 unexpected reference to ".concat(C));var E=Yt(T.data);f[x]=E[3].map(function(A){return w1(A.data)}).join("")}}),f}function av(e,r){var s={"!ref":"A1"},o=e[wn(Yt(r.data)[2][0].data)],f=Dr(o[0].meta[1][0].data);if(6001!=f)throw new Error("6000 unexpected reference to ".concat(f));return function iv(e,r,t){var s,o=Yt(r.data),f={s:{r:0,c:0},e:{r:0,c:0}};if(f.e.r=(Dr(o[6][0].data)>>>0)-1,f.e.r<0)throw new Error("Invalid row varint ".concat(o[6][0].data));if(f.e.c=(Dr(o[7][0].data)>>>0)-1,f.e.c<0)throw new Error("Invalid col varint ".concat(o[7][0].data));t["!ref"]=Et(f);var u=Yt(o[4][0].data),p=ux(e,e[wn(u[4][0].data)][0]),x=null!=(s=u[17])&&s[0]?ux(e,e[wn(u[17][0].data)][0]):[],_=Yt(u[3][0].data),w=0;_[1].forEach(function(T){var C=Yt(T.data),E=e[wn(C[2][0].data)][0],A=Dr(E.meta[1][0].data);if(6002!=A)throw new Error("6001 unexpected reference to ".concat(A));var k=function nv(e,r){var t,s=Yt(r.data),o=null!=(t=s?.[7])&&t[0]?Dr(s[7][0].data)>>>0>0?1:0:-1,f=y1(s[5],function(u){return function rv(e,r){var t,s,o,f,u,p,x,_,w,T,C,E,A,k,re,se,F=Yt(e),N=Dr(F[1][0].data)>>>0,B=Dr(F[2][0].data)>>>0,I=(null==(s=null==(t=F[8])?void 0:t[0])?void 0:s.data)&&Dr(F[8][0].data)>0||!1;if(null!=(f=null==(o=F[7])?void 0:o[0])&&f.data&&0!=r)re=null==(p=null==(u=F[7])?void 0:u[0])?void 0:p.data,se=null==(_=null==(x=F[6])?void 0:x[0])?void 0:_.data;else{if(null==(T=null==(w=F[4])?void 0:w[0])||!T.data||1==r)throw"NUMBERS Tile missing ".concat(r," cell storage");re=null==(E=null==(C=F[4])?void 0:C[0])?void 0:E.data,se=null==(k=null==(A=F[3])?void 0:A[0])?void 0:k.data}for(var ee=I?4:1,V=zs(re),ne=[],te=0;te<re.length/2;++te){var ge=V.getUint16(2*te,!0);ge<65535&&ne.push([te,ge])}if(ne.length!=B)throw"Expected ".concat(B," cells, found ").concat(ne.length);var _e=[];for(te=0;te<ne.length-1;++te)_e[ne[te][0]]=se.subarray(ne[te][1]*ee,ne[te+1][1]*ee);return ne.length>=1&&(_e[ne[ne.length-1][0]]=se.subarray(ne[ne.length-1][1]*ee)),{R:N,cells:_e}}(u,o)});return{nrows:Dr(s[4][0].data)>>>0,data:f.reduce(function(u,p){return u[p.R]||(u[p.R]=[]),p.cells.forEach(function(x,_){if(u[p.R][_])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(_));u[p.R][_]=x}),u},[])}}(0,E);k.data.forEach(function(F,N){F.forEach(function(B,I){var re=bt({r:w+N,c:I}),se=tv(B,p,x);se&&(t[re]=se)})}),w+=k.nrows})}(e,o[0],s),s}function T1(e){var r,t,s,o,f={},u=[];if(e.FullPaths.forEach(function(x){if(x.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(x){if(x.name.match(/\.iwa$/)){var _,w;try{_=ci(x.content)}catch(T){return console.log("?? "+x.content.length+" "+(T.message||T))}try{w=oi(_)}catch(T){return console.log("## "+(T.message||T))}w.forEach(function(T){f[T.id]=T.messages,u.push(T.id)})}}),!u.length)throw new Error("File has no messages");var p=(null==(o=null==(s=null==(t=null==(r=f?.[1])?void 0:r[0])?void 0:t.meta)?void 0:s[1])?void 0:o[0].data)&&1==Dr(f[1][0].meta[1][0].data)&&f[1][0];if(p||u.forEach(function(x){f[x].forEach(function(_){if(1==Dr(_.meta[1][0].data)>>>0){if(p)throw new Error("Document has multiple roots");p=_}})}),!p)throw new Error("Cannot find Document root");return function ov(e,r){var t={SheetNames:[],Sheets:{}};if(y1(Yt(r.data)[1],wn).forEach(function(f){e[f].forEach(function(u){if(2==Dr(u.meta[1][0].data)){var x=function sv(e,r){var t,s=Yt(r.data),o={name:null!=(t=s[1])&&t[0]?w1(s[1][0].data):"",sheets:[]};return y1(s[2],wn).forEach(function(u){e[u].forEach(function(p){6e3==Dr(p.meta[1][0].data)&&o.sheets.push(av(e,p))})}),o}(e,u);x.sheets.forEach(function(_,w){P1(t,_,0==w?x.name:x.name+"_"+w,!0)})}})}),0==t.SheetNames.length)throw new Error("Empty NUMBERS file");return t}(f,p)}function cv(e,r,t){var s,o,f,u;if(null==(s=e[6])||!s[0]||null==(o=e[7])||!o[0])throw"Mutation only works on post-BNC storages!";if((null==(u=null==(f=e[8])?void 0:f[0])?void 0:u.data)&&Dr(e[8][0].data)>0)throw"Math only works with normal offsets";for(var x=0,_=zs(e[7][0].data),w=0,T=[],C=zs(e[4][0].data),E=0,A=[],k=0;k<r.length;++k)if(null!=r[k]){var F,N;switch(_.setUint16(2*k,w,!0),C.setUint16(2*k,E,!0),typeof r[k]){case"string":F=b1({t:"s",v:r[k]},t),N=k1({t:"s",v:r[k]},t);break;case"number":F=b1({t:"n",v:r[k]},t),N=k1({t:"n",v:r[k]},t);break;case"boolean":F=b1({t:"b",v:r[k]},t),N=k1({t:"b",v:r[k]},t);break;default:throw new Error("Unsupported value "+r[k])}T.push(F),w+=F.length,A.push(N),E+=N.length,++x}else _.setUint16(2*k,65535,!0),C.setUint16(2*k,65535);for(e[2][0].data=nr(x);k<e[7][0].data.length/2;++k)_.setUint16(2*k,65535,!0),C.setUint16(2*k,65535,!0);return e[6][0].data=Qa(T),e[3][0].data=Qa(A),x}function dx(e){return function(t){for(var s=0;s!=e.length;++s){var o=e[s];void 0===t[o[0]]&&(t[o[0]]=o[1]),"n"===o[2]&&(t[o[0]]=Number(t[o[0]]))}}}function C1(e){dx([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function E1(e){dx([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function fv(e){return St.WS.indexOf(e)>-1?"sheet":St.CS&&e==St.CS?"chart":St.DS&&e==St.DS?"dialog":St.MS&&e==St.MS?"macro":e&&e.length?e:"sheet"}function uv(e,r,t,s,o,f,u,p,x,_,w,T){try{f[s]=La(Tn(e,t,!0),r);var E,C=xr(e,r);switch(p){case"sheet":E=Bx(C,r,o,x,f[s],_,w,T);break;case"chart":if(!(E=function Ux(e,r,t,s,o,f,u,p){return".bin"===r.slice(-4)?function Pe(e,r,t,s,o){if(!e)return e;s||(s={"!id":{}});var f={"!type":"chart","!drawel":null,"!rel":""},u=[],p=!1;return ni(e,function(_,w,T){switch(T){case 550:f["!rel"]=_;break;case 651:o.Sheets[t]||(o.Sheets[t]={}),_.name&&(o.Sheets[t].CodeName=_.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:p=!0;break;case 36:p=!1;break;case 37:u.push(T);break;case 38:u.pop();break;default:if(w.T>0)u.push(T);else if(w.T<0)u.pop();else if(!p||r.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}},r),s["!id"][f["!rel"]]&&(f["!drawel"]=s["!id"][f["!rel"]]),f}(e,s,t,o,f):function Ie(e,r,t,s,o){if(!e)return e;s||(s={"!id":{}});var u,f={"!type":"chart","!drawel":null,"!rel":""},p=e.match(ih);return p&&ml(p[0],0,o,t),(u=e.match(/drawing r:id="(.*?)"/))&&(f["!rel"]=u[1]),s["!id"][f["!rel"]]&&(f["!drawel"]=s["!id"][f["!rel"]]),f}(e,0,t,o,f)}(C,r,o,x,f[s],_))||!E["!drawel"])break;var A=ar(E["!drawel"].Target,r),k=Ar(A),F=function Bp(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}(Tn(e,A,!0),La(Tn(e,k,!0),A)),N=ar(F,A),B=Ar(N);E=function pe(e,r,t,s,o,f){var u=f||{"!type":"chart"};if(!e)return f;var p=0,x=0,_="A",w={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(T){var C=function xe(e){var s,r=[],t=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(f){var u=f.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);u&&(r[+u[1]]=t?+u[2]:u[2])});var o=zt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(f){s=f.replace(/<.*?>/g,"")}),[r,o,s]}(T);w.s.r=w.s.c=0,w.e.c=p,_=$t(p),C[0].forEach(function(E,A){u[_+yr(A)]={t:"n",v:E,z:C[1]},x=A}),w.e.r<x&&(w.e.r=x),++p}),p>0&&(u["!ref"]=Et(w)),u}(Tn(e,N,!0),0,0,La(Tn(e,B,!0),N),0,E);break;case"macro":E=function Hx(e,r,t,s,o,f,u,p){return r.slice(-4),{"!type":"macro"}}(0,r);break;case"dialog":E=function Wx(e,r,t,s,o,f,u,p){return r.slice(-4),{"!type":"dialog"}}(0,r);break;default:throw new Error("Unrecognized sheet type "+p)}u[s]=E;var I=[];f&&f[s]&&fr(f[s]).forEach(function(re){var se="";if(f[s][re].Type==St.CMNT){se=ar(f[s][re].Target,r);var ee=function Gx(e,r,t){return".bin"===r.slice(-4)?function Gp(e,r){var t=[],s=[],o={},f=!1;return ni(e,function(p,x,_){switch(_){case 632:s.push(p);break;case 635:o=p;break;case 637:o.t=p.t,o.h=p.h,o.r=p.r;break;case 636:if(o.author=s[o.iauthor],delete o.iauthor,r.sheetRows&&o.rfx&&r.sheetRows<=o.rfx.r)break;o.t||(o.t=""),delete o.rfx,t.push(o);break;case 3072:case 37:case 38:break;case 35:f=!0;break;case 36:f=!1;break;default:if(!x.T&&(!f||r.WTF))throw new Error("Unexpected record 0x"+_.toString(16))}}),t}(e,t):function Up(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],s=[],o=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);o&&o[1]&&o[1].split(/<\/\w*:?author>/).forEach(function(u){if(""!==u&&""!==u.trim()){var p=u.match(/<(?:\w+:)?author[^>]*>(.*)/);p&&t.push(p[1])}});var f=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return f&&f[1]&&f[1].split(/<\/\w*:?comment>/).forEach(function(u){if(""!==u&&""!==u.trim()){var p=u.match(/<(?:\w+:)?comment[^>]*>/);if(p){var x=mt(p[0]),_={author:x.authorId&&t[x.authorId]||"sheetjsghost",ref:x.ref,guid:x.guid},w=pr(x.ref);if(!(r.sheetRows&&r.sheetRows<=w.r)){var T=u.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),C=!!T&&!!T[1]&&Eo(T[1])||{r:"",t:"",h:""};_.r=C.r,"<t></t>"==C.r&&(C.t=C.h=""),_.t=(C.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(_.h=C.h),s.push(_)}}}}),s}(e,t)}(xr(e,se,!0),se,x);if(!ee||!ee.length)return;If(E,ee,!1)}f[s][re].Type==St.TCMNT&&(se=ar(f[s][re].Target,r),I=I.concat(function Hp(e,r){var t=[],s=!1,o={},f=0;return e.replace($r,function(p,x){var _=mt(p);switch(Cn(_[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":o={author:_.personId,guid:_.id,ref:_.ref,T:1};break;case"</threadedComment>":null!=o.t&&t.push(o);break;case"<text>":case"<text":f=x+p.length;break;case"</text>":o.t=e.slice(f,x).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":s=!0;break;case"</mentions>":case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+_[0]+" in threaded comments")}return p}),t}(xr(e,se,!0),x)))}),I&&I.length&&If(E,I,!0,x.people||[])}catch(re){if(x.WTF)throw re}}function li(e){return"/"==e.charAt(0)?e.slice(1):e}function dv(e,r){if(ve(),C1(r=r||{}),kn(e,"META-INF/manifest.xml")||kn(e,"objectdata.xml"))return function ox(e,r){r=r||{},kn(e,"META-INF/manifest.xml")&&function l0(e,r){for(var s,o,t=hc(e);s=qi.exec(t);)switch(s[3]){case"manifest":break;case"file-entry":if("/"==(o=mt(s[0],!1)).path&&o.type!==Zh)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw s}}(xr(e,"META-INF/manifest.xml"),r);var t=Tn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var s=sx(jt(t),r);return kn(e,"meta.xml")&&(s.Props=h0(xr(e,"meta.xml"))),s}(e,r);if(kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return T1(e);var t=et.utils.cfb_new();return eo(e).forEach(function(nt){Ct(t,nt,Si(e,nt))}),T1(t)}if(!kn(e,"[Content_Types].xml"))throw kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var u,p,s=eo(e),o=function vs(e){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return r;var t={};if((e.match($r)||[]).forEach(function(s){var o=mt(s);switch(o[0].replace(sc,"<")){case"<?xml":break;case"<Types":r.xmlns=o["xmlns"+(o[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[o.Extension]=o.ContentType;break;case"<Override":void 0!==r[Fc[o.ContentType]]&&r[Fc[o.ContentType]].push(o.PartName)}}),r.xmlns!==Cr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}(Tn(e,"[Content_Types].xml")),f=!1;if(0===o.workbooks.length&&xr(e,p="xl/workbook.xml",!0)&&o.workbooks.push(p),0===o.workbooks.length){if(!xr(e,p="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(p),f=!0}"bin"==o.workbooks[0].slice(-3)&&(f=!0);var x={},_={};if(!r.bookSheets&&!r.bookProps){if(Bs=[],o.sst)try{Bs=function $x(e,r,t){return".bin"===r.slice(-4)?function bd(e,r){var t=[],s=!1;return ni(e,function(f,u,p){switch(p){case 159:t.Count=f[0],t.Unique=f[1];break;case 19:t.push(f);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(!s||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}),t}(e,t):function df(e,r){var t=[],s="";if(!e)return t;var o=e.match(So);if(o){s=o[2].replace(uf,"").split(yd);for(var f=0;f!=s.length;++f){var u=Eo(s[f].trim(),r);null!=u&&(t[t.length]=u)}o=mt(o[1]),t.Count=o.count,t.Unique=o.uniqueCount}return t}(e,t)}(xr(e,li(o.sst)),o.sst,r)}catch(nt){if(r.WTF)throw nt}r.cellStyles&&o.themes.length&&(x=function zx(e,r,t){return Sf(e,t)}(Tn(e,o.themes[0].replace(/^\//,""),!0)||"",0,r)),o.style&&(_=function Vx(e,r,t,s){return".bin"===r.slice(-4)?function sp(e,r,t){var s={NumberFmt:[]};for(var o in vt)s.NumberFmt[o]=vt[o];s.CellXf=[],s.Fonts=[];var f=[],u=!1;return ni(e,function(x,_,w){switch(w){case 44:s.NumberFmt[x[0]]=x[1],Q(x[1],x[0]);break;case 43:s.Fonts.push(x),null!=x.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(x.color.rgb=Do(r.themeElements.clrScheme[x.color.theme].rgb,x.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==f[f.length-1]&&s.CellXf.push(x);break;case 35:u=!0;break;case 36:u=!1;break;case 37:f.push(w),u=!0;break;case 38:f.pop(),u=!1;break;default:if(_.T>0)f.push(w);else if(_.T<0)f.pop();else if(!u||t.WTF&&37!=f[f.length-1])throw new Error("Unexpected record 0x"+w.toString(16))}}),s}(e,t,s):Ro(e,t,s)}(xr(e,li(o.style)),o.style,x,r))}o.links.map(function(nt){try{return La(Tn(e,Ar(li(nt))),nt),function Xx(e,r,t,s){return".bin"===t.slice(-4)?function Np(e,r,t,s){if(!e)return e;var o=s||{},f=!1;ni(e,function(x,_,w){switch(w){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:f=!0;break;case 36:f=!1;break;default:if(!_.T&&(!f||o.WTF))throw new Error("Unexpected record 0x"+w.toString(16))}},o)}(e,0,0,s):void 0}(xr(e,li(nt)),0,nt,r)}catch{}});var w=function Nx(e,r,t){return".bin"===r.slice(-4)?function Ox(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],o=!1;r||(r={}),r.biff=12;var f=[],u=[[]];return u.SheetNames=[],u.XTI=[],wl[16]={n:"BrtFRTArchID$",f:Fx},ni(e,function(x,_,w){switch(w){case 156:u.SheetNames.push(x.name),t.Sheets.push(x);break;case 153:t.WBProps=x;break;case 39:null!=x.Sheet&&(r.SID=x.Sheet),x.Ref=Yr(x.Ptg,0,null,u,r),delete r.SID,delete x.Ptg,f.push(x);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:u[0].length?u.push([w,x]):u[0]=[w,x],u[u.length-1].XTI=[];break;case 362:0===u.length&&(u[0]=[],u[0].XTI=[]),u[u.length-1].XTI=u[u.length-1].XTI.concat(x),u.XTI=u.XTI.concat(x);break;case 35:case 37:s.push(w),o=!0;break;case 36:case 38:s.pop(),o=!1;break;default:if(!_.T&&(!o||r.WTF&&37!=s[s.length-1]&&35!=s[s.length-1]))throw new Error("Unexpected record 0x"+w.toString(16))}},r),vn(t),t.Names=f,t.supbooks=u,t}(e,t):function zo(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,o="xmlns",f={},u=0;if(e.replace($r,function(x,_){var w=mt(x);switch(Cn(w[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":x.match(Ja)&&(o="xmlns"+x.match(/<(\w+):/)[1]),t.xmlns=w[o];break;case"<fileVersion":delete w[0],t.AppVersion=w;break;case"<workbookPr":case"<workbookPr/>":Ve.forEach(function(T){if(null!=w[T[0]])switch(T[2]){case"bool":t.WBProps[T[0]]=sr(w[T[0]]);break;case"int":t.WBProps[T[0]]=parseInt(w[T[0]],10);break;default:t.WBProps[T[0]]=w[T[0]]}}),w.codeName&&(t.WBProps.CodeName=jt(w.codeName));break;case"<workbookView":case"<workbookView/>":delete w[0],t.WBView.push(w);break;case"<sheet":switch(w.state){case"hidden":w.Hidden=1;break;case"veryHidden":w.Hidden=2;break;default:w.Hidden=0}delete w.state,w.name=zt(jt(w.name)),delete w[0],t.Sheets.push(w);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":s=!1;break;case"<definedName":(f={}).Name=jt(w.name),w.comment&&(f.Comment=w.comment),w.localSheetId&&(f.Sheet=+w.localSheetId),sr(w.hidden||"0")&&(f.Hidden=!0),u=_+x.length;break;case"</definedName>":f.Ref=zt(jt(e.slice(u,_))),t.Names.push(f);break;case"<calcPr":case"<calcPr/>":delete w[0],t.CalcPr=w;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+w[0]+" in workbook")}return x}),-1===Di.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return vn(t),t}(e,t)}(xr(e,li(o.workbooks[0])),o.workbooks[0],r),T={},C="";o.coreprops.length&&((C=xr(e,li(o.coreprops[0]),!0))&&(T=h0(C)),0!==o.extprops.length&&(C=xr(e,li(o.extprops[0]),!0))&&function eu(e,r,t){var s={};r||(r={}),e=jt(e),Mi.forEach(function(o){var f=(e.match(In(o[0]))||[])[1];switch(o[2]){case"string":f&&(r[o[1]]=zt(f));break;case"bool":r[o[1]]="true"===f;break;case"raw":var u=e.match(new RegExp("<"+o[0]+"[^>]*>([\\s\\S]*?)</"+o[0]+">"));u&&u.length>0&&(s[o[1]]=u[1])}}),s.HeadingPairs&&s.TitlesOfParts&&d0(s.HeadingPairs,s.TitlesOfParts,r,t)}(C,T,r));var E={};(!r.bookSheets||r.bookProps)&&0!==o.custprops.length&&(C=Tn(e,li(o.custprops[0]),!0))&&(E=function ru(e,r){var t={},s="",o=e.match(tu);if(o)for(var f=0;f!=o.length;++f){var u=o[f],p=mt(u);switch(p[0]){case"<?xml":case"<Properties":break;case"<property":s=zt(p.name);break;case"</property>":s=null;break;default:if(0===u.indexOf("<vt:")){var x=u.split(">"),_=x[0].slice(4),w=x[1];switch(_){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[s]=zt(w);break;case"bool":t[s]=sr(w);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[s]=parseInt(w,10);break;case"r4":case"r8":case"decimal":t[s]=parseFloat(w);break;case"filetime":case"date":t[s]=Zt(w);break;default:if("/"==_.slice(-1))break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",u,_,x)}}else if("</"!==u.slice(0,2)&&r.WTF)throw new Error(u)}}return t}(C,r));var A={};if((r.bookSheets||r.bookProps)&&(w.Sheets?u=w.Sheets.map(function($e){return $e.name}):T.Worksheets&&T.SheetNames.length>0&&(u=T.SheetNames),r.bookProps&&(A.Props=T,A.Custprops=E),r.bookSheets&&typeof u<"u"&&(A.SheetNames=u),r.bookSheets?A.SheetNames:r.bookProps))return A;u={};var k={};r.bookDeps&&o.calcchain&&(k=function jx(e,r,t){return".bin"===r.slice(-4)?function Lp(e,r,t){var s=[];return ni(e,function(u,p,x){if(63===x)s.push(u);else if(!p.T)throw new Error("Unexpected record 0x"+x.toString(16))}),s}(e):function Mp(e){var r=[];if(!e)return r;var t=1;return(e.match($r)||[]).forEach(function(s){var o=mt(s);switch(o[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete o[0],o.i?t=o.i:o.i=t,r.push(o)}}),r}(e)}(xr(e,li(o.calcchain)),o.calcchain));var B,I,F=0,N={},re=w.Sheets;T.Worksheets=re.length,T.SheetNames=[];for(var se=0;se!=re.length;++se)T.SheetNames[se]=re[se].name;var ee=f?"bin":"xml",V=o.workbooks[0].lastIndexOf("/"),ne=(o.workbooks[0].slice(0,V+1)+"_rels/"+o.workbooks[0].slice(V+1)+".rels").replace(/^\//,"");kn(e,ne)||(ne="xl/_rels/workbook."+ee+".rels");var te=La(Tn(e,ne,!0),ne.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(r.xlmeta=function Yx(e,r,t){return".bin"===r.slice(-4)?function Op(e,r,t){var s={Types:[],Cell:[],Value:[]},o=t||{},f=[],u=!1,p=2;return ni(e,function(x,_,w){switch(w){case 335:s.Types.push({name:x.name});break;case 51:x.forEach(function(T){1==p?s.Cell.push({type:s.Types[T[0]-1].name,index:T[1]}):0==p&&s.Value.push({type:s.Types[T[0]-1].name,index:T[1]})});break;case 337:p=x?1:0;break;case 338:p=2;break;case 35:f.push(w),u=!0;break;case 36:f.pop(),u=!1;break;default:if(!_.T&&(!u||o.WTF&&35!=f[f.length-1]))throw new Error("Unexpected record 0x"+w.toString(16))}}),s}(e,0,t):function Pp(e,r,t){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var u,o=!1,f=2;return e.replace($r,function(p){var x=mt(p);switch(Cn(x[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":s.Types.push({name:x.name});break;case"<futureMetadata":for(var _=0;_<s.Types.length;++_)s.Types[_].name==x.name&&(u=s.Types[_]);break;case"<rc":1==f?s.Cell.push({type:s.Types[x.t-1].name,index:+x.v}):0==f&&s.Value.push({type:s.Types[x.t-1].name,index:+x.v});break;case"<cellMetadata":f=1;break;case"</cellMetadata>":case"</valueMetadata>":f=2;break;case"<valueMetadata":f=0;break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!u)break;u.offsets||(u.offsets=[]),u.offsets.push(+x.i);break;default:if(!o&&t.WTF)throw new Error("unrecognized "+x[0]+" in metadata")}return p}),s}(e,0,t)}(xr(e,li(o.metadata[0])),o.metadata[0],r)),(o.people||[]).length>=1&&(r.people=function nl(e,r){var t=[],s=!1;return e.replace($r,function(f){var u=mt(f);switch(Cn(u[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:u.displayname,id:u.id});break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return f}),t}(xr(e,li(o.people[0])),r)),te&&(te=function hv(e,r){if(!e)return 0;try{e=r.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,fv(e["!id"][s.id].Type)]})}catch{return null}return e&&0!==e.length?e:null}(te,w.Sheets));var ge=xr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=T.Worksheets;++F){var _e="sheet";if(te&&te[F]?(B="xl/"+te[F][1].replace(/[\/]?xl\//,""),kn(e,B)||(B=te[F][1]),kn(e,B)||(B=ne.replace(/_rels\/.*$/,"")+te[F][1]),_e=te[F][2]):B=(B="xl/worksheets/sheet"+(F+1-ge)+"."+ee).replace(/sheet0\./,"sheet."),I=B.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(F!=r.sheets)continue e;break;case"string":if(T.SheetNames[F].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var ae=!1,ze=0;ze!=r.sheets.length;++ze)"number"==typeof r.sheets[ze]&&r.sheets[ze]==F&&(ae=1),"string"==typeof r.sheets[ze]&&r.sheets[ze].toLowerCase()==T.SheetNames[F].toLowerCase()&&(ae=1);if(!ae)continue e}}uv(e,B,I,T.SheetNames[F],F,N,u,_e,r,w,x,_)}return A={Directory:o,Workbook:w,Props:T,Custprops:E,Deps:k,Sheets:u,SheetNames:T.SheetNames,Strings:Bs,Styles:_,Themes:x,SSF:tr(vt)},r&&r.bookFiles&&(e.files?(A.keys=s,A.files=e.files):(A.keys=[],A.files={},e.FullPaths.forEach(function(nt,$e){nt=nt.replace(/^Root Entry[\/]/,""),A.keys.push(nt),A.files[nt]=e.FileIndex[$e]}))),r&&r.bookVBA&&(o.vba.length>0?A.vbaraw=xr(e,li(o.vba[0]),!0):o.defaults&&o.defaults.bin===Xp&&(A.vbaraw=xr(e,"xl/vbaProject.bin",!0))),A}function pv(e,r){var t=r||{},s="Workbook",o=et.find(e,s);try{if(!(o=et.find(e,s="/!DataSpaces/Version"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(function Ed(e){var r={};r.id=e.read_shift(0,"lpp4"),r.R=si(e,4),r.U=si(e,4),r.W=si(e,4)}(o.content),!(o=et.find(e,s="/!DataSpaces/DataSpaceMap"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=function xf(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Sd(e));return r}(o.content);if(1!==f.length||1!==f[0].comps.length||0!==f[0].comps[0].t||"StrongEncryptionDataSpace"!==f[0].name||"EncryptedPackage"!==f[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+s);if(!(o=et.find(e,s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var u=function Ao(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}(o.content);if(1!=u.length||"StrongEncryptionTransform"!=u[0])throw new Error("ECMA-376 Encrypted file bad "+s);if(!(o=et.find(e,s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);!function Ss(e){var r=function Ad(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=si(e,4),r.U=si(e,4),r.W=si(e,4),r}(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return r}(o.content)}catch{}if(!(o=et.find(e,s="/EncryptionInfo"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var p=function _f(e){var r=si(e);switch(r.Minor){case 2:return[r.Minor,Fd(e)];case 3:return[r.Minor,Dd()];case 4:return[r.Minor,Od(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}(o.content);if(!(o=et.find(e,s="/EncryptedPackage"))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(4==p[0]&&typeof decrypt_agile<"u")return decrypt_agile(p[1],o.content,t.password||"",t);if(2==p[0]&&typeof decrypt_std76<"u")return decrypt_std76(p[1],o.content,t.password||"",t);throw new Error("File is password-protected")}function mv(e,r){return"ods"==r.bookType?fx(e,r):"numbers"==r.bookType?function lv(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=on(t["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>9&&(o=!0,s.e.c=9),s.e.r>49&&(o=!0,s.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(Et(s)));var f=yh(t,{range:s,header:1}),u=["~Sh33tJ5~"];f.forEach(function(q){return q.forEach(function(J){"string"==typeof J&&u.push(J)})});var p={},x=[],_=et.read(r.numbers,{type:"base64"});_.FileIndex.map(function(q,J){return[q,_.FullPaths[J]]}).forEach(function(q){var J=q[0],ke=q[1];2==J.type&&J.name.match(/\.iwa/)&&oi(ci(J.content)).forEach(function(Ae){x.push(Ae.id),p[Ae.id]={deps:[],location:ke,type:Dr(Ae.messages[0].meta[1][0].data)}})}),x.sort(function(q,J){return q-J});var w=x.filter(function(q){return q>1}).map(function(q){return[q,nr(q)]});_.FileIndex.map(function(q,J){return[q,_.FullPaths[J]]}).forEach(function(q){var J=q[0];J.name.match(/\.iwa/)&&oi(ci(J.content)).forEach(function(He){He.messages.forEach(function(We){w.forEach(function(Ae){He.messages.some(function(Ot){return 11006!=Dr(Ot.meta[1][0].data)&&function Z_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var s=0;s<r.length;++s)if(e[t+s]!=r[s])continue e;return!0}return!1}(Ot.data,Ae[1])})&&p[Ae[0]].deps.push(He.id)})})})});for(var A,C=et.find(_,p[1].location),E=oi(ci(C.content)),k=0;k<E.length;++k){var F=E[k];1==F.id&&(A=F)}var N=wn(Yt(A.messages[0].data)[1][0].data);for(E=oi(ci((C=et.find(_,p[N].location)).content)),k=0;k<E.length;++k)(F=E[k]).id==N&&(A=F);for(N=wn(Yt(A.messages[0].data)[2][0].data),E=oi(ci((C=et.find(_,p[N].location)).content)),k=0;k<E.length;++k)(F=E[k]).id==N&&(A=F);for(N=wn(Yt(A.messages[0].data)[2][0].data),E=oi(ci((C=et.find(_,p[N].location)).content)),k=0;k<E.length;++k)(F=E[k]).id==N&&(A=F);var B=Yt(A.messages[0].data);B[6][0].data=nr(s.e.r+1),B[7][0].data=nr(s.e.c+1);for(var I=wn(B[46][0].data),re=et.find(_,p[I].location),se=oi(ci(re.content)),ee=0;ee<se.length&&se[ee].id!=I;++ee);if(se[ee].id!=I)throw"Bad ColumnRowUIDMapArchive";var V=Yt(se[ee].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var ne=0;ne<=s.e.c;++ne){var te=[];te[1]=te[2]=[{type:0,data:nr(ne+420690)}],V[1].push({type:2,data:rn(te)}),V[2].push({type:0,data:nr(ne)}),V[3].push({type:0,data:nr(ne)})}V[4]=[],V[5]=[],V[6]=[];for(var ge=0;ge<=s.e.r;++ge)(te=[])[1]=te[2]=[{type:0,data:nr(ge+726270)}],V[4].push({type:2,data:rn(te)}),V[5].push({type:0,data:nr(ge)}),V[6].push({type:0,data:nr(ge)});se[ee].messages[0].data=rn(V),re.content=Go($o(se)),re.size=re.content.length,delete B[46];var _e=Yt(B[4][0].data);_e[7][0].data=nr(s.e.r+1);var ze=wn(Yt(_e[1][0].data)[2][0].data);if((se=oi(ci((re=et.find(_,p[ze].location)).content)))[0].id!=ze)throw"Bad HeaderStorageBucket";var nt=Yt(se[0].messages[0].data);for(ge=0;ge<f.length;++ge){var $e=Yt(nt[2][0].data);$e[1][0].data=nr(ge),$e[4][0].data=nr(f[ge].length),nt[2][ge]={type:nt[2][0].type,data:rn($e)}}se[0].messages[0].data=rn(nt),re.content=Go($o(se)),re.size=re.content.length;var xt=wn(_e[2][0].data);if((se=oi(ci((re=et.find(_,p[xt].location)).content)))[0].id!=xt)throw"Bad HeaderStorageBucket";for(nt=Yt(se[0].messages[0].data),ne=0;ne<=s.e.c;++ne)($e=Yt(nt[2][0].data))[1][0].data=nr(ne),$e[4][0].data=nr(s.e.r+1),nt[2][ne]={type:nt[2][0].type,data:rn($e)};se[0].messages[0].data=rn(nt),re.content=Go($o(se)),re.size=re.content.length;var ot=wn(_e[4][0].data);!function(){for(var ke,q=et.find(_,p[ot].location),J=oi(ci(q.content)),Ke=0;Ke<J.length;++Ke){var He=J[Ke];He.id==ot&&(ke=He)}var We=Yt(ke.messages[0].data);We[3]=[];var Ae=[];u.forEach(function(or,Ht){Ae[1]=[{type:0,data:nr(Ht)}],Ae[2]=[{type:0,data:nr(1)}],Ae[3]=[{type:2,data:Y_(or)}],We[3].push({type:2,data:rn(Ae)})}),ke.messages[0].data=rn(We);var G=Go($o(J));q.content=G,q.size=q.content.length}();var Nt=Yt(_e[3][0].data),qe=Nt[1][0];delete Nt[2];var pt=Yt(qe.data),Ee=wn(pt[2][0].data);!function(){for(var ke,q=et.find(_,p[Ee].location),J=oi(ci(q.content)),Ke=0;Ke<J.length;++Ke){var He=J[Ke];He.id==Ee&&(ke=He)}var We=Yt(ke.messages[0].data);delete We[6],delete Nt[7];var Ae=new Uint8Array(We[5][0].data);We[5]=[];for(var Ot=0,G=0;G<=s.e.r;++G){var or=Yt(Ae);Ot+=cv(or,f[G],u),or[1][0].data=nr(G),We[5].push({data:rn(or),type:2})}We[1]=[{type:0,data:nr(s.e.c+1)}],We[2]=[{type:0,data:nr(s.e.r+1)}],We[3]=[{type:0,data:nr(Ot)}],We[4]=[{type:0,data:nr(s.e.r+1)}],ke.messages[0].data=rn(We);var cr=Go($o(J));q.content=cr,q.size=q.content.length}(),qe.data=rn(pt),_e[3][0].data=rn(Nt),B[4][0].data=rn(_e),A.messages[0].data=rn(B);var fe=Go($o(E));return C.content=fe,C.size=C.content.length,_}(e,r):"xlsb"==r.bookType?function gv(e,r){Ga=1024,e&&!e.SSF&&(e.SSF=tr(vt)),e&&e.SSF&&(ve(),Z(e.SSF),r.revssf=rc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Us?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xlsb"==r.bookType?"bin":"xml",s=Rf.indexOf(r.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};E1(r=r||{});var f=hs(),u="",p=0;if(r.cellXfs=[],$i(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ct(f,u="docProps/core.xml",Ic(e.Props,r)),o.coreprops.push(u),Gt(r.rels,2,u,St.CORE_PROPS),u="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var x=[],_=0;_<e.SheetNames.length;++_)2!=(e.Workbook.Sheets[_]||{}).Hidden&&x.push(e.SheetNames[_]);e.Props.SheetNames=x}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,Ct(f,u,xo(e.Props)),o.extprops.push(u),Gt(r.rels,3,u,St.EXT_PROPS),e.Custprops!==e.Props&&fr(e.Custprops||{}).length>0&&(Ct(f,u="docProps/custom.xml",p0(e.Custprops)),o.custprops.push(u),Gt(r.rels,4,u,St.CUST_PROPS)),p=1;p<=e.SheetNames.length;++p){var w={"!id":{}},T=e.Sheets[e.SheetNames[p-1]];if(Ct(f,u="xl/worksheets/sheet"+p+"."+t,Kx(p-1,u,r,e,w)),o.sheets.push(u),Gt(r.wbrels,-1,"worksheets/sheet"+p+"."+t,St.WS[0]),T){var E=T["!comments"],A=!1,k="";E&&E.length>0&&(Ct(f,k="xl/comments"+p+"."+t,qx(E,k,r)),o.comments.push(k),Gt(w,-1,"../comments"+p+"."+t,St.CMNT),A=!0),T["!legacy"]&&A&&Ct(f,"xl/drawings/vmlDrawing"+p+".vml",Of(p,T["!comments"])),delete T["!comments"],delete T["!legacy"]}w["!id"].rId1&&Ct(f,Ar(u),Na(w))}return null!=r.Strings&&r.Strings.length>0&&(Ct(f,u="xl/sharedStrings."+t,function Qx(e,r,t){return(".bin"===r.slice(-4)?Cd:fn)(e,t)}(r.Strings,u,r)),o.strs.push(u),Gt(r.wbrels,-1,"sharedStrings."+t,St.SST)),Ct(f,u="xl/workbook."+t,function Zx(e,r,t){return(".bin"===r.slice(-4)?Lx:_a)(e,t)}(e,u,r)),o.workbooks.push(u),Gt(r.rels,1,u,St.WB),Ct(f,u="xl/theme/theme1.xml",el(e.Themes,r)),o.themes.push(u),Gt(r.wbrels,-1,"theme/theme1.xml",St.THEME),Ct(f,u="xl/styles."+t,function Jx(e,r,t){return(".bin"===r.slice(-4)?Ef:kf)(e,t)}(e,u,r)),o.styles.push(u),Gt(r.wbrels,-1,"styles."+t,St.STY),e.vbaraw&&s&&(Ct(f,u="xl/vbaProject.bin",e.vbaraw),o.vba.push(u),Gt(r.wbrels,-1,"vbaProject.bin",St.VBA)),Ct(f,u="xl/metadata."+t,function e_(e){return(".bin"===e.slice(-4)?Ip:Df)()}(u)),o.metadata.push(u),Gt(r.wbrels,-1,"metadata."+t,St.XLMETA),Ct(f,"[Content_Types].xml",ws(o,r)),Ct(f,"_rels/.rels",Na(r.rels)),Ct(f,"xl/_rels/workbook."+t+".rels",Na(r.wbrels)),delete r.revssf,delete r.ssf,f}(e,r):function px(e,r){Ga=1024,e&&!e.SSF&&(e.SSF=tr(vt)),e&&e.SSF&&(ve(),Z(e.SSF),r.revssf=rc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Us?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",s=Rf.indexOf(r.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};E1(r=r||{});var f=hs(),u="",p=0;if(r.cellXfs=[],$i(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ct(f,u="docProps/core.xml",Ic(e.Props,r)),o.coreprops.push(u),Gt(r.rels,2,u,St.CORE_PROPS),u="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var x=[],_=0;_<e.SheetNames.length;++_)2!=(e.Workbook.Sheets[_]||{}).Hidden&&x.push(e.SheetNames[_]);e.Props.SheetNames=x}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ct(f,u,xo(e.Props)),o.extprops.push(u),Gt(r.rels,3,u,St.EXT_PROPS),e.Custprops!==e.Props&&fr(e.Custprops||{}).length>0&&(Ct(f,u="docProps/custom.xml",p0(e.Custprops)),o.custprops.push(u),Gt(r.rels,4,u,St.CUST_PROPS));var w=["SheetJ5"];for(r.tcid=0,p=1;p<=e.SheetNames.length;++p){var T={"!id":{}},C=e.Sheets[e.SheetNames[p-1]];if(Ct(f,u="xl/worksheets/sheet"+p+"."+t,lh(p-1,r,e,T)),o.sheets.push(u),Gt(r.wbrels,-1,"worksheets/sheet"+p+"."+t,St.WS[0]),C){var A=C["!comments"],k=!1,F="";if(A&&A.length>0){var N=!1;A.forEach(function(B){B[1].forEach(function(I){1==I.T&&(N=!0)})}),N&&(Ct(f,F="xl/threadedComments/threadedComment"+p+"."+t,Wp(A,w,r)),o.threadedcomments.push(F),Gt(T,-1,"../threadedComments/threadedComment"+p+"."+t,St.TCMNT)),Ct(f,F="xl/comments"+p+"."+t,Pf(A)),o.comments.push(F),Gt(T,-1,"../comments"+p+"."+t,St.CMNT),k=!0}C["!legacy"]&&k&&Ct(f,"xl/drawings/vmlDrawing"+p+".vml",Of(p,C["!comments"])),delete C["!comments"],delete C["!legacy"]}T["!id"].rId1&&Ct(f,Ar(u),Na(T))}return null!=r.Strings&&r.Strings.length>0&&(Ct(f,u="xl/sharedStrings."+t,fn(r.Strings,r)),o.strs.push(u),Gt(r.wbrels,-1,"sharedStrings."+t,St.SST)),Ct(f,u="xl/workbook."+t,_a(e)),o.workbooks.push(u),Gt(r.rels,1,u,St.WB),Ct(f,u="xl/theme/theme1.xml",el(e.Themes,r)),o.themes.push(u),Gt(r.wbrels,-1,"theme/theme1.xml",St.THEME),Ct(f,u="xl/styles."+t,kf(e,r)),o.styles.push(u),Gt(r.wbrels,-1,"styles."+t,St.STY),e.vbaraw&&s&&(Ct(f,u="xl/vbaProject.bin",e.vbaraw),o.vba.push(u),Gt(r.wbrels,-1,"vbaProject.bin",St.VBA)),Ct(f,u="xl/metadata."+t,Df()),o.metadata.push(u),Gt(r.wbrels,-1,"metadata."+t,St.XLMETA),w.length>1&&(Ct(f,u="xl/persons/person.xml",function Vp(e){var r=[vr,Ue("personList",null,{xmlns:Cr.TCMNT,"xmlns:x":Di[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,s){r.push(Ue("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}(w)),o.people.push(u),Gt(r.wbrels,-1,"persons/person.xml",St.PEOPLE)),Ct(f,"[Content_Types].xml",ws(o,r)),Ct(f,"_rels/.rels",Na(r.rels)),Ct(f,"xl/_rels/workbook.xml.rels",Na(r.wbrels)),delete r.revssf,delete r.ssf,f}(e,r)}function S1(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ut(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function mx(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return _1(e.slice(t),r);default:break e}return _n.to_workbook(e,r)}function A1(e,r,t,s){return s?(t.type="string",_n.to_workbook(e,t)):_n.to_workbook(r,t)}function vh(e,r){Ne();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return vh(new Uint8Array(e),((t=tr(t)).type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var o,s=e,f=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ka={},t.dateNF&&(Ka.dateNF=t.dateNF),t.type||(t.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==t.type&&(t.type=wt?"buffer":"binary",s=function Qs(e){if(typeof Jr<"u")return Jr.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}(e),typeof Uint8Array<"u"&&!wt&&(t.type="array")),"string"==t.type&&(f=!0,t.type="binary",t.codepage=65001,s=function yv(e){return e.match(/[^\x00-\x7F]/)?ri(e):e}(e)),"array"==t.type&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var u=new ArrayBuffer(3),p=new Uint8Array(u);if(p.foo="bar",!p.foo)return(t=tr(t)).type="array",vh(nn(s),t)}switch((o=S1(s,t))[0]){case 208:if(207===o[1]&&17===o[2]&&224===o[3]&&161===o[4]&&177===o[5]&&26===o[6]&&225===o[7])return function xv(e,r){return et.find(e,"EncryptedPackage")?pv(e,r):Y1(e,r)}(et.read(s,t),t);break;case 9:if(o[1]<=8)return Y1(s,t);break;case 60:return _1(s,t);case 73:if(73===o[1]&&42===o[2]&&0===o[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===o[1])return function md(e,r){var t=r||{},s=!!t.WTF;t.WTF=!0;try{var o=ff.to_workbook(e,t);return t.WTF=s,o}catch(f){if(t.WTF=s,!f.message.match(/SYLK bad record ID/)&&s)throw f;return _n.to_workbook(e,r)}}(s,t);break;case 84:if(65===o[1]&&66===o[2]&&76===o[3])return Wa.to_workbook(s,t);break;case 80:return 75===o[1]&&o[2]<9&&o[3]<9?function _v(e,r){var s=e,o=r||{};return o.type||(o.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),dv(Ml(s,o),o)}(s,t):A1(e,s,t,f);case 239:return 60===o[3]?_1(s,t):A1(e,s,t,f);case 255:if(254===o[1])return function wv(e,r){var t=e;return"base64"==r.type&&(t=Ut(t)),t=ue.utils.decode(1200,t.slice(2),"str"),r.type="binary",mx(t,r)}(s,t);if(0===o[1]&&2===o[2]&&0===o[3])return Hi.to_workbook(s,t);break;case 0:if(0===o[1]&&(o[2]>=2&&0===o[3]||0===o[2]&&(8===o[3]||9===o[3])))return Hi.to_workbook(s,t);break;case 3:case 131:case 139:case 140:return Ha.to_workbook(s,t);case 123:if(92===o[1]&&114===o[2]&&116===o[3])return wf.to_workbook(s,t);break;case 10:case 13:case 32:return function vv(e,r){var t="",s=S1(e,r);switch(r.type){case"base64":t=Ut(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=pi(e);break;default:throw new Error("Unrecognized type "+r.type)}return 239==s[0]&&187==s[1]&&191==s[2]&&(t=jt(t)),r.type="binary",mx(t,r)}(s,t);case 137:if(80===o[1]&&78===o[2]&&71===o[3])throw new Error("PNG Image File is not a spreadsheet")}return pd.indexOf(o[0])>-1&&o[2]<=12&&o[3]<=31?Ha.to_workbook(s,t):A1(e,s,t,f)}function gx(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Un(r.file,et.write(e,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return et.write(e,r)}function Yi(e,r,t){t||(t="");var s=t+e;switch(r.type){case"base64":return _t(ri(s));case"binary":return ri(s);case"string":return e;case"file":return Un(r.file,s,"utf8");case"buffer":return wt?hn(s,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(s):Yi(s,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function wh(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return"base64"==r.type?_t(t):"string"==r.type?jt(t):t;case"file":return Un(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function F1(e,r){Ne(),function Zr(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");!function Yn(e,r,t){e.forEach(function(s,o){kr(s);for(var f=0;f<o;++f)if(s==e[f])throw new Error("Duplicate Sheet Name: "+s);if(t){var u=r&&r[o]&&r[o].CodeName||s;if(95==u.charCodeAt(0)&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}(e.SheetNames,e.Workbook&&e.Workbook.Sheets||[],!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)sg(e.Sheets[e.SheetNames[t]],0,t)}(e);var t=tr(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var s=F1(e,t);return t.type="array",ui(s)}var o=0;if(t.sheet&&(o="number"==typeof t.sheet?t.sheet:e.SheetNames.indexOf(t.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Yi(v_(e,t),t);case"slk":case"sylk":return Yi(ff.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"htm":case"html":return Yi(tx(e.Sheets[e.SheetNames[o]],t),t);case"txt":return function Cv(e,r){switch(r.type){case"base64":return _t(e);case"binary":case"string":return e;case"file":return Un(r.file,e,"binary");case"buffer":return wt?hn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}(bx(e.Sheets[e.SheetNames[o]],t),t);case"csv":return Yi(O1(e.Sheets[e.SheetNames[o]],t),t,"\ufeff");case"dif":return Yi(Wa.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"dbf":return wh(Ha.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"prn":return Yi(_n.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"rtf":return Yi(wf.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"eth":return Yi(Xn.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"fods":return Yi(fx(e,t),t);case"wk1":return wh(Hi.sheet_to_wk1(e.Sheets[e.SheetNames[o]],t),t);case"wk3":return wh(Hi.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),wh(Z1(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),function Tv(e,r){var t=r||{};return gx(function E_(e,r){var t=r||{},s=et.utils.cfb_new({root:"R"}),o="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":o="/Workbook",t.biff=8;break;case"biff5":o="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return et.utils.cfb_add(s,o,Z1(e,t)),8==t.biff&&(e.Props||e.Custprops)&&function C_(e,r){var u,t=[],s=[],o=[],f=0,p=tc(ca,"n"),x=tc(mo,"n");if(e.Props)for(u=fr(e.Props),f=0;f<u.length;++f)(Object.prototype.hasOwnProperty.call(p,u[f])?t:Object.prototype.hasOwnProperty.call(x,u[f])?s:o).push([u[f],e.Props[u[f]]]);if(e.Custprops)for(u=fr(e.Custprops),f=0;f<u.length;++f)Object.prototype.hasOwnProperty.call(e.Props||{},u[f])||(Object.prototype.hasOwnProperty.call(p,u[f])?t:Object.prototype.hasOwnProperty.call(x,u[f])?s:o).push([u[f],e.Custprops[u[f]]]);var _=[];for(f=0;f<o.length;++f)y0.indexOf(o[f][0])>-1||u0.indexOf(o[f][0])>-1||null!=o[f][1]&&_.push(o[f]);s.length&&et.utils.cfb_add(r,"/\x05SummaryInformation",Gn(s,vl.SI,x,mo)),(t.length||_.length)&&et.utils.cfb_add(r,"/\x05DocumentSummaryInformation",Gn(t,vl.DSI,p,ca,_.length?_:null,vl.UDI))}(e,s),8==t.biff&&e.vbaraw&&function Zp(e,r){r.FullPaths.forEach(function(t,s){if(0!=s){var o=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==o.slice(-1)&&et.utils.cfb_add(e,o,r.FileIndex[s].content)}})}(s,et.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),s}(e,t),t)}(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function bv(e,r){var t=tr(r||{});return function xx(e,r){var t={},s=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=s;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var o=e.FullPaths?et.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&"string"==typeof o){if("binary"==r.type||"base64"==r.type)return o;o=new Uint8Array(ui(o))}return r.password&&typeof encrypt_agile<"u"?gx(encrypt_agile(o,r.password),r):"file"===r.type?Un(r.file,o):"string"==r.type?jt(o):o}(mv(e,t),t)}(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Ev(e,r,t){var s=t||{};return s.type="file",s.file=r,function D1(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(s),F1(e,s)}function vx(e,r,t,s,o,f,u,p){var x=yr(t),_=p.defval,w=p.raw||!Object.prototype.hasOwnProperty.call(p,"raw"),T=!0,C=1===o?[]:{};if(1!==o)if(Object.defineProperty)try{Object.defineProperty(C,"__rowNum__",{value:t,enumerable:!1})}catch{C.__rowNum__=t}else C.__rowNum__=t;if(!u||e[t])for(var E=r.s.c;E<=r.e.c;++E){var A=u?e[t][E]:e[s[E]+x];if(void 0!==A&&void 0!==A.t){var k=A.v;switch(A.t){case"z":if(null==k)break;continue;case"e":k=0==k?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+A.t)}if(null!=f[E]){if(null==k)if("e"==A.t&&null===k)C[f[E]]=null;else if(void 0!==_)C[f[E]]=_;else{if(!w||null!==k)continue;C[f[E]]=null}else C[f[E]]=w&&("n"!==A.t||"n"===A.t&&!1!==p.rawNumbers)?k:Vn(A,k,p);null!=k&&(T=!1)}}else{if(void 0===_)continue;null!=f[E]&&(C[f[E]]=_)}}return{row:C,isempty:T}}function yh(e,r){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},s=0,o=1,f=[],u=0,p="",x={s:{r:0,c:0},e:{r:0,c:0}},_=r||{},w=null!=_.range?_.range:e["!ref"];switch(1===_.header?s=1:"A"===_.header?s=2:Array.isArray(_.header)?s=3:null==_.header&&(s=0),typeof w){case"string":x=Lt(w);break;case"number":(x=Lt(e["!ref"])).s.r=w;break;default:x=w}s>0&&(o=0);var T=yr(x.s.r),C=[],E=[],A=0,k=0,F=Array.isArray(e),N=x.s.r,B=0,I={};F&&!e[N]&&(e[N]=[]);var re=_.skipHidden&&e["!cols"]||[],se=_.skipHidden&&e["!rows"]||[];for(B=x.s.c;B<=x.e.c;++B)if(!(re[B]||{}).hidden)switch(C[B]=$t(B),t=F?e[N][B]:e[C[B]+T],s){case 1:f[B]=B-x.s.c;break;case 2:f[B]=C[B];break;case 3:f[B]=_.header[B-x.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),p=u=Vn(t,null,_),k=I[u]||0){do{p=u+"_"+k++}while(I[p]);I[u]=k,I[p]=1}else I[u]=1;f[B]=p}for(N=x.s.r+o;N<=x.e.r;++N)if(!(se[N]||{}).hidden){var ee=vx(e,x,N,C,s,f,F,_);(!1===ee.isempty||(1===s?!1!==_.blankrows:_.blankrows))&&(E[A++]=ee.row)}return E.length=A,E}var wx=/"/g;function yx(e,r,t,s,o,f,u,p){for(var x=!0,_=[],w="",T=yr(t),C=r.s.c;C<=r.e.c;++C)if(s[C]){var E=p.dense?(e[t]||[])[C]:e[s[C]+T];if(null==E)w="";else if(null!=E.v){x=!1,w=""+(p.rawNumbers&&"n"==E.t?E.v:Vn(E,null,p));for(var A=0,k=0;A!==w.length;++A)if((k=w.charCodeAt(A))===o||k===f||34===k||p.forceQuotes){w='"'+w.replace(wx,'""')+'"';break}"ID"==w&&(w='"ID"')}else null==E.f||E.F?w="":(x=!1,(w="="+E.f).indexOf(",")>=0&&(w='"'+w.replace(wx,'""')+'"'));_.push(w)}return!1===p.blankrows&&x?null:_.join(u)}function O1(e,r){var t=[],s=r??{};if(null==e||null==e["!ref"])return"";var o=Lt(e["!ref"]),f=void 0!==s.FS?s.FS:",",u=f.charCodeAt(0),p=void 0!==s.RS?s.RS:"\n",x=p.charCodeAt(0),_=new RegExp(("|"==f?"\\|":f)+"+$"),w="",T=[];s.dense=Array.isArray(e);for(var C=s.skipHidden&&e["!cols"]||[],E=s.skipHidden&&e["!rows"]||[],A=o.s.c;A<=o.e.c;++A)(C[A]||{}).hidden||(T[A]=$t(A));for(var k=0,F=o.s.r;F<=o.e.r;++F)(E[F]||{}).hidden||null!=(w=yx(e,o,F,T,u,x,f,s))&&(s.strip&&(w=w.replace(_,"")),(w||!1!==s.blankrows)&&t.push((k++?p:"")+w));return delete s.dense,t.join("")}function bx(e,r){r||(r={}),r.FS="\t",r.RS="\n";var t=O1(e,r);if(typeof ue>"u"||"string"==r.type)return t;var s=ue.utils.encode(1200,t,"str");return String.fromCharCode(255)+String.fromCharCode(254)+s}function kx(e,r,t){var s=t||{},o=+!s.skipHeader,f=e||{},u=0,p=0;if(f&&null!=s.origin)if("number"==typeof s.origin)u=s.origin;else{var x="string"==typeof s.origin?pr(s.origin):s.origin;u=x.r,p=x.c}var _,w={s:{c:0,r:0},e:{c:p,r:u+r.length-1+o}};if(f["!ref"]){var T=Lt(f["!ref"]);w.e.c=Math.max(w.e.c,T.e.c),w.e.r=Math.max(w.e.r,T.e.r),-1==u&&(w.e.r=(u=T.e.r+1)+r.length-1+o)}else-1==u&&(u=0,w.e.r=r.length-1+o);var C=s.header||[],E=0;r.forEach(function(k,F){fr(k).forEach(function(N){-1==(E=C.indexOf(N))&&(C[E=C.length]=N);var B=k[N],I="z",re="",se=bt({c:p+E,r:u+F+o});_=kl(f,se),!B||"object"!=typeof B||B instanceof Date?("number"==typeof B?I="n":"boolean"==typeof B?I="b":"string"==typeof B?I="s":B instanceof Date?(I="d",s.cellDates||(I="n",B=Ir(B)),re=s.dateNF||vt[14]):null===B&&s.nullError&&(I="e",B=0),_?(_.t=I,_.v=B,delete _.w,delete _.R,re&&(_.z=re)):f[se]=_={t:I,v:B},re&&(_.z=re)):f[se]=B})}),w.e.c=Math.max(w.e.c,p+C.length-1);var A=yr(u);if(o)for(E=0;E<C.length;++E)f[$t(E+p)+A]={t:"s",v:C[E]};return f["!ref"]=Et(w),f}function kl(e,r,t){if("string"==typeof r){if(Array.isArray(e)){var s=pr(r);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return kl(e,bt("number"!=typeof r?r:{r,c:t||0}))}function P1(e,r,t,s){var o=1;if(!t)for(;o<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+o);++o,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var f=t.match(/(^.*?)(\d+)$/);o=f&&+f[2]||0;var u=f&&f[1]||t;for(++o;o<=65535&&-1!=e.SheetNames.indexOf(t=u+o);++o);}if(kr(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Tx(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}var Rv={encode_col:$t,encode_row:yr,encode_cell:bt,encode_range:Et,decode_col:_c,decode_row:co,split_cell:function Bh(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:pr,decode_range:on,format_cell:Vn,sheet_add_aoa:ql,sheet_add_json:kx,sheet_add_dom:rx,aoa_to_sheet:ra,json_to_sheet:function Av(e,r){return kx(null,e,r)},table_to_sheet:nx,table_to_book:function $_(e,r){return gi(nx(e,r),r)},sheet_to_csv:O1,sheet_to_txt:bx,sheet_to_json:yh,sheet_to_html:tx,sheet_to_formulae:function Sv(e){var t,r="",s="";if(null==e||null==e["!ref"])return[];var p,o=Lt(e["!ref"]),f="",u=[],x=[],_=Array.isArray(e);for(p=o.s.c;p<=o.e.c;++p)u[p]=$t(p);for(var w=o.s.r;w<=o.e.r;++w)for(f=yr(w),p=o.s.c;p<=o.e.c;++p)if(r=u[p]+f,s="",void 0!==(t=_?(e[w]||[])[p]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;s=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)s=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)s=""+t.v;else if("b"==t.t)s=t.v?"TRUE":"FALSE";else if(void 0!==t.w)s="'"+t.w;else{if(void 0===t.v)continue;s="s"==t.t?"'"+t.v:""+t.v}}x[x.length]=r+"="+s}return x},sheet_to_row_object_array:yh,sheet_get_cell:kl,book_new:function I1(){return{SheetNames:[],Sheets:{}}},book_append_sheet:P1,book_set_sheet_visibility:function Dv(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=function Fv(e,r){if("number"==typeof r){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(e,r);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t},cell_set_number_format:function Ov(e,r){return e.z=r,e},cell_set_hyperlink:Tx,cell_set_internal_link:function Iv(e,r,t){return Tx(e,"#"+r,t)},cell_add_comment:function Pv(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})},sheet_set_array_formula:function Mv(e,r,t,s){for(var o="string"!=typeof r?r:Lt(r),f="string"==typeof r?r:Et(r),u=o.s.r;u<=o.e.r;++u)for(var p=o.s.c;p<=o.e.c;++p){var x=kl(e,u,p);x.t="n",x.F=f,delete x.v,u==o.s.r&&p==o.s.c&&(x.f=t,s&&(x.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}}}}]);