"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[428],{428:(ke,X,l)=>{l.r(X),l.d(X,{HomeModule:()=>$e});var u=l(6814),t=l(9212),P=l(8645),T=l(3019),L=l(5592),ut=l(2438),ht=l(9397),R=l(3020),gt=l(1631),D=l(8180),b=l(7398),ft=l(9360),Ct=l(8251),E=l(2181),A=l(9773);const y=!(typeof window>"u")&&("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);function K(o,c,e,i){const n=c.querySelectorAll(o);if(n.length){const s=e.querySelectorAll(o);for(let r=0;r<n.length;r++)i(n[r],s[r])}}let xt=0;function W(o,c){"file"!==c.type&&(c.value=o.value),"radio"===c.type&&c.name&&(c.name=`mat-clone-${c.name}-${xt++}`)}function V(o,c){const e=c.getContext("2d");if(e)try{e.drawImage(o,0,0)}catch{}}function q(o,c,e,i){const n={top:o.top,bottom:o.bottom,left:o.left,right:o.right};return c.top&&(n.top+=i),c.bottom&&(n.bottom+=i),c.left&&(n.left+=e),c.right&&(n.right+=e),n.height=n.bottom-n.top,n.width=n.right-n.left,n}const tt=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function et(o,c){return o.left&&o.top?c.topLeft:o.right&&o.top?c.topRight:o.left&&o.bottom?c.bottomLeft:o.right&&o.bottom?c.bottomRight:o.left||o.right?c.leftOrRight:o.top||o.bottom?c.topOrBottom:""}function z({edges:o,initialRectangle:c,newRectangle:e}){const i={};return Object.keys(o).forEach(n=>{i[n]=(e[n]||0)-(c[n]||0)}),i}const nt="resize-active";let ot=(()=>{class o{constructor(e,i,n,s){this.platformId=e,this.renderer=i,this.elm=n,this.zone=s,this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=tt,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=50,this.resizeStart=new t.vpe,this.resizing=new t.vpe,this.resizeEnd=new t.vpe,this.mouseup=new P.x,this.mousedown=new P.x,this.mousemove=new P.x,this.destroy$=new P.x,this.pointerEventListeners=O.getInstance(i,s)}ngOnInit(){const e=(0,T.T)(this.pointerEventListeners.pointerDown,this.mousedown),i=(0,T.T)(this.pointerEventListeners.pointerMove,this.mousemove).pipe((0,ht.b)(({event:m})=>{s&&m.cancelable&&m.preventDefault()}),(0,R.B)()),n=(0,T.T)(this.pointerEventListeners.pointerUp,this.mouseup);let s;const r=()=>{s&&s.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(s.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},a=()=>({...tt,...this.resizeCursors});e.pipe((0,gt.z)(m=>{function p(d){return{clientX:d.clientX-m.clientX,clientY:d.clientY-m.clientY}}const w=()=>{const d={x:1,y:1};return s&&(this.resizeSnapGrid.left&&s.edges.left?d.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&s.edges.right&&(d.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&s.edges.top?d.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&s.edges.bottom&&(d.y=+this.resizeSnapGrid.bottom)),d};function f(d,h){return{x:Math.ceil(d.clientX/h.x),y:Math.ceil(d.clientY/h.y)}}return(0,T.T)(i.pipe((0,D.q)(1)).pipe((0,b.U)(d=>[,d])),i.pipe(function bt(){return(0,ft.e)((o,c)=>{let e,i=!1;o.subscribe((0,Ct.x)(c,n=>{const s=e;e=n,i&&c.next([s,n]),i=!0}))})}())).pipe((0,b.U)(([d,h])=>[d&&p(d),p(h)])).pipe((0,E.h)(([d,h])=>{if(!d)return!0;const B=w(),k=f(d,B),_t=f(h,B);return k.x!==_t.x||k.y!==_t.y})).pipe((0,b.U)(([,d])=>{const h=w();return{clientX:Math.round(d.clientX/h.x)*h.x,clientY:Math.round(d.clientY/h.y)*h.y}})).pipe((0,A.R)((0,T.T)(n,e)))})).pipe((0,E.h)(()=>!!s)).pipe((0,b.U)(({clientX:m,clientY:p})=>q(s.startingRect,s.edges,m,p))).pipe((0,E.h)(m=>this.allowNegativeResizes||!!(m.height&&m.width&&m.height>0&&m.width>0))).pipe((0,E.h)(m=>!this.validateResize||this.validateResize({rectangle:m,edges:z({edges:s.edges,initialRectangle:s.startingRect,newRectangle:m})})),(0,A.R)(this.destroy$)).subscribe(m=>{s&&s.clonedNode&&(this.renderer.setStyle(s.clonedNode,"height",`${m.height}px`),this.renderer.setStyle(s.clonedNode,"width",`${m.width}px`),this.renderer.setStyle(s.clonedNode,"top",`${m.top}px`),this.renderer.setStyle(s.clonedNode,"left",`${m.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:z({edges:s.edges,initialRectangle:s.startingRect,newRectangle:m}),rectangle:m})}),s.currentRect=m}),e.pipe((0,b.U)(({edges:m})=>m||{}),(0,E.h)(m=>Object.keys(m).length>0),(0,A.R)(this.destroy$)).subscribe(m=>{s&&r();const p=function wt(o,c){let e=0,i=0;const n=o.nativeElement.style,r=["transform","-ms-transform","-moz-transform","-o-transform"].map(a=>n[a]).find(a=>!!a);if(r&&r.includes("translate")&&(e=r.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),i=r.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),"absolute"===c)return{height:o.nativeElement.offsetHeight,width:o.nativeElement.offsetWidth,top:o.nativeElement.offsetTop-i,bottom:o.nativeElement.offsetHeight+o.nativeElement.offsetTop-i,left:o.nativeElement.offsetLeft-e,right:o.nativeElement.offsetWidth+o.nativeElement.offsetLeft-e};{const a=o.nativeElement.getBoundingClientRect();return{height:a.height,width:a.width,top:a.top-i,bottom:a.bottom-i,left:a.left-e,right:a.right-e,scrollTop:o.nativeElement.scrollTop,scrollLeft:o.nativeElement.scrollLeft}}}(this.elm,this.ghostElementPositioning);s={edges:m,startingRect:p,currentRect:p};const w=a(),f=et(s.edges,w);this.renderer.setStyle(document.body,"cursor",f),this.setElementClass(this.elm,nt,!0),this.enableGhostResize&&(s.clonedNode=function vt(o){const c=o.cloneNode(!0),e=c.querySelectorAll("[id]"),i=o.nodeName.toLowerCase();return c.removeAttribute("id"),e.forEach(n=>{n.removeAttribute("id")}),"canvas"===i?V(o,c):("input"===i||"select"===i||"textarea"===i)&&W(o,c),K("canvas",o,c,V),K("input, textarea, select",o,c,W),c}(this.elm.nativeElement),this.elm.nativeElement.parentElement.appendChild(s.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(s.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(s.clonedNode,"left",`${s.startingRect.left}px`),this.renderer.setStyle(s.clonedNode,"top",`${s.startingRect.top}px`),this.renderer.setStyle(s.clonedNode,"height",`${s.startingRect.height}px`),this.renderer.setStyle(s.clonedNode,"width",`${s.startingRect.width}px`),this.renderer.setStyle(s.clonedNode,"cursor",et(s.edges,w)),this.renderer.addClass(s.clonedNode,"resize-ghost-element"),s.clonedNode.scrollTop=s.startingRect.scrollTop,s.clonedNode.scrollLeft=s.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:z({edges:m,initialRectangle:p,newRectangle:p}),rectangle:q(p,{},0,0)})})}),n.pipe((0,A.R)(this.destroy$)).subscribe(()=>{s&&(this.renderer.removeClass(this.elm.nativeElement,nt),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:z({edges:s.edges,initialRectangle:s.startingRect,newRectangle:s.currentRect}),rectangle:s.currentRect})}),r(),s=null)})}ngOnDestroy(){(0,u.NF)(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.destroy$.next()}setElementClass(e,i,n){n?this.renderer.addClass(e.nativeElement,i):this.renderer.removeClass(e.nativeElement,i)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.Lbi),t.Y36(t.Qsj),t.Y36(t.SBq),t.Y36(t.R0b))},o.\u0275dir=t.lG2({type:o,selectors:[["","mwlResizable",""]],inputs:{validateResize:"validateResize",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},exportAs:["mwlResizable"]}),o})();class O{constructor(c,e){this.pointerDown=new L.y(i=>{let n,s;return e.runOutsideAngular(()=>{n=c.listen("document","mousedown",r=>{i.next({clientX:r.clientX,clientY:r.clientY,event:r})}),y&&(s=c.listen("document","touchstart",r=>{i.next({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,event:r})}))}),()=>{n(),y&&s()}}).pipe((0,R.B)()),this.pointerMove=new L.y(i=>{let n,s;return e.runOutsideAngular(()=>{n=c.listen("document","mousemove",r=>{i.next({clientX:r.clientX,clientY:r.clientY,event:r})}),y&&(s=c.listen("document","touchmove",r=>{i.next({clientX:r.targetTouches[0].clientX,clientY:r.targetTouches[0].clientY,event:r})}))}),()=>{n(),y&&s()}}).pipe((0,R.B)()),this.pointerUp=new L.y(i=>{let n,s,r;return e.runOutsideAngular(()=>{n=c.listen("document","mouseup",a=>{i.next({clientX:a.clientX,clientY:a.clientY,event:a})}),y&&(s=c.listen("document","touchend",a=>{i.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}),r=c.listen("document","touchcancel",a=>{i.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}))}),()=>{n(),y&&(s(),r())}}).pipe((0,R.B)())}static getInstance(c,e){return O.instance||(O.instance=new O(c,e)),O.instance}}let St=(()=>{class o{constructor(e,i,n,s){this.renderer=e,this.element=i,this.zone=n,this.resizableDirective=s,this.resizeEdges={},this.eventListeners={},this.destroy$=new P.x}ngOnInit(){this.zone.runOutsideAngular(()=>{this.listenOnTheHost("mousedown").subscribe(e=>{this.onMousedown(e,e.clientX,e.clientY)}),this.listenOnTheHost("mouseup").subscribe(e=>{this.onMouseup(e.clientX,e.clientY)}),y&&(this.listenOnTheHost("touchstart").subscribe(e=>{this.onMousedown(e,e.touches[0].clientX,e.touches[0].clientY)}),(0,T.T)(this.listenOnTheHost("touchend"),this.listenOnTheHost("touchcancel")).subscribe(e=>{this.onMouseup(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}))})}ngOnDestroy(){this.destroy$.next(),this.unsubscribeEventListeners()}onMousedown(e,i,n){e.cancelable&&e.preventDefault(),this.eventListeners.touchmove||(this.eventListeners.touchmove=this.renderer.listen(this.element.nativeElement,"touchmove",s=>{this.onMousemove(s,s.targetTouches[0].clientX,s.targetTouches[0].clientY)})),this.eventListeners.mousemove||(this.eventListeners.mousemove=this.renderer.listen(this.element.nativeElement,"mousemove",s=>{this.onMousemove(s,s.clientX,s.clientY)})),this.resizable.mousedown.next({clientX:i,clientY:n,edges:this.resizeEdges})}onMouseup(e,i){this.unsubscribeEventListeners(),this.resizable.mouseup.next({clientX:e,clientY:i,edges:this.resizeEdges})}get resizable(){return this.resizableDirective||this.resizableContainer}onMousemove(e,i,n){this.resizable.mousemove.next({clientX:i,clientY:n,edges:this.resizeEdges,event:e})}unsubscribeEventListeners(){Object.keys(this.eventListeners).forEach(e=>{this.eventListeners[e](),delete this.eventListeners[e]})}listenOnTheHost(e){return(0,ut.R)(this.element.nativeElement,e).pipe((0,A.R)(this.destroy$))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.Qsj),t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(ot,8))},o.\u0275dir=t.lG2({type:o,selectors:[["","mwlResizeHandle",""]],inputs:{resizeEdges:"resizeEdges",resizableContainer:"resizableContainer"}}),o})(),Tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({}),o})();var I=l(8814),it=l(5877),v=l(6223);let Ot=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,it.r,v.u5,v.UX,I.A]})}return o})();var It=l(1534),Pt=l(4833);let Dt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,v.u5,v.UX,I.A,it.r]})}return o})();var Et=l(2057);let At=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,Ot,I.A,v.u5,v.UX,It.A,Pt.$,Dt,Et.I]})}return o})();var $t=l(1658);let kt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,v.u5,v.UX,I.A]})}return o})(),Rt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,I.A,kt]})}return o})();var st=l(1896),J=function(o){return o.Items="items",o.ComplectItems="complectItems",o.Complects="complects",o}(J||{}),N=l(2130),Z=l(1859),H=l(2942),rt=l(1486),S=l(2372),ct=l(2425);let at=(()=>{class o{constructor(e,i,n){this.itemsService=e,this.complectsService=i,this.toastr=n}importComplect(e){switch(e.type){case"application/json":this.loadJson(e);break;case"text/csv":this.loadCsv(e);break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":this.loadExcel(e);break;default:this.toastr.error(`Unknown file type ${e.type}`)}}loadCsv(e){const i=new FileReader;i.onload=n=>{const s=n.target?.result;if(s&&"string"==typeof s){const r=s.split("\n");if(!r||!r.length)return;const a=r[0].split(","),_=[];for(let m=1;m<r.length-1;m++){let p=r[m].split(",");p.length&&_.push(p)}this.addComplectFromArray(a,_,e.name.replace(/\.[^\.]+$/,""))}},i.readAsText(e,"UTF-8")}loadExcel(e){const i=new FileReader;i.onload=n=>{const s=n.target?.result;if(s){const r=(0,rt.ij)(s),_=rt.P6.sheet_to_json(r.Sheets[r.SheetNames[0]],{header:1});_&&_.length&&this.addComplectFromArray(_[0],_.slice(1),r.SheetNames[0])}},i.readAsArrayBuffer(e)}addComplectFromArray(e,i,n){if(!e||!e.length)return void this.toastr.error("Heders are empty");if(!i||!i.length)return void this.toastr.error("Data is empty");const s=e.findIndex(a=>"group"===a.toLowerCase()),r=e.findIndex(a=>"count"===a.toLowerCase());this.itemsService.properties$.pipe((0,D.q)(1)).subscribe(a=>{const _=a.map(f=>({property:f,index:e.findIndex(d=>d.toLowerCase()===f.name.toLowerCase())})),m=i.reduce((f,d)=>{const h=d.filter((B,k)=>k!==s&&k!==r).join("|");return(f[h]=f[h]||[]).push(d),f},{}),p=[];Object.keys(m).forEach(f=>{const d=(0,S.Z)();m[f].forEach(h=>{h.push(d)}),p.push({id:d,values:_.map(h=>({propertyId:h.property.id,value:-1!==h.index?m[f][0][h.index]:null}))})});const w=this.getNewComplectFromArray(i,s,r,n);this.itemsService.addItems(p,f=>{this.complectsService.addComplect(w)})})}loadJson(e){const i=new FileReader;i.onload=n=>{const s=n.target?.result;if(s&&"string"==typeof s){const r=JSON.parse(s);this.addComplect(r)}},i.readAsText(e,"UTF-8")}addComplect(e){this.itemsService.properties$.pipe((0,D.q)(1)).subscribe(i=>{const n=e.groups.flatMap(a=>a.items).reduce((a,_)=>{const m=_.id?_.id:(0,S.Z)();return(a[m]=a[m]||[]).push(_),a},{}),s=[];Object.keys(n).forEach(a=>{const _=(0,S.Z)();n[a].forEach(p=>{p.id=_});const m={id:n[a][0].id,values:n[a][0].values.map(p=>({propertyId:i.find(w=>w.name===p.name)?.id,value:p.value})).filter(p=>!!p.propertyId)};s.push(m)});const r=this.getNewComplect(e);this.itemsService.addItems(s,a=>{this.complectsService.addComplect(r)})})}getNewComplect(e){return{id:(0,S.Z)(),name:e.name,description:e.description,groups:e.groups.map(i=>({id:(0,S.Z)(),name:i.name,items:i.items.map(n=>({count:n.count,itemId:n.id}))}))}}getNewComplectFromArray(e,i,n,s){let r={};-1!==i?r=e.reduce((_,m)=>((_[m[i]]=_[m[i]]||[]).push(m),_),{}):r["Default group"]=e;const a={id:(0,S.Z)(),name:s,groups:[]};return Object.keys(r).forEach(_=>{const m=(0,S.Z)();a.groups.push({id:m,complectId:a.id,name:_,items:r[_].map(p=>({groupId:m,itemId:p[p.length-1],count:-1!==n?+p[n]:1}))})}),a}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(Z.L),t.LFG(H.s),t.LFG(ct._W))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac})}return o})();var F=l(2296),G=l(617),Y=l(2596),$=l(6236),zt=l(6452),x=l(2096),Zt=l(5619),U=l(2572),Q=l(1418),C=l(5313),g=l(6825),lt=l(4255);(0,g.oB)({transform:"rotate3d(0, 0, 1, 15deg)",offset:.2}),(0,g.oB)({transform:"rotate3d(0, 0, 1, -10deg)",offset:.4}),(0,g.oB)({transform:"rotate3d(0, 0, 1, 5deg)",offset:.6}),(0,g.oB)({transform:"rotate3d(0, 0, 1, -5deg)",offset:.8}),(0,g.oB)({transform:"none",offset:1}),(0,g.oB)({opacity:1}),(0,g.oB)({transform:"translate3d(1, 0, 0)",opacity:0});const Ht=[(0,g.oB)({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})];var mt=l(7700),M=l(5195),dt=l(7988),Lt=l(5986),Jt=l(8260),Nt=l(957),Ft=l(1193);function Gt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card-header",4)(1,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onActiveClick())}),t.TgZ(2,"mat-icon"),t._uU(3,"list"),t.qZA()()()}}function Yt(o,c){1&o&&t._UZ(0,"div",18)}function Ut(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"li",14),t.YNc(1,Yt,1,0,"div",15),t.TgZ(2,"mat-checkbox",16),t.NdJ("ngModelChange",function(n){const r=t.CHM(e).$implicit;return t.KtG(r.params.listDisplay=n)})("click",function(n){return n.stopPropagation()})("change",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.onItemHeaderSelected(s.params))}),t._uU(3),t.qZA(),t.TgZ(4,"mat-icon",17),t._uU(5," swap_vert "),t.qZA()()}if(2&o){const e=c.$implicit;t.xp6(2),t.Q6J("ngModel",e.params.listDisplay)("disableRipple",!0),t.xp6(1),t.hij(" ",e.name," ")}}function Qt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ul",12),t.NdJ("cdkDropListDropped",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onDropHeader(n))}),t.YNc(1,Ut,6,3,"li",13),t.qZA()}if(2&o){const e=c.ngIf;t.Q6J("cdkDropListData",e),t.xp6(1),t.Q6J("ngForOf",e)}}function jt(o,c){if(1&o&&(t.TgZ(0,"mat-card-header",6)(1,"mat-card-title")(2,"button",7)(3,"mat-icon"),t._uU(4,"settings"),t.qZA()(),t.TgZ(5,"mat-menu",8,9),t.NdJ("click",function(i){return i.stopPropagation()}),t.YNc(7,Qt,2,2,"ul",10),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"span",11),t._uU(10,"My stuff"),t.qZA()()()),2&o){const e=t.MAs(6),i=t.oxw();t.xp6(2),t.Q6J("matMenuTriggerFor",e),t.xp6(5),t.Q6J("ngIf",t.lcZ(8,2,i.propertiesSorted$))}}function Bt(o,c){if(1&o&&(t.TgZ(0,"mat-header-cell",37)(1,"span"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2).$implicit;t.Q6J("ngClass",e.class),t.xp6(2),t.Oqu(e.header)}}function Xt(o,c){1&o&&t.YNc(0,Bt,3,2,"mat-header-cell",36)}function Kt(o,c){if(1&o&&(t.TgZ(0,"mat-header-cell",39)(1,"span"),t._uU(2),t.qZA()()),2&o){const e=t.oxw(2).$implicit;t.Q6J("ngClass",e.class),t.xp6(2),t.Oqu(e.header)}}function Wt(o,c){1&o&&t.YNc(0,Kt,3,2,"mat-header-cell",38)}function Vt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",44),t.NdJ("mousedown",function(){t.CHM(e);const n=t.oxw(6);return t.KtG(n.dragDisabled=!1)})("mouseUp",function(){t.CHM(e);const n=t.oxw(6);return t.KtG(n.dragDisabled=!0)})("touchstart",function(){t.CHM(e);const n=t.oxw(6);return t.KtG(n.dragDisabled=!1)})("touchend",function(){t.CHM(e);const n=t.oxw(6);return t.KtG(n.dragDisabled=!0)}),t._uU(1," more_vert "),t.qZA()}}function qt(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Vt,2,0,"mat-icon",43),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.isSummary)}}function te(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"span",45),t._uU(2),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.count)}}function ee(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",46)(2,"button",47),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw().$implicit,r=t.oxw(4);return t.KtG(r.openEditItemDialog(s,n))}),t.TgZ(3,"mat-icon"),t._uU(4,"edit"),t.qZA()(),t.TgZ(5,"button",48),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw().$implicit,r=t.oxw(4);return t.KtG(r.openCloneItemDialog(s,n))}),t.TgZ(6,"mat-icon"),t._uU(7,"control_point_duplicate"),t.qZA()(),t.TgZ(8,"button",49),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw().$implicit,r=t.oxw(4);return t.KtG(r.openDeleteItemDialog(s,n))}),t.TgZ(9,"mat-icon"),t._uU(10,"delete"),t.qZA()()(),t.BQk()}}function ne(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"span",50),t._uU(2),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(i.cell(e))}}function oe(o,c){if(1&o&&(t.ynx(0),t._UZ(1,"app-item-value",51),t.BQk()),2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("property",i.property)("value",i.cell(e))}}function ie(o,c){if(1&o&&(t.TgZ(0,"mat-cell",40),t.YNc(1,qt,2,1,"ng-container",41)(2,te,3,1,"ng-container",41)(3,ee,11,0,"ng-container",41)(4,ne,3,1,"ng-container",41)(5,oe,2,2,"ng-container",42),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("ngClass",e.class)("ngSwitch",e.columnDef),t.xp6(1),t.Q6J("ngSwitchCase","move-item"),t.xp6(1),t.Q6J("ngSwitchCase","count"),t.xp6(1),t.Q6J("ngSwitchCase","actions"),t.xp6(1),t.Q6J("ngSwitchCase","category")}}function se(o,c){if(1&o&&(t.ynx(0,31)(1,32),t.YNc(2,Xt,1,0,"ng-template",33)(3,Wt,1,0,"ng-template",34),t.BQk(),t.YNc(4,ie,6,6,"mat-cell",35),t.BQk()),2&o){const e=c.$implicit;t.Q6J("matColumnDef",e.columnDef),t.xp6(1),t.Q6J("ngSwitch",e.columnDef),t.xp6(1),t.s9C("ngSwitchCase","count"===e.columnDef||"actions"===e.columnDef||"move-item"===e.columnDef)}}function re(o,c){if(1&o&&t._UZ(0,"app-item-view",55),2&o){const e=t.oxw().$implicit;t.Q6J("item",e)}}function ce(o,c){if(1&o&&(t.TgZ(0,"mat-cell",52)(1,"div",53),t.YNc(2,re,1,1,"app-item-view",54),t.qZA()()),2&o){const e=c.$implicit,i=t.oxw().ngIf,n=t.oxw(2);t.ekj("hidden",e!==n.expandedElement),t.uIk("colspan",i.length),t.xp6(1),t.Q6J("@detailExpand",e===n.expandedElement?"expanded":"collapsed"),t.xp6(1),t.Q6J("ngIf",e===n.expandedElement)}}function ae(o,c){1&o&&t._UZ(0,"mat-header-row",56)}function le(o,c){1&o&&t._UZ(0,"div",18)}function me(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-row",57),t.NdJ("cdkDragStarted",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.onDragStarted(n))})("cdkDragEnded",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.onDragEnded())})("click",function(n){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.onItemClick(r,n))})("onLongPress",function(n){const r=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.onItemLongPress(r,n))})("@cardAnimator.done",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.onItemSwipeRightEnd(s))})("swiperight",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.onItemSwipeRight(s))}),t.YNc(1,le,1,0,"div",15),t.qZA()}if(2&o){const e=c.$implicit,i=t.oxw(3);t.ekj("expanded-row",i.expandedElement===e),t.Q6J("cdkDragData",e)("longPress",!0)("@cardAnimator",e===i.slidingElement?"slideOutRight":"")}}function de(o,c){1&o&&t._UZ(0,"mat-row",58)}const pe=()=>["expandedDetail"];function _e(o,c){if(1&o&&(t.TgZ(0,"mat-table",23,24),t.YNc(2,se,5,3,"ng-container",25),t.ALo(3,"async"),t.ynx(4,26),t.YNc(5,ce,3,5,"mat-cell",27),t.BQk(),t.YNc(6,ae,1,0,"mat-header-row",28),t.ALo(7,"async"),t.YNc(8,me,2,5,"mat-row",29),t.ALo(9,"async"),t.YNc(10,de,1,0,"mat-row",30),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("dataSource",e.dataSource)("cdkDropListDisabled",e.dragDisabled)("cdkDropListData",e.dataSource),t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,8,e.columnViews$)),t.xp6(4),t.Q6J("matHeaderRowDef",t.lcZ(7,10,e.displayedColumns$))("matHeaderRowDefSticky",!0),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(9,12,e.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.DdM(14,pe))}}function ue(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card-content",19),t.YNc(1,_e,11,15,"mat-table",20),t.ALo(2,"async"),t.TgZ(3,"div",21)(4,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openAddItemDialog())}),t.TgZ(5,"mat-icon"),t._uU(6,"add"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.displayedColumns$))}}const he=(o,c)=>({mobile:o,inactive:c});let ge=(()=>{class o{constructor(e,i,n){this.itemsService=e,this.complectsService=i,this.dialog=n,this.isActive=!1,this.isActiveChange=new t.vpe,this.properties$=(0,x.of)([]),this.items$=(0,x.of)([]),this.tempIndexSource=new Zt.X(null),this.tempIndex$=this.tempIndexSource.asObservable(),this.subsctiptions=[],this.propertiesSorted$=(0,x.of)([]),this.propertiesFiltered$=(0,x.of)([]),this.itemList$=(0,x.of)([]),this.columnViews$=(0,x.of)([]),this.displayedColumns$=(0,x.of)([]),this.expandedElement=null,this.slidingElement=null,this.dataSource=new C.by,this.dragDisabled=!0,this.screenStateStore=(0,t.f3M)(N.M)}ngOnInit(){this.propertiesSorted$=this.properties$.pipe((0,b.U)(i=>[...i?.sort((n,s)=>n.params.listOrder>s.params.listOrder?1:-1)??[]])),this.propertiesFiltered$=this.propertiesSorted$.pipe((0,b.U)(i=>i.filter(n=>n.params.listDisplay))),this.columnViews$=this.propertiesFiltered$.pipe((0,b.U)(i=>this.getColumns(i))),this.displayedColumns$=this.columnViews$.pipe((0,b.U)(i=>i.map(n=>n.columnDef)??[])),this.itemList$=(0,U.a)({items:this.items$,tempIndex:this.tempIndex$}).pipe((0,b.U)(i=>{if(null===i.tempIndex||!i.items)return i.items??[];{const n=[...i.items];return n.splice(i.tempIndex+1,0,i.items[i.tempIndex]),n}}));const e=(0,U.a)([this.itemList$,this.propertiesFiltered$]).subscribe(i=>{this.dataSource.data=i[0]?i[0]:[],this.table?.renderRows()});this.subsctiptions.push(e)}ngOnDestroy(){this.subsctiptions.forEach(e=>{e.unsubscribe()})}getColumns(e){const i=e.map(n=>({columnDef:n.id??"",header:n.name,property:n,cell:s=>`${s.values.find(r=>r.id===n.id)?.value}`,width:`${n.params.complectWidth??50} px`,class:"item__value"}))??[];return this.screenStateStore.isMobilePortrait()||i.unshift({columnDef:"move-item",header:"",property:null,cell:()=>"",width:"30px",class:"move"}),i.push({columnDef:"actions",header:"",property:null,cell:n=>"",width:"30px",class:"actions"}),i}onItemHeaderSelected(e){this.itemsService.updatePropertyParam(e)}onDropHeader(e){const i=e.container.data?.map(n=>n.params)??[];(0,$.bA)(i,e.previousIndex,e.currentIndex),i.forEach((n,s)=>{n.listOrder=s}),this.itemsService.updatePropertyParams(i)}onActiveClick(){this.isActiveChange.emit()}onItemClick(e,i){this.screenStateStore.isMobile()||(this.expandedElement=this.expandedElement===e?null:e,i.stopPropagation())}onItemLongPress(e,i){this.screenStateStore.isMobile()&&(this.expandedElement=this.dragDisabled?this.expandedElement===e?null:e:null,i.stopPropagation())}onDragEnded(){this.tempIndexSource.next(null),this.dragDisabled=!0}onDragStarted(e){e.source.data?.id&&this.tempIndexSource.next(this.dataSource.data.findIndex(i=>i.id===e.source.data.id))}onItemSwipeRight(e){this.screenStateStore.isMobilePortrait()?this.slidingElement||(this.slidingElement=e,this.complectsService.addItemToCurrentGroup(e).subscribe(i=>{})):this.slidingElement=null}onItemSwipeRightEnd(e){this.slidingElement=null}openAddItemDialog(){this.dialog.open(Q.s,{data:null}).afterClosed().subscribe(i=>{})}openEditItemDialog(e,i){i.stopPropagation(),this.dialog.open(Q.s,{data:e}).afterClosed().subscribe(s=>{})}openCloneItemDialog(e,i){i.stopPropagation();const n=Object.assign(new zt.c,e);n.id="",this.dialog.open(Q.s,{data:n}).afterClosed().subscribe(r=>{})}openDeleteItemDialog(e,i){i.stopPropagation(),this.dialog.open(lt.$,{data:"Delete item?"}).afterClosed().subscribe(s=>{s&&this.itemsService.deleteItem(e.id)})}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(Z.L),t.Y36(H.s),t.Y36(mt.uw))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-items"]],viewQuery:function(i,n){if(1&i&&t.Gf(C.BZ,5),2&i){let s;t.iGM(s=t.CRH())&&(n.table=s.first)}},inputs:{isActive:"isActive",properties$:"properties$",items$:"items$"},outputs:{isActiveChange:"isActiveChange"},decls:4,vars:7,consts:[[1,"card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],["class","header",4,"ngIf"],["class","content",4,"ngIf"],[1,"mobile-preview"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[1,"header"],["mat-icon-button","","color","primary","aria-label","Show headers","matTooltip","Show headers",3,"matMenuTriggerFor"],[1,"table-headers-menu",3,"click"],["itemsListHeadersMenu","matMenu"],["class","table-headers-menu-list","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],[1,"header-name"],["cdkDropList","",1,"table-headers-menu-list",3,"cdkDropListData","cdkDropListDropped"],["class","item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",1,"item"],["class","drag-placeholder",4,"cdkDragPlaceholder"],[1,"ckeckbox",3,"ngModel","disableRipple","ngModelChange","click","change"],["cdkDragHandle","",1,"drag-handle"],[1,"drag-placeholder"],[1,"content"],["class","items","multiTemplateDataRows","","id","itemsList","cdkDropList","","cdkDropListConnectedTo","complectItemsList","cdkDropListSortingDisabled","",3,"dataSource","cdkDropListDisabled","cdkDropListData",4,"ngIf"],[1,"end-row"],["mat-icon-button","","color","primary","aria-label","Add item","matTooltip","Add",1,"add-btn",3,"click"],["multiTemplateDataRows","","id","itemsList","cdkDropList","","cdkDropListConnectedTo","complectItemsList","cdkDropListSortingDisabled","",1,"items",3,"dataSource","cdkDropListDisabled","cdkDropListData"],["itemsList","cdkDropList"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["class","detail-cell",3,"hidden",4,"matCellDef"],["class","row table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","row item","cdkDrag","",3,"expanded-row","cdkDragData","longPress","cdkDragStarted","cdkDragEnded","click","onLongPress","swiperight",4,"matRowDef","matRowDefColumns"],["class","row detail-row",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],[3,"ngSwitch"],[3,"ngSwitchCase"],["ngSwitchDefault",""],[3,"ngClass","ngSwitch",4,"matCellDef"],["sticky","",3,"ngClass",4,"matHeaderCellDef"],["sticky","",3,"ngClass"],[3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass"],[3,"ngClass","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","reorder",3,"mousedown","mouseUp","touchstart","touchend",4,"ngIf"],[1,"reorder",3,"mousedown","mouseUp","touchstart","touchend"],[1,"count-value"],[1,"buttons-container"],["mat-icon-button","","color","primary","aria-label","Edit count",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit item",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete from complect",1,"small-button",3,"click"],[1,"category"],[1,"value",3,"property","value"],[1,"detail-cell"],[1,"detail"],[3,"item",4,"ngIf"],[3,"item"],[1,"row","table-header"],["cdkDrag","",1,"row","item",3,"cdkDragData","longPress","cdkDragStarted","cdkDragEnded","click","onLongPress","swiperight"],[1,"row","detail-row"]],template:function(i,n){1&i&&(t.TgZ(0,"mat-card",0),t.YNc(1,Gt,4,0,"mat-card-header",1)(2,jt,11,4,"mat-card-header",2)(3,ue,7,3,"mat-card-content",3),t.qZA()),2&i&&(t.Q6J("ngClass",t.WLB(4,he,n.screenStateStore.isMobilePortrait(),n.screenStateStore.isMobilePortrait()&&!n.isActive)),t.xp6(1),t.Q6J("ngIf",n.screenStateStore.isMobilePortrait()&&!n.isActive),t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()||n.isActive),t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()||n.isActive))},dependencies:[u.mk,u.sg,u.O5,u.RF,u.n9,u.ED,F.RK,M.a8,M.dn,M.dk,M.n5,dt.VK,dt.p6,C.BZ,C.fO,C.as,C.w1,C.Dz,C.nj,C.ge,C.ev,C.XQ,C.Gk,G.Hw,$.Wj,$.Zt,$.Bh,$.Hk,Y.gM,Lt.oG,v.JJ,v.On,Jt.H,Nt.F,Ft.T,u.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;background:#F5F5F5;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.card[_ngcontent-%COMP%]{height:100%}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex:0 0 auto;display:flex;justify-content:space-between}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{display:flex;align-items:center}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:calc(100% - 60px);display:flex;flex-direction:column;align-items:stretch;width:100%;max-width:100%;overflow-y:auto;overflow-x:hidden}.card[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 5px;display:flex;justify-content:center;align-items:center}.table-headers-menu-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;min-width:190px}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;padding-right:10px;justify-content:space-between;align-items:center;transition:box-shadow .2s cubic-bezier(0,0,.2,1)}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active{background:#F5F5F5}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:move}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:40px;transition:transform .25s cubic-bezier(0,0,.2,1)}.row[_ngcontent-%COMP%]{min-height:30px;overflow-wrap:break-word;position:relative}.row[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{display:flex}.row[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:white;border:3px dotted rgba(0,0,0,.14);min-height:35px}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{max-width:0;min-width:0;padding-left:0;padding-right:0;position:relative;overflow:visible}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:none;position:absolute;top:0;right:0;z-index:100;background-color:#fdfdfd;border-radius:10px}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{position:relative;width:0;max-width:0;min-width:0;padding-left:0;padding-right:0;overflow:visible}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]   .reorder[_ngcontent-%COMP%]{position:absolute;left:-5px;top:0;z-index:100;cursor:move;display:block;color:#0003}.row[_ngcontent-%COMP%]   .expand[_ngcontent-%COMP%]{max-width:0;width:0;padding:0}.row.expanded-row[_ngcontent-%COMP%], .row.detail-row[_ngcontent-%COMP%]{background-color:#00000008}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom-width:0!important}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:none}.detail-row[_ngcontent-%COMP%]{min-height:0}.detail-row[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{overflow:hidden;width:100%;padding-bottom:5px}.end-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;position:sticky;bottom:0;width:100%;height:30px}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.card.mobile[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{min-height:60px}"],data:{animation:[(0,g.X$)("detailExpand",[(0,g.SB)("collapsed",(0,g.oB)({height:"0px",minHeight:"0"})),(0,g.SB)("expanded",(0,g.oB)({height:"*"})),(0,g.eR)("expanded <=> collapsed",(0,g.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))]),(0,g.X$)("cardAnimator",[(0,g.eR)("* => slideOutRight",(0,g.jt)(300,(0,g.F4)(Ht)))])]},changeDetection:0})}return o})();var fe=l(8685),j=l(6592),Ce=l(6385),pt=l(9038);function be(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onToggleCard())}),t.TgZ(2,"mat-icon"),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngClass",e.isCardHidden?"card-hidden":""),t.xp6(1),t.s9C("matTooltip",e.isCardHidden?"Show packs":"Hide packs"),t.xp6(2),t.Oqu(e.isCardHidden?"arrow_back_ios":"arrow_forward_ios")}}function ve(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card-header",7)(1,"button",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onActiveClick())}),t.TgZ(2,"mat-icon"),t._uU(3,"view_quilt"),t.qZA()()()}}function xe(o,c){1&o&&(t.TgZ(0,"mat-card-header")(1,"mat-card-title"),t._uU(2,"My packs"),t.qZA()())}function we(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"li",13),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.onComplectClick(s))}),t.ALo(1,"async"),t._UZ(2,"mat-divider"),t.TgZ(3,"div",14)(4,"h4",15),t._uU(5),t.qZA(),t.TgZ(6,"div",16)(7,"div",17)(8,"button",18),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.openEditComplectDialog(s))}),t.TgZ(9,"mat-icon"),t._uU(10,"edit"),t.qZA()(),t.TgZ(11,"button",19),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.openCloneComplectDialog(s))}),t.TgZ(12,"mat-icon"),t._uU(13,"control_point_duplicate"),t.qZA()(),t.TgZ(14,"button",20),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.openDeleteComplectDialog(s))}),t.TgZ(15,"mat-icon"),t._uU(16,"delete"),t.qZA()()()()(),t.TgZ(17,"div",21)(18,"p",22),t._uU(19),t.qZA()()()}if(2&o){const e=c.$implicit,i=t.oxw(2);let n;t.Q6J("ngClass",e.id===(null==(n=t.lcZ(1,3,i.currentComplect$))?null:n.id)?"complect-list__item_selected":""),t.xp6(5),t.Oqu(e.name),t.xp6(14),t.Oqu(e.description)}}function Me(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card-content")(1,"ul",9),t.YNc(2,we,20,5,"li",10),t.ALo(3,"async"),t.TgZ(4,"li",11)(5,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openAddComplectDialog())}),t.TgZ(6,"mat-icon"),t._uU(7,"add"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,1,e.orderedComplects$))}}const ye=(o,c,e)=>({mobile:o,inactive:c,hidden:e});let Se=(()=>{class o{constructor(e,i,n){this.complectsService=e,this.dialog=i,this.toastr=n,this.isActive=!1,this.isActiveChange=new t.vpe,this.complects$=(0,x.of)(null),this.currentComplect$=(0,x.of)(null),this.currentComplectChange=new t.vpe,this.orderedComplects$=(0,x.of)([]),this.isCardHidden=!1,this.screenStateStore=(0,t.f3M)(N.M)}ngOnInit(){this.orderedComplects$=this.complects$.pipe((0,b.U)(e=>e?.sort((i,n)=>i.name.localeCompare(n.name))??[]))}openAddComplectDialog(){this.dialog.open(j.g,{data:null}).afterClosed().subscribe(i=>{i&&this.currentComplectChange.emit(i)})}openEditComplectDialog(e){this.dialog.open(j.g,{data:e}).afterClosed().subscribe(n=>{})}openCloneComplectDialog(e){const i=Object.assign({},e);i.id="",i.groups=e.groups.map(s=>{const r=Object.assign({},s);return r.id=void 0,r.complectId="",r.items=s.items.map(a=>Object.assign({},a)),r}),this.dialog.open(j.g,{data:i}).afterClosed().pipe((0,D.q)(1)).subscribe(s=>{s&&this.currentComplectChange.emit(s)})}openDeleteComplectDialog(e){this.dialog.open(lt.$,{data:"Delete complect?"}).afterClosed().subscribe(n=>{n&&e.id&&this.complectsService.deleteComplect(e.id)&&(0,U.a)({currentComplect:this.currentComplect$,complects:this.complects$}).pipe((0,D.q)(1)).subscribe({next:s=>{this.toastr.success("Done!"),e.id===s.currentComplect?.id&&this.currentComplectChange.emit(s.complects?.length?s.complects[0]:null)},error:s=>this.toastr.error(s.error)})})}onComplectClick(e){this.currentComplectChange.emit(e)}onToggleCard(){this.isCardHidden=!this.isCardHidden}onActiveClick(){this.isActiveChange.emit()}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(H.s),t.Y36(mt.uw),t.Y36(ct._W))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-complects"]],inputs:{isActive:"isActive",complects$:"complects$",currentComplect$:"currentComplect$"},outputs:{isActiveChange:"isActiveChange",currentComplectChange:"currentComplectChange"},decls:6,vars:9,consts:[[1,"container"],["class","toggle-button",3,"ngClass",4,"ngIf"],[1,"card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],[4,"ngIf"],[1,"toggle-button",3,"ngClass"],["mat-icon-button","","color","primary",3,"matTooltip","click"],[1,"mobile-preview"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[1,"complect-list"],["class","complect-list__item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"complect-list_item","complect-list_item-end"],["mat-icon-button","","color","primary","aria-label","Add complect","matTooltip","Add",1,"complect-list__add-btn",3,"click"],[1,"complect-list__item",3,"ngClass","click"],[1,"complect-list__item-header"],["matListItemTitle","",1,"complect-list__item-header-text"],[1,"complect-list__buttons"],[1,"complect-list__buttons-container"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Edit",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Clone",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete item","matTooltip","Delete",1,"small-button",3,"click"],[1,"complect-list__item-data"],["matListItemLine",""]],template:function(i,n){1&i&&(t.TgZ(0,"div",0),t.YNc(1,be,4,3,"div",1),t.TgZ(2,"mat-card",2),t.YNc(3,ve,4,0,"mat-card-header",3)(4,xe,3,0,"mat-card-header",4)(5,Me,8,3,"mat-card-content",4),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()),t.xp6(1),t.Q6J("ngClass",t.kEZ(5,ye,n.screenStateStore.isMobilePortrait(),!n.isActive,!n.screenStateStore.isMobilePortrait()&&n.isCardHidden)),t.xp6(1),t.Q6J("ngIf",n.screenStateStore.isMobilePortrait()&&!n.isActive),t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()||n.isActive),t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()||n.isActive))},dependencies:[u.mk,u.sg,u.O5,F.RK,M.a8,M.dn,M.dk,M.n5,G.Hw,Ce.d,pt.WW,pt.sL,Y.gM,u.Ov],styles:[".container[_ngcontent-%COMP%]{height:100%;position:relative}.mat-mdc-card[_ngcontent-%COMP%]{height:100%}.mat-mdc-card-header[_ngcontent-%COMP%]{justify-content:space-between;margin-left:30px}.mat-mdc-card-content[_ngcontent-%COMP%]{min-width:250px;height:calc(100% - 50px);overflow:auto}.complect-list__item[_ngcontent-%COMP%]{padding-right:3px}.complect-list__item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__item-header-text[_ngcontent-%COMP%]{margin-bottom:3px}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]{width:0;position:relative}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]   .complect-list__buttons-container[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;display:none}.complect-list__item[_ngcontent-%COMP%]:hover{cursor:pointer}.complect-list__item[_ngcontent-%COMP%]:hover   .complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]   .complect-list__buttons-container[_ngcontent-%COMP%]{display:flex}.complect-list__item_selected[_ngcontent-%COMP%]{background-color:#0000000a}.complect-list_item-end[_ngcontent-%COMP%]{position:sticky;left:0;bottom:0;display:flex;justify-content:flex-end}.toggle-button[_ngcontent-%COMP%]{position:absolute;top:0;z-index:100}.toggle-button.card-visible[_ngcontent-%COMP%]{left:0}.toggle-button.card-hidden[_ngcontent-%COMP%]{right:0}.hidden[_ngcontent-%COMP%]{display:none}.mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 5px;margin:0;display:flex;justify-content:center;align-items:center}"],changeDetection:0})}return o})();const Te=["home"],Oe=["items"];function Ie(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onToggleItems())}),t.TgZ(2,"mat-icon"),t._uU(3),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngClass",e.isItemsHidden?"card-hidden":"card-visible"),t.xp6(1),t.s9C("matTooltip",e.isItemsHidden?"Show packs":"Hide packs"),t.xp6(2),t.Oqu(e.isItemsHidden?"arrow_forward_ios":"arrow_back_ios")}}const Pe=()=>({right:!0});function De(o,c){1&o&&t._UZ(0,"div",11),2&o&&t.Q6J("resizeEdges",t.DdM(1,Pe))}const Ee=[{path:"",component:(()=>{class o{constructor(e,i,n){this.itemsService=e,this.complectsService=i,this.importService=n,this.mobileWidth=992,this.itemsWidth=300,this.isItemsHidden=!1,this.tabsEnum=J,this.activeTab=J.ComplectItems,this.subsctiptions=[],this.screenStateStore=(0,t.f3M)(N.M)}ngOnInit(){}ngOnDestroy(){this.subsctiptions.forEach(e=>{e.unsubscribe()})}onItemsResizeEnd(e){this.itemsWidth=e.rectangle.width??50}onCurrentComplectChange(e){this.complectsService.setCurrentComplect(e)}onCurrentCategoryChange(e){this.complectsService.setCurrentGroup(e)}onPropertyParamChange(e){this.itemsService.updatePropertyParam(e)}onPropertyParamsChange(e){this.itemsService.updatePropertyParams(e)}onToggleItems(){this.isItemsHidden=!this.isItemsHidden}onActiveTabChange(e){this.activeTab=e}importComplect(e){this.importService.importComplect(e)}getItemsWidth(){return this.screenStateStore.isMobilePortrait()?"100%":this.isItemsHidden?"0":`${this.itemsWidth}px`}getItemsMinWidth(){return this.screenStateStore.isMobilePortrait()?"100%":this.isItemsHidden?"0":"200px"}getItemsStyle(){return this.screenStateStore.isMobilePortrait()?{}:{width:this.isItemsHidden?"0":`${this.itemsWidth}px`,"min-width":this.isItemsHidden?"0":"200px"}}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(Z.L),t.Y36(H.s),t.Y36(at))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-home"]],viewQuery:function(i,n){if(1&i&&(t.Gf(Te,7),t.Gf(Oe,7)),2&i){let s;t.iGM(s=t.CRH())&&(n.homeElement=s.first),t.iGM(s=t.CRH())&&(n.itemsElement=s.first)}},decls:9,vars:21,consts:[[1,"home"],["home",""],["mwlResizable","",1,"block","items",3,"ngClass","ngStyle","enableGhostResize","resizeEnd"],["items",""],["class","toggle-button",3,"ngClass",4,"ngIf"],[3,"isActive","properties$","items$","isActiveChange"],["class","resize-handle-right","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],[1,"block","complect-items",3,"ngClass","isActive","complect$","items$","properties$","isActiveChange","complectChange","currentCategoryChange","propertyParamsChange","propertyParamChange","onImportComplect"],[1,"block","complects",3,"ngClass","isActive","complects$","currentComplect$","isActiveChange","currentComplectChange"],[1,"toggle-button",3,"ngClass"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mwlResizeHandle","",1,"resize-handle-right",3,"resizeEdges"]],template:function(i,n){1&i&&(t.TgZ(0,"section",0,1)(2,"div",2,3),t.NdJ("resizeEnd",function(r){return n.onItemsResizeEnd(r)}),t.YNc(4,Ie,4,3,"div",4),t.TgZ(5,"app-items",5),t.NdJ("isActiveChange",function(){return n.onActiveTabChange(n.tabsEnum.Items)}),t.qZA(),t.YNc(6,De,1,2,"div",6),t.qZA(),t.TgZ(7,"app-complect-items",7),t.NdJ("isActiveChange",function(){return n.onActiveTabChange(n.tabsEnum.ComplectItems)})("complectChange",function(r){return n.onCurrentComplectChange(r)})("currentCategoryChange",function(r){return n.onCurrentCategoryChange(r)})("propertyParamsChange",function(r){return n.onPropertyParamsChange(r)})("propertyParamChange",function(r){return n.onPropertyParamChange(r)})("onImportComplect",function(r){return n.importComplect(r)}),t.qZA(),t.TgZ(8,"app-complects",8),t.NdJ("isActiveChange",function(){return n.onActiveTabChange(n.tabsEnum.Complects)})("currentComplectChange",function(r){return n.onCurrentComplectChange(r)}),t.qZA()()),2&i&&(t.ekj("mobile",n.screenStateStore.isMobilePortrait()),t.xp6(2),t.ekj("resizable",!n.screenStateStore.isMobilePortrait()),t.Q6J("ngClass",n.activeTab===n.tabsEnum.Items?"active":"inactive")("ngStyle",n.getItemsStyle())("enableGhostResize",!1),t.xp6(2),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()),t.xp6(1),t.Q6J("isActive",n.activeTab===n.tabsEnum.Items)("properties$",n.itemsService.properties$)("items$",n.itemsService.itemObjects$),t.xp6(1),t.Q6J("ngIf",!n.screenStateStore.isMobilePortrait()),t.xp6(1),t.Q6J("ngClass",n.activeTab===n.tabsEnum.ComplectItems?"active":"inactive")("isActive",n.activeTab===n.tabsEnum.ComplectItems)("complect$",n.complectsService.currentComplect$)("items$",n.itemsService.itemObjects$)("properties$",n.itemsService.properties$),t.xp6(1),t.Q6J("ngClass",n.activeTab===n.tabsEnum.Complects?"active":"inactive")("isActive",n.activeTab===n.tabsEnum.Complects)("complects$",n.complectsService.complects$)("currentComplect$",n.complectsService.currentComplect$))},dependencies:[u.mk,u.O5,u.PC,ot,St,F.RK,G.Hw,Y.gM,ge,fe.J,Se],styles:[".home[_ngcontent-%COMP%]{display:flex;justify-content:stretch;align-items:stretch;height:100%;gap:5px;padding:5px}.home[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;height:100%}.home[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{position:relative}.home[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   app-items[_ngcontent-%COMP%]{flex-grow:1;width:100%}.home[_ngcontent-%COMP%]   .complect-items[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;min-width:280px}.home[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{position:absolute;top:0;z-index:100}.home[_ngcontent-%COMP%]   .toggle-button.card-visible[_ngcontent-%COMP%]{right:0}.home[_ngcontent-%COMP%]   .toggle-button.card-hidden[_ngcontent-%COMP%]{left:0}.home.mobile[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:space-between}.home.mobile[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-grow:1;width:auto;min-width:auto}.home.mobile[_ngcontent-%COMP%] > .active[_ngcontent-%COMP%]{order:-1;flex:1 0 100%;height:calc(100% - 70px);width:100%}.home.mobile[_ngcontent-%COMP%] > .inactive[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;height:60px;max-width:50%}.home.mobile[_ngcontent-%COMP%] > .inactive.complect-items[_ngcontent-%COMP%]{order:3;flex-grow:1;flex-shrink:0;max-width:calc(100% - 65px);width:calc(100% - 65px)}.home.mobile[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{display:none}"]})}return o})()}];let Ae=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[st.Bz.forChild(Ee),st.Bz]})}return o})(),$e=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({providers:[Z.L,at],imports:[u.ez,Tt,I.A,At,$t.C,Rt,Ae]})}return o})()}}]);