"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[42],{7685:(Cr,Ct,te)=>{te.d(Ct,{W:()=>v});var v=function(W){return W.JSON="JSON",W.CSV="CSV",W.XLSX="XLSX",W}(v||{})},5936:(Cr,Ct,te)=>{te.d(Ct,{B:()=>v});var v=function(W){return W.Unknown="Unknown",W.String="String",W.Number="Number",W.Decimal="Decimal",W.PictureLink="PictureLink",W.Date="Date",W}(v||{})},1647:(Cr,Ct,te)=>{te.d(Ct,{O:()=>qe});var v=te(6452),W=te(7990);class qe{static getItem(oe,it){const rt=Object.assign(new v.c,oe);return rt.values=it.map(et=>{const ft=oe.values.find(mt=>mt.propertyId===et.id),pt=Object.assign(new W.Z,et);return pt.value=ft?.value,pt}),rt}}},6452:(Cr,Ct,te)=>{te.d(Ct,{c:()=>v});class v{constructor(){this.values=[],this.id=""}}},7990:(Cr,Ct,te)=>{te.d(Ct,{Z:()=>W});var v=te(5936);class W{constructor(){this.name="",this.valueType=v.B.String,this.attributes=[],this.id="",this.params={}}}},4255:(Cr,Ct,te)=>{te.d(Ct,{$:()=>Ze});var v=te(7700),W=te(5879),qe=te(2296);let Ze=(()=>{var oe;class it{constructor(et,ft){this.dialogRef=et,this.title="Are you sure?",ft&&(this.title=ft)}onOkClick(){this.dialogRef.close(!0)}onNoClick(){this.dialogRef.close(!1)}}return(oe=it).\u0275fac=function(et){return new(et||oe)(W.Y36(v.so),W.Y36(v.WI))},oe.\u0275cmp=W.Xpm({type:oe,selectors:[["app-yes-no"]],decls:7,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(et,ft){1&et&&(W.TgZ(0,"h1",0),W._uU(1),W.qZA(),W.TgZ(2,"div",1)(3,"button",2),W.NdJ("click",function(){return ft.onNoClick()}),W._uU(4,"No"),W.qZA(),W.TgZ(5,"button",3),W.NdJ("click",function(){return ft.onOkClick()}),W._uU(6,"Yes"),W.qZA()()),2&et&&(W.xp6(1),W.Oqu(ft.title),W.xp6(1),W.Q6J("align","end"))},dependencies:[qe.lW,v.uh,v.H8]}),it})()},2946:(Cr,Ct,te)=>{te.d(Ct,{a:()=>Te});var v=te(5936),W=te(5879),qe=te(6223),Ze=te(6814),oe=te(2032),it=te(9157),rt=te(617),et=te(8034);function ft(he,wt){if(1&he&&(W.TgZ(0,"mat-error"),W._uU(1),W.qZA()),2&he){const Ne=W.oxw(2);W.xp6(1),W.Oqu(Ne.getErrorMessage())}}function pt(he,wt){if(1&he&&(W.TgZ(0,"mat-form-field")(1,"mat-label"),W._uU(2),W.qZA(),W._UZ(3,"input",3),W.YNc(4,ft,2,1,"mat-error",4),W.qZA()),2&he){const Ne=W.oxw();W.xp6(2),W.Oqu(Ne.label),W.xp6(1),W.Q6J("type","number")("formControl",Ne.control)("min",Ne.min)("max",Ne.max)("step",Ne.step),W.xp6(1),W.Q6J("ngIf",Ne.control.invalid)}}function mt(he,wt){if(1&he&&(W.TgZ(0,"mat-error"),W._uU(1),W.qZA()),2&he){const Ne=W.oxw(2);W.xp6(1),W.Oqu(Ne.getErrorMessage())}}function at(he,wt){if(1&he&&(W.TgZ(0,"mat-form-field")(1,"mat-label"),W._uU(2),W.qZA(),W._UZ(3,"input",5),W.TgZ(4,"mat-hint"),W._uU(5),W.qZA(),W._UZ(6,"mat-datepicker-toggle",6)(7,"mat-datepicker",null,7),W.YNc(9,mt,2,1,"mat-error",4),W.qZA()),2&he){const Ne=W.MAs(8),Me=W.oxw();W.xp6(2),W.Oqu(Me.label),W.xp6(1),W.Q6J("matDatepicker",Ne)("formControl",Me.control),W.xp6(2),W.Oqu(Me.getDateFormatString()),W.xp6(1),W.Q6J("for",Ne),W.xp6(3),W.Q6J("ngIf",Me.control.invalid)}}function Xe(he,wt){if(1&he){const Ne=W.EpF();W.TgZ(0,"div",10),W.NdJ("click",function(){W.CHM(Ne);const ot=W.oxw(2);return W.KtG(ot.hidePassword=!ot.hidePassword)}),W.TgZ(1,"mat-icon"),W._uU(2),W.qZA()()}if(2&he){const Ne=W.oxw(2);W.uIk("aria-label","Hide password")("aria-pressed",Ne.hidePassword),W.xp6(2),W.Oqu(Ne.hidePassword?"visibility_off":"visibility")}}function Se(he,wt){if(1&he&&(W.TgZ(0,"mat-error"),W._uU(1),W.qZA()),2&he){const Ne=W.oxw(2);W.xp6(1),W.Oqu(Ne.getErrorMessage())}}function se(he,wt){if(1&he&&(W.TgZ(0,"mat-form-field")(1,"mat-label"),W._uU(2),W.qZA(),W._UZ(3,"input",8),W.YNc(4,Xe,3,3,"div",9),W.YNc(5,Se,2,1,"mat-error",4),W.qZA()),2&he){const Ne=W.oxw();W.xp6(2),W.Oqu(Ne.label),W.xp6(1),W.Q6J("type",Ne.hidePassword?Ne.type:"text")("formControl",Ne.control),W.xp6(1),W.Q6J("ngIf","password"===Ne.type),W.xp6(1),W.Q6J("ngIf",Ne.control.invalid)}}let Te=(()=>{var he;class wt{constructor(Me){this.ngControl=Me,this.label="",this.valueType=v.B.Unknown,this.type="text",this.step=void 0,this.min=null,this.max=null,this.hidePassword=!0,this.valueTypeEnum=v.B,this.ngControl.valueAccessor=this}ngOnInit(){this.setControlType(this.valueType)}setControlType(Me){switch(Me){case v.B.Number:(null==this.min||isNaN(+this.min))&&(this.min=0),(null==this.step||isNaN(+this.step))&&(this.step=1),this.type="number";break;case v.B.Decimal:(null==this.min||isNaN(+this.min))&&(this.min=0),(null==this.step||isNaN(+this.step))&&(this.step=.01),this.type="number";break;case v.B.Date:this.type="date";break;default:this.type="text"}}getDateFormatString(){return"MM/DD/YYYY"}writeValue(Me){}registerOnChange(Me){}registerOnTouched(Me){}setDisabledState(Me){}get control(){return this.ngControl.control}getErrorMessage(){return this.ngControl.hasError("required")?`Please enter a ${this.label}`:this.ngControl.hasError("minlength")?`${this.label} must be at least ${this.ngControl.errors?.minlength.requiredLength} characters`:this.ngControl.hasError("maxlength")?`${this.label} must be at most ${this.ngControl.errors?.maxlength.requiredLength} characters`:this.ngControl.hasError("min")?`${this.label} must be at least ${this.ngControl.errors?.min.min}`:this.ngControl.hasError("max")?`${this.label} must be at most ${this.ngControl.errors?.max.max}`:this.ngControl.hasError("notMatching")?`${this.label} do not match`:this.ngControl.hasError("email")?"Not a valid email":""}}return(he=wt).\u0275fac=function(Me){return new(Me||he)(W.Y36(qe.a5,2))},he.\u0275cmp=W.Xpm({type:he,selectors:[["app-input"]],inputs:{label:"label",valueType:"valueType",type:"type",step:"step",min:"min",max:"max"},decls:4,vars:3,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["matInput","",3,"type","formControl","min","max","step"],[4,"ngIf"],["matInput","",3,"matDatepicker","formControl"],["matIconSuffix","",3,"for"],["picker",""],["matInput","",3,"type","formControl"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"click"]],template:function(Me,ot){1&Me&&(W.ynx(0,0),W.YNc(1,pt,5,7,"mat-form-field",1),W.YNc(2,at,10,6,"mat-form-field",1),W.YNc(3,se,6,5,"mat-form-field",2),W.BQk()),2&Me&&(W.Q6J("ngSwitch",ot.valueType),W.xp6(1),W.Q6J("ngSwitchCase",ot.valueType===ot.valueTypeEnum.Number||ot.valueType===ot.valueTypeEnum.Decimal?ot.valueType:""),W.xp6(1),W.Q6J("ngSwitchCase",ot.valueTypeEnum.Date))},dependencies:[Ze.O5,Ze.RF,Ze.n9,Ze.ED,oe.Nt,it.KE,it.hX,it.bx,it.TO,it.R9,rt.Hw,et.Mq,et.hl,et.nW,qe.Fj,qe.JJ,qe.oH],styles:[".mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}"]}),wt})()},1193:(Cr,Ct,te)=>{te.d(Ct,{T:()=>W});var v=te(5879);let W=(()=>{var qe;class Ze{set longPress(it){!1===it&&this.endPress(),this.enabled=it}constructor(it,rt){this.elRef=it,this.renderer=rt,this.enabled=!0,this.pressing=!1,this.longPressing=!1,this.longPressDuration=500,this.longPressingInterval=0,this.onLongPress=new v.vpe,this.onLongPressing=new v.vpe,this.onLongPressEnd=new v.vpe}onMouseDown(it){this.enabled&&(this.renderer.addClass(this.elRef.nativeElement,"ripple-press"),this.pressing=!0,this.longPressing=!1,this.timeout=setTimeout(()=>{this.longPressing=!0,this.onLongPress.emit(it),this.longPressingInterval>0&&(this.interval=setInterval(()=>{this.onLongPressing.emit(it)},this.longPressingInterval))},this.longPressDuration))}endPress(){this.longPressing&&this.onLongPressEnd.emit(this.elRef.nativeElement);try{clearTimeout(this.timeout),clearInterval(this.interval)}catch{}this.longPressing=!1,this.pressing=!1}ngOnDestroy(){try{clearTimeout(this.timeout),clearInterval(this.interval)}catch{}}}return(qe=Ze).\u0275fac=function(it){return new(it||qe)(v.Y36(v.SBq),v.Y36(v.Qsj))},qe.\u0275dir=v.lG2({type:qe,selectors:[["","longPress",""]],hostBindings:function(it,rt){1&it&&v.NdJ("touchstart",function(ft){return rt.onMouseDown(ft)})("mousedown",function(ft){return rt.onMouseDown(ft)})("touchend",function(){return rt.endPress()})("mouseup",function(){return rt.endPress()})("mouseleave",function(){return rt.endPress()})},inputs:{longPress:"longPress",longPressDuration:"longPressDuration",longPressingInterval:"longPressingInterval"},outputs:{onLongPress:"onLongPress",onLongPressing:"onLongPressing",onLongPressEnd:"onLongPressEnd"}}),Ze})()},2057:(Cr,Ct,te)=>{te.d(Ct,{I:()=>qe});var v=te(6814),W=te(5879);let qe=(()=>{var Ze;class oe{}return(Ze=oe).\u0275fac=function(rt){return new(rt||Ze)},Ze.\u0275mod=W.oAB({type:Ze}),Ze.\u0275inj=W.cJS({imports:[v.ez]}),oe})()},1658:(Cr,Ct,te)=>{te.d(Ct,{C:()=>Xe});var v=te(6814),W=te(8814),qe=te(2057),Ze=te(4833),oe=te(1534),it=te(6223),rt=te(9886),et=te(5879);let ft=(()=>{var Se;class se{}return(Se=se).\u0275fac=function(he){return new(he||Se)},Se.\u0275mod=et.oAB({type:Se}),Se.\u0275inj=et.cJS({imports:[v.ez,rt.vQ,W.A]}),se})(),pt=(()=>{var Se;class se{}return(Se=se).\u0275fac=function(he){return new(he||Se)},Se.\u0275mod=et.oAB({type:Se}),Se.\u0275inj=et.cJS({imports:[v.ez,it.u5,it.UX,W.A]}),se})(),mt=(()=>{var Se;class se{}return(Se=se).\u0275fac=function(he){return new(he||Se)},Se.\u0275mod=et.oAB({type:Se}),Se.\u0275inj=et.cJS({imports:[v.ez,W.A]}),se})();var at=te(4013);let Xe=(()=>{var Se;class se{}return(Se=se).\u0275fac=function(he){return new(he||Se)},Se.\u0275mod=et.oAB({type:Se}),Se.\u0275inj=et.cJS({providers:[at.T],imports:[v.ez,W.A,qe.I,Ze.$,oe.A,it.u5,ft,pt,mt]}),se})()},8685:(Cr,Ct,te)=>{te.d(Ct,{J:()=>ns});var v=te(5879),W=te(6452),qe=te(7990);class Ze extends W.c{constructor(){super(...arguments),this.count=1}}class oe extends Ze{constructor(){super(...arguments),this.isGroupBy=!1,this.groupValue=new qe.Z,this.isSummary=!1}}var it=te(6236),rt=te(4255),et=te(5936),ft=te(5313),pt=te(5619),mt=te(2096),at=te(7398),Xe=te(2572),Se=te(8180),se=te(2372),Te=te(6223),he=te(7700),wt=te(2296),Ne=te(2946);let Me=(()=>{var ce;class Ye{constructor(Y,Z,ne){this.dialogRef=Y,this.fb=ne,this.form=new Te.cw({}),this.valueTypeEnum=et.B,this.data=Z}ngOnInit(){this.initializeForm()}initializeForm(){this.form=this.fb.group({count:new Te.NI(this.data,[Te.kI.required,Te.kI.min(1)])})}onOkClick(){this.dialogRef.close(+this.form.value.count)}onNoClick(){this.dialogRef.close()}}return(ce=Ye).\u0275fac=function(Y){return new(Y||ce)(v.Y36(he.so),v.Y36(he.WI),v.Y36(Te.qu))},ce.\u0275cmp=v.Xpm({type:ce,selectors:[["app-edit-count"]],decls:10,vars:7,consts:[["mat-dialog-title",""],["autocomplete","off",1,"form",3,"formGroup","ngSubmit"],["mat-dialog-content",""],[3,"formControl","valueType","label","min"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","basic","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit","cdkFocusInitial","",3,"disabled"]],template:function(Y,Z){1&Y&&(v.TgZ(0,"h1",0),v._uU(1,"Edit count"),v.qZA(),v.TgZ(2,"form",1),v.NdJ("ngSubmit",function(){return Z.form.valid&&Z.onOkClick()}),v.TgZ(3,"div",2),v._UZ(4,"app-input",3),v.qZA(),v.TgZ(5,"div",4)(6,"button",5),v.NdJ("click",function(){return Z.onNoClick()}),v._uU(7,"Cancel"),v.qZA(),v.TgZ(8,"button",6),v._uU(9,"Save"),v.qZA()()()),2&Y&&(v.xp6(2),v.Q6J("formGroup",Z.form),v.xp6(2),v.Q6J("formControl",Z.form.controls.count)("valueType",Z.valueTypeEnum.Number)("label","Count")("min",1),v.xp6(1),v.Q6J("align","end"),v.xp6(3),v.Q6J("disabled",!Z.form.valid))},dependencies:[Te._Y,Te.JJ,Te.JL,Te.oH,Te.sg,wt.lW,he.uh,he.xY,he.H8,Ne.a]}),Ye})();var ot=te(6825),Pt=te(1418),Kt=te(6592),xt=te(2942),_n=te(8763),$n=te(2032),On=te(9157);let Ur=(()=>{var ce;class Ye{constructor(Y,Z,ne,Fe){this.dialogRef=Y,this.complectsService=ne,this.toastr=Fe,this.data=Object.assign({},Z)}getTitle(){return this.data.id?"Edit group":"Add group"}onOkClick(){this.complectsService.saveGroup(this.data).subscribe({next:Y=>{Y?(this.toastr.info("Done!"),this.dialogRef.close(Y)):this.toastr.error("Error with saving group!")},error:Y=>this.toastr.error(Y.error)})}onNoClick(){this.dialogRef.close()}}return(ce=Ye).\u0275fac=function(Y){return new(Y||ce)(v.Y36(he.so),v.Y36(he.WI),v.Y36(xt.s),v.Y36(_n._W))},ce.\u0275cmp=v.Xpm({type:ce,selectors:[["app-group-edit-dialog"]],decls:12,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(Y,Z){1&Y&&(v.TgZ(0,"h1",0),v._uU(1),v.qZA(),v.TgZ(2,"div",1)(3,"mat-form-field")(4,"mat-label"),v._uU(5,"Name"),v.qZA(),v.TgZ(6,"input",2),v.NdJ("ngModelChange",function(Fe){return Z.data.name=Fe}),v.qZA()()(),v.TgZ(7,"div",3)(8,"button",4),v.NdJ("click",function(){return Z.onNoClick()}),v._uU(9,"Cancel"),v.qZA(),v.TgZ(10,"button",5),v.NdJ("click",function(){return Z.onOkClick()}),v._uU(11,"Save"),v.qZA()()),2&Y&&(v.xp6(1),v.Oqu(Z.getTitle()),v.xp6(5),v.Q6J("ngModel",Z.data.name),v.xp6(1),v.Q6J("align","end"))},dependencies:[Te.Fj,Te.JJ,Te.On,wt.lW,$n.Nt,On.KE,On.hX,he.uh,he.xY,he.H8],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),Ye})();var ai=te(4013),Sr=te(6814),Yi=te(5195),jn=te(7988),br=te(617),Gs=te(2596),Hr=te(5986),si=te(8525),Gn=te(3680),vn=te(9014),ki=te(1193),ya=te(957),Qo=te(8260),qo=te(9886);function Xs(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-option",9),v._uU(1),v.qZA()),2&ce){const le=Ye.$implicit;v.s9C("value",le.id),v.xp6(1),v.hij(" ",le.name," ")}}let Xn=(()=>{var ce;class Ye{constructor(){this.subsctiptions=[],this.chartData={},this.chartOptions={},this.chartPlugins=[],this.doughnutChartType="doughnut",this.propertiesDigit$=(0,mt.of)([]),this.summPropertyIdSource=new pt.X(void 0),this.summPropertyId$=this.summPropertyIdSource.asObservable(),this.items$=(0,mt.of)([]),this.properties$=(0,mt.of)([]),this.groups$=(0,mt.of)([]),this.groupPropertyId$=(0,mt.of)(null),this.categoryGroupId="category",this.summPropertyIdChanged=new v.vpe}ngOnInit(){this.chartPlugins.push(this.getHtmlLegendPlugin()),this.chartOptions=this.getChartOptions(),this.summPropertyIdSource.next(this.summPropertyId??"count"),this.propertiesDigit$=this.properties$.pipe((0,at.U)(Z=>Z?.filter(ne=>ne.valueType===et.B.Decimal||ne.valueType===et.B.Number)??[]));const Y=(0,Xe.a)([this.groups$,this.propertiesDigit$,this.items$,this.groupPropertyId$,this.summPropertyId$]).subscribe(Z=>{this.chartData=this.getChartData(Z[0],Z[1],Z[2],Z[3],Z[4])});this.subsctiptions.push(Y)}ngOnDestroy(){this.subsctiptions.forEach(Y=>{Y.unsubscribe()})}onSummPropertyIdChanged(Y){this.summPropertyIdSource.next(Y),this.summPropertyIdChanged.emit(Y)}getHtmlLegendPlugin(){return{id:"htmlLegend",afterUpdate(ne,Fe,Be){const Qe=((ne,Fe)=>{const Be=document.getElementById("legend-container");let Qe=Be?.querySelector("ul");return!Qe&&Be&&(Qe=document.createElement("ul"),Qe.className="legend",Be.appendChild(Qe)),Qe})();for(;Qe?.firstChild;)Qe.firstChild.remove();const yt=ne.options.plugins.legend.labels.generateLabels(ne),xr=ne.data.datasets[0].data;yt.forEach((kr,fn)=>{const Yn=document.createElement("li");Yn.className="item",Yn.onclick=()=>{const{type:Zn}=ne.config;"pie"===Zn||"doughnut"===Zn?ne.toggleDataVisibility(kr.index):ne.setDatasetVisibility(kr.datasetIndex,!ne.isDatasetVisible(kr.datasetIndex)),ne.update()};const Pr=document.createElement("span");Pr.style.background=kr.fillStyle,Pr.style.borderColor=kr.strokeStyle,Pr.style.borderWidth=kr.lineWidth+"px",Pr.className="marker";const lt=document.createElement("p");lt.className="name",lt.style.color=kr.fontColor,lt.style.textDecoration=kr.hidden?"line-through":"";const nr=document.createTextNode(kr.text);lt.appendChild(nr);const ka=document.createElement("p");ka.className="data",ka.style.color=kr.fontColor,ka.style.textDecoration=kr.hidden?"line-through":"";const Rn=document.createTextNode(xr[fn]);ka.appendChild(Rn),Yn.appendChild(Pr),Yn.appendChild(lt),Yn.appendChild(ka),Qe?.appendChild(Yn)})}}}getChartOptions(){return{responsive:!0,plugins:{legend:{display:!1}}}}getChartData(Y,Z,ne,Fe,Be){const Qe=[];if(Y&&ne){let yt={};yt=Fe&&Fe!==this.categoryGroupId?this.groupItemsByGrouppingField(Y,ne,Fe):this.groupItemsByGroups(Y,ne),Object.keys(yt).forEach(xr=>{Qe.push({key:yt[xr].name,value:yt[xr].items.reduce((kr,fn)=>kr+(Be&&"count"!==Be?+(fn.values.find(Yn=>Yn.id===Be)?.value??"0")*fn.count:fn.count),0)})})}return{labels:Qe?.map(yt=>yt.key),datasets:[{data:Qe?.map(yt=>yt.value)}]}}getGroupItems(Y,Z){return Z.map(ne=>({groupItem:ne,item:Y.find(Fe=>Fe.id===ne.itemId)})).filter(ne=>ne.item).map(ne=>Object.assign(new Ze,ne.item,ne.groupItem))}groupItemsByGroups(Y,Z){const ne={};return Y.forEach(Fe=>{ne[Fe.id??""]={name:Fe.name??"",items:this.getGroupItems(Z,Fe.items)}}),ne}groupItemsByGrouppingField(Y,Z,ne){return this.getGroupItems(Z,Y.map(Be=>Be.items)?.flat()??[]).reduce((Be,Qe)=>{const yt=Qe.values.find(xr=>xr.id==ne)?.value??"";return Be[yt]||(Be[yt]={name:yt,items:[]}),Be[yt].items.push(Qe),Be},{})}chartClicked({}){}chartHovered({}){}}return(ce=Ye).\u0275fac=function(Y){return new(Y||ce)},ce.\u0275cmp=v.Xpm({type:ce,selectors:[["app-chart"]],inputs:{items$:"items$",properties$:"properties$",groups$:"groups$",groupPropertyId$:"groupPropertyId$",categoryGroupId:"categoryGroupId",summPropertyId:"summPropertyId"},outputs:{summPropertyIdChanged:"summPropertyIdChanged"},decls:14,vars:10,consts:[[1,"container"],[1,"chart-container"],["baseChart","",1,"chart",3,"type","data","options","plugins"],[1,"data-container"],["appearance","outline",1,"small-outlined-select"],[3,"value","valueChange"],["value","count",1,"complect__group-select-item"],["class","complect__group-select-item",3,"value",4,"ngFor","ngForOf"],["id","legend-container",1,"legend-container"],[1,"complect__group-select-item",3,"value"]],template:function(Y,Z){1&Y&&(v.TgZ(0,"div",0)(1,"div",1),v._UZ(2,"canvas",2),v.qZA(),v.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),v._uU(6,"Summ by"),v.qZA(),v.TgZ(7,"mat-select",5),v.NdJ("valueChange",function(Fe){return Z.onSummPropertyIdChanged(Fe)}),v.ALo(8,"async"),v.TgZ(9,"mat-option",6),v._uU(10,"Count"),v.qZA(),v.YNc(11,Xs,2,2,"mat-option",7),v.ALo(12,"async"),v.qZA()(),v._UZ(13,"div",8),v.qZA()()),2&Y&&(v.xp6(2),v.Q6J("type","doughnut")("data",Z.chartData)("options",Z.chartOptions)("plugins",Z.chartPlugins),v.xp6(5),v.Q6J("value",v.lcZ(8,6,Z.summPropertyId$)),v.xp6(4),v.Q6J("ngForOf",v.lcZ(12,8,Z.propertiesDigit$)))},dependencies:[Sr.sg,qo.jh,On.KE,On.hX,si.gD,Gn.ey,Sr.Ov],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:10px}.chart-container[_ngcontent-%COMP%]{position:relative;height:100%;max-width:200px;max-height:200px}.data-container[_ngcontent-%COMP%]   .small-outlined-select[_ngcontent-%COMP%]{margin-top:5px}  .legend{margin-top:5px;display:flex;flex-direction:column;gap:2px;max-height:160px;overflow-y:auto}  .legend .item{align-items:center;cursor:pointer;display:flex;flex-direction:row;justify-content:stretch;gap:10px;word-wrap:break-word}  .legend .item .marker{display:inline-block;flex-shrink:0;height:20px;width:20px}  .legend .item .name{margin:0;padding:0;flex-grow:1;width:120px}  .legend .item .data{margin:0;padding:0;width:50px}"]}),Ye})();var In=te(7685),Ys=te(342);function Ti(ce,Ye){1&ce&&(v.TgZ(0,"mat-icon"),v._uU(1,"edit"),v.qZA())}function Zs(ce,Ye){1&ce&&(v.TgZ(0,"mat-icon"),v._uU(1,"add"),v.qZA())}function gt(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"button",10),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.onEditComplectClick())}),v.YNc(1,Ti,2,0,"mat-icon",11),v.ALo(2,"async"),v.YNc(3,Zs,2,0,"mat-icon",11),v.ALo(4,"async"),v.qZA()}if(2&ce){const le=v.oxw();v.xp6(1),v.Q6J("ngIf",v.lcZ(2,2,le.complect$)),v.xp6(2),v.Q6J("ngIf",!v.lcZ(4,4,le.complect$))}}function Ks(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"button",12),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.onCloneComplectClick())}),v.TgZ(1,"mat-icon"),v._uU(2,"control_point_duplicate"),v.qZA()()}}function Ei(ce,Ye){1&ce&&(v.TgZ(0,"button",13)(1,"mat-icon"),v._uU(2,"download"),v.qZA()())}function ts(ce,Ye){if(1&ce&&(v.TgZ(0,"button",14)(1,"mat-icon"),v._uU(2,"ios_share"),v.qZA()()),2&ce){v.oxw();const le=v.MAs(8);v.Q6J("matMenuTriggerFor",le)}}function Wr(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"button",15),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.onCopyToClipboard())}),v.ALo(1,"async"),v.TgZ(2,"mat-icon",7),v._uU(3,"content_copy"),v.qZA(),v._uU(4," Link "),v.qZA()}if(2&ce){const le=v.oxw();let Y;v.Q6J("cdkCopyToClipboard",null!==(Y=v.lcZ(1,1,le.complectLink$))&&void 0!==Y?Y:"")}}let Js=(()=>{var ce;class Ye{constructor(Y){this.toastr=Y,this.isReadonly=!1,this.complect$=(0,mt.of)(null),this.onEditComplect=new v.vpe,this.onCloneComplect=new v.vpe,this.onExportComplect=new v.vpe,this.complectLink$=(0,mt.of)(""),this.FileTypeEnum=In.W}ngOnInit(){this.complectLink$=this.complect$.pipe((0,at.U)(Y=>Y?.id?`${location.origin}/shared/${Y.id}`:""))}onEditComplectClick(){this.onEditComplect.emit()}onCloneComplectClick(){this.onCloneComplect.emit()}onCopyToClipboard(){this.toastr.success("Link was copied to the clipboard")}onExportComplectClick(Y){this.onExportComplect.emit(Y)}}return(ce=Ye).\u0275fac=function(Y){return new(Y||ce)(v.Y36(_n._W))},ce.\u0275cmp=v.Xpm({type:ce,selectors:[["app-complect-items-header-buttons"]],inputs:{isReadonly:"isReadonly",complect$:"complect$"},outputs:{onEditComplect:"onEditComplect",onCloneComplect:"onCloneComplect",onExportComplect:"onExportComplect"},decls:23,vars:13,consts:[["mat-icon-button","","color","primary","aria-label","Edit","class","small-button",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Edit item","class","small-button","matTooltip","Clone",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Import","class","small-button","matTooltip","Import",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Export","class","small-button","matTooltip","Export",3,"matMenuTriggerFor",4,"ngIf"],["exportMenu","matMenu"],["mat-menu-item","","color","primary","aria-label","Copy link to clipboard","matTooltip","Copy link to clipboard",3,"cdkCopyToClipboard","click",4,"ngIf"],["mat-menu-item","","color","primary","aria-label","Save as XLSX","matTooltip","Save as XLSX",3,"click"],["color","primary"],["mat-menu-item","","color","primary","aria-label","Save as CSV","matTooltip","Save as CSV",3,"click"],["mat-menu-item","","color","primary","aria-label","Save as JSON","matTooltip","Save as JSON",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit",1,"small-button",3,"click"],[4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Clone",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Import","matTooltip","Import",1,"small-button"],["mat-icon-button","","color","primary","aria-label","Export","matTooltip","Export",1,"small-button",3,"matMenuTriggerFor"],["mat-menu-item","","color","primary","aria-label","Copy link to clipboard","matTooltip","Copy link to clipboard",3,"cdkCopyToClipboard","click"]],template:function(Y,Z){if(1&Y&&(v.YNc(0,gt,5,6,"button",0),v.YNc(1,Ks,3,0,"button",1),v.ALo(2,"async"),v.YNc(3,Ei,3,0,"button",2),v.ALo(4,"async"),v.YNc(5,ts,3,1,"button",3),v.ALo(6,"async"),v.TgZ(7,"mat-menu",null,4),v.YNc(9,Wr,5,3,"button",5),v.ALo(10,"async"),v.TgZ(11,"button",6),v.NdJ("click",function(){return Z.onExportComplectClick(Z.FileTypeEnum.XLSX)}),v.TgZ(12,"mat-icon",7),v._uU(13,"save"),v.qZA(),v._uU(14," Exel "),v.qZA(),v.TgZ(15,"button",8),v.NdJ("click",function(){return Z.onExportComplectClick(Z.FileTypeEnum.CSV)}),v.TgZ(16,"mat-icon",7),v._uU(17,"save"),v.qZA(),v._uU(18," CSV "),v.qZA(),v.TgZ(19,"button",9),v.NdJ("click",function(){return Z.onExportComplectClick(Z.FileTypeEnum.JSON)}),v.TgZ(20,"mat-icon",7),v._uU(21,"save"),v.qZA(),v._uU(22," JSON "),v.qZA()()),2&Y){let ne;v.Q6J("ngIf",!Z.isReadonly),v.xp6(1),v.Q6J("ngIf",!Z.isReadonly&&v.lcZ(2,5,Z.complect$)),v.xp6(2),v.Q6J("ngIf",v.lcZ(4,7,Z.complect$)),v.xp6(2),v.Q6J("ngIf",v.lcZ(6,9,Z.complect$)),v.xp6(4),v.Q6J("ngIf",null==(ne=v.lcZ(10,11,Z.complect$))?null:ne.isShared)}},dependencies:[Sr.O5,wt.RK,jn.VK,jn.OP,jn.p6,br.Hw,Gs.gM,Ys.i3,Sr.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;gap:4px;padding:0 4px}"]}),Ye})();function Ut(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-option",10),v._uU(1),v.qZA()),2&ce){const le=Ye.$implicit;v.s9C("value",le.id),v.xp6(1),v.hij(" ",le.name," ")}}function tr(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"mat-card-header",3)(1,"div",4)(2,"h4",5),v._uU(3),v.ALo(4,"async"),v.qZA(),v.TgZ(5,"mat-form-field",6),v.ALo(6,"async"),v.TgZ(7,"mat-label"),v._uU(8,"Category"),v.qZA(),v.TgZ(9,"mat-select",7),v.NdJ("valueChange",function(Z){v.CHM(le);const ne=v.oxw();return v.KtG(ne.onCurrentCategoryIdChanged(Z))}),v.ALo(10,"async"),v.YNc(11,Ut,2,2,"mat-option",8),v.ALo(12,"async"),v.qZA()()(),v.TgZ(13,"button",9),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.onActiveClick())}),v.TgZ(14,"mat-icon"),v._uU(15,"work_outline"),v.qZA()()()}if(2&ce){const le=v.oxw();let Y,Z;v.xp6(3),v.hij("",null==(Y=v.lcZ(4,4,le.complect$))?null:Y.name," "),v.xp6(2),v.Q6J("matBadge",v.lcZ(6,6,le.currentGroupCount$)),v.xp6(4),v.Q6J("value",v.lcZ(10,8,le.currentCategoryId$)),v.xp6(2),v.Q6J("ngForOf",null==(Z=v.lcZ(12,10,le.complect$))?null:Z.groups)}}function Mt(ce,Ye){if(1&ce&&v._UZ(0,"app-chart",25),2&ce){const le=v.oxw(2);v.Q6J("items$",le.items$)("properties$",le.properties$)("categoryGroupId",le.categoryGroupId)("groupPropertyId$",le.groupPropertyId$)("groups$",le.groups$)}}function sr(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-option",10),v._uU(1),v.qZA()),2&ce){const le=Ye.$implicit;v.s9C("value",le.id),v.xp6(1),v.hij(" ",le.name," ")}}function ln(ce,Ye){1&ce&&v._UZ(0,"div",32)}function Tt(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"li",28),v.YNc(1,ln,1,0,"div",29),v.TgZ(2,"mat-checkbox",30),v.NdJ("ngModelChange",function(Z){const Fe=v.CHM(le).$implicit;return v.KtG(Fe.params.complectDisplay=Z)})("click",function(Z){return Z.stopPropagation()})("change",function(){const ne=v.CHM(le).$implicit,Fe=v.oxw(3);return v.KtG(Fe.onTableHeaderSelected(ne.params))}),v._uU(3),v.qZA(),v.TgZ(4,"mat-icon",31),v._uU(5," swap_vert "),v.qZA()()}if(2&ce){const le=Ye.$implicit;v.xp6(2),v.Q6J("ngModel",le.params.complectDisplay)("disableRipple",!0),v.xp6(1),v.hij(" ",le.name," ")}}function ec(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"ul",26),v.NdJ("cdkDropListDropped",function(Z){v.CHM(le);const ne=v.oxw(2);return v.KtG(ne.onHeaderDrop(Z))}),v.YNc(1,Tt,6,3,"li",27),v.qZA()}if(2&ce){const le=Ye.ngIf;v.Q6J("cdkDropListData",le),v.xp6(1),v.Q6J("ngForOf",le)}}function Ci(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-header-cell",51)(1,"span"),v._uU(2),v.qZA()()),2&ce){const le=v.oxw(2).$implicit;v.Q6J("ngClass",le.class),v.xp6(2),v.Oqu(le.header)}}function $t(ce,Ye){1&ce&&v.YNc(0,Ci,3,2,"mat-header-cell",50)}function Gt(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-header-cell",53)(1,"span"),v._uU(2),v.qZA()()),2&ce){const le=v.oxw(2).$implicit;v.Q6J("ngClass",le.class),v.xp6(2),v.Oqu(le.header)}}function ba(ce,Ye){1&ce&&v.YNc(0,Gt,3,2,"mat-header-cell",52)}function wn(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"mat-icon",58),v.NdJ("mousedown",function(){v.CHM(le);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!1)})("mouseUp",function(){v.CHM(le);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!0)})("touchstart",function(){v.CHM(le);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!1)})("touchend",function(){v.CHM(le);const Z=v.oxw(6);return v.KtG(Z.dragDisabled=!0)}),v._uU(1,"more_vert"),v.qZA()}}function rs(ce,Ye){if(1&ce&&(v.ynx(0),v.YNc(1,wn,2,0,"mat-icon",57),v.BQk()),2&ce){const le=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!le.isSummary)}}function tc(ce,Ye){if(1&ce&&(v.ynx(0),v.TgZ(1,"span",59),v._uU(2),v.qZA(),v.BQk()),2&ce){const le=v.oxw().$implicit;v.xp6(2),v.Oqu(le.count)}}function Zi(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"div",15)(1,"button",61),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw(2).$implicit,ne=v.oxw(4);return v.KtG(ne.openEditItemCountDialog(Z))}),v.TgZ(2,"i",62),v._uU(3,"\xb1"),v.qZA()(),v.TgZ(4,"button",63),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw(2).$implicit,ne=v.oxw(4);return v.KtG(ne.openEditItemDialog(Z))}),v.TgZ(5,"mat-icon"),v._uU(6,"edit"),v.qZA()(),v.TgZ(7,"button",64),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw(2).$implicit,ne=v.oxw(4);return v.KtG(ne.openDeleteComplectItemDialog(Z))}),v.TgZ(8,"mat-icon"),v._uU(9,"delete"),v.qZA()()()}}function Si(ce,Ye){if(1&ce&&(v.ynx(0),v.YNc(1,Zi,10,0,"div",60),v.BQk()),2&ce){const le=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!le.isSummary)}}function Qs(ce,Ye){if(1&ce&&(v.ynx(0),v.TgZ(1,"span",65),v._uU(2),v.qZA(),v.BQk()),2&ce){const le=v.oxw().$implicit,Y=v.oxw().$implicit;v.xp6(2),v.Oqu(Y.cell(le))}}function Ml(ce,Ye){if(1&ce&&(v.ynx(0),v._UZ(1,"app-item-value",66),v.BQk()),2&ce){const le=v.oxw().$implicit,Y=v.oxw().$implicit;v.xp6(1),v.Q6J("property",Y.property)("value",Y.cell(le))}}function qs(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-cell",54),v.YNc(1,rs,2,1,"ng-container",55),v.YNc(2,tc,3,1,"ng-container",55),v.YNc(3,Si,2,1,"ng-container",55),v.YNc(4,Qs,3,1,"ng-container",55),v.YNc(5,Ml,2,2,"ng-container",56),v.qZA()),2&ce){const le=v.oxw().$implicit;v.Q6J("ngClass",le.class)("ngSwitch",le.columnDef),v.xp6(1),v.Q6J("ngSwitchCase","move-item"),v.xp6(1),v.Q6J("ngSwitchCase","count"),v.xp6(1),v.Q6J("ngSwitchCase","actions"),v.xp6(1),v.Q6J("ngSwitchCase","category")}}function eo(ce,Ye){if(1&ce&&(v.ynx(0,45)(1,46),v.YNc(2,$t,1,0,"ng-template",47),v.YNc(3,ba,1,0,"ng-template",48),v.BQk(),v.YNc(4,qs,6,6,"mat-cell",49),v.BQk()),2&ce){const le=Ye.$implicit;v.Q6J("matColumnDef",le.columnDef),v.xp6(1),v.Q6J("ngSwitch",le.columnDef),v.xp6(1),v.s9C("ngSwitchCase","count"===le.columnDef||"actions"===le.columnDef||"move-item"===le.columnDef)}}function to(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"mat-cell",67)(1,"div",68)(2,"span"),v._uU(3),v.qZA(),v._UZ(4,"app-item-value",66),v.TgZ(5,"span"),v._uU(6,'"'),v.qZA()(),v.TgZ(7,"div",15)(8,"button",63),v.NdJ("click",function(){const ne=v.CHM(le).$implicit,Fe=v.oxw(3);return v.KtG(Fe.openEditGroupDialog(ne))}),v.TgZ(9,"mat-icon"),v._uU(10,"edit"),v.qZA()(),v.TgZ(11,"button",64),v.NdJ("click",function(){const ne=v.CHM(le).$implicit,Fe=v.oxw(3);return v.KtG(Fe.openDeleteGroupDialog(ne))}),v.TgZ(12,"mat-icon"),v._uU(13,"delete"),v.qZA()()()()}if(2&ce){const le=Ye.$implicit;v.xp6(3),v.hij("",le.groupValue.name,': "'),v.xp6(1),v.Q6J("property",le.groupValue)("value",le.groupValue.value)}}function Pn(ce,Ye){if(1&ce&&v._UZ(0,"app-item-view",72),2&ce){const le=v.oxw().$implicit;v.Q6J("item",le)}}function Ir(ce,Ye){if(1&ce&&(v.TgZ(0,"mat-cell",69)(1,"div",70),v.YNc(2,Pn,1,1,"app-item-view",71),v.qZA()()),2&ce){const le=Ye.$implicit,Y=v.oxw().ngIf,Z=v.oxw(2);v.ekj("hidden",le!==Z.expandedElement),v.uIk("colspan",Y.length),v.xp6(1),v.Q6J("@detailExpand",le==Z.expandedElement?"expanded":"collapsed"),v.xp6(1),v.Q6J("ngIf",le==Z.expandedElement)}}function Ai(ce,Ye){1&ce&&v._UZ(0,"mat-header-row",73)}function Mn(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"mat-row",74),v.NdJ("click",function(Z){const Fe=v.CHM(le).$implicit,Be=v.oxw(3);return v.KtG(Be.onItemClick(Fe,Z))})("onLongPress",function(Z){const Fe=v.CHM(le).$implicit,Be=v.oxw(3);return v.KtG(Be.onItemLongPress(Fe,Z))}),v.qZA()}if(2&ce){const le=Ye.$implicit,Y=v.oxw(3);v.ekj("expanded-row",Y.expandedElement===le),v.Q6J("cdkDragData",le)("longPress",!0)}}function ro(ce,Ye){1&ce&&v._UZ(0,"mat-row",75)}function rc(ce,Ye){1&ce&&v._UZ(0,"mat-row",76),2&ce&&v.Q6J("cdkDragData",Ye.$implicit)("cdkDragDisabled",!0)}function Rt(ce,Ye){1&ce&&v._UZ(0,"mat-row",77),2&ce&&v.Q6J("cdkDragData",Ye.$implicit)("cdkDragDisabled",!0)}const rr=function(){return["expandedDetail"]},nc=function(){return["groupHeader"]};function Ki(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"mat-table",33,34),v.NdJ("cdkDropListDropped",function(Z){v.CHM(le);const ne=v.oxw(2);return v.KtG(ne.onItemDrop(Z))}),v.YNc(2,eo,5,3,"ng-container",35),v.ALo(3,"async"),v.ynx(4,36),v.YNc(5,to,14,3,"mat-cell",37),v.BQk(),v.ynx(6,38),v.YNc(7,Ir,3,5,"mat-cell",39),v.BQk(),v.YNc(8,Ai,1,0,"mat-header-row",40),v.ALo(9,"async"),v.YNc(10,Mn,1,4,"mat-row",41),v.ALo(11,"async"),v.YNc(12,ro,1,0,"mat-row",42),v.YNc(13,rc,1,2,"mat-row",43),v.ALo(14,"async"),v.YNc(15,Rt,1,2,"mat-row",44),v.qZA()}if(2&ce){const le=v.oxw(2);v.Q6J("dataSource",le.dataSource)("cdkDropListData",le.dataSource)("cdkDropListDisabled",le.dragDisabled),v.xp6(2),v.Q6J("ngForOf",v.lcZ(3,14,le.columnViews$)),v.xp6(6),v.Q6J("matHeaderRowDef",v.lcZ(9,16,le.displayedColumns$))("matHeaderRowDefSticky",!0),v.xp6(2),v.Q6J("matRowDefColumns",v.lcZ(11,18,le.displayedColumns$))("matRowDefWhen",le.isItem),v.xp6(2),v.Q6J("matRowDefColumns",v.DdM(22,rr))("matRowDefWhen",le.isItem),v.xp6(1),v.Q6J("matRowDefColumns",v.lcZ(14,20,le.displayedColumns$))("matRowDefWhen",le.isSummary),v.xp6(2),v.Q6J("matRowDefColumns",v.DdM(23,nc))("matRowDefWhen",le.isGroup)}}function Cn(ce,Ye){if(1&ce){const le=v.EpF();v.TgZ(0,"div",78)(1,"div",79)(2,"button",80),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw(2);return v.KtG(Z.openAddGroupDialog())}),v.TgZ(3,"mat-icon"),v._uU(4,"add"),v.qZA()()()()}}function Xt(ce,Ye){if(1&ce){const le=v.EpF();v.ynx(0),v.YNc(1,Mt,1,5,"app-chart",11),v.TgZ(2,"mat-card-header",4)(3,"mat-card-title",12)(4,"span",13),v._uU(5),v.ALo(6,"async"),v.qZA(),v.TgZ(7,"app-complect-items-header-buttons",14),v.NdJ("onEditComplect",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.openEditComplectDialog())})("onCloneComplect",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.openCloneComplectDialog())})("onExportComplect",function(Z){v.CHM(le);const ne=v.oxw();return v.KtG(ne.exportComplect(Z))}),v.qZA()(),v.TgZ(8,"mat-card-subtitle"),v._uU(9),v.ALo(10,"async"),v.qZA(),v.TgZ(11,"div",15)(12,"mat-form-field",16)(13,"mat-label"),v._uU(14,"Show by"),v.qZA(),v.TgZ(15,"mat-select",7),v.NdJ("valueChange",function(Z){v.CHM(le);const ne=v.oxw();return v.KtG(ne.onGroupPropertyIdChanged(Z))}),v.ALo(16,"async"),v.TgZ(17,"mat-option"),v._uU(18,"None"),v.qZA(),v.TgZ(19,"mat-option",10),v._uU(20,"Category"),v.qZA(),v.YNc(21,sr,2,2,"mat-option",8),v.ALo(22,"async"),v.qZA()(),v.TgZ(23,"button",17)(24,"mat-icon"),v._uU(25,"settings"),v.qZA()(),v.TgZ(26,"mat-menu",18,19),v.NdJ("click",function(Z){return Z.stopPropagation()}),v.YNc(28,ec,2,2,"ul",20),v.ALo(29,"async"),v.qZA(),v.TgZ(30,"button",21),v.NdJ("click",function(){v.CHM(le);const Z=v.oxw();return v.KtG(Z.onChartToggleClick())}),v.TgZ(31,"mat-icon"),v._uU(32,"pie_chart"),v.qZA()()()(),v.TgZ(33,"mat-card-content",22),v.YNc(34,Ki,16,24,"mat-table",23),v.ALo(35,"async"),v.YNc(36,Cn,5,0,"div",24),v.ALo(37,"async"),v.qZA(),v.BQk()}if(2&ce){const le=v.MAs(27),Y=v.oxw();let Z,ne;v.xp6(1),v.Q6J("ngIf",Y.showChart),v.xp6(4),v.hij("",null==(Z=v.lcZ(6,13,Y.complect$))?null:Z.name," "),v.xp6(2),v.Q6J("isReadonly",Y.isReadonly)("complect$",Y.complect$),v.xp6(2),v.hij(" ",null==(ne=v.lcZ(10,15,Y.complect$))?null:ne.description," "),v.xp6(6),v.Q6J("value",v.lcZ(16,17,Y.groupPropertyId$)),v.xp6(4),v.s9C("value",Y.categoryGroupId),v.xp6(2),v.Q6J("ngForOf",v.lcZ(22,19,Y.properties$)),v.xp6(2),v.Q6J("matMenuTriggerFor",le),v.xp6(5),v.Q6J("ngIf",v.lcZ(29,21,Y.propertiesSorted$)),v.xp6(2),v.Q6J("matTooltip",Y.getChartLabel()),v.xp6(4),v.Q6J("ngIf",v.lcZ(35,23,Y.displayedColumns$)),v.xp6(2),v.Q6J("ngIf",!Y.isReadonly&&v.lcZ(37,25,Y.complect$))}}const oi=function(ce,Ye){return{mobile:ce,inactive:Ye}};let ns=(()=>{var ce;class Ye{constructor(Y,Z,ne,Fe){this.complectsService=Y,this.dialog=Z,this.toastr=ne,this.exportService=Fe,this.categoryGroupId="category",this.dataSource=new ft.by,this.groupPropertyIdSource=new pt.X(this.categoryGroupId),this.groupPropertyId$=this.groupPropertyIdSource.asObservable(),this.groups$=(0,mt.of)([]),this.propertiesSorted$=(0,mt.of)([]),this.propertiesFiltered$=(0,mt.of)([]),this.columnViews$=(0,mt.of)([]),this.displayedColumns$=(0,mt.of)([]),this.currentGroup$=(0,mt.of)(null),this.currentGroupCount$=(0,mt.of)(0),this.currentCategoryId=new pt.X(void 0),this.currentCategoryId$=this.currentCategoryId.asObservable(),this.subsctiptions=[],this.dragDisabled=!0,this.expandedElement=null,this.isMobile=!1,this.isActive=!1,this.isReadonly=!1,this.isActiveChange=new v.vpe,this.properties$=(0,mt.of)([]),this.items$=(0,mt.of)([]),this.complect$=(0,mt.of)(null),this.showChart=!1,this.showChartChange=new v.vpe,this.complectChange=new v.vpe,this.complectItemUpdated=new v.vpe,this.currentCategoryChange=new v.vpe,this.propertyParamChange=new v.vpe,this.propertyParamsChange=new v.vpe}ngOnInit(){this.groups$=this.complect$.pipe((0,at.U)(Z=>Z?.groups??[])),this.propertiesSorted$=this.properties$.pipe((0,at.U)(Z=>[...Z?.sort((ne,Fe)=>ne.params.complectOrder>Fe.params.complectOrder?1:-1)??[]])),this.propertiesFiltered$=this.propertiesSorted$.pipe((0,at.U)(Z=>Z.filter(ne=>ne.params.complectDisplay))),this.columnViews$=(0,Xe.a)([this.propertiesFiltered$,this.groupPropertyId$,this.complect$]).pipe((0,at.U)(Z=>this.getColumns(Z[0],Z[1],Z[2]))),this.displayedColumns$=this.columnViews$.pipe((0,at.U)(Z=>Z.map(ne=>ne.columnDef)??[])),this.currentGroup$=(0,Xe.a)([this.complect$,this.currentCategoryId$]).pipe((0,at.U)(Z=>{const ne=Z[0],Fe=Z[1];let Be=null;return ne&&(Be=ne.groups.find(Qe=>Qe.id==Fe)??ne.groups[0]??null),Fe!==Be?.id&&this.currentCategoryId.next(Be?.id),this.currentCategoryChange.emit(Be),Be})),this.currentGroupCount$=this.currentGroup$.pipe((0,at.U)(Z=>Z?.items?.reduce((ne,Fe)=>ne+Fe.count,0)??0));const Y=(0,Xe.a)([this.groups$,this.items$,this.propertiesFiltered$,this.groupPropertyId$]).subscribe(Z=>{this.dataSource.data=Z[0]&&Z[1]?this.getComplectItemViews(Z[0],Z[1],Z[2],Z[3]):[],this.table?.renderRows()});this.subsctiptions.push(Y)}ngOnDestroy(){this.subsctiptions.forEach(Y=>{Y.unsubscribe()}),this.currentCategoryChange.emit(null)}onGroupPropertyIdChanged(Y){this.groupPropertyIdSource.next(Y)}onTableHeaderSelected(Y){this.propertyParamChange.emit(Y)}onHeaderDrop(Y){const Z=Y.container.data?.map(ne=>ne.params)??[];(0,it.bA)(Z,Y.previousIndex,Y.currentIndex),Z.forEach((ne,Fe)=>{ne.complectOrder=Fe}),this.propertyParamsChange.emit(Z)}onItemDrop(Y){this.dragDisabled=!0,this.complect$.pipe((0,Se.q)(1)).subscribe(Z=>{if(!Z)return;const ne=0===Y.currentIndex?1:Y.currentIndex-1;let Fe=Y.container.data.data[ne];if(Fe)if(Fe.groupId||(Fe=Y.container.data.data[ne-1]),Y.previousContainer===Y.container){const Be=Y.previousContainer.data.data[Y.previousIndex];this.changeItemGroup(Be.id,Be.groupId,Fe.groupId)}else{const Be=Y.item.data,Qe=Z.groups.find(yt=>yt.id===Fe.groupId)??Z.groups[0];this.complectsService.addItemToGroup(Be,Qe)}})}onChartToggleClick(){this.showChart=!this.showChart,this.showChartChange.emit(this.showChart)}onActiveClick(){this.isActiveChange.emit()}onCurrentCategoryIdChanged(Y){Y!==this.currentCategoryId.value&&this.currentCategoryId.next(Y)}onItemClick(Y,Z){this.isMobile||(this.expandedElement=this.expandedElement===Y?null:Y,Z.stopPropagation())}onItemLongPress(Y,Z){this.isMobile&&(this.expandedElement=this.dragDisabled?this.expandedElement===Y?null:Y:null,Z.stopPropagation())}onCopyToClipboard(){this.toastr.success("Link was copied to the clipboard")}getColumns(Y,Z,ne){const Fe=Y.map(Be=>({columnDef:Be.id??"",header:Be.name,property:Be,cell:Qe=>`${Qe.values.find(yt=>yt.id===Be.id)?.value}`,width:`${Be.params.complectWidth??50} px`,class:"item__value"}))??[];return Z!==this.categoryGroupId?Fe.push({columnDef:"category",header:"Category",property:null,cell:Be=>ne?.groups?.find(Qe=>Qe.id===Be.groupId)?.name??"",width:"30px",class:"item__category"}):this.isReadonly||Fe.unshift({columnDef:"move-item",header:"",property:null,cell:()=>"",width:"30px",class:"move"}),Fe.push({columnDef:"count",header:"Count",property:null,cell:Be=>`${Be.count}`,width:"20px",class:"value count"}),this.isReadonly||Fe.push({columnDef:"actions",header:"",property:null,cell:Be=>"",width:"30px",class:"actions"}),Fe}getComplectItemViews(Y,Z,ne,Fe){return Y&&Z?Fe===this.categoryGroupId?this.getItemsByGroups(Y,Z,ne):this.getItemsByGrouppingField(Y,Z,ne,Fe):[]}getItemViews(Y,Z){return Z.map(ne=>({groupItem:ne,item:Y.find(Fe=>Fe.id===ne.itemId)})).filter(ne=>ne.item).map(ne=>Object.assign(new oe,ne.item,ne.groupItem))}getItemsByGroups(Y,Z,ne){const Fe={};return Y.forEach(Be=>{const Qe=new qe.Z;Qe.value=Qe.id=Be.name,Qe.name="Category",Fe[Be.id??""]=[{isGroupBy:!0,groupValue:Qe,groupId:Be.id}].concat(this.getItemViews(Z,Be.items))}),this.fillGroupViews(Fe,ne)}getItemsByGrouppingField(Y,Z,ne,Fe){let Be=this.getItemViews(Z,Y.map(Qe=>Qe.items)?.flat()??[]);return Fe&&(Be=this.groupItemsByProp(Be,ne,Fe)),Be}groupItemsByProp(Y,Z,ne){const Fe=Y.reduce((Be,Qe)=>{const yt=Qe.values.find(kr=>kr.id==ne),xr=yt?.value??"";return Be[xr]||(Be[xr]=[{isGroupBy:!0,groupValue:yt}]),Be[xr].push(Qe),Be},{});return this.fillGroupViews(Fe,Z)}fillGroupViews(Y,Z){let ne=[];return Object.keys(Y).forEach(Fe=>{ne=ne.concat(Y[Fe]);const Be=[];Z.forEach(Qe=>{Be.push(0)}),Y[Fe].forEach(Qe=>{Qe.isGroupBy||Qe.values.forEach((yt,xr)=>{(yt.valueType===et.B.Decimal||yt.valueType===et.B.Number)&&(Be[xr]+=+(yt.value??"0")*Qe.count)})}),ne.push({isSummary:!0,count:Y[Fe].splice(1).reduce((Qe,yt)=>Qe+yt.count,0),values:Z.map((Qe,yt)=>{const xr=Object.assign(new qe.Z,Qe);return xr.value=xr.valueType===et.B.Decimal||xr.valueType===et.B.Number?Be[yt].toString():"",xr})})}),ne}changeItemGroup(Y,Z,ne){Z!==ne&&this.complect$.pipe((0,Se.q)(1)).subscribe(Fe=>{const Be=Fe?.groups.find(fn=>fn.id==Z),Qe=Fe?.groups.find(fn=>fn.id==ne),yt=Be?.items?.find(fn=>fn.itemId==Y);if(!Be||!Qe||!yt)return;const kr={itemId:yt.itemId,groupId:Qe.id,count:yt.count};this.complectsService.deleteGroupItem({itemId:yt.itemId,groupId:yt.groupId,count:yt.count}),this.complectsService.addGroupItemToGroup(kr,Qe)})}isGroup(Y,Z){return Z.isGroupBy}isSummary(Y,Z){return Z.isSummary}isItem(Y,Z){return!Z.isGroupBy&&!Z.isSummary}getChartLabel(){return(this.showChart?"Hide":"Show")+" chart"}openEditComplectDialog(){this.complect$.pipe((0,Se.q)(1)).subscribe(Y=>{this.dialog.open(Kt.g,{data:Y}).afterClosed().subscribe(ne=>{ne&&this.complectChange.emit(ne)})})}openCloneComplectDialog(){this.complect$.pipe((0,Se.q)(1)).subscribe(Y=>{if(Y){const Z=Object.assign({},Y);Z.id="",Z.groups=Y.groups.map(Fe=>{const Be=Object.assign({},Fe);return Be.id=(0,se.Z)(),Be.items=Fe.items.map(Qe=>{const yt=Object.assign({},Qe);return yt.groupId=Be.id??"",yt}),Be}),this.dialog.open(Kt.g,{data:Z}).afterClosed().subscribe(Fe=>{Fe&&this.complectChange.emit(Fe)})}})}openEditItemDialog(Y){this.dialog.open(Pt.s,{data:Y})}openCloneItemDialog(Y){const Z=Object.assign(new W.c,Y);Z.id="",this.dialog.open(Pt.s,{data:Z}).afterClosed().subscribe(Fe=>{this.complect$.pipe((0,Se.q)(1)).subscribe(Be=>{if(Fe&&Be){const Qe=Be.groups.find(yt=>yt.id===Y.groupId)??Be.groups[0];this.complectsService.addItemToGroup(Fe,Qe)}})})}openEditItemCountDialog(Y){this.dialog.open(Me,{data:Y.count}).afterClosed().subscribe(ne=>{ne&&ne>0&&ne!==Y.count&&this.complect$.pipe((0,Se.q)(1)).subscribe(Fe=>{if(Fe){const Be=Fe?.groups.find(Qe=>!!Y.groupId&&Qe.id===Y.groupId)?.items.find(Qe=>Qe.itemId==Y.id);Be&&(Be.count=ne),this.complectsService.updateGroupItem({itemId:Y.id,groupId:Y.groupId,count:ne})}})})}openDeleteComplectItemDialog(Y){this.dialog.open(rt.$,{data:"Delete item from complect?"}).afterClosed().subscribe(ne=>{ne&&this.complectsService.deleteGroupItem({itemId:Y.id,groupId:Y.groupId,count:Y.count})})}openAddGroupDialog(){this.complect$.pipe((0,Se.q)(1)).subscribe(Y=>{Y&&this.dialog.open(Ur,{data:{complectId:Y?.id,items:[]}})})}openEditGroupDialog(Y){this.complect$.pipe((0,Se.q)(1)).subscribe(Z=>{const ne=Z?.groups?.find(Fe=>Fe.id===Y.groupId);ne&&this.dialog.open(Ur,{data:ne})})}openDeleteGroupDialog(Y){this.dialog.open(rt.$,{data:"Delete group?"}).afterClosed().subscribe(ne=>{ne&&this.complect$.pipe((0,Se.q)(1)).subscribe(Fe=>{this.complectsService.deleteGroup({id:Y.groupId,complectId:Fe?.id})})})}changeDragDisabled(Y){this.dragDisabled=Y}exportComplect(Y){(0,Xe.a)([this.complect$,this.items$,this.properties$]).pipe((0,Se.q)(1)).subscribe(Z=>{Z[0]&&Z[1]&&Z[2]&&this.exportService.saveToFile({complect:Z[0],items:Z[1],properties:Z[2]},Y)})}}return(ce=Ye).\u0275fac=function(Y){return new(Y||ce)(v.Y36(xt.s),v.Y36(he.uw),v.Y36(_n._W),v.Y36(ai.T))},ce.\u0275cmp=v.Xpm({type:ce,selectors:[["app-complect-items"]],viewQuery:function(Y,Z){if(1&Y&&v.Gf(ft.BZ,5),2&Y){let ne;v.iGM(ne=v.CRH())&&(Z.table=ne.first)}},inputs:{isMobile:"isMobile",isActive:"isActive",isReadonly:"isReadonly",properties$:"properties$",items$:"items$",complect$:"complect$",showChart:"showChart"},outputs:{isActiveChange:"isActiveChange",showChartChange:"showChartChange",complectChange:"complectChange",complectItemUpdated:"complectItemUpdated",currentCategoryChange:"currentCategoryChange",propertyParamChange:"propertyParamChange",propertyParamsChange:"propertyParamsChange"},decls:3,vars:6,consts:[[1,"complect-container","card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],[4,"ngIf"],[1,"mobile-preview"],[1,"header"],[1,"name"],["appearance","outline","matBadgeOverlap","true",1,"small-outlined-select","stretch-badge",3,"matBadge"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[3,"value"],["class","chart",3,"items$","properties$","categoryGroupId","groupPropertyId$","groups$",4,"ngIf"],[1,"title"],[1,"header-name"],[3,"isReadonly","complect$","onEditComplect","onCloneComplect","onExportComplect"],[1,"buttons-container"],["appearance","outline",1,"small-outlined-select"],["mat-icon-button","","color","primary","aria-label","Show headers","matTooltip","Show headers",3,"matMenuTriggerFor"],[1,"table-headers-menu",3,"click"],["listHeadersMenu","matMenu"],["class","table-headers-menu-list","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Toggle chart",3,"matTooltip","click"],[1,"complect-items"],["multiTemplateDataRows","","cdkDropList","","id","complectItemsList","cdkDropListConnectedTo","itemsList",3,"dataSource","cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],["class","end-row",4,"ngIf"],[1,"chart",3,"items$","properties$","categoryGroupId","groupPropertyId$","groups$"],["cdkDropList","",1,"table-headers-menu-list",3,"cdkDropListData","cdkDropListDropped"],["class","item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",1,"item"],["class","drag-placeholder",4,"cdkDragPlaceholder"],[3,"ngModel","disableRipple","ngModelChange","click","change"],["cdkDragHandle","",1,"drag-handle"],[1,"drag-placeholder"],["multiTemplateDataRows","","cdkDropList","","id","complectItemsList","cdkDropListConnectedTo","itemsList",3,"dataSource","cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["complectItemsList","cdkDropList"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","groupHeader"],["class","cell","colspan","999",4,"matCellDef"],["matColumnDef","expandedDetail"],["class","detail-cell",3,"hidden",4,"matCellDef"],["class","row table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","row item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary","#complectItemsList",3,"expanded-row","cdkDragData","longPress","click","onLongPress",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row detail-row",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row summary","cdkDrag","",3,"cdkDragData","cdkDragDisabled",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","row group-item","cdkDrag","",3,"cdkDragData","cdkDragDisabled",4,"matRowDef","matRowDefColumns","matRowDefWhen"],[3,"matColumnDef"],[3,"ngSwitch"],[3,"ngSwitchCase"],["ngSwitchDefault",""],[3,"ngClass","ngSwitch",4,"matCellDef"],["sticky","",3,"ngClass",4,"matHeaderCellDef"],["sticky","",3,"ngClass"],[3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass"],[3,"ngClass","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","reorder",3,"mousedown","mouseUp","touchstart","touchend",4,"ngIf"],[1,"reorder",3,"mousedown","mouseUp","touchstart","touchend"],[1,"count-value"],["class","buttons-container",4,"ngIf"],["mat-icon-button","","color","primary","aria-label","Edit count",1,"small-button",3,"click"],[1,"mat-icon"],["mat-icon-button","","color","primary","aria-label","Edit item",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete from complect",1,"small-button",3,"click"],[1,"category"],[1,"value",3,"property","value"],["colspan","999",1,"cell"],[1,"container"],[1,"detail-cell"],[1,"detail"],[3,"item",4,"ngIf"],[3,"item"],[1,"row","table-header"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary","#complectItemsList",1,"row","item",3,"cdkDragData","longPress","click","onLongPress"],[1,"row","detail-row"],["cdkDrag","",1,"row","summary",3,"cdkDragData","cdkDragDisabled"],["cdkDrag","",1,"row","group-item",3,"cdkDragData","cdkDragDisabled"],[1,"end-row"],[1,"buttons"],["mat-icon-button","","color","primary","aria-label","Add category","matTooltip","Add category",1,"add-category-btn",3,"click"]],template:function(Y,Z){1&Y&&(v.TgZ(0,"mat-card",0),v.YNc(1,tr,16,12,"mat-card-header",1),v.YNc(2,Xt,38,27,"ng-container",2),v.qZA()),2&Y&&(v.Q6J("ngClass",v.WLB(3,oi,Z.isMobile,!Z.isActive)),v.xp6(1),v.Q6J("ngIf",Z.isMobile&&!Z.isActive),v.xp6(1),v.Q6J("ngIf",!Z.isMobile||Z.isActive))},dependencies:[Sr.mk,Sr.sg,Sr.O5,Sr.RF,Sr.n9,Sr.ED,wt.RK,Yi.a8,Yi.dn,Yi.dk,Yi.$j,Yi.n5,On.KE,On.hX,jn.VK,jn.p6,ft.BZ,ft.fO,ft.as,ft.w1,ft.Dz,ft.nj,ft.ge,ft.ev,ft.XQ,ft.Gk,br.Hw,it.Wj,it.Zt,it.Bh,it.Hk,Gs.gM,Hr.oG,si.gD,Gn.ey,vn.k,ki.T,ya.F,Qo.H,Te.JJ,Te.On,Xn,Js,Sr.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;background:#F5F5F5;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.buttons-container[_ngcontent-%COMP%]{display:flex;align-items:center}  .mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{top:25px!important}.chart-container[_ngcontent-%COMP%]{height:40%;margin-bottom:4px}.chart-container[_ngcontent-%COMP%]   .chart[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content}.complect-container[_ngcontent-%COMP%]{height:100%}.complect-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:16px 36px 0;justify-content:space-between;flex-wrap:wrap}.complect-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 10px;margin:0;display:flex;flex-wrap:nowrap;justify-content:space-between;align-items:center;gap:10px}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:0 0 5px;flex-grow:1;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:2px}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:block}.complect-container[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:500}.table-headers-menu-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;min-width:190px}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;padding-right:10px;justify-content:space-between;align-items:center;transition:box-shadow .2s cubic-bezier(0,0,.2,1)}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active{background:#F5F5F5}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:move}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:red;border:dotted 3px #999;min-height:100px;transition:transform .25s cubic-bezier(0,0,.2,1)}.complect-items[_ngcontent-%COMP%]{height:calc(100% - 75px);overflow-y:auto}.row[_ngcontent-%COMP%]{min-height:30px;overflow-wrap:break-word;position:relative}.row[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{display:flex}.row.group-item[_ngcontent-%COMP%], .row.group-item[_ngcontent-%COMP%]:hover{background-color:#0000000a}.row[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:white;border:3px dotted rgba(0,0,0,.14);min-height:35px}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{max-width:0;min-width:0;padding-left:0;padding-right:0;position:relative;overflow:visible}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:none;position:absolute;top:0;right:0;z-index:100;background-color:#fdfdfd;border-radius:10px}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{position:relative;width:0;max-width:0;min-width:0;padding-left:0;padding-right:0;overflow:visible}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]   .reorder[_ngcontent-%COMP%]{position:absolute;left:-5px;top:0;z-index:100;cursor:move;display:block;color:#0003}.row[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{max-width:60px}.row[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]   .count-value[_ngcontent-%COMP%]{width:50px;border:none;outline:none;padding:5px;margin:auto 0}.row.expanded-row[_ngcontent-%COMP%], .row.detail-row[_ngcontent-%COMP%]{background-color:#00000008}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom-width:0!important}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:none}.row.draggable-row[_ngcontent-%COMP%]{border:red 1px solid}.group-item[_ngcontent-%COMP%]{font-weight:500}.group-item[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{display:flex;justify-content:space-between;position:relative}.group-item[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;gap:2px;align-items:center}.group-item[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:none;position:absolute;right:0;z-index:100}.summary[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.summary[_ngcontent-%COMP%]   .count-value[_ngcontent-%COMP%]{padding:0 5px}.detail-row[_ngcontent-%COMP%]{min-height:0}.detail-row[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{overflow:hidden;width:100%;padding-bottom:5px}.end-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;position:sticky;bottom:0;width:100%;height:30px}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add-category-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.card.mobile[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{min-height:60px}"],data:{animation:[(0,ot.X$)("detailExpand",[(0,ot.SB)("collapsed",(0,ot.oB)({height:"0px",minHeight:"0"})),(0,ot.SB)("expanded",(0,ot.oB)({height:"*"})),(0,ot.eR)("expanded <=> collapsed",(0,ot.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]},changeDetection:0}),Ye})()},6592:(Cr,Ct,te)=>{te.d(Ct,{g:()=>ft});var v=te(7700),W=te(5879),qe=te(2942),Ze=te(6223),oe=te(2296),it=te(2032),rt=te(9157),et=te(5986);let ft=(()=>{var pt;class mt{constructor(Xe,Se,se){this.dialogRef=Xe,this.complectsService=se,this.data=Se?Object.assign({},Se):this.complectsService.createNewComplect()}getTitle(){return this.data.id?"Edit complect":"Add complect"}onOkClick(){this.complectsService.saveComplect(this.data),this.dialogRef.close(this.data)}onNoClick(){this.dialogRef.close()}}return(pt=mt).\u0275fac=function(Xe){return new(Xe||pt)(W.Y36(v.so),W.Y36(v.WI),W.Y36(qe.s))},pt.\u0275cmp=W.Xpm({type:pt,selectors:[["app-complect-edit-dialog"]],decls:22,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["matInput","",3,"hidden","ngModel","ngModelChange"],[3,"ngModel","labelPosition","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"click"]],template:function(Xe,Se){1&Xe&&(W.TgZ(0,"h1",0),W._uU(1),W.qZA(),W.TgZ(2,"div",1)(3,"mat-form-field")(4,"mat-label"),W._uU(5,"Name"),W.qZA(),W.TgZ(6,"input",2),W.NdJ("ngModelChange",function(Te){return Se.data.name=Te}),W.qZA()(),W.TgZ(7,"mat-form-field")(8,"mat-label"),W._uU(9,"Description"),W.qZA(),W.TgZ(10,"input",2),W.NdJ("ngModelChange",function(Te){return Se.data.description=Te}),W.qZA()(),W.TgZ(11,"mat-form-field")(12,"mat-label"),W._uU(13,"Public"),W.qZA(),W.TgZ(14,"input",3),W.NdJ("ngModelChange",function(Te){return Se.data.isShared=Te}),W.qZA(),W.TgZ(15,"mat-checkbox",4),W.NdJ("ngModelChange",function(Te){return Se.data.isShared=Te}),W._uU(16," Share complect "),W.qZA()()(),W.TgZ(17,"div",5)(18,"button",6),W.NdJ("click",function(){return Se.onNoClick()}),W._uU(19,"Cancel"),W.qZA(),W.TgZ(20,"button",7),W.NdJ("click",function(){return Se.onOkClick()}),W._uU(21,"Save"),W.qZA()()),2&Xe&&(W.xp6(1),W.Oqu(Se.getTitle()),W.xp6(5),W.Q6J("ngModel",Se.data.name),W.xp6(4),W.Q6J("ngModel",Se.data.description),W.xp6(4),W.Q6J("hidden",!0)("ngModel",Se.data.isShared),W.xp6(1),W.Q6J("ngModel",Se.data.isShared)("labelPosition","before"),W.xp6(2),W.Q6J("align","end"))},dependencies:[Ze.Fj,Ze.JJ,Ze.On,oe.lW,it.Nt,rt.KE,rt.hX,v.uh,v.xY,v.H8,et.oG],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),mt})()},1418:(Cr,Ct,te)=>{te.d(Ct,{s:()=>mt});var v=te(6223),W=te(7700),qe=te(6452),Ze=te(7990),oe=te(5879),it=te(1859),rt=te(6814),et=te(2946),ft=te(2296);function pt(at,Xe){if(1&at&&(oe.ynx(0),oe._UZ(1,"app-input",7),oe.BQk()),2&at){const Se=Xe.$implicit,se=oe.oxw();oe.xp6(1),oe.Q6J("formControl",se.form.controls[Se.id])("valueType",Se.valueType)("label",Se.name)}}let mt=(()=>{var at;class Xe{constructor(se,Te,he,wt){this.dialogRef=se,this.itemsService=he,this.fb=wt,this.form=new v.cw({}),Te?(this.data=Object.assign(new qe.c,Te),this.data.values=Te.values.map(Ne=>Object.assign(new Ze.Z,Ne))):this.data=this.itemsService.createNewItem()}ngOnInit(){this.initializeForm()}initializeForm(){const se={};this.data.values.forEach(Te=>{se[Te.id]=new v.NI(Te.value||"",this.getValidators(Te))}),this.form=this.fb.group(se)}getValidators(se){const Te=[];return"Name"===se.name&&Te.push(v.kI.required),Te}getTitle(){return this.data.id?"Edit item":"Add item"}onOkClick(){const se=this.form.value;this.data.values.forEach(he=>{he.value=se[he.id]});const Te=this.itemsService.saveItem(this.data);this.dialogRef.close(Te)}onNoClick(){this.dialogRef.close()}}return(at=Xe).\u0275fac=function(se){return new(se||at)(oe.Y36(W.so),oe.Y36(W.WI),oe.Y36(it.L),oe.Y36(v.qu))},at.\u0275cmp=oe.Xpm({type:at,selectors:[["app-item-edit-dialog"]],decls:10,vars:5,consts:[["mat-dialog-title",""],["autocomplete","off",1,"form",3,"formGroup","ngSubmit"],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","basic","type","button",3,"click"],["mat-raised-button","","color","accent","type","submit","cdkFocusInitial","",3,"disabled"],[3,"formControl","valueType","label"]],template:function(se,Te){1&se&&(oe.TgZ(0,"h1",0),oe._uU(1),oe.qZA(),oe.TgZ(2,"form",1),oe.NdJ("ngSubmit",function(){return Te.form.valid&&Te.onOkClick()}),oe.TgZ(3,"div",2),oe.YNc(4,pt,2,3,"ng-container",3),oe.qZA(),oe.TgZ(5,"div",4)(6,"button",5),oe.NdJ("click",function(){return Te.onNoClick()}),oe._uU(7,"Cancel"),oe.qZA(),oe.TgZ(8,"button",6),oe._uU(9,"Save"),oe.qZA()()()),2&se&&(oe.xp6(1),oe.Oqu(Te.getTitle()),oe.xp6(1),oe.Q6J("formGroup",Te.form),oe.xp6(2),oe.Q6J("ngForOf",Te.data.values),oe.xp6(1),oe.Q6J("align","end"),oe.xp6(3),oe.Q6J("disabled",!Te.form.valid))},dependencies:[rt.sg,et.a,v._Y,v.JJ,v.JL,v.oH,v.sg,ft.lW,W.uh,W.xY,W.H8],styles:[".mdc-dialog__content[_ngcontent-%COMP%]{max-width:360px;width:360px;display:flex;flex-direction:column}@media only screen and (max-width: 560px){.mdc-dialog__content[_ngcontent-%COMP%]{width:100%}}"]}),Xe})()},1534:(Cr,Ct,te)=>{te.d(Ct,{A:()=>qe});var v=te(6814),W=te(5879);let qe=(()=>{var Ze;class oe{}return(Ze=oe).\u0275fac=function(rt){return new(rt||Ze)},Ze.\u0275mod=W.oAB({type:Ze}),Ze.\u0275inj=W.cJS({imports:[v.ez]}),oe})()},8260:(Cr,Ct,te)=>{te.d(Ct,{H:()=>rt});var v=te(5936),W=te(5879),qe=te(6814);function Ze(et,ft){if(1&et&&(W.TgZ(0,"span"),W._uU(1),W.ALo(2,"date"),W.qZA()),2&et){const pt=W.oxw(2);W.xp6(1),W.hij(" ",W.xi3(2,1,pt.value,"shortDate")," ")}}function oe(et,ft){if(1&et&&(W.TgZ(0,"p",3),W.YNc(1,Ze,3,4,"span",4),W.qZA()),2&et){const pt=W.oxw();W.xp6(1),W.Q6J("ngIf",!!pt.value&&"undefined"!==pt.value&&"null"!==pt.value)}}function it(et,ft){if(1&et&&(W.TgZ(0,"p",3),W._uU(1),W.qZA()),2&et){const pt=W.oxw();W.xp6(1),W.hij(" ",pt.value," ")}}let rt=(()=>{var et;class ft{constructor(){this.valueTypeEnum=v.B}}return(et=ft).\u0275fac=function(mt){return new(mt||et)},et.\u0275cmp=W.Xpm({type:et,selectors:[["app-item-value"]],inputs:{property:"property",value:"value"},decls:3,vars:2,consts:[[1,"item-value",3,"ngSwitch"],["class","item-value__value",4,"ngSwitchCase"],["class","item-value__value",4,"ngSwitchDefault"],[1,"item-value__value"],[4,"ngIf"]],template:function(mt,at){1&mt&&(W.TgZ(0,"div",0),W.YNc(1,oe,2,1,"p",1),W.YNc(2,it,2,1,"p",2),W.qZA()),2&mt&&(W.Q6J("ngSwitch",null==at.property?null:at.property.valueType),W.xp6(1),W.Q6J("ngSwitchCase",at.valueTypeEnum.Date))},dependencies:[qe.O5,qe.RF,qe.n9,qe.ED,qe.uU],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center}.item-value[_ngcontent-%COMP%]   .item-value__value[_ngcontent-%COMP%]{margin:0;padding:5px 0;min-height:20px;-webkit-hyphens:auto;hyphens:auto;word-break:break-all}"]}),ft})()},4833:(Cr,Ct,te)=>{te.d(Ct,{$:()=>oe});var v=te(6814),W=te(8814),qe=te(1534),Ze=te(5879);let oe=(()=>{var it;class rt{}return(it=rt).\u0275fac=function(ft){return new(ft||it)},it.\u0275mod=Ze.oAB({type:it}),it.\u0275inj=Ze.cJS({imports:[v.ez,W.A,qe.A]}),rt})()},957:(Cr,Ct,te)=>{te.d(Ct,{F:()=>mt});var v=te(5879),W=te(6814),qe=te(5195),Ze=te(5313),oe=te(8260);function it(at,Xe){if(1&at&&(v.TgZ(0,"mat-cell",8),v._uU(1),v.qZA()),2&at){const Se=Xe.$implicit;v.xp6(1),v.hij(" ",Se.name," ")}}function rt(at,Xe){if(1&at&&(v.TgZ(0,"mat-cell"),v._UZ(1,"app-item-value",9),v.qZA()),2&at){const Se=Xe.$implicit;v.xp6(1),v.Q6J("property",Se)("value",Se.value)}}function et(at,Xe){1&at&&v._UZ(0,"mat-row")}const ft=function(){return["name","value"]};function pt(at,Xe){if(1&at&&(v.TgZ(0,"mat-card",1)(1,"mat-card-content")(2,"mat-table",2),v.ynx(3,3),v.YNc(4,it,2,1,"mat-cell",4),v.BQk(),v.ynx(5,5),v.YNc(6,rt,2,2,"mat-cell",6),v.BQk(),v.YNc(7,et,1,0,"mat-row",7),v.qZA()()()),2&at){const Se=v.oxw();v.xp6(2),v.Q6J("dataSource",Se.item.values),v.xp6(5),v.Q6J("matRowDefColumns",v.DdM(2,ft))}}let mt=(()=>{var at;class Xe{}return(at=Xe).\u0275fac=function(se){return new(se||at)},at.\u0275cmp=v.Xpm({type:at,selectors:[["app-item-view"]],inputs:{item:"item"},decls:1,vars:1,consts:[["class","item",4,"ngIf"],[1,"item"],[3,"dataSource"],["matColumnDef","name"],["class","name",4,"matCellDef"],["matColumnDef","value"],[4,"matCellDef"],[4,"matRowDef","matRowDefColumns"],[1,"name"],[1,"value",3,"property","value"]],template:function(se,Te){1&se&&v.YNc(0,pt,8,3,"mat-card",0),2&se&&v.Q6J("ngIf",Te.item)},dependencies:[W.O5,qe.a8,qe.dn,Ze.BZ,Ze.w1,Ze.Dz,Ze.nj,Ze.ev,Ze.Gk,oe.H],styles:[".item[_ngcontent-%COMP%]{width:100%}.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}"]}),Xe})()},5744:(Cr,Ct,te)=>{te.d(Ct,{B:()=>v});class v{constructor(qe){this.accountService=qe,this.unsinchronised=!1}init(){this.accountService.currentUser$.subscribe(qe=>{(this.userId??"")!==(qe?.id??"")&&(this.userId?this.cleanData():this.mergeData(),this.userId=qe?.id)}),this.loadAll()}execAuthorisedHttp(qe){this.userId&&qe.subscribe({next:Ze=>{},error:Ze=>{console.error(Ze),this.unsinchronised=!0}})}}},2942:(Cr,Ct,te)=>{te.d(Ct,{s:()=>mt});var v=te(5879),W=te(5619),qe=te(7398),Ze=te(8180),oe=te(5744),it=te(2372),rt=te(6719),et=te(4826),ft=te(9862);let pt=(()=>{var at;class Xe extends et.q{constructor(se){super(se,"complects")}getAll(){return this.http.get(`${this.rootUrl}getall`)}add(se){return this.http.post(`${this.rootUrl}add`,se)}edit(se){return this.http.put(`${this.rootUrl}edit`,se)}delete(se){const Te=(new ft.LE).set("id",se);return this.http.delete(`${this.rootUrl}delete`,{params:Te})}addGroup(se){return this.http.post(`${this.rootUrl}addGroup`,se)}deleteGroup(se){const Te=(new ft.LE).set("id",se);return this.http.delete(`${this.rootUrl}deleteGroup`,{params:Te})}updateGroup(se){return this.http.put(`${this.rootUrl}updateGroup`,se)}addItem(se){return this.http.post(`${this.rootUrl}addItem`,se)}deleteItem(se){const Te=(new ft.LE).set("itemId",se.itemId).set("groupId",se.groupId);return this.http.delete(`${this.rootUrl}deleteItem`,{params:Te})}updateItem(se){return this.http.put(`${this.rootUrl}updateItem`,se)}}return(at=Xe).\u0275fac=function(se){return new(se||at)(v.LFG(ft.eN))},at.\u0275prov=v.Yz7({token:at,factory:at.\u0275fac,providedIn:"root"}),Xe})(),mt=(()=>{var at;class Xe extends oe.B{constructor(se,Te){super(se),this.complectsHttp=Te,this.complectsSource=new W.X([]),this.complects$=this.complectsSource.asObservable(),this.currentGroup=new W.X(null),this.currentGroup$=this.currentGroup.asObservable(),this.groupItemAdded=new v.vpe,this.init()}cleanData(){localStorage.removeItem("complects"),this.complectsSource.next([])}mergeData(){this.loadComplects().subscribe(se=>{})}loadAll(){if(this.userId)this.loadComplects().subscribe(se=>{});else{const se=localStorage.getItem("complects");if(se){const Te=JSON.parse(se);this.complectsSource.next(Te)}}this.complects$.subscribe(se=>{localStorage.setItem("complects",JSON.stringify(se))})}loadComplects(){return this.complectsHttp.getAll().pipe((0,qe.U)(se=>{const Te=se??[];return this.complectsSource.next(Te),Te}))}createNewComplect(){return{id:null,name:"",description:"",groups:[this.createNewGroup()]}}createNewGroup(se=null){return{id:(0,it.Z)(),name:"Default group",complectId:null,items:[]}}saveComplect(se){se.id?this.updateComplect(se):this.addComplect(se)}addComplect(se){this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{se.id=(0,it.Z)(),se.groups.length?se.groups.forEach(he=>{he.complectId=se.id??""}):se.groups.push(this.createNewGroup(se.id)),Te.push(se),this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.add(se))})}updateComplect(se){this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{var he=Te.findIndex(wt=>wt.id===se.id);Te[he]=se,this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.edit(se))})}deleteComplect(se){return this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{const he=Te.filter(wt=>wt.id!==se);this.complectsSource.next(he)}),this.execAuthorisedHttp(this.complectsHttp.delete(se)),!0}saveGroup(se){return se.id?this.updateGroup(se):this.addGroup(se)}addGroup(se){return se.id=(0,it.Z)(),this.complects$.pipe((0,Ze.q)(1)).pipe((0,qe.U)(Te=>{const he=Te.find(wt=>wt.id==se.complectId);return he?(he.groups.push(se),this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.addGroup(se)),se):null}))}updateGroup(se){return this.complects$.pipe((0,Ze.q)(1)).pipe((0,qe.U)(Te=>{const he=Te.find(Ne=>Ne.id==se.complectId),wt=he?.groups?.findIndex(Ne=>Ne.id===se.id)??-1;return he&&-1!=wt?(he.groups[wt].name=se.name,this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.updateGroup(se)),se):null}))}deleteGroup(se){return this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{const he=Te.find(wt=>wt.id==se.complectId);he&&se.id&&(he.groups=he.groups.filter(wt=>wt.id!==se.id),this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.deleteGroup(se.id)))})}addGroupItemToGroup(se,Te){this.complects$.pipe((0,Ze.q)(1)).subscribe(he=>{const Ne=he.find(Pt=>Pt.id===Te.complectId)?.groups?.find(Pt=>Pt.id===Te.id);if(!Ne)return;const Me=Object.assign({},se);Me.groupId=Ne.id??"";let ot=0;if(Ne.items){const Pt=Ne.items.find(Kt=>Kt.itemId===se.itemId);Pt&&(ot=Pt.count,Pt.count+=Me.count,Me.count=Pt.count)}else Ne.items=[];ot||Ne.items.push(Me),this.complectsSource.next(he),this.groupItemAdded.emit(se),this.execAuthorisedHttp(ot?this.complectsHttp.updateItem(Me):this.complectsHttp.addItem(Me))})}addItemToGroup(se,Te){this.addGroupItemToGroup({itemId:se.id,groupId:Te.id,count:1},Te)}addItemToCurrentGroup(se){return this.currentGroup$.pipe((0,Ze.q)(1),(0,qe.U)(Te=>!!Te&&(this.addItemToGroup(se,Te),!0)))}updateGroupItem(se){this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{let he=-1;const wt=Te.find(Ne=>(he=Ne.groups.findIndex(Me=>Me.id===se.groupId),he>-1));if(wt){const Ne=wt.groups[he].items.findIndex(Me=>Me.itemId===se.itemId)??-1;-1!==Ne&&(wt.groups[he].items[Ne]=se)}this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.updateItem(se))})}deleteGroupItem(se){this.complects$.pipe((0,Ze.q)(1)).subscribe(Te=>{let he=-1;const wt=Te.find(Ne=>(he=Ne.groups.findIndex(Me=>Me.id===se.groupId),he>-1));if(wt){const Ne=wt.groups[he],Me=Ne.items.findIndex(ot=>ot.itemId===se.itemId)??-1;-1!==Me&&Ne.items.splice(Me,1)}this.complectsSource.next(Te),this.execAuthorisedHttp(this.complectsHttp.deleteItem(se))})}setCurrentGroup(se){this.currentGroup.next(se??null)}}return(at=Xe).\u0275fac=function(se){return new(se||at)(v.LFG(rt.B),v.LFG(pt))},at.\u0275prov=v.Yz7({token:at,factory:at.\u0275fac,providedIn:"root"}),Xe})()},4013:(Cr,Ct,te)=>{te.d(Ct,{T:()=>zv});var v=te(7685),W={version:"0.18.5"},qe=1200,Ze=1252,oe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],it={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rt=function(e){-1!=oe.indexOf(e)&&(Ze=it[0]=e)},ft=function(e){qe=e,rt(e)};var he,se=function(r){return String.fromCharCode(r)},Te=function(r){return String.fromCharCode(r)},Ne=null,ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pt(e){for(var r="",t=0,s=0,o=0,f=0,u=0,p=0,x=0,_=0;_<e.length;)f=(t=e.charCodeAt(_++))>>2,u=(3&t)<<4|(s=e.charCodeAt(_++))>>4,p=(15&s)<<2|(o=e.charCodeAt(_++))>>6,x=63&o,isNaN(s)?p=x=64:isNaN(o)&&(x=64),r+=ot.charAt(f)+ot.charAt(u)+ot.charAt(p)+ot.charAt(x);return r}function Kt(e){var r="",f=0,u=0,p=0,x=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var _=0;_<e.length;)f=ot.indexOf(e.charAt(_++)),u=ot.indexOf(e.charAt(_++)),r+=String.fromCharCode(f<<2|u>>4),64!==(p=ot.indexOf(e.charAt(_++)))&&(r+=String.fromCharCode((15&u)<<4|p>>2)),64!==(x=ot.indexOf(e.charAt(_++)))&&(r+=String.fromCharCode((3&p)<<6|x));return r}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),_n=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function $n(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function On(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ur=function(r){return xt?_n(r,"binary"):r.split("").map(function(t){return 255&t.charCodeAt(0)})};function ai(e){if(typeof ArrayBuffer>"u")return Ur(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),s=0;s!=e.length;++s)t[s]=255&e.charCodeAt(s);return r}function Sr(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}var br=xt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:_n(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var s=new Uint8Array(t),o=0;for(r=0,t=0;r<e.length;t+=o,++r)if(o=e[r].length,e[r]instanceof Uint8Array)s.set(e[r],t);else{if("string"==typeof e[r])throw"wtf";s.set(new Uint8Array(e[r]),t)}return s}return[].concat.apply([],e.map(function(f){return Array.isArray(f)?f:[].slice.call(f)}))},Hr=/\u0000/g,si=/[\u0001-\u0006]/g;function Gn(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function vn(e,r){var t=""+e;return t.length>=r?t:cr("0",r-t.length)+t}function ki(e,r){var t=""+e;return t.length>=r?t:cr(" ",r-t.length)+t}function ya(e,r){var t=""+e;return t.length>=r?t:t+cr(" ",r-t.length)}var Xs=Math.pow(2,32);function Xn(e,r){return e>Xs||e<-Xs?function Qo(e,r){var t=""+Math.round(e);return t.length>=r?t:cr("0",r-t.length)+t}(e,r):function qo(e,r){var t=""+e;return t.length>=r?t:cr("0",r-t.length)+t}(Math.round(e),r)}function In(e,r){return e.length>=7+(r=r||0)&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var Ys=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ti=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ks={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ei={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ts(e,r,t){for(var s=e<0?-1:1,o=e*s,f=0,u=1,p=0,x=1,_=0,y=0,T=Math.floor(o);_<r&&(p=(T=Math.floor(o))*u+f,y=T*_+x,!(o-T<5e-8));)o=1/(o-T),f=u,u=p,x=_,_=y;if(y>r&&(_>r?(y=x,p=f):(y=_,p=u)),!t)return[0,s*p,y];var E=Math.floor(s*p/y);return[E,s*p-E*y,y]}function Wr(e,r,t){if(e>2958465||e<0)return null;var s=0|e,o=Math.floor(86400*(e-s)),f=0,u=[],p={D:s,T:o,u:86400*(e-s)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(p.u)<1e-6&&(p.u=0),r&&r.date1904&&(s+=1462),p.u>.9999&&(p.u=0,86400==++o&&(p.T=o=0,++s,++p.D)),60===s)u=t?[1317,10,29]:[1900,2,29],f=3;else if(0===s)u=t?[1317,8,29]:[1900,1,0],f=6;else{s>60&&--s;var x=new Date(1900,0,1);x.setDate(x.getDate()+s-1),u=[x.getFullYear(),x.getMonth()+1,x.getDate()],f=x.getDay(),s<60&&(f=(f+6)%7),t&&(f=function Gt(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}(x,u))}return p.y=u[0],p.m=u[1],p.d=u[2],p.S=o%60,o=Math.floor(o/60),p.M=o%60,o=Math.floor(o/60),p.H=o,p.q=f,p}var Js=new Date(1899,11,31,0,0,0),Ut=Js.getTime(),tr=new Date(1900,2,1,0,0,0);function Mt(e,r){var t=e.getTime();return r?t-=1262304e5:e>=tr&&(t+=864e5),(t-(Ut+6e4*(e.getTimezoneOffset()-Js.getTimezoneOffset())))/864e5}function sr(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $t(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):function Ci(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function Tt(e){var r=e<0?12:11,t=sr(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10)).length<=r?t:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function ec(e){var r=sr(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e),sr(function ln(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return ne(14,Mt(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function ba(e,r,t,s){var x,o="",f=0,u=0,p=t.y,_=0;switch(e){case 98:p=t.y+543;case 121:switch(r.length){case 1:case 2:x=p%100,_=2;break;default:x=p%1e4,_=4}break;case 109:switch(r.length){case 1:case 2:x=t.m,_=r.length;break;case 3:return Ti[t.m-1][1];case 5:return Ti[t.m-1][0];default:return Ti[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:x=t.d,_=r.length;break;case 3:return Ys[t.q][0];default:return Ys[t.q][1]}break;case 104:switch(r.length){case 1:case 2:x=1+(t.H+11)%12,_=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:x=t.H,_=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:x=t.M,_=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(u=s>=2?3===s?1e3:100:1===s?10:1,(f=Math.round(u*(t.S+t.u)))>=60*u&&(f=0),"s"===r?0===f?"0":""+f/u:(o=vn(f,2+s),"ss"===r?o.substr(0,2):"."+o.substr(2,r.length-1))):vn(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":x=24*t.D+t.H;break;case"[m]":case"[mm]":x=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":x=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}_=3===r.length?1:2;break;case 101:x=p,_=1}return _>0?vn(x,_):""}function wn(e){if(e.length<=3)return e;for(var t=e.length%3,s=e.substr(0,t);t!=e.length;t+=3)s+=(s.length>0?",":"")+e.substr(t,3);return s}var rs=/%/g;function Si(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+Si(e,-r);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%o;if(f<0&&(f+=o),-1===(t=(r/Math.pow(10,f)).toPrecision(s+1+(o+f)%o)).indexOf("e")){var u=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,o)+"."+t.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,x,_,y){return x+_+y.substr(0,(o+f)%o)+"."+y.substr(f)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Qs=/# (\?+)( ?)\/( ?)(\d+)/,eo=/^#*0*\.([0#]+)/,to=/\).*[0#]/,Pn=/\(###\) ###\\?-####/;function Ir(e){for(var t,r="",s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ai(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Mn(e,r){var t=e-Math.floor(e),s=Math.pow(10,r);return r<(""+Math.round(t*s)).length?0:Math.round(t*s)}function Rt(e,r,t){if(40===e.charCodeAt(0)&&!r.match(to)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Rt("n",s,t):"("+Rt("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function Zi(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Xt(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function tc(e,r,t){var s=r.replace(rs,""),o=r.length-s.length;return Xt(e,s,t*Math.pow(10,2*o))+cr("%",o)}(e,r,t);if(-1!==r.indexOf("E"))return Si(r,t);if(36===r.charCodeAt(0))return"$"+Rt(e,r.substr(" "==r.charAt(1)?2:1),t);var o,f,u,p,x=Math.abs(t),_=t<0?"-":"";if(r.match(/^00+$/))return _+Xn(x,r.length);if(r.match(/^[#?]+$/))return"0"===(o=Xn(t,0))&&(o=""),o.length>r.length?o:Ir(r.substr(0,r.length-o.length))+o;if(f=r.match(Qs))return function Ml(e,r,t){var s=parseInt(e[4],10),o=Math.round(r*s),f=Math.floor(o/s),u=o-f*s,p=s;return t+(0===f?"":""+f)+" "+(0===u?cr(" ",e[1].length+1+e[4].length):ki(u,e[1].length)+e[2]+"/"+e[3]+vn(p,e[4].length))}(f,x,_);if(r.match(/^#+0+$/))return _+Xn(x,r.length-r.indexOf("0"));if(f=r.match(eo))return o=Ai(t,f[1].length).replace(/^([^\.]+)$/,"$1."+Ir(f[1])).replace(/\.$/,"."+Ir(f[1])).replace(/\.(\d*)$/,function(A,k){return"."+k+cr("0",Ir(f[1]).length-k.length)}),-1!==r.indexOf("0.")?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return _+Ai(x,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return _+wn(Xn(x,0));if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Rt(e,r,-t):wn(""+(Math.floor(t)+function ro(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}(t,f[1].length)))+"."+vn(Mn(t,f[1].length),f[1].length);if(f=r.match(/^#,#*,#0/))return Rt(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Gn(Rt(e,r.replace(/[\\-]/g,""),t)),u=0,Gn(Gn(r.replace(/\\/g,"")).replace(/[0#]/g,function(A){return u<o.length?o.charAt(u++):"0"===A?"0":""}));if(r.match(Pn))return"("+(o=Rt(e,"##########",t)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var y="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),p=ts(x,Math.pow(10,u)-1,!1),o=""+_," "==(y=Xt("n",f[1],p[1])).charAt(y.length-1)&&(y=y.substr(0,y.length-1)+"0"),o+=y+f[2]+"/"+f[3],(y=ya(p[2],u)).length<f[4].length&&(y=Ir(f[4].substr(f[4].length-y.length))+y),o+=y;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),_+((p=ts(x,Math.pow(10,u)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?ki(p[1],u)+f[2]+"/"+f[3]+ya(p[2],u):cr(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return o=Xn(t,0),r.length<=o.length?o:Ir(r.substr(0,r.length-o.length))+o;if(f=r.match(/^([#0?]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var T=r.indexOf(".")-u,E=r.length-o.length-T;return Ir(r.substr(0,T)+o+r.substr(r.length-E))}if(f=r.match(/^00,000\.([#0]*0)$/))return u=Mn(t,f[1].length),t<0?"-"+Rt(e,r,-t):wn(function rc(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?vn(0,3-A.length):"")+A})+"."+vn(u,f[1].length);switch(r){case"###,##0.00":return Rt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var C=wn(Xn(x,0));return"0"!==C?_+C:"";case"###,###.00":return Rt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Rt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Ki(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+Ki(e,-r);var o=e.indexOf(".");-1===o&&(o=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%o;if(f<0&&(f+=o),!(t=(r/Math.pow(10,f)).toPrecision(s+1+(o+f)%o)).match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,x,_,y){return x+_+y.substr(0,(o+f)%o)+"."+y.substr(f)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Cn(e,r,t){if(40===e.charCodeAt(0)&&!r.match(to)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Cn("n",s,t):"("+Cn("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function rr(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Xt(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function nc(e,r,t){var s=r.replace(rs,""),o=r.length-s.length;return Xt(e,s,t*Math.pow(10,2*o))+cr("%",o)}(e,r,t);if(-1!==r.indexOf("E"))return Ki(r,t);if(36===r.charCodeAt(0))return"$"+Cn(e,r.substr(" "==r.charAt(1)?2:1),t);var o,f,u,p,x=Math.abs(t),_=t<0?"-":"";if(r.match(/^00+$/))return _+vn(x,r.length);if(r.match(/^[#?]+$/))return o=""+t,0===t&&(o=""),o.length>r.length?o:Ir(r.substr(0,r.length-o.length))+o;if(f=r.match(Qs))return function qs(e,r,t){return t+(0===r?"":""+r)+cr(" ",e[1].length+2+e[4].length)}(f,x,_);if(r.match(/^#+0+$/))return _+vn(x,r.length-r.indexOf("0"));if(f=r.match(eo))return o=(o=(""+t).replace(/^([^\.]+)$/,"$1."+Ir(f[1])).replace(/\.$/,"."+Ir(f[1]))).replace(/\.(\d*)$/,function(A,k){return"."+k+cr("0",Ir(f[1]).length-k.length)}),-1!==r.indexOf("0.")?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return _+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return _+wn(""+x);if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Cn(e,r,-t):wn(""+t)+"."+cr("0",f[1].length);if(f=r.match(/^#,#*,#0/))return Cn(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Gn(Cn(e,r.replace(/[\\-]/g,""),t)),u=0,Gn(Gn(r.replace(/\\/g,"")).replace(/[0#]/g,function(A){return u<o.length?o.charAt(u++):"0"===A?"0":""}));if(r.match(Pn))return"("+(o=Cn(e,"##########",t)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var y="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),p=ts(x,Math.pow(10,u)-1,!1),o=""+_," "==(y=Xt("n",f[1],p[1])).charAt(y.length-1)&&(y=y.substr(0,y.length-1)+"0"),o+=y+f[2]+"/"+f[3],(y=ya(p[2],u)).length<f[4].length&&(y=Ir(f[4].substr(f[4].length-y.length))+y),o+=y;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),_+((p=ts(x,Math.pow(10,u)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?ki(p[1],u)+f[2]+"/"+f[3]+ya(p[2],u):cr(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return r.length<=(o=""+t).length?o:Ir(r.substr(0,r.length-o.length))+o;if(f=r.match(/^([#0]+)\.([#0]+)$/)){o=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var T=r.indexOf(".")-u,E=r.length-o.length-T;return Ir(r.substr(0,T)+o+r.substr(r.length-E))}if(f=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Cn(e,r,-t):wn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?vn(0,3-A.length):"")+A})+"."+vn(0,f[1].length);switch(r){case"###,###":case"##,###":case"#,###":var C=wn(""+x);return"0"!==C?_+C:"";default:if(r.match(/\.[0#?]*$/))return Cn(e,r.slice(0,r.lastIndexOf(".")),t)+Ir(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Xt(e,r,t){return(0|t)===t?Cn(e,r,t):Rt(e,r,t)}var ns=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ce(e){for(var r=0,t="",s="";r<e.length;)switch(t=e.charAt(r)){case"G":In(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(r,3).toUpperCase()||"AM/PM"===e.substr(r,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(s=t;"]"!==e.charAt(r++)&&r<e.length;)s+=e.charAt(r);if(s.match(ns))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||"\\"==t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(" "==e.charAt(r)||"*"==e.charAt(r))&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;default:++r}return!1}var le=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Y(e,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function ne(e,r,t){null==t&&(t={});var s="";switch(typeof e){case"string":s="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(s=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:gt)[e])&&(s=t.table&&t.table[Ks[e]]||gt[Ks[e]]),null==s&&(s=Ei[e]||"General")}if(In(s,0))return $t(r,t);r instanceof Date&&(r=Mt(r,t.date1904));var o=function Z(e,r){var t=function oi(e){for(var r=[],t=!1,s=0,o=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=e.substr(o,s-o),o=s+1}if(r[r.length]=e.substr(o),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}(e),s=t.length,o=t[s-1].indexOf("@");if(s<4&&o>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||o>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=o>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=o>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=o>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var f=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[s,f];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var u=t[0].match(le),p=t[1].match(le);return Y(r,u)?[s,t[0]]:Y(r,p)?[s,t[1]]:[s,t[null!=u&&null!=p?2:1]]}return[s,f]}(s,r);if(In(o[1]))return $t(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return function Ye(e,r,t,s){for(var _,y,T,o=[],f="",u=0,p="",x="t",E="H";u<e.length;)switch(p=e.charAt(u)){case"G":if(!In(e,u))throw new Error("unrecognized character "+p+" in "+e);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(f="";34!==(T=e.charCodeAt(++u))&&u<e.length;)f+=String.fromCharCode(T);o[o.length]={t:"t",v:f},++u;break;case"\\":var C=e.charAt(++u);o[o.length]={t:"("===C||")"===C?C:"t",v:C},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:r},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==_&&null==(_=Wr(r,t,"2"===e.charAt(u+1))))return"";o[o.length]={t:"X",v:e.substr(u,2)},x=p,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":p=p.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||null==_&&null==(_=Wr(r,t)))return"";for(f=p;++u<e.length&&e.charAt(u).toLowerCase()===p;)f+=p;"m"===p&&"h"===x.toLowerCase()&&(p="M"),"h"===p&&(p=E),o[o.length]={t:p,v:f},x=p;break;case"A":case"a":case"\u4e0a":var k={t:p,v:p};if(null==_&&(_=Wr(r,t)),"A/P"===e.substr(u,3).toUpperCase()?(null!=_&&(k.v=_.H>=12?"P":"A"),k.t="T",E="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=_&&(k.v=_.H>=12?"PM":"AM"),k.t="T",u+=5,E="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(u,5).toUpperCase()?(null!=_&&(k.v=_.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),k.t="T",u+=5,E="h"):(k.t="t",++u),null==_&&"T"===k.t)return"";o[o.length]=k,x=p;break;case"[":for(f=p;"]"!==e.charAt(u++)&&u<e.length;)f+=e.charAt(u);if("]"!==f.slice(-1))throw'unterminated "[" block: |'+f+"|";if(f.match(ns)){if(null==_&&null==(_=Wr(r,t)))return"";o[o.length]={t:"Z",v:f.toLowerCase()},x=f.charAt(1)}else f.indexOf("$")>-1&&(f=(f.match(/\$([^-\[\]]*)/)||[])[1]||"$",ce(e)||(o[o.length]={t:"t",v:f}));break;case".":if(null!=_){for(f=p;++u<e.length&&"0"===(p=e.charAt(u));)f+=p;o[o.length]={t:"s",v:f};break}case"0":case"#":for(f=p;++u<e.length&&"0#?.,E+-%".indexOf(p=e.charAt(u))>-1;)f+=p;o[o.length]={t:"n",v:f};break;case"?":for(f=p;e.charAt(++u)===p;)f+=p;o[o.length]={t:p,v:f},x=p;break;case"*":++u,(" "==e.charAt(u)||"*"==e.charAt(u))&&++u;break;case"(":case")":o[o.length]={t:1===s?"t":p,v:p},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(f=p;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)f+=e.charAt(u);o[o.length]={t:"D",v:f};break;case" ":o[o.length]={t:p,v:p},++u;break;case"$":o[o.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(p))throw new Error("unrecognized character "+p+" in "+e);o[o.length]={t:"t",v:p},++u}var L,F=0,N=0;for(u=o.length-1,x="t";u>=0;--u)switch(o[u].t){case"h":case"H":o[u].t=E,x="h",F<1&&(F=1);break;case"s":(L=o[u].v.match(/\.0+$/))&&(N=Math.max(N,L[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":x=o[u].t;break;case"m":"s"===x&&(o[u].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&o[u].v.match(/[Hh]/)&&(F=1),F<2&&o[u].v.match(/[Mm]/)&&(F=2),F<3&&o[u].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M),_.M>=60&&(_.M=0,++_.H);break;case 2:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M)}var q,M="";for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=ba(o[u].t.charCodeAt(0),o[u].v,_,N),o[u].t="t";break;case"n":case"?":for(q=u+1;null!=o[q]&&("?"===(p=o[q].t)||"D"===p||(" "===p||"t"===p)&&null!=o[q+1]&&("?"===o[q+1].t||"t"===o[q+1].t&&"/"===o[q+1].v)||"("===o[u].t&&(" "===p||"n"===p||")"===p)||"t"===p&&("/"===o[q].v||" "===o[q].v&&null!=o[q+1]&&"?"==o[q+1].t));)o[u].v+=o[q].v,o[q]={v:"",t:";"},++q;M+=o[u].v,u=q-1;break;case"G":o[u].t="t",o[u].v=$t(r,t)}var ve,G,ae="";if(M.length>0){40==M.charCodeAt(0)?(ve=r<0&&45===M.charCodeAt(0)?-r:r,G=Xt("n",M,ve)):(G=Xt("n",M,ve=r<0&&s>1?-r:r),ve<0&&o[0]&&"t"==o[0].t&&(G=G.substr(1),o[0].v="-"+o[0].v)),q=G.length-1;var ie=o.length;for(u=0;u<o.length;++u)if(null!=o[u]&&"t"!=o[u].t&&o[u].v.indexOf(".")>-1){ie=u;break}var ee=o.length;if(ie===o.length&&-1===G.indexOf("E")){for(u=o.length-1;u>=0;--u)null==o[u]||-1==="n?".indexOf(o[u].t)||(q>=o[u].v.length-1?o[u].v=G.substr(1+(q-=o[u].v.length),o[u].v.length):q<0?o[u].v="":(o[u].v=G.substr(0,q+1),q=-1),o[u].t="t",ee=u);q>=0&&ee<o.length&&(o[ee].v=G.substr(0,q+1)+o[ee].v)}else if(ie!==o.length&&-1===G.indexOf("E")){for(q=G.indexOf(".")-1,u=ie;u>=0;--u)if(null!=o[u]&&-1!=="n?".indexOf(o[u].t)){for(y=o[u].v.indexOf(".")>-1&&u===ie?o[u].v.indexOf(".")-1:o[u].v.length-1,ae=o[u].v.substr(y+1);y>=0;--y)q>=0&&("0"===o[u].v.charAt(y)||"#"===o[u].v.charAt(y))&&(ae=G.charAt(q--)+ae);o[u].v=ae,o[u].t="t",ee=u}for(q>=0&&ee<o.length&&(o[ee].v=G.substr(0,q+1)+o[ee].v),q=G.indexOf(".")+1,u=ie;u<o.length;++u)if(null!=o[u]&&(-1!=="n?(".indexOf(o[u].t)||u===ie)){for(y=o[u].v.indexOf(".")>-1&&u===ie?o[u].v.indexOf(".")+1:0,ae=o[u].v.substr(0,y);y<o[u].v.length;++y)q<G.length&&(ae+=G.charAt(q++));o[u].v=ae,o[u].t="t",ee=u}}}for(u=0;u<o.length;++u)null!=o[u]&&"n?".indexOf(o[u].t)>-1&&(o[u].v=Xt(o[u].t,o[u].v,ve=s>1&&r<0&&u>0&&"-"===o[u-1].v?-r:r),o[u].t="t");var we="";for(u=0;u!==o.length;++u)null!=o[u]&&(we+=o[u].v);return we}(o[1],r,t,o[0])}function Fe(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=gt[t]){if(gt[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return gt[r]=e,r}function Be(e){for(var r=0;392!=r;++r)void 0!==e[r]&&Fe(e[r],r)}function Qe(){gt=function Zs(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var kr=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Pr=function(){var e={version:"1.2.0"},t=function r(){for(var G=0,ie=new Array(256),ee=0;256!=ee;++ee)ie[ee]=G=1&(G=1&(G=1&(G=1&(G=1&(G=1&(G=1&(G=1&(G=ee)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1)?-306674912^G>>>1:G>>>1;return typeof Int32Array<"u"?new Int32Array(ie):ie}(),o=function s(G){var ie=0,ee=0,we=0,ye=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(we=0;256!=we;++we)ye[we]=G[we];for(we=0;256!=we;++we)for(ee=G[we],ie=256+we;ie<4096;ie+=256)ee=ye[ie]=ee>>>8^G[255&ee];var re=[];for(we=1;16!=we;++we)re[we-1]=typeof Int32Array<"u"?ye.subarray(256*we,256*we+256):ye.slice(256*we,256*we+256);return re}(t),f=o[0],u=o[1],p=o[2],x=o[3],_=o[4],y=o[5],T=o[6],E=o[7],C=o[8],A=o[9],k=o[10],F=o[11],N=o[12],L=o[13],M=o[14];return e.table=t,e.bstr=function q(G,ie){for(var ee=-1^ie,we=0,ye=G.length;we<ye;)ee=ee>>>8^t[255&(ee^G.charCodeAt(we++))];return~ee},e.buf=function ae(G,ie){for(var ee=-1^ie,we=G.length-15,ye=0;ye<we;)ee=M[G[ye++]^255&ee]^L[G[ye++]^ee>>8&255]^N[G[ye++]^ee>>16&255]^F[G[ye++]^ee>>>24]^k[G[ye++]]^A[G[ye++]]^C[G[ye++]]^E[G[ye++]]^T[G[ye++]]^y[G[ye++]]^_[G[ye++]]^x[G[ye++]]^p[G[ye++]]^u[G[ye++]]^f[G[ye++]]^t[G[ye++]];for(we+=15;ye<we;)ee=ee>>>8^t[255&(ee^G[ye++])];return~ee},e.str=function ve(G,ie){for(var ee=-1^ie,we=0,ye=G.length,re=0,ze=0;we<ye;)(re=G.charCodeAt(we++))<128?ee=ee>>>8^t[255&(ee^re)]:re<2048?ee=(ee=ee>>>8^t[255&(ee^(192|re>>6&31))])>>>8^t[255&(ee^(128|63&re))]:re>=55296&&re<57344?(re=64+(1023&re),ze=1023&G.charCodeAt(we++),ee=(ee=(ee=(ee=ee>>>8^t[255&(ee^(240|re>>8&7))])>>>8^t[255&(ee^(128|re>>2&63))])>>>8^t[255&(ee^(128|ze>>6&15|(3&re)<<4))])>>>8^t[255&(ee^(128|63&ze))]):ee=(ee=(ee=ee>>>8^t[255&(ee^(224|re>>12&15))])>>>8^t[255&(ee^(128|re>>6&63))])>>>8^t[255&(ee^(128|63&re))];return~ee},e}(),lt=function(){var x,r={};function s(D){if("/"==D.charAt(D.length-1))return-1===D.slice(0,-1).indexOf("/")?D:s(D.slice(0,-1));var B=D.lastIndexOf("/");return-1===B?D:D.slice(0,B+1)}function o(D){if("/"==D.charAt(D.length-1))return o(D.slice(0,-1));var B=D.lastIndexOf("/");return-1===B?D:D.slice(B+1)}function f(D,B){"string"==typeof B&&(B=new Date(B));var P=B.getHours();P=(P=P<<6|B.getMinutes())<<5|B.getSeconds()>>>1,D.write_shift(2,P);var R=B.getFullYear()-1980;R=(R=R<<4|B.getMonth()+1)<<5|B.getDate(),D.write_shift(2,R)}function p(D){Yr(D,0);for(var B={},P=0;D.l<=D.length-4;){var R=D.read_shift(2),U=D.read_shift(2),H=D.l+U,fe={};21589===R&&(1&(P=D.read_shift(1))&&(fe.mtime=D.read_shift(4)),U>5&&(2&P&&(fe.atime=D.read_shift(4)),4&P&&(fe.ctime=D.read_shift(4))),fe.mtime&&(fe.mt=new Date(1e3*fe.mtime))),D.l=H,B[R]=fe}return B}function _(){return x||(x={})}function y(D,B){if(80==D[0]&&75==D[1])return Mx(D,B);if(109==(32|D[0])&&105==(32|D[1]))return function qv(D,B){if("mime-version:"!=nt(D.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var P=B&&B.root||"",R=(xt&&Buffer.isBuffer(D)?D.toString("binary"):nt(D)).split("\r\n"),U=0,H="";for(U=0;U<R.length;++U)if(/^Content-Location:/i.test(H=R[U])&&(H=H.slice(H.indexOf("file")),P||(P=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,P.length)!=P))for(;P.length>0&&(P=(P=P.slice(0,P.length-1)).slice(0,P.lastIndexOf("/")+1),H.slice(0,P.length)!=P););var fe=(R[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var be="--"+(fe[1]||""),me={FileIndex:[],FullPaths:[]};G(me);var Re,$e=0;for(U=0;U<R.length;++U){var ht=R[U];ht!==be&&ht!==be+"--"||($e++&&Qv(me,R.slice(Re,U),P),Re=U)}return me}(D,B);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var P,U,H,fe,be,de,R=512,ue=[],me=D.slice(0,512);Yr(me,0);var Re=function T(D){if(80==D[D.l]&&75==D[D.l+1])return[0,0];D.chk(ct,"Header Signature: "),D.l+=16;var B=D.read_shift(2,"u");return[D.read_shift(2,"u"),B]}(me);switch(P=Re[0]){case 3:R=512;break;case 4:R=4096;break;case 0:if(0==Re[1])return Mx(D,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}512!==R&&Yr(me=D.slice(0,R),28);var $e=D.slice(0,R);!function E(D,B){var P;switch(D.l+=2,P=D.read_shift(2)){case 9:if(3!=B)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(4!=B)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}(me,P);var ht=me.read_shift(4,"i");if(3===P&&0!==ht)throw new Error("# Directory Sectors: Expected 0 saw "+ht);me.l+=4,fe=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),be=me.read_shift(4,"i"),U=me.read_shift(4,"i"),de=me.read_shift(4,"i"),H=me.read_shift(4,"i");for(var je=-1,Ke=0;Ke<109&&!((je=me.read_shift(4,"i"))<0);++Ke)ue[Ke]=je;var Dt=function C(D,B){for(var P=Math.ceil(D.length/B)-1,R=[],U=1;U<P;++U)R[U-1]=D.slice(U*B,(U+1)*B);return R[P-1]=D.slice(P*B),R}(D,R);F(de,H,Dt,R,ue);var _r=function L(D,B,P,R){var U=D.length,H=[],fe=[],be=[],de=[],ue=R-1,me=0,Re=0,$e=0,ht=0;for(me=0;me<U;++me)if(be=[],($e=me+B)>=U&&($e-=U),!fe[$e]){de=[];var je=[];for(Re=$e;Re>=0;){je[Re]=!0,fe[Re]=!0,be[be.length]=Re,de.push(D[Re]);var Ke=P[Math.floor(4*Re/R)];if(R<4+(ht=4*Re&ue))throw new Error("FAT boundary crossed: "+Re+" 4 "+R);if(!D[Ke]||je[Re=Kn(D[Ke],ht)])break}H[$e]={nodes:be,data:uc([de])}}return H}(Dt,fe,ue,R);_r[fe].name="!Directory",U>0&&be!==ze&&(_r[be].name="!MiniFAT"),_r[ue[0]].name="!FAT",_r.fat_addrs=ue,_r.ssz=R;var jr=[],zn=[],Il=[];(function M(D,B,P,R,U,H,fe,be){for(var ht,de=0,ue=R.length?2:0,me=B[D].data,Re=0,$e=0;Re<me.length;Re+=128){var je=me.slice(Re,Re+128);Yr(je,64),$e=je.read_shift(2),ht=so(je,0,$e-ue),R.push(ht);var Ke={name:ht,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0};0!==je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2)&&(Ke.ct=q(je,je.l-8)),0!==je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2)&&(Ke.mt=q(je,je.l-8)),Ke.start=je.read_shift(4,"i"),Ke.size=je.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=ze,Ke.name=""),5===Ke.type?(de=Ke.start,U>0&&de!==ze&&(B[de].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",void 0===B[Ke.start]&&(B[Ke.start]=N(P,Ke.start,B.fat_addrs,B.ssz)),B[Ke.start].name=Ke.name,Ke.content=B[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:de!==ze&&Ke.start!==ze&&B[de]&&(Ke.content=k(Ke,B[de].data,(B[be]||{}).data))),Ke.content&&Yr(Ke.content,0),H[ht]=Ke,fe.push(Ke)}})(fe,_r,Dt,jr,U,{},zn,be),function A(D,B,P){for(var R=0,U=0,H=0,fe=0,be=0,de=P.length,ue=[],me=[];R<de;++R)ue[R]=me[R]=R,B[R]=P[R];for(;be<me.length;++be)U=D[R=me[be]].L,H=D[R].R,fe=D[R].C,ue[R]===R&&(-1!==U&&ue[U]!==U&&(ue[R]=ue[U]),-1!==H&&ue[H]!==H&&(ue[R]=ue[H])),-1!==fe&&(ue[fe]=R),-1!==U&&R!=ue[R]&&(ue[U]=ue[R],me.lastIndexOf(U)<be&&me.push(U)),-1!==H&&R!=ue[R]&&(ue[H]=ue[R],me.lastIndexOf(H)<be&&me.push(H));for(R=1;R<de;++R)ue[R]===R&&(-1!==H&&ue[H]!==H?ue[R]=ue[H]:-1!==U&&ue[U]!==U&&(ue[R]=ue[U]));for(R=1;R<de;++R)if(0!==D[R].type){if((be=R)!=ue[be])do{B[R]=B[be=ue[be]]+"/"+B[R]}while(0!==be&&-1!==ue[be]&&be!=ue[be]);ue[R]=-1}for(B[0]+="/",R=1;R<de;++R)2!==D[R].type&&(B[R]+="/")}(zn,Il,jr),jr.shift();var Pl={FileIndex:zn,FullPaths:Il};return B&&B.raw&&(Pl.raw={header:$e,sectors:Dt}),Pl}function k(D,B,P){for(var U=D.size,H=[],fe=D.start;P&&U>0&&fe>=0;)H.push(B.slice(fe*re,fe*re+re)),U-=re,fe=Kn(P,4*fe);return 0===H.length?xe(0):br(H).slice(0,D.size)}function F(D,B,P,R,U){var H=ze;if(D===ze){if(0!==B)throw new Error("DIFAT chain shorter than expected")}else if(-1!==D){var fe=P[D],be=(R>>>2)-1;if(!fe)return;for(var de=0;de<be&&(H=Kn(fe,4*de))!==ze;++de)U.push(H);F(Kn(fe,R-4),B-1,P,R,U)}}function N(D,B,P,R,U){var H=[],fe=[];U||(U=[]);var be=R-1,de=0,ue=0;for(de=B;de>=0;){U[de]=!0,H[H.length]=de,fe.push(D[de]);var me=P[Math.floor(4*de/R)];if(R<4+(ue=4*de&be))throw new Error("FAT boundary crossed: "+de+" 4 "+R);if(!D[me])break;de=Kn(D[me],ue)}return{nodes:H,data:uc([fe])}}function q(D,B){return new Date(1e3*(Vr(D,B+4)/1e7*Math.pow(2,32)+Vr(D,B)/1e7-11644473600))}function G(D,B){var P=B||{},R=P.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");0===D.FullPaths.length&&(D.FullPaths[0]=R+"/",D.FileIndex[0]={name:R,type:5}),P.CLSID&&(D.FileIndex[0].clsid=P.CLSID),function ie(D){var B="\x01Sh33tJ5";if(!lt.find(D,"/"+B)){var P=xe(4);P[0]=55,P[1]=P[3]=50,P[2]=54,D.FileIndex.push({name:B,type:2,content:P,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+B),ee(D)}}(D)}function ee(D,B){G(D);for(var P=!1,R=!1,U=D.FullPaths.length-1;U>=0;--U){var H=D.FileIndex[U];switch(H.type){case 0:R?P=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(H.R*H.L*H.C)&&(P=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(P=!0);break;default:P=!0}}if(P||B){var fe=new Date(1987,1,19),be=0,de=Object.create?Object.create(null):{},ue=[];for(U=0;U<D.FullPaths.length;++U)de[D.FullPaths[U]]=!0,0!==D.FileIndex[U].type&&ue.push([D.FullPaths[U],D.FileIndex[U]]);for(U=0;U<ue.length;++U){var me=s(ue[U][0]);(R=de[me])||(ue.push([me,{name:o(me).replace("/",""),type:1,clsid:vt,ct:fe,mt:fe,content:null}]),de[me]=!0)}for(ue.sort(function(ht,je){return function t(D,B){for(var P=D.split("/"),R=B.split("/"),U=0,H=0,fe=Math.min(P.length,R.length);U<fe;++U){if(H=P[U].length-R[U].length)return H;if(P[U]!=R[U])return P[U]<R[U]?-1:1}return P.length-R.length}(ht[0],je[0])}),D.FullPaths=[],D.FileIndex=[],U=0;U<ue.length;++U)D.FullPaths[U]=ue[U][0],D.FileIndex[U]=ue[U][1];for(U=0;U<ue.length;++U){var Re=D.FileIndex[U],$e=D.FullPaths[U];if(Re.name=o($e).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||vt,0===U)Re.C=ue.length>1?1:-1,Re.size=0,Re.type=5;else if("/"==$e.slice(-1)){for(be=U+1;be<ue.length&&s(D.FullPaths[be])!=$e;++be);for(Re.C=be>=ue.length?-1:be,be=U+1;be<ue.length&&s(D.FullPaths[be])!=s($e);++be);Re.R=be>=ue.length?-1:be,Re.type=1}else s(D.FullPaths[U+1]||"")==s($e)&&(Re.R=U+1),Re.type=2}}}function we(D,B){var P=B||{};if("mad"==P.fileType)return function e2(D,B){for(var P=B||{},R=P.boundary||"SheetJS",U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(R="------="+R).slice(2)+'"',"","",""],H=D.FullPaths[0],fe=H,be=D.FileIndex[0],de=1;de<D.FullPaths.length;++de)if(fe=D.FullPaths[de].slice(H.length),(be=D.FileIndex[de]).size&&be.content&&"\x01Sh33tJ5"!=fe){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Dt){return"_x"+Dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Dt){return"_u"+Dt.charCodeAt(0).toString(16)+"_"});for(var ue=be.content,me=xt&&Buffer.isBuffer(ue)?ue.toString("binary"):nt(ue),Re=0,$e=Math.min(1024,me.length),ht=0,je=0;je<=$e;++je)(ht=me.charCodeAt(je))>=32&&ht<128&&++Re;var Ke=Re>=4*$e/5;U.push(R),U.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+fe),U.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),U.push("Content-Type: "+Yv(be,fe)),U.push(""),U.push(Ke?Kv(me):Zv(me))}return U.push(R+"--\r\n"),U.join("\r\n")}(D,P);if("zip"===(ee(D),P.fileType))return function Xv(D,B){var P=B||{},R=[],U=[],H=xe(1),fe=P.compression?8:0,be=0,ue=0,me=0,Re=0,$e=0,ht=D.FullPaths[0],je=ht,Ke=D.FileIndex[0],Dt=[],_r=0;for(ue=1;ue<D.FullPaths.length;++ue)if(je=D.FullPaths[ue].slice(ht.length),(Ke=D.FileIndex[ue]).size&&Ke.content&&"\x01Sh33tJ5"!=je){var Dn=Re,jr=xe(je.length);for(me=0;me<je.length;++me)jr.write_shift(1,127&je.charCodeAt(me));jr=jr.slice(0,jr.l),Dt[$e]=Pr.buf(Ke.content,0);var zn=Ke.content;8==fe&&(zn=Q(zn)),(H=xe(30)).write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,be),H.write_shift(2,fe),Ke.mt?f(H,Ke.mt):H.write_shift(4,0),H.write_shift(-4,8&be?0:Dt[$e]),H.write_shift(4,8&be?0:zn.length),H.write_shift(4,8&be?0:Ke.content.length),H.write_shift(2,jr.length),H.write_shift(2,0),Re+=H.length,R.push(H),Re+=jr.length,R.push(jr),Re+=zn.length,R.push(zn),8&be&&((H=xe(12)).write_shift(-4,Dt[$e]),H.write_shift(4,zn.length),H.write_shift(4,Ke.content.length),Re+=H.l,R.push(H)),(H=xe(46)).write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,be),H.write_shift(2,fe),H.write_shift(4,0),H.write_shift(-4,Dt[$e]),H.write_shift(4,zn.length),H.write_shift(4,Ke.content.length),H.write_shift(2,jr.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Dn),_r+=H.l,U.push(H),_r+=jr.length,U.push(jr),++$e}return(H=xe(22)).write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,$e),H.write_shift(2,$e),H.write_shift(4,_r),H.write_shift(4,Re),H.write_shift(2,0),br([br(R),br(U),H])}(D,P);var R=function(ht){for(var je=0,Ke=0,Dt=0;Dt<ht.FileIndex.length;++Dt){var _r=ht.FileIndex[Dt];if(_r.content){var Dn=_r.content.length;Dn>0&&(Dn<4096?je+=Dn+63>>6:Ke+=Dn+511>>9)}}for(var jr=ht.FullPaths.length+3>>2,Il=je+127>>7,Pl=(je+7>>3)+Ke+jr+Il,js=Pl+127>>7,H1=js<=109?0:Math.ceil((js-109)/127);Pl+js+H1+127>>7>js;)H1=++js<=109?0:Math.ceil((js-109)/127);var wa=[1,H1,js,Il,jr,Ke,je,0];return ht.FileIndex[0].size=je<<6,wa[7]=(ht.FileIndex[0].start=wa[0]+wa[1]+wa[2]+wa[3]+wa[4]+wa[5])+(wa[6]+7>>3),wa}(D),U=xe(R[7]<<9),H=0,fe=0;for(H=0;H<8;++H)U.write_shift(1,Ge[H]);for(H=0;H<8;++H)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),H=0;H<3;++H)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,R[2]),U.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:ze),U.write_shift(4,R[3]),U.write_shift(-4,R[1]?R[0]-1:ze),U.write_shift(4,R[1]),H=0;H<109;++H)U.write_shift(-4,H<R[2]?R[1]+H:-1);if(R[1])for(fe=0;fe<R[1];++fe){for(;H<236+127*fe;++H)U.write_shift(-4,H<R[2]?R[1]+H:-1);U.write_shift(-4,fe===R[1]-1?ze:fe+1)}var be=function(ht){for(fe+=ht;H<fe-1;++H)U.write_shift(-4,H+1);ht&&(++H,U.write_shift(-4,ze))};for(fe=H=0,fe+=R[1];H<fe;++H)U.write_shift(-4,dt.DIFSECT);for(fe+=R[2];H<fe;++H)U.write_shift(-4,dt.FATSECT);be(R[3]),be(R[4]);for(var de=0,ue=0,me=D.FileIndex[0];de<D.FileIndex.length;++de)(me=D.FileIndex[de]).content&&!((ue=me.content.length)<4096)&&(me.start=fe,be(ue+511>>9));for(be(R[6]+7>>3);511&U.l;)U.write_shift(-4,dt.ENDOFCHAIN);for(fe=H=0,de=0;de<D.FileIndex.length;++de)(me=D.FileIndex[de]).content&&(ue=me.content.length)&&!(ue>=4096)&&(me.start=fe,be(ue+63>>6));for(;511&U.l;)U.write_shift(-4,dt.ENDOFCHAIN);for(H=0;H<R[4]<<2;++H){var Re=D.FullPaths[H];if(Re&&0!==Re.length){me=D.FileIndex[H],0===H&&(me.start=me.size?me.start-1:ze);var $e=0===H&&P.root||me.name;if(ue=2*($e.length+1),U.write_shift(64,$e,"utf16le"),U.write_shift(2,ue),U.write_shift(1,me.type),U.write_shift(1,me.color),U.write_shift(-4,me.L),U.write_shift(-4,me.R),U.write_shift(-4,me.C),me.clsid)U.write_shift(16,me.clsid,"hex");else for(de=0;de<4;++de)U.write_shift(4,0);U.write_shift(4,me.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,me.start),U.write_shift(4,me.size),U.write_shift(4,0)}else{for(de=0;de<17;++de)U.write_shift(4,0);for(de=0;de<3;++de)U.write_shift(4,-1);for(de=0;de<12;++de)U.write_shift(4,0)}}for(H=1;H<D.FileIndex.length;++H)if((me=D.FileIndex[H]).size>=4096)if(U.l=me.start+1<<9,xt&&Buffer.isBuffer(me.content))me.content.copy(U,U.l,0,me.size),U.l+=me.size+511&-512;else{for(de=0;de<me.size;++de)U.write_shift(1,me.content[de]);for(;511&de;++de)U.write_shift(1,0)}for(H=1;H<D.FileIndex.length;++H)if((me=D.FileIndex[H]).size>0&&me.size<4096)if(xt&&Buffer.isBuffer(me.content))me.content.copy(U,U.l,0,me.size),U.l+=me.size+63&-64;else{for(de=0;de<me.size;++de)U.write_shift(1,me.content[de]);for(;63&de;++de)U.write_shift(1,0)}if(xt)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}r.version="1.2.1";var De,re=64,ze=-2,ct="d0cf11e0a1b11ae1",Ge=[208,207,17,224,161,177,26,225],vt="00000000000000000000000000000000",dt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ze,FREESECT:-1,HEADER_SIGNATURE:ct,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:vt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function nt(D){for(var B=new Array(D.length),P=0;P<D.length;++P)B[P]=String.fromCharCode(D[P]);return B.join("")}function Q(D){return De?De.deflateRawSync(D):Bt(D)}for(var D,B,J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ke=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Je=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],We=typeof Uint8Array<"u",Ae=We?new Uint8Array(256):[],Lt=0;Lt<256;++Lt)Ae[Lt]=(void 0,255&((B=139536&((D=Lt)<<1|D<<11)|558144&(D<<5|D<<15))>>16|B>>8|B));function z(D,B){var P=Ae[255&D];return B<=8?P>>>8-B:(P=P<<8|Ae[D>>8&255],B<=16?P>>>16-B:(P=P<<8|Ae[D>>16&255])>>>24-B)}function ir(D,B){var P=7&B,R=B>>>3;return(D[R]|(P<=6?0:D[R+1]<<8))>>>P&3}function Vt(D,B){var P=7&B,R=B>>>3;return(D[R]|(P<=5?0:D[R+1]<<8))>>>P&7}function zt(D,B){var P=7&B,R=B>>>3;return(D[R]|(P<=3?0:D[R+1]<<8))>>>P&31}function tt(D,B){var P=7&B,R=B>>>3;return(D[R]|(P<=1?0:D[R+1]<<8))>>>P&127}function Nr(D,B,P){var R=7&B,U=B>>>3,fe=D[U]>>>R;return P<8-R||(fe|=D[U+1]<<8-R,P<16-R)||(fe|=D[U+2]<<16-R,P<24-R)||(fe|=D[U+3]<<24-R),fe&(1<<P)-1}function ni(D,B,P){var R=7&B,U=B>>>3;return R<=5?D[U]|=(7&P)<<R:(D[U]|=P<<R&255,D[U+1]=(7&P)>>8-R),B+3}function Gi(D,B,P){return D[B>>>3]|=P=(1&P)<<(7&B),B+1}function _a(D,B,P){var U=B>>>3;return D[U]|=255&(P<<=7&B),D[U+1]=P>>>=8,B+8}function Dl(D,B,P){var U=B>>>3;return D[U]|=255&(P<<=7&B),D[U+1]=255&(P>>>=8),D[U+2]=P>>>8,B+16}function qa(D,B){var P=D.length,R=2*P>B?2*P:B+5,U=0;if(P>=B)return D;if(xt){var H=On(R);if(D.copy)D.copy(H);else for(;U<D.length;++U)H[U]=D[U];return H}if(We){var fe=new Uint8Array(R);if(fe.set)fe.set(D);else for(;U<P;++U)fe[U]=D[U];return fe}return D.length=R,D}function Vn(D){for(var B=new Array(D),P=0;P<D;++P)B[P]=0;return B}function va(D,B,P){var R=1,U=0,H=0,fe=0,be=0,de=D.length,ue=We?new Uint16Array(32):Vn(32);for(H=0;H<32;++H)ue[H]=0;for(H=de;H<P;++H)D[H]=0;de=D.length;var me=We?new Uint16Array(de):Vn(de);for(H=0;H<de;++H)ue[U=D[H]]++,R<U&&(R=U),me[H]=0;for(ue[0]=0,H=1;H<=R;++H)ue[H+16]=be=be+ue[H-1]<<1;for(H=0;H<de;++H)0!=(be=D[H])&&(me[H]=ue[be+16]++);var Re=0;for(H=0;H<de;++H)if(0!=(Re=D[H]))for(be=z(me[H],R)>>R-Re,fe=(1<<R+4-Re)-1;fe>=0;--fe)B[be|fe<<Re]=15&Re|H<<4;return R}var es=We?new Uint16Array(512):Vn(512),Ol=We?new Uint16Array(32):Vn(32);if(!We){for(var En=0;En<512;++En)es[En]=0;for(En=0;En<32;++En)Ol[En]=0}!function(){for(var D=[],B=0;B<32;B++)D.push(5);va(D,Ol,32);var P=[];for(B=0;B<=143;B++)P.push(8);for(;B<=255;B++)P.push(9);for(;B<=279;B++)P.push(7);for(;B<=287;B++)P.push(8);va(P,es,288)}();var Xi=function(){for(var B=We?new Uint8Array(32768):[],P=0,R=0;P<Je.length-1;++P)for(;R<Je[P+1];++R)B[R]=P;for(;R<32768;++R)B[R]=29;var U=We?new Uint8Array(259):[];for(P=0,R=0;P<ke.length-1;++P)for(;R<ke[P+1];++R)U[R]=P;return function(de,ue){return de.length<8?function H(be,de){for(var ue=0;ue<be.length;){var me=Math.min(65535,be.length-ue);for(de.write_shift(1,+(ue+me==be.length)),de.write_shift(2,me),de.write_shift(2,65535&~me);me-- >0;)de[de.l++]=be[ue++]}return de.l}(de,ue):function fe(be,de){for(var ue=0,me=0,Re=We?new Uint16Array(32768):[];me<be.length;){var $e=Math.min(65535,be.length-me);if($e<10){for(7&(ue=ni(de,ue,+(me+$e==be.length)))&&(ue+=8-(7&ue)),de.l=ue/8|0,de.write_shift(2,$e),de.write_shift(2,65535&~$e);$e-- >0;)de[de.l++]=be[me++];ue=8*de.l}else{ue=ni(de,ue,+(me+$e==be.length)+2);for(var ht=0;$e-- >0;){var je=be[me],Ke=-1,Dt=0;if((Ke=Re[ht=32767&(ht<<5^je)])&&((Ke|=-32768&me)>me&&(Ke-=32768),Ke<me))for(;be[Ke+Dt]==be[me+Dt]&&Dt<250;)++Dt;if(Dt>2){(je=U[Dt])<=22?ue=_a(de,ue,Ae[je+1]>>1)-1:(_a(de,ue,3),_a(de,ue+=5,Ae[je-23]>>5),ue+=3);var _r=je<8?0:je-4>>2;_r>0&&(Dl(de,ue,Dt-ke[je]),ue+=_r),ue=_a(de,ue,Ae[je=B[me-Ke]]>>3),ue-=3;var Dn=je<4?0:je-2>>1;Dn>0&&(Dl(de,ue,me-Ke-Je[je]),ue+=Dn);for(var jr=0;jr<Dt;++jr)Re[ht]=32767&me,ht=32767&(ht<<5^be[me]),++me;$e-=Dt-1}else je<=143?je+=48:ue=Gi(de,ue,1),ue=_a(de,ue,Ae[je]),Re[ht]=32767&me,++me}ue=_a(de,ue,0)-1}}return de.l=(ue+7)/8|0,de.l}(de,ue)}}();function Bt(D){var B=xe(50+Math.floor(1.1*D.length)),P=Xi(D,B);return B.slice(0,P)}var Br=We?new Uint16Array(32768):Vn(32768),ii=We?new Uint16Array(32768):Vn(32768),tn=We?new Uint16Array(128):Vn(128),$s=1,Ox=1;function $v(D,B){var P=zt(D,B)+257,R=zt(D,B+=5)+1,U=function ar(D,B){var P=7&B,R=B>>>3;return(D[R]|(P<=4?0:D[R+1]<<8))>>>P&15}(D,B+=5)+4;B+=4;for(var H=0,fe=We?new Uint8Array(19):Vn(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,ue=We?new Uint8Array(8):Vn(8),me=We?new Uint8Array(8):Vn(8),Re=fe.length,$e=0;$e<U;++$e)fe[J[$e]]=H=Vt(D,B),de<H&&(de=H),ue[H]++,B+=3;var ht=0;for(ue[0]=0,$e=1;$e<=de;++$e)me[$e]=ht=ht+ue[$e-1]<<1;for($e=0;$e<Re;++$e)0!=(ht=fe[$e])&&(be[$e]=me[ht]++);var je=0;for($e=0;$e<Re;++$e)if(0!=(je=fe[$e])){ht=Ae[be[$e]]>>8-je;for(var Ke=(1<<7-je)-1;Ke>=0;--Ke)tn[ht|Ke<<je]=7&je|$e<<3}var Dt=[];for(de=1;Dt.length<P+R;)switch(ht=tn[tt(D,B)],B+=7&ht,ht>>>=3){case 16:for(H=3+ir(D,B),B+=2,ht=Dt[Dt.length-1];H-- >0;)Dt.push(ht);break;case 17:for(H=3+Vt(D,B),B+=3;H-- >0;)Dt.push(0);break;case 18:for(H=11+tt(D,B),B+=7;H-- >0;)Dt.push(0);break;default:Dt.push(ht),de<ht&&(de=ht)}var _r=Dt.slice(0,P),Dn=Dt.slice(P);for($e=P;$e<286;++$e)_r[$e]=0;for($e=R;$e<30;++$e)Dn[$e]=0;return $s=va(_r,Br,286),Ox=va(Dn,ii,30),B}function Ix(D,B){var R=function jv(D,B){if(3==D[0]&&!(3&D[1]))return[$n(B),2];for(var P=0,R=0,U=On(B||1<<18),H=0,fe=U.length>>>0,be=0,de=0;!(1&R);)if(R=Vt(D,P),P+=3,R>>>1)for(R>>1==1?(be=9,de=5):(P=$v(D,P),be=$s,de=Ox);;){!B&&fe<H+32767&&(fe=(U=qa(U,H+32767)).length);var me=Nr(D,P,be),Re=R>>>1==1?es[me]:Br[me];if(P+=15&Re,(Re>>>=4)>>>8&255){if(256==Re)break;var $e=(Re-=257)<8?0:Re-4>>2;$e>5&&($e=0);var ht=H+ke[Re];$e>0&&(ht+=Nr(D,P,$e),P+=$e),me=Nr(D,P,de),P+=15&(Re=R>>>1==1?Ol[me]:ii[me]);var je=(Re>>>=4)<4?0:Re-2>>1,Ke=Je[Re];for(je>0&&(Ke+=Nr(D,P,je),P+=je),!B&&fe<ht&&(fe=(U=qa(U,ht+100)).length);H<ht;)U[H]=U[H-Ke],++H}else U[H++]=Re}else{7&P&&(P+=8-(7&P));var ue=D[P>>>3]|D[1+(P>>>3)]<<8;if(P+=32,ue>0)for(!B&&fe<H+ue&&(fe=(U=qa(U,H+ue)).length);ue-- >0;)U[H++]=D[P>>>3],P+=8}return B?[U,P+7>>>3]:[U.slice(0,H),P+7>>>3]}(D.slice(D.l||0),B);return D.l+=R[1],R[0]}function Px(D,B){if(!D)throw new Error(B);typeof console<"u"&&console.error(B)}function Mx(D,B){var P=D;Yr(P,0);var H={FileIndex:[],FullPaths:[]};G(H,{root:B.root});for(var fe=P.length-4;(80!=P[fe]||75!=P[fe+1]||5!=P[fe+2]||6!=P[fe+3])&&fe>=0;)--fe;P.l=fe+4,P.l+=4;var be=P.read_shift(2);P.l+=6;var de=P.read_shift(4);for(P.l=de,fe=0;fe<be;++fe){P.l+=20;var ue=P.read_shift(4),me=P.read_shift(4),Re=P.read_shift(2),$e=P.read_shift(2),ht=P.read_shift(2);P.l+=8;var je=P.read_shift(4),Ke=p(P.slice(P.l+Re,P.l+Re+$e));P.l+=Re+$e+ht;var Dt=P.l;P.l=je+4,Gv(P,ue,me,H,Ke),P.l=Dt}return H}function Gv(D,B,P,R,U){D.l+=2;var H=D.read_shift(2),fe=D.read_shift(2),be=function u(D){var B=65535&D.read_shift(2),P=65535&D.read_shift(2),R=new Date,U=31&P,H=15&(P>>>=5);P>>>=4,R.setMilliseconds(0),R.setFullYear(P+1980),R.setMonth(H-1),R.setDate(U);var fe=31&B,be=63&(B>>>=5);return R.setHours(B>>>=6),R.setMinutes(be),R.setSeconds(fe<<1),R}(D);if(8257&H)throw new Error("Unsupported ZIP encryption");D.read_shift(4);for(var ue=D.read_shift(4),me=D.read_shift(4),Re=D.read_shift(2),$e=D.read_shift(2),ht="",je=0;je<Re;++je)ht+=String.fromCharCode(D[D.l++]);if($e){var Ke=p(D.slice(D.l,D.l+$e));(Ke[21589]||{}).mt&&(be=Ke[21589].mt),((U||{})[21589]||{}).mt&&(be=U[21589].mt)}D.l+=$e;var Dt=D.slice(D.l,D.l+ue);switch(fe){case 8:Dt=function pe(D,B){if(!De)return Ix(D,B);var R=new(0,De.InflateRaw),U=R._processChunk(D.slice(D.l),R._finishFlushFlag);return D.l+=R.bytesRead,U}(D,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var _r=!1;8&H&&(134695760==D.read_shift(4)&&(D.read_shift(4),_r=!0),ue=D.read_shift(4),me=D.read_shift(4)),ue!=B&&Px(_r,"Bad compressed size: "+B+" != "+ue),me!=P&&Px(_r,"Bad uncompressed size: "+P+" != "+me),U1(R,ht,Dt,{unsafe:!0,mt:be})}var Wh={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Yv(D,B){if(D.ctype)return D.ctype;var P=D.name||"",R=P.match(/\.([^\.]+)$/);return R&&Wh[R[1]]||B&&(R=(P=B).match(/[\.\\]([^\.\\])+$/))&&Wh[R[1]]?Wh[R[1]]:"application/octet-stream"}function Zv(D){for(var B=Pt(D),P=[],R=0;R<B.length;R+=76)P.push(B.slice(R,R+76));return P.join("\r\n")+"\r\n"}function Kv(D){var B=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var me=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(1==me.length?"0"+me:me)});"\n"==(B=B.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(B="=0D"+B.slice(1));for(var P=[],R=(B=B.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),U=0;U<R.length;++U){var H=R[U];if(0!=H.length)for(var fe=0;fe<H.length;){var be=76,de=H.slice(fe,fe+be);"="==de.charAt(be-1)?be--:"="==de.charAt(be-2)?be-=2:"="==de.charAt(be-3)&&(be-=3),de=H.slice(fe,fe+be),(fe+=be)<H.length&&(de+="="),P.push(de)}else P.push("")}return P.join("\r\n")}function Qv(D,B,P){for(var fe,R="",U="",H="",be=0;be<10;++be){var de=B[be];if(!de||de.match(/^\s*$/))break;var ue=de.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":R=ue[2].trim();break;case"content-type":H=ue[2].trim();break;case"content-transfer-encoding":U=ue[2].trim()}}switch(++be,U.toLowerCase()){case"base64":fe=Ur(Kt(B.slice(be).join("")));break;case"quoted-printable":fe=function Jv(D){for(var B=[],P=0;P<D.length;++P){for(var R=D[P];P<=D.length&&"="==R.charAt(R.length-1);)R=R.slice(0,R.length-1)+D[++P];B.push(R)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Ur(B.join("\r\n"))}(B.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var me=U1(D,R.slice(P.length),fe,{unsafe:!0});H&&(me.ctype=H)}function U1(D,B,P,R){var U=R&&R.unsafe;U||G(D);var H=!U&&lt.find(D,B);if(!H){var fe=D.FullPaths[0];B.slice(0,fe.length)==fe?fe=B:("/"!=fe.slice(-1)&&(fe+="/"),fe=(fe+B).replace("//","/")),H={name:o(B),type:2},D.FileIndex.push(H),D.FullPaths.push(fe),U||lt.utils.cfb_gc(D)}return H.content=P,H.size=P?P.length:0,R&&(R.CLSID&&(H.clsid=R.CLSID),R.mt&&(H.mt=R.mt),R.ct&&(H.ct=R.ct)),H}return r.find=function ye(D,B){var P=D.FullPaths.map(function(de){return de.toUpperCase()}),R=P.map(function(de){var ue=de.split("/");return ue[ue.length-("/"==de.slice(-1)?2:1)]}),U=!1;47===B.charCodeAt(0)?(U=!0,B=P[0].slice(0,-1)+B):U=-1!==B.indexOf("/");var H=B.toUpperCase(),fe=!0===U?P.indexOf(H):R.indexOf(H);if(-1!==fe)return D.FileIndex[fe];var be=!H.match(si);for(H=H.replace(Hr,""),be&&(H=H.replace(si,"!")),fe=0;fe<P.length;++fe)if((be?P[fe].replace(si,"!"):P[fe]).replace(Hr,"")==H||(be?R[fe].replace(si,"!"):R[fe]).replace(Hr,"")==H)return D.FileIndex[fe];return null},r.read=function ve(D,B){var P=B&&B.type;switch(P||xt&&Buffer.isBuffer(D)&&(P="buffer"),P||"base64"){case"file":return function ae(D,B){return _(),y(x.readFileSync(D),B)}(D,B);case"base64":return y(Ur(Kt(D)),B);case"binary":return y(Ur(D),B)}return y(D,B)},r.parse=y,r.write=function bt(D,B){var P=we(D,B);switch(B&&B.type||"buffer"){case"file":return _(),x.writeFileSync(B.filename,P),P;case"binary":return"string"==typeof P?P:nt(P);case"base64":return Pt("string"==typeof P?P:nt(P));case"buffer":if(xt)return Buffer.isBuffer(P)?P:_n(P);case"array":return"string"==typeof P?Ur(P):P}return P},r.writeFile=function Wt(D,B,P){_();var R=we(D,P);x.writeFileSync(B,R)},r.utils={cfb_new:function t2(D){var B={};return G(B,D),B},cfb_add:U1,cfb_del:function r2(D,B){G(D);var P=lt.find(D,B);if(P)for(var R=0;R<D.FileIndex.length;++R)if(D.FileIndex[R]==P)return D.FileIndex.splice(R,1),D.FullPaths.splice(R,1),!0;return!1},cfb_mov:function n2(D,B,P){G(D);var R=lt.find(D,B);if(R)for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==R)return D.FileIndex[U].name=o(P),D.FullPaths[U]=P,!0;return!1},cfb_gc:function i2(D){ee(D,!0)},ReadShift:Da,CheckField:n0,prep_blob:Yr,bconcat:br,use_zlib:function j(D){try{var P=new(0,D.InflateRaw);if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),!P.bytesRead)throw new Error("zlib does not expose bytesRead");De=D}catch(R){console.error("cannot use native zlib: "+(R.message||R))}},_deflateRaw:Bt,_inflateRaw:Ix,consts:dt},r}();let nr;function Rn(e){return"string"==typeof e?ai(e):Array.isArray(e)?function Yi(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Zn(e,r,t){if(typeof nr<"u"&&nr.writeFileSync)return t?nr.writeFileSync(e,r,t):nr.writeFileSync(e,r);if(typeof Deno<"u"){if(t&&"string"==typeof r)switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=ai(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var s="utf8"==t?fr(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var o=new Blob([Rn(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var f=URL.createObjectURL(o);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),chrome.downloads.download({url:f,filename:e,saveAs:!0});var u=document.createElement("a");if(null!=u.download)return u.download=e,u.href=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),f}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var p=File(e);return p.open("w"),p.encoding="binary",Array.isArray(r)&&(r=Sr(r)),p.write(r),p.close(),r}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+e)}function vr(e){for(var r=Object.keys(e),t=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e,r[s])&&t.push(r[s]);return t}function Rl(e,r){for(var t=[],s=vr(e),o=0;o!==s.length;++o)null==t[e[s[o]][r]]&&(t[e[s[o]][r]]=s[o]);return t}function is(e){for(var r=[],t=vr(e),s=0;s!==t.length;++s)r[e[t[s]]]=t[s];return r}function no(e){for(var r=[],t=vr(e),s=0;s!==t.length;++s)r[e[t[s]]]=parseInt(t[s],10);return r}var as=new Date(1899,11,30,0,0,0);function Gr(e,r){var t=e.getTime();return r&&(t-=1263168e5),(t-(as.getTime()+6e4*(e.getTimezoneOffset()-as.getTimezoneOffset())))/864e5}var ic=new Date,Nl=as.getTime()+6e4*(ic.getTimezoneOffset()-as.getTimezoneOffset()),Bl=ic.getTimezoneOffset();function ss(e){var r=new Date;return r.setTime(24*e*60*60*1e3+Nl),r.getTimezoneOffset()!==Bl&&r.setTime(r.getTime()+6e4*(r.getTimezoneOffset()-Bl)),r}var Ul=new Date("2017-02-19T19:06:09.000Z"),ac=isNaN(Ul.getFullYear())?new Date("2/19/17"):Ul,Hl=2017==ac.getFullYear();function or(e,r){var t=new Date(e);if(Hl)return r>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==ac.getFullYear()&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],f=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(f=new Date(f.getTime()-60*f.getTimezoneOffset()*1e3)),f}function Fi(e,r){if(xt&&Buffer.isBuffer(e)){if(r){if(255==e[0]&&254==e[1])return fr(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return fr(function Xe(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(255==e[0]&&254==e[1])return fr(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return fr(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(f){return t[f]||f})}catch{}for(var s=[],o=0;o!=e.length;++o)s.push(String.fromCharCode(e[o]));return s.join("")}function Qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Qt(e[t]));return r}function cr(e,r){for(var t="";t.length<r;)t+=e;return t}function yn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(s))&&(s=s.replace(/[(](.*)[)]/,function(o,f){return t=-t,f}),isNaN(r=Number(s)))?r:r/t}var Wl=["january","february","march","april","may","june","july","august","september","october","november","december"];function Di(e){var r=new Date(e),t=new Date(NaN),s=r.getYear(),o=r.getMonth(),f=r.getDate();if(isNaN(f))return t;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Wl.indexOf(u))return t}else if(u.match(/[a-z]/))return t;return s<0||s>8099?t:(o>0||f>1)&&101!=s?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Ot(e,r,t){if(e.FullPaths){var s;if("string"==typeof t)return s=xt?_n(t):function Gs(e){for(var r=[],t=0,s=e.length+250,o=$n(e.length+255),f=0;f<e.length;++f){var u=e.charCodeAt(f);if(u<128)o[t++]=u;else if(u<2048)o[t++]=192|u>>6&31,o[t++]=128|63&u;else if(u>=55296&&u<57344){u=64+(1023&u);var p=1023&e.charCodeAt(++f);o[t++]=240|u>>8&7,o[t++]=128|u>>2&63,o[t++]=128|p>>6&15|(3&u)<<4,o[t++]=128|63&p}else o[t++]=224|u>>12&15,o[t++]=128|u>>6&63,o[t++]=128|63&u;t>s&&(r.push(o.slice(0,t)),t=0,o=$n(65535),s=65530)}return r.push(o.slice(0,t)),br(r)}(t),lt.utils.cfb_add(e,r,s);lt.utils.cfb_add(e,r,t)}else e.file(r,t)}function li(){return lt.utils.cfb_new()}var pr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Ln=is({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Ta=/[&<>'"]/g,Xh=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){return(e+"").replace(Ta,function(t){return Ln[t]}).replace(Xh,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Gl(e){return Jt(e).replace(/ /g,"_x0020_")}var Xl=/[\u0000-\u001f]/g;function Yl(e){return(e+"").replace(Ta,function(t){return Ln[t]}).replace(/\n/g,"<br/>").replace(Xl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function oc(e){for(var r="",t=0,s=0,o=0,f=0,u=0,p=0;t<e.length;)(s=e.charCodeAt(t++))<128?r+=String.fromCharCode(s):(o=e.charCodeAt(t++),s>191&&s<224?(u=(31&s)<<6,u|=63&o,r+=String.fromCharCode(u)):(f=e.charCodeAt(t++),s<240?r+=String.fromCharCode((15&s)<<12|(63&o)<<6|63&f):(p=((7&s)<<18|(63&o)<<12|(63&f)<<6|63&(u=e.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(p>>>10&1023)),r+=String.fromCharCode(56320+(1023&p)))));return r}function Zl(e){var t,s,p,r=$n(2*e.length),o=1,f=0,u=0;for(s=0;s<e.length;s+=o)o=1,(p=e.charCodeAt(s))<128?t=p:p<224?(t=64*(31&p)+(63&e.charCodeAt(s+1)),o=2):p<240?(t=4096*(15&p)+64*(63&e.charCodeAt(s+1))+(63&e.charCodeAt(s+2)),o=3):(o=4,t=262144*(7&p)+4096*(63&e.charCodeAt(s+1))+64*(63&e.charCodeAt(s+2))+(63&e.charCodeAt(s+3)),u=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==u&&(r[f++]=255&u,r[f++]=u>>>8,u=0),r[f++]=t%256,r[f++]=t>>>8;return r.slice(0,f).toString("ucs2")}function ao(e){return _n(e,"binary").toString("utf8")}var cs="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Yt=xt&&(ao(cs)==oc(cs)&&ao||Zl(cs)==oc(cs)&&Zl)||oc,fr=xt?function(e){return _n(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,s=0,o=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(63&s)));break;case s>=55296&&s<57344:s-=55296,o=e.charCodeAt(t++)-56320+(s<<10),r.push(String.fromCharCode(240+(o>>18&7))),r.push(String.fromCharCode(144+(o>>12&63))),r.push(String.fromCharCode(128+(o>>6&63))),r.push(String.fromCharCode(128+(63&o)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(63&s)))}return r.join("")},Ca=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),o=0;o<e.length;++o)s=s.replace(e[o][0],e[o][1]);return s}}(),lc=/(^\s|\s$|\n)/;function Xr(e,r){return"<"+e+(r.match(lc)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function ea(e){return vr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Le(e,r,t){return"<"+e+(null!=t?ea(t):"")+(null!=r?(r.match(lc)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function fc(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}var Ar={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ii=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},Jl=function(e){for(var r=[],s=0;s<e[0].length;++s)if(e[0][s])for(var o=0,f=e[0][s].length;o<f;o+=10240)r.push.apply(r,e[0][s].slice(o,o+10240));return r},uc=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:_n(r)})):Jl(e)}:Jl,dc=function(e,r,t){for(var s=[],o=r;o<t;o+=2)s.push(String.fromCharCode(hi(e,o)));return s.join("").replace(Hr,"")},so=xt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Hr,""):dc(e,r,t)}:dc,pc=function(e,r,t){for(var s=[],o=r;o<r+t;++o)s.push(("0"+e[o].toString(16)).slice(-2));return s.join("")},Ql=xt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):pc(e,r,t)}:pc,ta=function(e,r,t){for(var s=[],o=r;o<t;o++)s.push(String.fromCharCode(Fa(e,o)));return s.join("")},ra=xt?function(r,t,s){return Buffer.isBuffer(r)?r.toString("utf8",t,s):ta(r,t,s)}:ta,ql=function(e,r){var t=Vr(e,r);return t>0?ra(e,r+4,r+4+t-1):""},mc=ql,e0=function(e,r){var t=Vr(e,r);return t>0?ra(e,r+4,r+4+t-1):""},gc=e0,ls=function(e,r){var t=2*Vr(e,r);return t>0?ra(e,r+4,r+4+t-1):""},xc=ls,t0=function(r,t){var s=Vr(r,t);return s>0?so(r,t+4,t+4+s):""},oo=t0,co=function(e,r){var t=Vr(e,r);return t>0?ra(e,r+4,r+4+t):""},Aa=co,fs=function(e,r){return function Kl(e,r){for(var t=1-2*(e[r+7]>>>7),s=((127&e[r+7])<<4)+(e[r+6]>>>4&15),o=15&e[r+6],f=5;f>=0;--f)o=256*o+e[r+f];return 2047==s?0==o?t*(1/0):NaN:(0==s?s=-1022:(s-=1023,o+=Math.pow(2,52)),t*Math.pow(2,s-52)*o)}(e,r)},lo=fs,_c=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};xt&&(mc=function(r,t){if(!Buffer.isBuffer(r))return ql(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},gc=function(r,t){if(!Buffer.isBuffer(r))return e0(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},xc=function(r,t){if(!Buffer.isBuffer(r))return ls(r,t);var s=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s-1)},oo=function(r,t){if(!Buffer.isBuffer(r))return t0(r,t);var s=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s)},Aa=function(r,t){if(!Buffer.isBuffer(r))return co(r,t);var s=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+s)},lo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):fs(r,t)},_c=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),typeof he<"u"&&function Pi(){so=function(e,r,t){return he.utils.decode(1200,e.slice(r,t)).replace(Hr,"")},ra=function(e,r,t){return he.utils.decode(65001,e.slice(r,t))},mc=function(e,r){var t=Vr(e,r);return t>0?he.utils.decode(Ze,e.slice(r+4,r+4+t-1)):""},gc=function(e,r){var t=Vr(e,r);return t>0?he.utils.decode(qe,e.slice(r+4,r+4+t-1)):""},xc=function(e,r){var t=2*Vr(e,r);return t>0?he.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},oo=function(e,r){var t=Vr(e,r);return t>0?he.utils.decode(1200,e.slice(r+4,r+4+t)):""},Aa=function(e,r){var t=Vr(e,r);return t>0?he.utils.decode(65001,e.slice(r+4,r+4+t)):""}}();var Fa=function(e,r){return e[r]},hi=function(e,r){return 256*e[r+1]+e[r]},na=function(e,r){var t=256*e[r+1]+e[r];return t<32768?t:-1*(65535-t+1)},Vr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Kn=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Qh=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Da(e,r){var s,o,u,p,x,_,t="",f=[];switch(r){case"dbcs":if(_=this.l,xt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(x=0;x<e;++x)t+=String.fromCharCode(hi(this,_)),_+=2;e*=2;break;case"utf8":t=ra(this,this.l,this.l+e);break;case"utf16le":t=so(this,this.l,this.l+(e*=2));break;case"wstr":if(!(typeof he<"u"))return Da.call(this,e,"dbcs");t=he.utils.decode(qe,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":t=mc(this,this.l),e=4+Vr(this,this.l);break;case"lpstr-cp":t=gc(this,this.l),e=4+Vr(this,this.l);break;case"lpwstr":t=xc(this,this.l),e=4+2*Vr(this,this.l);break;case"lpp4":e=4+Vr(this,this.l),t=oo(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Vr(this,this.l),t=Aa(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,t="";0!==(u=Fa(this,this.l+e++));)f.push(se(u));t=f.join("");break;case"_wstr":for(e=0,t="";0!==(u=hi(this,this.l+e));)f.push(se(u)),e+=2;e+=2,t=f.join("");break;case"dbcs-cont":for(t="",_=this.l,x=0;x<e;++x){if(this.lens&&-1!==this.lens.indexOf(_))return u=Fa(this,_),this.l=_+1,p=Da.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(se(hi(this,_))),_+=2}t=f.join(""),e*=2;break;case"cpstr":if(typeof he<"u"){t=he.utils.decode(qe,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",_=this.l,x=0;x!=e;++x){if(this.lens&&-1!==this.lens.indexOf(_))return u=Fa(this,_),this.l=_+1,p=Da.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),f.join("")+p;f.push(se(Fa(this,_))),_+=1}t=f.join("");break;default:switch(e){case 1:return s=Fa(this,this.l),this.l++,s;case 2:return s=("i"===r?na:hi)(this,this.l),this.l+=2,s;case 4:case-4:return"i"!==r&&128&this[this.l+3]?(o=Vr(this,this.l),this.l+=4,o):(s=(e>0?Kn:Qh)(this,this.l),this.l+=4,s);case 8:case-8:if("f"===r)return o=8==e?lo(this,this.l):lo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:t=Ql(this,this.l,e)}}return this.l+=e,t}var qh=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},r0=function(e,r,t){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},ia=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255};function eu(e,r,t){var s=0,o=0;if("dbcs"===t){for(o=0;o!=r.length;++o)ia(this,r.charCodeAt(o),this.l+2*o);s=2*r.length}else if("sbcs"===t){if(typeof he<"u"&&874==Ze)for(o=0;o!=r.length;++o){var f=he.utils.encode(Ze,r.charAt(o));this[this.l+o]=f[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=r.length;++o)this[this.l+o]=255&r.charCodeAt(o);s=r.length}else{if("hex"===t){for(;o<e;++o)this[this.l++]=parseInt(r.slice(2*o,2*o+2),16)||0;return this}if("utf16le"===t){var u=Math.min(this.l+e,this.length);for(o=0;o<Math.min(r.length,e);++o){var p=r.charCodeAt(o);this[this.l++]=255&p,this[this.l++]=p>>8}for(;this.l<u;)this[this.l++]=0;return this}switch(e){case 1:s=1,this[this.l]=255&r;break;case 2:s=2,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8);break;case 3:s=3,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8),this[this.l+2]=255&(r>>>=8);break;case 4:s=4,qh(this,r,this.l);break;case 8:if(s=8,"f"===t){!function Jh(e,r,t){var s=(r<0||1/r==-1/0?1:0)<<7,o=0,f=0,u=s?-r:r;isFinite(u)?0==u?o=f=0:(o=Math.floor(Math.log(u)/Math.LN2),f=u*Math.pow(2,52-o),o<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?o=-1022:(f-=Math.pow(2,52),o+=1023)):(o=2047,f=isNaN(r)?26985:0);for(var p=0;p<=5;++p,f/=256)e[t+p]=255&f;e[t+6]=(15&o)<<4|15&f,e[t+7]=o>>4|s}(this,r,this.l);break}case 16:break;case-4:s=4,r0(this,r,this.l)}}return this.l+=s,this}function n0(e,r){var t=Ql(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Yr(e,r){e.l=r,e.read_shift=Da,e.chk=n0,e.write_shift=eu}function nn(e,r){e.l+=r}function xe(e){var r=$n(e);return Yr(r,0),r}function an(){var e=[],r=xt?256:2048,t=function(_){var y=xe(_);return Yr(y,0),y},s=t(r),o=function(){s&&(s.length>s.l&&((s=s.slice(0,s.l)).l=s.length),s.length>0&&e.push(s),s=null)},f=function(_){return s&&_<s.length-s.l?s:(o(),s=t(Math.max(_+1,r)))};return{next:f,push:function(_){o(),null==(s=_).l&&(s.l=s.length),f(r)},end:function(){return o(),br(e)},_bufs:e}}function Ce(e,r,t,s){var f,o=+r;if(!isNaN(o)){s||(s=El[o].p||(t||[]).length||0),f=1+(o>=128?1:0)+1,s>=128&&++f,s>=16384&&++f,s>=2097152&&++f;var u=e.next(f);o<=127?u.write_shift(1,o):(u.write_shift(1,128+(127&o)),u.write_shift(1,o>>7));for(var p=0;4!=p;++p){if(!(s>=128)){u.write_shift(1,s);break}u.write_shift(1,128+(127&s)),s>>=7}s>0&&_c(t)&&e.push(t)}}function Oa(e,r,t){var s=Qt(e);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function i0(e,r,t){var s=Qt(e);return s.s=Oa(s.s,r.s,t),s.e=Oa(s.e,r.s,t),s}function Ia(e,r){if(e.cRel&&e.c<0)for(e=Qt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Qt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=_t(e);return!e.cRel&&null!=e.cRel&&(t=function ru(e){return e.replace(/^([A-Z])/,"$$$1")}(t)),!e.rRel&&null!=e.rRel&&(t=function tu(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function fo(e,r){return 0!=e.s.r||e.s.rRel||e.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(r.biff>=12?16383:255)||e.e.cRel?Ia(e.s,r.biff)+":"+Ia(e.e,r.biff):(e.s.rRel?"":"$")+wr(e.s.r)+":"+(e.e.rRel?"":"$")+wr(e.e.r):(e.s.cRel?"":"$")+lr(e.s.c)+":"+(e.e.cRel?"":"$")+lr(e.e.c)}function vc(e){return parseInt(function a0(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1}function wr(e){return""+(e+1)}function wc(e){for(var r=function nu(e){return e.replace(/^\$([A-Z])/,"$1")}(e),t=0,s=0;s!==r.length;++s)t=26*t+r.charCodeAt(s)-64;return t-1}function lr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function yr(e){for(var r=0,t=0,s=0;s<e.length;++s){var o=e.charCodeAt(s);o>=48&&o<=57?r=10*r+(o-48):o>=65&&o<=90&&(t=26*t+(o-64))}return{c:t-1,r:r-1}}function _t(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function un(e){var r=e.indexOf(":");return-1==r?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,r)),e:yr(e.slice(r+1))}}function St(e,r){return typeof r>"u"||"number"==typeof r?St(e.s,e.e):("string"!=typeof e&&(e=_t(e)),"string"!=typeof r&&(r=_t(r)),e==r?e:e+":"+r)}function Ht(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,o=0,f=e.length;for(t=0;s<f&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)t=26*t+o;for(r.s.c=--t,t=0;s<f&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)t=10*t+o;if(r.s.r=--t,s===f||10!=o)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,t=0;s!=f&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)t=26*t+o;for(r.e.c=--t,t=0;s!=f&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)t=10*t+o;return r.e.r=--t,r}function Nn(e,r,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?mi[e.v]||e.v:function s0(e,r){var t="d"==e.t&&r instanceof Date;if(null!=e.z)try{return e.w=ne(e.z,t?Gr(r):r)}catch{}try{return e.w=ne((e.XF||{}).numFmtId||(t?14:0),t?Gr(r):r)}catch{return""+r}}(e,null==r?e.v:r))}function Mi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function o0(e,r,t){var s=t||{},o=e?Array.isArray(e):s.dense;null!=Ne&&null==o&&(o=Ne);var f=e||(o?[]:{}),u=0,p=0;if(f&&null!=s.origin){if("number"==typeof s.origin)u=s.origin;else{var x="string"==typeof s.origin?yr(s.origin):s.origin;u=x.r,p=x.c}f["!ref"]||(f["!ref"]="A1:A1")}var _={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var y=Ht(f["!ref"]);_.s.c=y.s.c,_.s.r=y.s.r,_.e.c=Math.max(_.e.c,y.e.c),_.e.r=Math.max(_.e.r,y.e.r),-1==u&&(_.e.r=u=y.e.r+1)}for(var T=0;T!=r.length;++T)if(r[T]){if(!Array.isArray(r[T]))throw new Error("aoa_to_sheet expects an array of arrays");for(var E=0;E!=r[T].length;++E)if(!(typeof r[T][E]>"u")){var C={v:r[T][E]},A=u+T,k=p+E;if(_.s.r>A&&(_.s.r=A),_.s.c>k&&(_.s.c=k),_.e.r<A&&(_.e.r=A),_.e.c<k&&(_.e.c=k),!r[T][E]||"object"!=typeof r[T][E]||Array.isArray(r[T][E])||r[T][E]instanceof Date)if(Array.isArray(C.v)&&(C.f=r[T][E][1],C.v=C.v[0]),null===C.v)if(C.f)C.t="n";else if(s.nullError)C.t="e",C.v=0;else{if(!s.sheetStubs)continue;C.t="z"}else"number"==typeof C.v?C.t="n":"boolean"==typeof C.v?C.t="b":C.v instanceof Date?(C.z=s.dateNF||gt[14],s.cellDates?(C.t="d",C.w=ne(C.z,Gr(C.v))):(C.t="n",C.v=Gr(C.v),C.w=ne(C.z,C.v))):C.t="s";else C=r[T][E];if(o)f[A]||(f[A]=[]),f[A][k]&&f[A][k].z&&(C.z=f[A][k].z),f[A][k]=C;else{var F=_t({c:k,r:A});f[F]&&f[F].z&&(C.z=f[F].z),f[F]=C}}}return _.s.c<1e7&&(f["!ref"]=St(_)),f}function aa(e,r){return o0(null,e,r)}function Bn(e,r){return r||(r=xe(4)),r.write_shift(4,e),r}function Zr(e){var r=e.read_shift(4);return 0===r?"":e.read_shift(r,"dbcs")}function zr(e,r){var t=!1;return null==r&&(t=!0,r=xe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function iu(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ho(e,r){var t=e.l,s=e.read_shift(1),o=Zr(e),f=[],u={t:o,h:o};if(1&s){for(var p=e.read_shift(4),x=0;x!=p;++x)f.push(iu(e));u.r=f}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}var yc=ho;function An(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Un(e,r){return null==r&&(r=xe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function di(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Ri(e,r){return null==r&&(r=xe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var ou=Zr,pi=zr;function bc(e){var r=e.read_shift(4);return 0===r||4294967295===r?"":e.read_shift(r,"dbcs")}function uo(e,r){var t=!1;return null==r&&(t=!0,r=xe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var cu=Zr,kc=bc,Tc=uo;function po(e){var r=e.slice(e.l,e.l+4),t=1&r[0],s=2&r[0];e.l+=4;var o=0===s?lo([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):Kn(r,0)>>2;return t?o/100:o}function Ec(e,r){null==r&&(r=xe(4));var t=0,s=0,o=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?s=1:o==(0|o)&&o>=-(1<<29)&&o<1<<29&&(s=1,t=1),!s)throw new Error("unsupported RkNumber "+e);r.write_shift(-4,((t?o:e)<<2)+(t+2))}function mo(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var sa=mo,Pa=function lu(e,r){return r||(r=xe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r};function Kr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oa(e,r){return(r||xe(8)).write_shift(8,e,"f")}function go(e,r){if(r||(r=xe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;null!=e.index?(r.write_shift(1,2),r.write_shift(1,e.index)):null!=e.theme?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),e.rgb&&null==e.theme){var s=e.rgb||"FFFFFF";"number"==typeof s&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}else r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r}var wo={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Dc={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function d0(e){return e.map(function(r){return[r>>16&255,r>>8&255,255&r]})}var ca=Qt(d0([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),mi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ic={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ds={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p0(e,r){var o,t=function Ll(e){for(var r=[],t=vr(e),s=0;s!==t.length;++s)null==r[e[t[s]]]&&(r[e[t[s]]]=[]),r[e[t[s]]].push(t[s]);return r}(Ic),s=[];s[s.length]=pr,s[s.length]=Le("Types",null,{xmlns:Ar.CT,"xmlns:xsd":Ar.xsd,"xmlns:xsi":Ar.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(x){return Le("Default",null,{Extension:x[0],ContentType:x[1]})}));var f=function(x){e[x]&&e[x].length>0&&(s[s.length]=Le("Override",null,{PartName:("/"==(o=e[x][0])[0]?"":"/")+o,ContentType:ds[x][r.bookType]||ds[x].xlsx}))},u=function(x){(e[x]||[]).forEach(function(_){s[s.length]=Le("Override",null,{PartName:("/"==_[0]?"":"/")+_,ContentType:ds[x][r.bookType]||ds[x].xlsx})})},p=function(x){(e[x]||[]).forEach(function(_){s[s.length]=Le("Override",null,{PartName:("/"==_[0]?"":"/")+_,ContentType:t[x][0]})})};return f("workbooks"),u("sheets"),u("charts"),p("themes"),["strs","styles"].forEach(f),["coreprops","extprops","custprops"].forEach(p),p("vba"),p("comments"),p("threadedcomments"),p("drawings"),u("metadata"),p("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gi(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function la(e){var r=[pr,Le("Relationships",null,{xmlns:Ar.RELS})];return vr(e["!id"]).forEach(function(t){r[r.length]=Le("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function kt(e,r,t,s,o,f){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,o.Id="rId"+r,o.Type=s,o.Target=t,f?o.TargetMode=f:[At.HLINK,At.XPATH,At.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,r}function g0(e,r,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function x0(e,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Pc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+W.version+"</meta:generator></office:meta></office:document-meta>"}var xi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function La(e,r,t,s,o){null!=o[e]||null==r||""===r||(o[e]=r,r=Jt(r),s[s.length]=t?Le(e,r,t):Xr(e,r))}function v0(e,r){var t=r||{},s=[pr,Le("cp:coreProperties",null,{"xmlns:cp":Ar.CORE_PROPS,"xmlns:dc":Ar.dc,"xmlns:dcterms":Ar.dcterms,"xmlns:dcmitype":Ar.dcmitype,"xmlns:xsi":Ar.xsi})],o={};if(!e&&!t.Props)return s.join("");e&&(null!=e.CreatedDate&&La("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:fc(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o),null!=e.ModifiedDate&&La("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:fc(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o));for(var f=0;f!=xi.length;++f){var u=xi[f],p=t.Props&&null!=t.Props[u[1]]?t.Props[u[1]]:e?e[u[1]]:null;!0===p?p="1":!1===p?p="0":"number"==typeof p&&(p=String(p)),null!=p&&La(u[0],p,null,s,o)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var fa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Na=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function y0(e){var r=[],t=Le;return e||(e={}),e.Application="SheetJS",r[r.length]=pr,r[r.length]=Le("Properties",null,{xmlns:Ar.EXT_PROPS,"xmlns:vt":Ar.vt}),fa.forEach(function(s){if(void 0!==e[s[1]]){var o;switch(s[2]){case"string":o=Jt(String(e[s[1]]));break;case"bool":o=e[s[1]]?"true":"false"}void 0!==o&&(r[r.length]=t(s[0],o))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Jt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function ko(e){var r=[pr,Le("Properties",null,{xmlns:Ar.CUST_PROPS,"xmlns:vt":Ar.vt})];if(!e)return r.join("");var t=1;return vr(e).forEach(function(o){++t,r[r.length]=Le("property",function Kh(e,r){switch(typeof e){case"string":var t=Le("vt:lpwstr",Jt(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return Le((0|e)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return Le("vt:bool",e?"true":"false")}if(e instanceof Date)return Le("vt:filetime",fc(e));throw new Error("Unable to serialize "+e)}(e[o],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Jt(o)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Rc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function F0(e,r){var t=xe(4),s=xe(4);switch(t.write_shift(4,80==e?31:e),e){case 3:s.write_shift(-4,r);break;case 5:(s=xe(8)).write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=function Cu(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,s=t%Math.pow(2,32),o=(t-s)/Math.pow(2,32);o*=1e7;var f=(s*=1e7)/Math.pow(2,32)|0;f>0&&(s%=Math.pow(2,32),o+=f);var u=xe(8);return u.write_shift(4,s),u.write_shift(4,o),u}(r);break;case 31:case 80:for((s=xe(4+2*(r.length+1)+(r.length%2?0:2))).write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return br([t,s])}var O0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ha(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ms(e,r,t){var s=xe(8),o=[],f=[],u=8,p=0,x=xe(8),_=xe(8);if(x.write_shift(4,2),x.write_shift(4,1200),_.write_shift(4,1),f.push(x),o.push(_),u+=8+x.length,!r){(_=xe(8)).write_shift(4,0),o.unshift(_);var y=[xe(4)];for(y[0].write_shift(4,e.length),p=0;p<e.length;++p){var T=e[p][0];for((x=xe(8+2*(T.length+1)+(T.length%2?0:2))).write_shift(4,p+2),x.write_shift(4,T.length+1),x.write_shift(0,T,"dbcs");x.l!=x.length;)x.write_shift(1,0);y.push(x)}x=br(y),f.unshift(x),u+=8+x.length}for(p=0;p<e.length;++p)if((!r||r[e[p][0]])&&!(O0.indexOf(e[p][0])>-1||Na.indexOf(e[p][0])>-1)&&null!=e[p][1]){var E=e[p][1],C=0;if(r){var A=t[C=+r[e[p][0]]];if("version"==A.p&&"string"==typeof E){var k=E.split(".");E=(+k[0]<<16)+(+k[1]||0)}x=F0(A.t,E)}else{var F=ha(E);-1==F&&(F=31,E=String(E)),x=F0(F,E)}f.push(x),(_=xe(8)).write_shift(4,r?C:2+p),o.push(_),u+=8+x.length}var N=8*(f.length+1);for(p=0;p<f.length;++p)o[p].write_shift(4,N),N+=f[p].length;return s.write_shift(4,u),s.write_shift(4,f.length),br([s].concat(o).concat(f))}function P0(e,r,t,s,o,f){var u=xe(o?68:48),p=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,lt.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,o?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,o?68:48);var x=ms(e,t,s);if(p.push(x),o){var _=ms(o,null,null);u.write_shift(16,f,"hex"),u.write_shift(4,68+x.length),p.push(_)}return br(p)}function dn(e,r){return r||(r=xe(2)),r.write_shift(2,+!!e),r}function Fr(e){return e.read_shift(2,"u")}function Fn(e,r){return r||(r=xe(2)),r.write_shift(2,e),r}function R0(e,r,t){return t||(t=xe(2)),t.write_shift(1,"e"==r?+e:+!!e),t.write_shift(1,"e"==r?1:0),t}function gs(e,r,t){var s=e.read_shift(t&&t.biff>=12?2:1),o="sbcs-cont",f=qe;t&&t.biff>=8&&(qe=1200),t&&8!=t.biff?12==t.biff&&(o="wstr"):e.read_shift(1)&&(o="dbcs-cont"),t.biff>=2&&t.biff<=5&&(o="cpstr");var p=s?e.read_shift(s,o):"";return qe=f,p}function Du(e){var r=e.t||"",s=xe(3);s.write_shift(2,r.length),s.write_shift(1,1);var o=xe(2*r.length);return o.write_shift(2*r.length,r,"utf16le"),br([s,o])}function N0(e,r,t){return t||(t=xe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function _s(e,r){r||(r=xe(6+2*e.length)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Iu(e){var r=xe(512),t=0,s=e.Target;"file://"==s.slice(0,7)&&(s=s.slice(7));var o=s.indexOf("#"),f=o>-1?31:23;switch(s.charAt(0)){case"#":f=28;break;case".":f&=-3}r.write_shift(4,2),r.write_shift(4,f);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)r.write_shift(4,u[t]);if(28==f)_s(s=s.slice(1),r);else if(2&f){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));var p=o>-1?s.slice(0,o):s;for(r.write_shift(4,2*(p.length+1)),t=0;t<p.length;++t)r.write_shift(2,p.charCodeAt(t));r.write_shift(2,0),8&f&&_s(o>-1?s.slice(o+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));for(var x=0;"../"==s.slice(3*x,3*x+3)||"..\\"==s.slice(3*x,3*x+3);)++x;for(r.write_shift(2,x),r.write_shift(4,s.length-3*x+1),t=0;t<s.length-3*x;++t)r.write_shift(1,255&s.charCodeAt(t+3*x));for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function da(e,r,t,s){return s||(s=xe(6)),s.write_shift(2,e),s.write_shift(2,r),s.write_shift(2,t||0),s}function z0(e,r,t){var s=t.biff>8?4:2;return[e.read_shift(s),e.read_shift(s,"i"),e.read_shift(s,"i")]}function ws(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r},e:{c:e.read_shift(2),r:t}}}function ys(e,r){return r||(r=xe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function zc(e,r,t){var s=1536,o=16;switch(t.bookType){case"biff8":case"xla":break;case"biff5":s=1280,o=8;break;case"biff4":s=4,o=6;break;case"biff3":s=3,o=6;break;case"biff2":s=2,o=4;break;default:throw new Error("unsupported BIFF version")}var f=xe(o);return f.write_shift(2,s),f.write_shift(2,r),o>4&&f.write_shift(2,29282),o>6&&f.write_shift(2,1997),o>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function G0(e,r){var t=!r||r.biff>=8?2:1,s=xe(8+t*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var o=s.slice(0,s.l);return o.l=s.l,o}function jc(e,r,t,s){var o=t&&5==t.biff;s||(s=xe(o?3+r.length:5+2*r.length)),s.write_shift(2,e),s.write_shift(o?1:2,r.length),o||s.write_shift(1,1),s.write_shift((o?1:2)*r.length,r,o?"sbcs":"utf16le");var f=s.length>s.l?s.slice(0,s.l):s;return null==f.l&&(f.l=f.length),f}function Yc(e,r,t,s){var o=t&&5==t.biff;s||(s=xe(o?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,r<<4));var f=0;return e.numFmtId>0&&o&&(f|=1024),s.write_shift(4,f),s.write_shift(4,0),o||s.write_shift(4,0),s.write_shift(2,0),s}function dd(e){var r=xe(24),t=yr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)r.write_shift(1,parseInt(s[o],16));return br([r,Iu(e[1])])}function md(e){var r=e[1].Tooltip,t=xe(10+2*(r.length+1));t.write_shift(2,2048);var s=yr(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var o=0;o<r.length;++o)t.write_shift(2,r.charCodeAt(o));return t.write_shift(2,0),t}var ks=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=is({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(p,x){var _=x||{};_.dateNF||(_.dateNF="yyyymmdd");var y=aa(function t(p,x){var _=[],y=$n(1);switch(x.type){case"base64":y=Ur(Kt(p));break;case"binary":y=Ur(p);break;case"buffer":case"array":y=p}Yr(y,0);var T=y.read_shift(1),E=!!(136&T),C=!1,A=!1;switch(T){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:C=!0,E=!0;break;case 140:A=!0;break;default:throw new Error("DBF Unsupported Version: "+T.toString(16))}var k=0,F=521;2==T&&(k=y.read_shift(2)),y.l+=3,2!=T&&(k=y.read_shift(4)),k>1048576&&(k=1e6),2!=T&&(F=y.read_shift(2));var N=y.read_shift(2),L=x.codepage||1252;2!=T&&(y.l+=16,y.read_shift(1),0!==y[y.l]&&(L=e[y[y.l]]),y.l+=1,y.l+=2),A&&(y.l+=36);for(var M=[],q={},ae=Math.min(y.length,2==T?521:F-10-(C?264:0)),ve=A?32:11;y.l<ae&&13!=y[y.l];)switch(q={},q.name=he.utils.decode(L,y.slice(y.l,y.l+ve)).replace(/[\u0000\r\n].*$/g,""),y.l+=ve,q.type=String.fromCharCode(y.read_shift(1)),2!=T&&!A&&(q.offset=y.read_shift(4)),q.len=y.read_shift(1),2==T&&(q.offset=y.read_shift(2)),q.dec=y.read_shift(1),q.name.length&&M.push(q),2!=T&&(y.l+=A?13:14),q.type){case"B":(!C||8!=q.len)&&x.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":x.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(13!==y[y.l]&&(y.l=F-1),13!==y.read_shift(1))throw new Error("DBF Terminator not found "+y.l+" "+y[y.l]);y.l=F;var G=0,ie=0;for(_[0]=[],ie=0;ie!=M.length;++ie)_[0][ie]=M[ie].name;for(;k-- >0;)if(42!==y[y.l])for(++y.l,_[++G]=[],ie=0,ie=0;ie!=M.length;++ie){var ee=y.slice(y.l,y.l+M[ie].len);y.l+=M[ie].len,Yr(ee,0);var we=he.utils.decode(L,ee);switch(M[ie].type){case"C":we.trim().length&&(_[G][ie]=we.replace(/\s+$/,""));break;case"D":_[G][ie]=8===we.length?new Date(+we.slice(0,4),+we.slice(4,6)-1,+we.slice(6,8)):we;break;case"F":_[G][ie]=parseFloat(we.trim());break;case"+":case"I":_[G][ie]=A?2147483648^ee.read_shift(-4,"i"):ee.read_shift(4,"i");break;case"L":switch(we.trim().toUpperCase()){case"Y":case"T":_[G][ie]=!0;break;case"N":case"F":_[G][ie]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+we+"|")}break;case"M":if(!E)throw new Error("DBF Unexpected MEMO for type "+T.toString(16));_[G][ie]="##MEMO##"+(A?parseInt(we.trim(),10):ee.read_shift(4));break;case"N":(we=we.replace(/\u0000/g,"").trim())&&"."!=we&&(_[G][ie]=+we||0);break;case"@":_[G][ie]=new Date(ee.read_shift(-8,"f")-621356832e5);break;case"T":_[G][ie]=new Date(864e5*(ee.read_shift(4)-2440588)+ee.read_shift(4));break;case"Y":_[G][ie]=ee.read_shift(4,"i")/1e4+ee.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":_[G][ie]=-ee.read_shift(-8,"f");break;case"B":if(C&&8==M[ie].len){_[G][ie]=ee.read_shift(8,"f");break}case"G":case"P":ee.l+=M[ie].len;break;case"0":if("_NullFlags"===M[ie].name)break;default:throw new Error("DBF Unsupported data type "+M[ie].type)}}else y.l+=N;if(2!=T&&y.l<y.length&&26!=y[y.l++])throw new Error("DBF EOF Marker missing "+(y.l-1)+" of "+y.length+" "+y[y.l-1].toString(16));return x&&x.sheetRows&&(_=_.slice(0,x.sheetRows)),x.DBF=M,_}(p,_),_);return y["!cols"]=_.DBF.map(function(T){return{wch:T.len,DBF:T}}),delete _.DBF,y}var f={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function o(p,x){try{return Mi(s(p,x),x)}catch(_){if(x&&x.WTF)throw _}return{SheetNames:[],Sheets:{}}},to_sheet:s,from_sheet:function u(p,x){var _=x||{};if(+_.codepage>=0&&ft(+_.codepage),"string"==_.type)throw new Error("Cannot write DBF to JS string");var y=an(),T=Uh(p,{header:1,raw:!0,cellDates:!0}),E=T[0],C=T.slice(1),A=p["!cols"]||[],k=0,F=0,N=0,L=1;for(k=0;k<E.length;++k)if(((A[k]||{}).DBF||{}).name)E[k]=A[k].DBF.name,++N;else if(null!=E[k]){if(++N,"number"==typeof E[k]&&(E[k]=E[k].toString(10)),"string"!=typeof E[k])throw new Error("DBF Invalid column name "+E[k]+" |"+typeof E[k]+"|");if(E.indexOf(E[k])!==k)for(F=0;F<1024;++F)if(-1==E.indexOf(E[k]+"_"+F)){E[k]+="_"+F;break}}var M=Ht(p["!ref"]),q=[],ae=[],ve=[];for(k=0;k<=M.e.c-M.s.c;++k){var G="",ie="",ee=0,we=[];for(F=0;F<C.length;++F)null!=C[F][k]&&we.push(C[F][k]);if(0!=we.length&&null!=E[k]){for(F=0;F<we.length;++F){switch(typeof we[F]){case"number":ie="B";break;case"string":default:ie="C";break;case"boolean":ie="L";break;case"object":ie=we[F]instanceof Date?"D":"C"}ee=Math.max(ee,String(we[F]).length),G=G&&G!=ie?"C":ie}ee>250&&(ee=250),"C"==(ie=((A[k]||{}).DBF||{}).type)&&A[k].DBF.len>ee&&(ee=A[k].DBF.len),"B"==G&&"N"==ie&&(G="N",ve[k]=A[k].DBF.dec,ee=A[k].DBF.len),ae[k]="C"==G||"N"==ie?ee:f[G]||0,L+=ae[k],q[k]=G}else q[k]="?"}var ye=y.next(32);for(ye.write_shift(4,318902576),ye.write_shift(4,C.length),ye.write_shift(2,296+32*N),ye.write_shift(2,L),k=0;k<4;++k)ye.write_shift(4,0);for(ye.write_shift(4,0|(+r[Ze]||3)<<8),k=0,F=0;k<E.length;++k)if(null!=E[k]){var re=y.next(32),ze=(E[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);re.write_shift(1,ze,"sbcs"),re.write_shift(1,"?"==q[k]?"C":q[k],"sbcs"),re.write_shift(4,F),re.write_shift(1,ae[k]||f[q[k]]||0),re.write_shift(1,ve[k]||0),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(1,0),re.write_shift(4,0),re.write_shift(4,0),F+=ae[k]||f[q[k]]||0}var ct=y.next(264);for(ct.write_shift(4,13),k=0;k<65;++k)ct.write_shift(4,0);for(k=0;k<C.length;++k){var Ge=y.next(L);for(Ge.write_shift(1,0),F=0;F<E.length;++F)if(null!=E[F])switch(q[F]){case"L":Ge.write_shift(1,null==C[k][F]?63:C[k][F]?84:70);break;case"B":Ge.write_shift(8,C[k][F]||0,"f");break;case"N":var vt="0";for("number"==typeof C[k][F]&&(vt=C[k][F].toFixed(ve[F]||0)),N=0;N<ae[F]-vt.length;++N)Ge.write_shift(1,32);Ge.write_shift(1,vt,"sbcs");break;case"D":C[k][F]?(Ge.write_shift(4,("0000"+C[k][F].getFullYear()).slice(-4),"sbcs"),Ge.write_shift(2,("00"+(C[k][F].getMonth()+1)).slice(-2),"sbcs"),Ge.write_shift(2,("00"+C[k][F].getDate()).slice(-2),"sbcs")):Ge.write_shift(8,"00000000","sbcs");break;case"C":var dt=String(null!=C[k][F]?C[k][F]:"").slice(0,ae[F]);for(Ge.write_shift(1,dt,"sbcs"),N=0;N<ae[F]-dt.length;++N)Ge.write_shift(1,32)}}return y.next(1).write_shift(1,26),y.end()}}}(),vf=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1bN("+vr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(E,C){var A=e[C];return"number"==typeof A?Te(A):A},s=function(E,C,A){var k=C.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return 59==k?E:Te(k)};function f(E,C){var ye,A=E.split(/[\n\r]+/),k=-1,F=-1,N=0,L=0,M=[],q=[],ae=null,ve={},G=[],ie=[],ee=[],we=0;for(+C.codepage>=0&&ft(+C.codepage);N!==A.length;++N){we=0;var Ge,re=A[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,t),ze=re.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")});if(re.length>0)switch(ze[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==ze[1].charAt(0)&&q.push(re.slice(3).replace(/;;/g,";"));break;case"C":var vt=!1,dt=!1,Wt=!1,nt=!1,bt=-1,De=-1;for(L=1;L<ze.length;++L)switch(ze[L].charAt(0)){case"A":case"G":break;case"X":F=parseInt(ze[L].slice(1))-1,dt=!0;break;case"Y":for(k=parseInt(ze[L].slice(1))-1,dt||(F=0),ye=M.length;ye<=k;++ye)M[ye]=[];break;case"K":'"'===(Ge=ze[L].slice(1)).charAt(0)?Ge=Ge.slice(1,Ge.length-1):"TRUE"===Ge?Ge=!0:"FALSE"===Ge?Ge=!1:isNaN(yn(Ge))?isNaN(Di(Ge).getDate())||(Ge=or(Ge)):(Ge=yn(Ge),null!==ae&&ce(ae)&&(Ge=ss(Ge))),typeof he<"u"&&"string"==typeof Ge&&"string"!=(C||{}).type&&(C||{}).codepage&&(Ge=he.utils.decode(C.codepage,Ge)),vt=!0;break;case"E":nt=!0;var j=Ga(ze[L].slice(1),{r:k,c:F});M[k][F]=[M[k][F],j];break;case"S":Wt=!0,M[k][F]=[M[k][F],"S5S"];break;case"R":bt=parseInt(ze[L].slice(1))-1;break;case"C":De=parseInt(ze[L].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+re)}if(vt&&(M[k][F]&&2==M[k][F].length?M[k][F][0]=Ge:M[k][F]=Ge,ae=null),Wt){if(nt)throw new Error("SYLK shared formula cannot have own formula");var pe=bt>-1&&M[bt][De];if(!pe||!pe[1])throw new Error("SYLK shared formula cannot find base");M[k][F][1]=eh(pe[1],{r:k-bt,c:F-De})}break;case"F":var Q=0;for(L=1;L<ze.length;++L)switch(ze[L].charAt(0)){case"X":F=parseInt(ze[L].slice(1))-1,++Q;break;case"Y":for(k=parseInt(ze[L].slice(1))-1,ye=M.length;ye<=k;++ye)M[ye]=[];break;case"M":we=parseInt(ze[L].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":ae=q[parseInt(ze[L].slice(1))];break;case"W":for(ee=ze[L].slice(1).split(" "),ye=parseInt(ee[0],10);ye<=parseInt(ee[1],10);++ye)we=parseInt(ee[2],10),ie[ye-1]=0===we?{hidden:!0}:{wch:we},yi(ie[ye-1]);break;case"C":ie[F=parseInt(ze[L].slice(1))-1]||(ie[F]={});break;case"R":G[k=parseInt(ze[L].slice(1))-1]||(G[k]={}),we>0?(G[k].hpt=we,G[k].hpx=Lo(we)):0===we&&(G[k].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+re)}Q<1&&(ae=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+re)}}return G.length>0&&(ve["!rows"]=G),ie.length>0&&(ve["!cols"]=ie),C&&C.sheetRows&&(M=M.slice(0,C.sheetRows)),[M,ve]}function u(E,C){var A=function o(E,C){switch(C.type){case"base64":return f(Kt(E),C);case"binary":return f(E,C);case"buffer":return f(xt&&Buffer.isBuffer(E)?E.toString("binary"):Sr(E),C);case"array":return f(Fi(E),C)}throw new Error("Unrecognized type "+C.type)}(E,C),F=A[1],N=aa(A[0],C);return vr(F).forEach(function(L){N[L]=F[L]}),N}function x(E,C,A,k){var F="C;Y"+(A+1)+";X"+(k+1)+";K";switch(E.t){case"n":F+=E.v||0,E.f&&!E.F&&(F+=";E"+ol(E.f,{r:A,c:k}));break;case"b":F+=E.v?"TRUE":"FALSE";break;case"e":F+=E.w||E.v;break;case"d":F+='"'+(E.w||E.v)+'"';break;case"s":F+='"'+E.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return F}return e["|"]=254,{to_workbook:function p(E,C){return Mi(u(E,C),C)},to_sheet:u,from_sheet:function T(E,C){var N,A=["ID;PWXL;N;E"],k=[],F=Ht(E["!ref"]),L=Array.isArray(E),M="\r\n";A.push("P;PGeneral"),A.push("F;P0;DG0G8;M255"),E["!cols"]&&function _(E,C){C.forEach(function(A,k){var F="F;W"+(k+1)+" "+(k+1)+" ";A.hidden?F+="0":("number"==typeof A.width&&!A.wpx&&(A.wpx=wi(A.width)),"number"==typeof A.wpx&&!A.wch&&(A.wch=Hi(A.wpx)),"number"==typeof A.wch&&(F+=Math.round(A.wch)))," "!=F.charAt(F.length-1)&&E.push(F)})}(A,E["!cols"]),E["!rows"]&&function y(E,C){C.forEach(function(A,k){var F="F;";A.hidden?F+="M0;":A.hpt?F+="M"+20*A.hpt+";":A.hpx&&(F+="M"+20*Va(A.hpx)+";"),F.length>2&&E.push(F+"R"+(k+1))})}(A,E["!rows"]),A.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var q=F.s.r;q<=F.e.r;++q)for(var ae=F.s.c;ae<=F.e.c;++ae){var ve=_t({r:q,c:ae});(N=L?(E[q]||[])[ae]:E[ve])&&(null!=N.v||N.f&&!N.F)&&k.push(x(N,0,q,ae))}return A.join(M)+M+k.join(M)+M+"E"+M}}}(),wf=function(){function r(f,u){for(var p=f.split("\n"),x=-1,_=-1,y=0,T=[];y!==p.length;++y)if("BOT"!==p[y].trim()){if(!(x<0)){for(var E=p[y].trim().split(","),C=E[0],A=E[1],k=p[++y]||"";1&(k.match(/["]/g)||[]).length&&y<p.length-1;)k+="\n"+p[++y];switch(k=k.trim(),+C){case-1:if("BOT"===k){T[++x]=[],_=0;continue}if("EOD"!==k)throw new Error("Unrecognized DIF special command "+k);break;case 0:T[x][_]="TRUE"===k||"FALSE"!==k&&(isNaN(yn(A))?isNaN(Di(A).getDate())?A:or(A):yn(A)),++_;break;case 1:(k=(k=k.slice(1,k.length-1)).replace(/""/g,'"'))&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),T[x][_++]=""!==k?k:null}if("EOD"===k)break}}else T[++x]=[],_=0;return u&&u.sheetRows&&(T=T.slice(0,u.sheetRows)),T}function t(f,u){return aa(function e(f,u){switch(u.type){case"base64":return r(Kt(f),u);case"binary":return r(f,u);case"buffer":return r(xt&&Buffer.isBuffer(f)?f.toString("binary"):Sr(f),u);case"array":return r(Fi(f),u)}throw new Error("Unrecognized type "+u.type)}(f,u),u)}return{to_workbook:function s(f,u){return Mi(t(f,u),u)},to_sheet:t,from_sheet:function(){var f=function(x,_,y,T,E){x.push(_),x.push(y+","+T),x.push('"'+E.replace(/"/g,'""')+'"')},u=function(x,_,y,T){x.push(_+","+y),x.push(1==_?'"'+T.replace(/"/g,'""')+'"':T)};return function(x){var T,_=[],y=Ht(x["!ref"]),E=Array.isArray(x);f(_,"TABLE",0,1,"sheetjs"),f(_,"VECTORS",0,y.e.r-y.s.r+1,""),f(_,"TUPLES",0,y.e.c-y.s.c+1,""),f(_,"DATA",0,0,"");for(var C=y.s.r;C<=y.e.r;++C){u(_,-1,0,"BOT");for(var A=y.s.c;A<=y.e.c;++A){var k=_t({r:C,c:A});if(T=E?(x[C]||[])[A]:x[k])switch(T.t){case"n":var F=T.w;!F&&null!=T.v&&(F=T.v),null==F?u(_,1,0,T.f&&!T.F?"="+T.f:""):u(_,0,F,"V");break;case"b":u(_,0,T.v?1:0,T.v?"TRUE":"FALSE");break;case"s":u(_,1,0,isNaN(T.v)?T.v:'="'+T.v+'"');break;case"d":T.w||(T.w=ne(T.z||gt[14],Gr(or(T.v)))),u(_,0,T.w,"V");break;default:u(_,1,0,"")}else u(_,1,0,"")}}return u(_,-1,0,"EOD"),_.join("\r\n")}}()}}(),Ts=function(){function e(T){return T.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(T){return T.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(T,E){return aa(function t(T,E){for(var C=T.split("\n"),A=-1,k=-1,F=0,N=[];F!==C.length;++F){var L=C[F].trim().split(":");if("cell"===L[0]){var M=yr(L[1]);if(N.length<=M.r)for(A=N.length;A<=M.r;++A)N[A]||(N[A]=[]);switch(A=M.r,k=M.c,L[2]){case"t":N[A][k]=e(L[3]);break;case"v":N[A][k]=+L[3];break;case"vtf":var q=L[L.length-1];case"vtc":N[A][k]="nl"===L[3]?!!+L[4]:+L[4],"vtf"==L[2]&&(N[A][k]=[N[A][k],q])}}}return E&&E.sheetRows&&(N=N.slice(0,E.sheetRows)),N}(T,E),E)}var f=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",p=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),x="--SocialCalcSpreadsheetControlSave--";function _(T){if(!T||!T["!ref"])return"";for(var A,E=[],C=[],k="",F=un(T["!ref"]),N=Array.isArray(T),L=F.s.r;L<=F.e.r;++L)for(var M=F.s.c;M<=F.e.c;++M)if(k=_t({r:L,c:M}),(A=N?(T[L]||[])[M]:T[k])&&null!=A.v&&"z"!==A.t){switch(C=["cell",k,"t"],A.t){case"s":case"str":C.push(r(A.v));break;case"n":A.f?(C[2]="vtf",C[3]="n",C[4]=A.v,C[5]=r(A.f)):(C[2]="v",C[3]=A.v);break;case"b":C[2]="vt"+(A.f?"f":"c"),C[3]="nl",C[4]=A.v?"1":"0",C[5]=r(A.f||(A.v?"TRUE":"FALSE"));break;case"d":var q=Gr(or(A.v));C[2]="vtc",C[3]="nd",C[4]=""+q,C[5]=A.w||ne(A.z||gt[14],q);break;case"e":continue}E.push(C.join(":"))}return E.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),E.push("valueformat:1:text-wiki"),E.join("\n")}return{to_workbook:function o(T,E){return Mi(s(T,E),E)},to_sheet:s,from_sheet:function y(T){return[f,u,p,u,_(T),x].join("\n")}}}(),Wa=function(){function e(y,T,E,C,A){A.raw?T[E][C]=y:""===y||(T[E][C]="TRUE"===y||"FALSE"!==y&&(isNaN(yn(y))?isNaN(Di(y).getDate())?y:or(y):yn(y)))}var t={44:",",9:"\t",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function o(y){for(var T={},E=!1,C=0,A=0;C<y.length;++C)34==(A=y.charCodeAt(C))?E=!E:!E&&A in t&&(T[A]=(T[A]||0)+1);for(C in A=[],T)Object.prototype.hasOwnProperty.call(T,C)&&A.push([T[C],C]);if(!A.length)for(C in T=s)Object.prototype.hasOwnProperty.call(T,C)&&A.push([T[C],C]);return A.sort(function(k,F){return k[0]-F[0]||s[k[1]]-s[F[1]]}),t[A.pop()[1]]||44}function u(y,T){return!T||!T.PRN||T.FS||"sep="==y.slice(0,4)||y.indexOf("\t")>=0||y.indexOf(",")>=0||y.indexOf(";")>=0?function f(y,T){var E=T||{},C="";null!=Ne&&null==E.dense&&(E.dense=Ne);var A=E.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};"sep="==y.slice(0,4)?13==y.charCodeAt(5)&&10==y.charCodeAt(6)?(C=y.charAt(4),y=y.slice(7)):13==y.charCodeAt(5)||10==y.charCodeAt(5)?(C=y.charAt(4),y=y.slice(6)):C=o(y.slice(0,1024)):C=E&&E.FS?E.FS:o(y.slice(0,1024));var F=0,N=0,L=0,M=0,q=0,ae=C.charCodeAt(0),ve=!1,G=0,ie=y.charCodeAt(0);y=y.replace(/\r\n/gm,"\n");var ee=null!=E.dateNF?function fn(e){var r="number"==typeof e?gt[e]:e;return r=r.replace(kr,"(\\d+)"),new RegExp("^"+r+"$")}(E.dateNF):null;function we(){var ye=y.slice(M,q),re={};if('"'==ye.charAt(0)&&'"'==ye.charAt(ye.length-1)&&(ye=ye.slice(1,-1).replace(/""/g,'"')),0===ye.length)re.t="z";else if(E.raw)re.t="s",re.v=ye;else if(0===ye.trim().length)re.t="s",re.v=ye;else if(61==ye.charCodeAt(0))34==ye.charCodeAt(1)&&34==ye.charCodeAt(ye.length-1)?(re.t="s",re.v=ye.slice(2,-1).replace(/""/g,'"')):function rm(e){return 1!=e.length}(ye)?(re.t="n",re.f=ye.slice(1)):(re.t="s",re.v=ye);else if("TRUE"==ye)re.t="b",re.v=!0;else if("FALSE"==ye)re.t="b",re.v=!1;else if(isNaN(L=yn(ye)))if(!isNaN(Di(ye).getDate())||ee&&ye.match(ee)){re.z=E.dateNF||gt[14];var ze=0;ee&&ye.match(ee)&&(ye=function Yn(e,r,t){var s=-1,o=-1,f=-1,u=-1,p=-1,x=-1;(r.match(kr)||[]).forEach(function(T,E){var C=parseInt(t[E+1],10);switch(T.toLowerCase().charAt(0)){case"y":s=C;break;case"d":f=C;break;case"h":u=C;break;case"s":x=C;break;case"m":u>=0?p=C:o=C}}),x>=0&&-1==p&&o>=0&&(p=o,o=-1);var _=(""+(s>=0?s:(new Date).getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(f>=1?f:1)).slice(-2);7==_.length&&(_="0"+_),8==_.length&&(_="20"+_);var y=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2);return-1==u&&-1==p&&-1==x?_:-1==s&&-1==o&&-1==f?y:_+"T"+y}(0,E.dateNF,ye.match(ee)||[]),ze=1),E.cellDates?(re.t="d",re.v=or(ye,ze)):(re.t="n",re.v=Gr(or(ye,ze))),!1!==E.cellText&&(re.w=ne(re.z,re.v instanceof Date?Gr(re.v):re.v)),E.cellNF||delete re.z}else re.t="s",re.v=ye;else re.t="n",!1!==E.cellText&&(re.w=ye),re.v=L;if("z"==re.t||(E.dense?(A[F]||(A[F]=[]),A[F][N]=re):A[_t({c:N,r:F})]=re),ie=y.charCodeAt(M=q+1),k.e.c<N&&(k.e.c=N),k.e.r<F&&(k.e.r=F),G==ae)++N;else if(N=0,++F,E.sheetRows&&E.sheetRows<=F)return!0}e:for(;q<y.length;++q)switch(G=y.charCodeAt(q)){case 34:34===ie&&(ve=!ve);break;case ae:case 10:case 13:if(!ve&&we())break e}return q-M>0&&we(),A["!ref"]=St(k),A}(y,T):aa(function r(y,T){var E=T||{},C=[];if(!y||0===y.length)return C;for(var A=y.split(/[\r\n]/),k=A.length-1;k>=0&&0===A[k].length;)--k;for(var F=10,N=0,L=0;L<=k;++L)-1==(N=A[L].indexOf(" "))?N=A[L].length:N++,F=Math.max(F,N);for(L=0;L<=k;++L){C[L]=[];var M=0;for(e(A[L].slice(0,F).trim(),C,L,M,E),M=1;M<=(A[L].length-F)/10+1;++M)e(A[L].slice(F+10*(M-1),F+10*M).trim(),C,L,M,E)}return E.sheetRows&&(C=C.slice(0,E.sheetRows)),C}(y,T),T)}function p(y,T){var E="",C="string"==T.type?[0,0,0,0]:function D1(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Kt(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}(y,T);switch(T.type){case"base64":E=Kt(y);break;case"binary":case"string":E=y;break;case"buffer":E=65001==T.codepage?y.toString("utf8"):T.codepage&&typeof he<"u"?he.utils.decode(T.codepage,y):xt&&Buffer.isBuffer(y)?y.toString("binary"):Sr(y);break;case"array":E=Fi(y);break;default:throw new Error("Unrecognized type "+T.type)}return 239==C[0]&&187==C[1]&&191==C[2]?E=Yt(E.slice(3)):"string"!=T.type&&"buffer"!=T.type&&65001==T.codepage?E=Yt(E):"binary"==T.type&&typeof he<"u"&&T.codepage&&(E=he.utils.decode(T.codepage,he.utils.encode(28591,E))),"socialcalc:version:"==E.slice(0,19)?Ts.to_sheet("string"==T.type?E:Yt(E),T):u(E,T)}return{to_workbook:function x(y,T){return Mi(p(y,T),T)},to_sheet:p,from_sheet:function _(y){for(var C,T=[],E=Ht(y["!ref"]),A=Array.isArray(y),k=E.s.r;k<=E.e.r;++k){for(var F=[],N=E.s.c;N<=E.e.c;++N){var L=_t({r:k,c:N});if((C=A?(y[k]||[])[N]:y[L])&&null!=C.v){for(var M=(C.w||(Nn(C),C.w)||"").slice(0,10);M.length<10;)M+=" ";F.push(M+(0===N?" ":""))}else F.push("          ")}T.push(F.join(""))}return T.join("\n")}}}(),sn=function(){function e(j,pe,Q){if(j){Yr(j,j.l||0);for(var J=Q.Enum||bt;j.l<j.length;){var ke=j.read_shift(2),Je=J[ke]||J[65535],He=j.read_shift(2),We=j.l+He,Ae=Je.f&&Je.f(j,He,Q);if(j.l=We,pe(Ae,Je,ke))return}}}function t(j,pe){if(!j)return j;var Q=pe||{};null!=Ne&&null==Q.dense&&(Q.dense=Ne);var J=Q.dense?[]:{},ke="Sheet1",Je="",He=0,We={},Ae=[],Lt=[],z={s:{r:0,c:0},e:{r:0,c:0}},ir=Q.sheetRows||0;if(0==j[2]&&(8==j[3]||9==j[3])&&j.length>=16&&5==j[14]&&108===j[15])throw new Error("Unsupported Works 3 for Mac file");if(2==j[2])Q.Enum=bt,e(j,function(tt,Nr,ni){switch(ni){case 0:Q.vers=tt,tt>=4096&&(Q.qpro=!0);break;case 6:z=tt;break;case 204:tt&&(Je=tt);break;case 222:Je=tt;break;case 15:case 51:Q.qpro||(tt[1].v=tt[1].v.slice(1));case 13:case 14:case 16:14==ni&&112==(112&tt[2])&&(15&tt[2])>1&&(15&tt[2])<15&&(tt[1].z=Q.dateNF||gt[14],Q.cellDates&&(tt[1].t="d",tt[1].v=ss(tt[1].v))),Q.qpro&&tt[3]>He&&(J["!ref"]=St(z),We[ke]=J,Ae.push(ke),J=Q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},He=tt[3],ke=Je||"Sheet"+(He+1),Je="");var Gi=Q.dense?(J[tt[0].r]||[])[tt[0].c]:J[_t(tt[0])];if(Gi){Gi.t=tt[1].t,Gi.v=tt[1].v,null!=tt[1].z&&(Gi.z=tt[1].z),null!=tt[1].f&&(Gi.f=tt[1].f);break}Q.dense?(J[tt[0].r]||(J[tt[0].r]=[]),J[tt[0].r][tt[0].c]=tt[1]):J[_t(tt[0])]=tt[1]}},Q);else{if(26!=j[2]&&14!=j[2])throw new Error("Unrecognized LOTUS BOF "+j[2]);Q.Enum=De,14==j[2]&&(Q.qpro=!0,j.l=0),e(j,function(tt,Nr,ni){switch(ni){case 204:ke=tt;break;case 22:tt[1].v=tt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(tt[3]>He&&(J["!ref"]=St(z),We[ke]=J,Ae.push(ke),J=Q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ke="Sheet"+((He=tt[3])+1)),ir>0&&tt[0].r>=ir)break;Q.dense?(J[tt[0].r]||(J[tt[0].r]=[]),J[tt[0].r][tt[0].c]=tt[1]):J[_t(tt[0])]=tt[1],z.e.c<tt[0].c&&(z.e.c=tt[0].c),z.e.r<tt[0].r&&(z.e.r=tt[0].r);break;case 27:tt[14e3]&&(Lt[tt[14e3][0]]=tt[14e3][1]);break;case 1537:Lt[tt[0]]=tt[1],tt[0]==He&&(ke=tt[1])}},Q)}if(J["!ref"]=St(z),We[Je||ke]=J,Ae.push(Je||ke),!Lt.length)return{SheetNames:Ae,Sheets:We};for(var Vt={},ar=[],zt=0;zt<Lt.length;++zt)We[Ae[zt]]?(ar.push(Lt[zt]||Ae[zt]),Vt[Lt[zt]]=We[Lt[zt]]||We[Ae[zt]]):(ar.push(Lt[zt]),Vt[Lt[zt]]={"!ref":"A1"});return{SheetNames:ar,Sheets:Vt}}function _(j,pe,Q){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&20768!=Q.vers?(J[0].c=j.read_shift(1),J[3]=j.read_shift(1),J[0].r=j.read_shift(2),j.l+=2):(J[2]=j.read_shift(1),J[0].c=j.read_shift(2),J[0].r=j.read_shift(2)),J}function y(j,pe,Q){var J=j.l+pe,ke=_(j,0,Q);if(ke[1].t="s",20768==Q.vers){j.l++;var Je=j.read_shift(1);return ke[1].v=j.read_shift(Je,"utf8"),ke}return Q.qpro&&j.l++,ke[1].v=j.read_shift(J-j.l,"cstr"),ke}function T(j,pe,Q){var J=xe(7+Q.length);J.write_shift(1,255),J.write_shift(2,pe),J.write_shift(2,j),J.write_shift(1,39);for(var ke=0;ke<J.length;++ke){var Je=Q.charCodeAt(ke);J.write_shift(1,Je>=128?95:Je)}return J.write_shift(1,0),J}function C(j,pe,Q){var J=xe(7);return J.write_shift(1,255),J.write_shift(2,pe),J.write_shift(2,j),J.write_shift(2,Q,"i"),J}function k(j,pe,Q){var J=xe(13);return J.write_shift(1,255),J.write_shift(2,pe),J.write_shift(2,j),J.write_shift(8,Q,"f"),J}function N(j,pe,Q){var J=32768&pe;return pe=(J?j:0)+((pe&=-32769)>=8192?pe-16384:pe),(J?"":"$")+(Q?lr(pe):wr(pe))}var L={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},M=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ae(j){var pe=[{c:0,r:0},{t:"n",v:0},0];return pe[0].r=j.read_shift(2),pe[3]=j[j.l++],pe[0].c=j[j.l++],pe}function G(j,pe,Q,J){var ke=xe(6+J.length);ke.write_shift(2,j),ke.write_shift(1,Q),ke.write_shift(1,pe),ke.write_shift(1,39);for(var Je=0;Je<J.length;++Je){var He=J.charCodeAt(Je);ke.write_shift(1,He>=128?95:He)}return ke.write_shift(1,0),ke}function ee(j,pe){var Q=ae(j),J=j.read_shift(4),ke=j.read_shift(4),Je=j.read_shift(2);if(65535==Je)return 0===J&&3221225472===ke?(Q[1].t="e",Q[1].v=15):0===J&&3489660928===ke?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var He=32768&Je;return Je=(32767&Je)-16446,Q[1].v=(1-2*He)*(ke*Math.pow(2,Je+32)+J*Math.pow(2,Je)),Q}function we(j,pe,Q,J){var ke=xe(14);if(ke.write_shift(2,j),ke.write_shift(1,Q),ke.write_shift(1,pe),0==J)return ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(2,65535),ke;var Je=0,He=0,Ae=0;return J<0&&(Je=1,J=-J),He=0|Math.log2(J),2147483648&(Ae=(J/=Math.pow(2,He-31))>>>0)||(++He,Ae=(J/=2)>>>0),J-=Ae,Ae|=2147483648,Ae>>>=0,J*=Math.pow(2,32),ke.write_shift(4,J>>>0),ke.write_shift(4,Ae),ke.write_shift(2,He+=16383+(Je?32768:0)),ke}function ze(j,pe){var Q=ae(j),J=j.read_shift(8,"f");return Q[1].v=J,Q}function Ge(j,pe){return 0==j[j.l+pe-1]?j.read_shift(pe,"cstr"):""}function nt(j,pe){var Q=xe(5+j.length);Q.write_shift(2,14e3),Q.write_shift(2,pe);for(var J=0;J<j.length;++J){var ke=j.charCodeAt(J);Q[Q.l++]=ke>127?95:ke}return Q[Q.l++]=0,Q}var bt={0:{n:"BOF",f:Fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function p(j,pe,Q){var J={s:{c:0,r:0},e:{c:0,r:0}};return 8==pe&&Q.qpro?(J.s.c=j.read_shift(1),j.l++,J.s.r=j.read_shift(2),J.e.c=j.read_shift(1),j.l++,J.e.r=j.read_shift(2),J):(J.s.c=j.read_shift(2),J.s.r=j.read_shift(2),12==pe&&Q.qpro&&(j.l+=2),J.e.c=j.read_shift(2),J.e.r=j.read_shift(2),12==pe&&Q.qpro&&(j.l+=2),65535==J.s.c&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function E(j,pe,Q){var J=_(j,0,Q);return J[1].v=j.read_shift(2,"i"),J}},14:{n:"NUMBER",f:function A(j,pe,Q){var J=_(j,0,Q);return J[1].v=j.read_shift(8,"f"),J}},15:{n:"LABEL",f:y},16:{n:"FORMULA",f:function F(j,pe,Q){var J=j.l+pe,ke=_(j,0,Q);if(ke[1].v=j.read_shift(8,"f"),Q.qpro)j.l=J;else{var Je=j.read_shift(2);(function q(j,pe){Yr(j,0);for(var Q=[],J=0,ke="",Je="",He="",We="";j.l<j.length;){var Ae=j[j.l++];switch(Ae){case 0:Q.push(j.read_shift(8,"f"));break;case 1:Je=N(pe[0].c,j.read_shift(2),!0),ke=N(pe[0].r,j.read_shift(2),!1),Q.push(Je+ke);break;case 2:var Lt=N(pe[0].c,j.read_shift(2),!0),z=N(pe[0].r,j.read_shift(2),!1);Je=N(pe[0].c,j.read_shift(2),!0),ke=N(pe[0].r,j.read_shift(2),!1),Q.push(Lt+z+":"+Je+ke);break;case 3:if(j.l<j.length)return void console.error("WK1 premature formula end");break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(j.read_shift(2));break;case 6:for(var ir="";Ae=j[j.l++];)ir+=String.fromCharCode(Ae);Q.push('"'+ir.replace(/"/g,'""')+'"');break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:We=Q.pop(),He=Q.pop(),Q.push(["AND","OR"][Ae-20]+"("+He+","+We+")");break;default:if(Ae<32&&M[Ae])We=Q.pop(),He=Q.pop(),Q.push(He+M[Ae]+We);else{if(!L[Ae])return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16));if(69==(J=L[Ae][1])&&(J=j[j.l++]),J>Q.length)return void console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+Q.join("|")+"|");var Vt=Q.slice(-J);Q.length-=J,Q.push(L[Ae][0]+"("+Vt.join(",")+")")}}}1==Q.length?pe[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")})(j.slice(j.l,j.l+Je),ke),j.l+=Je}return ke}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ge},222:{n:"SHEETNAMELP",f:function vt(j,pe){var Q=j[j.l++];Q>pe-1&&(Q=pe-1);for(var J="";J.length<Q;)J+=String.fromCharCode(j[j.l++]);return J}},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function ve(j,pe){var Q=ae(j);return Q[1].t="s",Q[1].v=j.read_shift(pe-4,"cstr"),Q}},23:{n:"NUMBER17",f:ee},24:{n:"NUMBER18",f:function ie(j,pe){var Q=ae(j);Q[1].v=j.read_shift(2);var J=Q[1].v>>1;if(1&Q[1].v)switch(7&J){case 0:J=5e3*(J>>3);break;case 1:J=500*(J>>3);break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64}return Q[1].v=J,Q}},25:{n:"FORMULA19",f:function ye(j,pe){var Q=ee(j);return j.l+=pe-14,Q}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Wt(j,pe){for(var Q={},J=j.l+pe;j.l<J;){var ke=j.read_shift(2);if(14e3==ke){for(Q[ke]=[0,""],Q[ke][0]=j.read_shift(2);j[j.l];)Q[ke][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return Q}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function re(j,pe){var Q=ae(j),J=j.read_shift(4);return Q[1].v=J>>6,Q}},38:{n:"??"},39:{n:"NUMBER27",f:ze},40:{n:"FORMULA28",f:function ct(j,pe){var Q=ze(j);return j.l+=pe-10,Q}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function dt(j,pe,Q){if(Q.qpro&&!(pe<21)){var J=j.read_shift(1);return j.l+=17,j.l+=1,j.l+=2,[J,j.read_shift(pe-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function s(j,pe){var Q=pe||{};if(+Q.codepage>=0&&ft(+Q.codepage),"string"==Q.type)throw new Error("Cannot write WK1 to JS string");var J=an(),ke=Ht(j["!ref"]),Je=Array.isArray(j),He=[];Ve(J,0,function f(j){var pe=xe(2);return pe.write_shift(2,j),pe}(1030)),Ve(J,6,function x(j){var pe=xe(8);return pe.write_shift(2,j.s.c),pe.write_shift(2,j.s.r),pe.write_shift(2,j.e.c),pe.write_shift(2,j.e.r),pe}(ke));for(var We=Math.min(ke.e.r,8191),Ae=ke.s.r;Ae<=We;++Ae)for(var Lt=wr(Ae),z=ke.s.c;z<=ke.e.c;++z){Ae===ke.s.r&&(He[z]=lr(z));var Vt=Je?(j[Ae]||[])[z]:j[He[z]+Lt];Vt&&"z"!=Vt.t&&("n"==Vt.t?(0|Vt.v)==Vt.v&&Vt.v>=-32768&&Vt.v<=32767?Ve(J,13,C(Ae,z,Vt.v)):Ve(J,14,k(Ae,z,Vt.v)):Ve(J,15,T(Ae,z,Nn(Vt).slice(0,239))))}return Ve(J,1),J.end()},book_to_wk3:function o(j,pe){var Q=pe||{};if(+Q.codepage>=0&&ft(+Q.codepage),"string"==Q.type)throw new Error("Cannot write WK3 to JS string");var J=an();Ve(J,0,function u(j){var pe=xe(26);pe.write_shift(2,4096),pe.write_shift(2,4),pe.write_shift(4,0);for(var Q=0,J=0,ke=0,Je=0;Je<j.SheetNames.length;++Je){var We=j.Sheets[j.SheetNames[Je]];if(We&&We["!ref"]){++ke;var Ae=un(We["!ref"]);Q<Ae.e.r&&(Q=Ae.e.r),J<Ae.e.c&&(J=Ae.e.c)}}return Q>8191&&(Q=8191),pe.write_shift(2,Q),pe.write_shift(1,ke),pe.write_shift(1,J),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(1,1),pe.write_shift(1,2),pe.write_shift(4,0),pe.write_shift(4,0),pe}(j));for(var ke=0,Je=0;ke<j.SheetNames.length;++ke)(j.Sheets[j.SheetNames[ke]]||{})["!ref"]&&Ve(J,27,nt(j.SheetNames[ke],Je++));var He=0;for(ke=0;ke<j.SheetNames.length;++ke){var We=j.Sheets[j.SheetNames[ke]];if(We&&We["!ref"]){for(var Ae=Ht(We["!ref"]),Lt=Array.isArray(We),z=[],ir=Math.min(Ae.e.r,8191),Vt=Ae.s.r;Vt<=ir;++Vt)for(var ar=wr(Vt),zt=Ae.s.c;zt<=Ae.e.c;++zt){Vt===Ae.s.r&&(z[zt]=lr(zt));var Nr=Lt?(We[Vt]||[])[zt]:We[z[zt]+ar];Nr&&"z"!=Nr.t&&("n"==Nr.t?Ve(J,23,we(Vt,zt,He,Nr.v)):Ve(J,22,G(Vt,zt,He,Nn(Nr).slice(0,239))))}++He}}return Ve(J,1),J.end()},to_workbook:function r(j,pe){switch(pe.type){case"base64":return t(Ur(Kt(j)),pe);case"binary":return t(Ur(j),pe);case"buffer":case"array":return t(j,pe)}throw"Unsupported type "+pe.type}}}(),kf=/^\s|\s$|[\t\n\r]/;function Tf(e,r){if(!r.bookSST)return"";var t=[pr];t[t.length]=Le("sst",null,{xmlns:Ii[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(null!=e[s]){var o=e[s],f="<si>";o.r?f+=o.r:(f+="<t",o.t||(o.t=""),o.t.match(kf)&&(f+=' xml:space="preserve"'),f+=">"+Jt(o.t)+"</t>"),t[t.length]=f+="</si>"}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}var Sf=function l0(e,r){var t=!1;return null==r&&(t=!0,r=xe(15+4*e.t.length)),r.write_shift(1,0),zr(e.t,r),t?r.slice(0,r.l):r};function Ld(e){var r=an();Ce(r,159,function mn(e,r){return r||(r=xe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}(e));for(var t=0;t<e.length;++t)Ce(r,19,Sf(e[t]));return Ce(r,160),r.end()}function As(e){var t,f,r=0,s=function Af(e){if(typeof he<"u")return he.utils.encode(Ze,e);for(var r=[],t=e.split(""),s=0;s<t.length;++s)r[s]=t[s].charCodeAt(0);return r}(e),o=s.length+1;for((t=$n(o))[0]=s.length,f=1;f!=o;++f)t[f]=s[f-1];for(f=o-1;f>=0;--f)r=((16384&r?1:0)|r<<1&32767)^t[f];return 52811^r}var Mf=function(){function e(o,f){switch(f.type){case"base64":return r(Kt(o),f);case"binary":return r(o,f);case"buffer":return r(xt&&Buffer.isBuffer(o)?o.toString("binary"):Sr(o),f);case"array":return r(Fi(o),f)}throw new Error("Unrecognized type "+f.type)}function r(o,f){var p=(f||{}).dense?[]:{},x=o.match(/\\trowd.*?\\row\b/g);if(!x.length)throw new Error("RTF missing table");var _={s:{c:0,r:0},e:{c:0,r:x.length-1}};return x.forEach(function(y,T){Array.isArray(p)&&(p[T]=[]);for(var A,E=/\\\w+\b/g,C=0,k=-1;A=E.exec(y);){if("\\cell"===A[0]){var F=y.slice(C,E.lastIndex-A[0].length);if(" "==F[0]&&(F=F.slice(1)),++k,F.length){var N={v:F,t:"s"};Array.isArray(p)?p[T][k]=N:p[_t({r:T,c:k})]=N}}C=E.lastIndex}k>_.e.c&&(_.e.c=k)}),p["!ref"]=St(_),p}return{to_workbook:function t(o,f){return Mi(e(o,f),f)},to_sheet:e,from_sheet:function s(o){for(var p,f=["{\\rtf1\\ansi"],u=Ht(o["!ref"]),x=Array.isArray(o),_=u.s.r;_<=u.e.r;++_){f.push("\\trowd\\trautofit1");for(var y=u.s.c;y<=u.e.c;++y)f.push("\\cellx"+(y+1));for(f.push("\\pard\\intbl"),y=u.s.c;y<=u.e.c;++y){var T=_t({r:_,c:y});(p=x?(o[_]||[])[y]:o[T])&&(null!=p.v||p.f&&!p.F)&&(f.push(" "+(p.w||(Nn(p),p.w))),f.push("\\cell"))}f.push("\\pard\\intbl\\row")}return f.join("")+"}"}}}();function Fs(e){for(var r=0,t=1;3!=r;++r)t=256*t+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var on=6;function wi(e){return Math.floor((e+Math.round(128/on)/256)*on)}function Hi(e){return Math.floor((e-5)/on*100+.5)/100}function Jr(e){return Math.round((e*on+5)/on*256)/256}function yi(e){e.width?(e.wpx=wi(e.width),e.wch=Hi(e.wpx),e.MDW=on):e.wpx?(e.wch=Hi(e.wpx),e.width=Jr(e.wch),e.MDW=on):"number"==typeof e.wch&&(e.width=Jr(e.wch),e.wpx=wi(e.width),e.MDW=on),e.customWidth&&delete e.customWidth}var Nf=96;function Va(e){return 96*e/Nf}function Lo(e){return e*Nf/96}function Ds(e,r){var s,t=[pr,Le("styleSheet",null,{xmlns:Ii[0],"xmlns:vt":Ar.vt})];return e.SSF&&null!=(s=function Qd(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)null!=e[s]&&(r[r.length]=Le("numFmt",null,{numFmtId:s,formatCode:Jt(e[s])}))}),1===r.length?"":(r[r.length]="</numFmts>",r[0]=Le("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(e.SSF))&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=function qd(e){var r=[];return r[r.length]=Le("cellXfs",null),e.forEach(function(t){r[r.length]=Le("xf",null,t)}),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=Le("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(r.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Uo(e,r,t){t||(t=xe(6+4*r.length)),t.write_shift(2,e),zr(r,t);var s=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),s}var tl,ip=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ap=nn;function Wf(e,r){r||(r=xe(84)),tl||(tl=is(ip));var t=tl[e.patternType];null==t&&(t=40),r.write_shift(4,t);var s=0;if(40!=t)for(go({auto:1},r),go({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Vf(e,r,t){return t||(t=xe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Os(e,r){return r||(r=xe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var op=nn;function $a(e,r){var t=an();return Ce(t,278),function fp(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&++t}),0!=t&&(Ce(e,615,Bn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&Ce(e,44,Uo(o,r[o]))}),Ce(e,616))}}(t,e.SSF),function hp(e){Ce(e,611,Bn(1)),Ce(e,43,function np(e,r){r||(r=xe(153)),r.write_shift(2,20*e.sz),function hu(e,r){r||(r=xe(2)),r.write_shift(1,(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0)),r.write_shift(1,0)}(e,r),r.write_shift(2,e.bold?700:400);var t=0;"superscript"==e.vertAlign?t=1:"subscript"==e.vertAlign&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),go(e.color,r);var s=0;return"major"==e.scheme&&(s=1),"minor"==e.scheme&&(s=2),r.write_shift(1,s),zr(e.name,r),r.length>r.l?r.slice(0,r.l):r}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ce(e,612)}(t),function up(e){Ce(e,603,Bn(2)),Ce(e,45,Wf({patternType:"none"})),Ce(e,45,Wf({patternType:"gray125"})),Ce(e,604)}(t),function dp(e){Ce(e,613,Bn(1)),Ce(e,46,function za(e,r){return r||(r=xe(51)),r.write_shift(1,0),Os(0,r),Os(0,r),Os(0,r),Os(0,r),Os(0,r),r.length>r.l?r.slice(0,r.l):r}()),Ce(e,614)}(t),function pp(e){Ce(e,626,Bn(1)),Ce(e,47,Vf({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ce(e,627)}(t),function mp(e,r){Ce(e,617,Bn(r.length)),r.forEach(function(t){Ce(e,47,Vf(t,0))}),Ce(e,618)}(t,r.cellXfs),function gp(e){Ce(e,619,Bn(1)),Ce(e,48,function Ho(e,r){return r||(r=xe(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),uo(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}({xfId:0,builtinId:0,name:"Normal"})),Ce(e,620)}(t),function zf(e){Ce(e,505,Bn(0)),Ce(e,506)}(t),function xp(e){Ce(e,508,function cp(e,r,t){var s=xe(2052);return s.write_shift(4,e),uo(r,s),uo(t,s),s.length>s.l?s.slice(0,s.l):s}(0,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}(t),Ce(t,279),t.end()}function rl(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var t=[pr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Xf(){var e=an();return Ce(e,332),Ce(e,334,Bn(1)),Ce(e,335,function Dp(e){var r=xe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),zr(e.name,r),r.slice(0,r.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,function Pp(e,r){var t=xe(8+2*r.length);return t.write_shift(4,e),zr(r,t),t.slice(0,t.l)}(1,"XLDAPR")),Ce(e,52),Ce(e,35,Bn(514)),Ce(e,4096,Bn(0)),Ce(e,4097,Fn(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,function Mp(e,r){var t=xe(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}(1,!0)),Ce(e,51,function Ip(e){var r=xe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function Yf(){var e=[pr];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var ja=1024;function Zf(e,r){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),o=[Le("xml",null,{"xmlns:v":hn.v,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:mv":hn.mv}).replace(/\/>/,">"),Le("o:shapelayout",Le("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Le("v:shapetype",[Le("v:stroke",null,{joinstyle:"miter"}),Le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];ja<1e3*e;)ja+=1e3;return r.forEach(function(f){var u=yr(f[0]),p={color2:"#BEFF82",type:"gradient"};"gradient"==p.type&&(p.angle="-180");var x="gradient"==p.type?Le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,_=Le("v:fill",x,p);++ja,o=o.concat(["<v:shape"+ea({id:"_x0000_s"+ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(f[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",_,Le("v:shadow",null,{on:"t",obscured:"t"}),Le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),Xr("x:AutoFill","False"),Xr("x:Row",String(u.r)),Xr("x:Column",String(u.c)),f[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function Jf(e){var r=[pr,Le("comments",null,{xmlns:Ii[0]})],t=[];return r.push("<authors>"),e.forEach(function(s){s[1].forEach(function(o){var f=Jt(o.a);-1==t.indexOf(f)&&(t.push(f),r.push("<author>"+f+"</author>")),o.T&&o.ID&&-1==t.indexOf("tc="+o.ID)&&(t.push("tc="+o.ID),r.push("<author>tc="+o.ID+"</author>"))})}),0==t.length&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(s){var o=0,f=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?o=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(x){x.a&&(o=t.indexOf(Jt(x.a))),f.push(x.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+o+'"><text>'),f.length<=1)r.push(Xr("t",Jt(f[0]||"")));else{for(var u="Comment:\n    "+f[0]+"\n",p=1;p<f.length;++p)u+="Reply:\n    "+f[p]+"\n";r.push(Xr("t",Jt(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function zp(e,r,t){var s=[pr,Le("ThreadedComments",null,{xmlns:Ar.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var f="";(o[1]||[]).forEach(function(u,p){if(u.T){u.a&&-1==r.indexOf(u.a)&&r.push(u.a);var x={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};0==p?f=x.id:x.parentId=f,u.ID=x.id,u.a&&(x.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),s.push(Le("threadedComment",Xr("text",u.t||""),x))}else delete u.ID})}),s.push("</ThreadedComments>"),s.join("")}var Xp=Zr;function Ps(e){var r=an(),t=[];return Ce(r,628),Ce(r,630),e.forEach(function(s){s[1].forEach(function(o){t.indexOf(o.a)>-1||(t.push(o.a.slice(0,54)),Ce(r,632,function Qf(e){return zr(e.slice(0,54))}(o.a)))})}),Ce(r,631),Ce(r,633),e.forEach(function(s){s[1].forEach(function(o){o.iauthor=t.indexOf(o.a);var f={s:yr(s[0]),e:yr(s[0])};Ce(r,635,function al(e,r){return null==r&&(r=xe(36)),r.write_shift(4,e[1].iauthor),Pa(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}([f,o])),o.t&&o.t.length>0&&Ce(r,637,function su(e,r){var t=!1;return null==r&&(t=!0,r=xe(23+4*e.t.length)),r.write_shift(1,1),zr(e.t,r),r.write_shift(4,1),function au(e,r){r||(r=xe(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}(o)),Ce(r,636),delete o.iauthor})}),Ce(r,634),Ce(r,629),r.end()}var qf=["xlsb","xlsm","xlam","biff8","xla"],Ga=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(s,o,f,u){var p=!1,x=!1;0==f.length?x=!0:"["==f.charAt(0)&&(x=!0,f=f.slice(1,-1)),0==u.length?p=!0:"["==u.charAt(0)&&(p=!0,u=u.slice(1,-1));var _=f.length>0?0|parseInt(f,10):0,y=u.length>0?0|parseInt(u,10):0;return p?y+=r.c:--y,x?_+=r.r:--_,o+(p?"":"$")+lr(y)+(x?"":"$")+wr(_)}return function(o,f){return r=f,o.replace(e,t)}}(),sl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ol=function(){return function(r,t){return r.replace(sl,function(s,o,f,u,p,x){var _=wc(u)-(f?0:t.c),y=vc(x)-(p?0:t.r);return o+"R"+(0==y?"":p?y+1:"["+y+"]")+"C"+(0==_?"":f?_+1:"["+_+"]")})}}();function eh(e,r){return e.replace(sl,function(t,s,o,f,u,p){return s+("$"==o?o+f:lr(wc(f)+r.c))+("$"==u?u+p:wr(vc(p)+r.r))})}function Dr(e){e.l+=1}function Tn(e,r){var t=e.read_shift(1==r?1:2);return[16383&t,t>>14&1,t>>15&1]}function cl(e,r,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return th(e);12==t.biff&&(s=4)}var o=e.read_shift(s),f=e.read_shift(s),u=Tn(e,2),p=Tn(e,2);return{s:{r:o,c:u[0],cRel:u[1],rRel:u[2]},e:{r:f,c:p[0],cRel:p[1],rRel:p[2]}}}function th(e){var r=Tn(e,2),t=Tn(e,2),s=e.read_shift(1),o=e.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:t[0],c:o,cRel:t[1],rRel:t[2]}}}function rh(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return function im(e){var r=Tn(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}(e);var s=e.read_shift(t&&12==t.biff?4:2),o=Tn(e,2);return{r:s,c:o[0],cRel:o[1],rRel:o[2]}}function am(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function nh(e){var r=1&e[e.l+1];return e.l+=4,[r,1]}function ga(e){return[e.read_shift(1),e.read_shift(1)]}function oh(e,r){var t=[e.read_shift(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=function Tr(e,r){return 1===e.read_shift(r)}(e,1)?"TRUE":"FALSE",12!=r&&(e.l+=7);break;case 37:case 16:t[1]=mi[e[e.l]],e.l+=12==r?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Kr(e);break;case 2:t[1]=function ua(e,r,t){if(t.biff>5)return function Ua(e,r,t){var s=e.read_shift(t&&2==t.biff?1:2);return 0===s?(e.l++,""):function _i(e,r,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var o=e.read_shift(1);return e.read_shift(r,0===o?"sbcs-cont":"dbcs-cont")}(e,s,t)}(e,0,t);var s=e.read_shift(1);return 0===s?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Em(e,r,t){for(var s=e.read_shift(12==t.biff?4:2),o=[],f=0;f!=s;++f)o.push((12==t.biff?sa:ws)(e,8));return o}function Cm(e,r,t){var s=0,o=0;12==t.biff?(s=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,0==--o&&(o=256));for(var f=0,u=[];f!=s&&(u[f]=[]);++f)for(var p=0;p!=o;++p)u[f][p]=oh(e,t.biff);return u}function Ms(e,r,t){return e.l+=2,[am(e)]}function hl(e){return e.l+=6,[]}function hh(e){return e.l+=2,[Fr(e),1&e.read_shift(2)]}var Hm=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],mh={1:{n:"PtgExp",f:function bm(e,r,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:nn},3:{n:"PtgAdd",f:Dr},4:{n:"PtgSub",f:Dr},5:{n:"PtgMul",f:Dr},6:{n:"PtgDiv",f:Dr},7:{n:"PtgPower",f:Dr},8:{n:"PtgConcat",f:Dr},9:{n:"PtgLt",f:Dr},10:{n:"PtgLe",f:Dr},11:{n:"PtgEq",f:Dr},12:{n:"PtgGe",f:Dr},13:{n:"PtgGt",f:Dr},14:{n:"PtgNe",f:Dr},15:{n:"PtgIsect",f:Dr},16:{n:"PtgUnion",f:Dr},17:{n:"PtgRange",f:Dr},18:{n:"PtgUplus",f:Dr},19:{n:"PtgUminus",f:Dr},20:{n:"PtgPercent",f:Dr},21:{n:"PtgParen",f:Dr},22:{n:"PtgMissArg",f:Dr},23:{n:"PtgStr",f:function sh(e,r,t){return e.l++,gs(e,0,t)}},26:{n:"PtgSheet",f:function ph(e,r,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function Vm(e,r,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function km(e){return e.l++,mi[e.read_shift(1)]}},29:{n:"PtgBool",f:function ah(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function ih(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function Tm(e){return e.l++,Kr(e)}},32:{n:"PtgArray",f:function um(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[s]}},33:{n:"PtgFunc",f:function wm(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(t&&t.biff<=3?1:2);return[rg[o],bh[o],s]}},34:{n:"PtgFuncVar",f:function fl(e,r,t){var s=e[e.l++],o=e.read_shift(1),f=t&&t.biff<=3?[88==s?-1:0,e.read_shift(1)]:function ym(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[o,(0===f[0]?bh:tg)[f[1]]]}},35:{n:"PtgName",f:function Sm(e,r,t){var s=e.read_shift(1)>>>5&3,f=e.read_shift(!t||t.biff>=8?4:2);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[s,0,f]}},36:{n:"PtgRef",f:function $o(e,r,t){var s=(96&e[e.l])>>5;return e.l+=1,[s,rh(e,0,t)]}},37:{n:"PtgArea",f:function om(e,r,t){return[(96&e[e.l++])>>5,cl(e,0,t)]}},38:{n:"PtgMemArea",f:function Fm(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[s,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:nn},40:{n:"PtgMemNoMem",f:nn},41:{n:"PtgMemFunc",f:function Dm(e,r,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function Om(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[s]}},43:{n:"PtgAreaErr",f:function lm(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}},44:{n:"PtgRefN",f:function vm(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=function zo(e,r,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return function sm(e){var r=e.read_shift(2),t=e.read_shift(1),s=(32768&r)>>15,o=(16384&r)>>14;return r&=16383,1==s&&r>=8192&&(r-=16384),1==o&&t>=128&&(t-=256),{r,c:t,cRel:o,rRel:s}}(e);var o=e.read_shift(s>=12?4:2),f=e.read_shift(2),u=(16384&f)>>14,p=(32768&f)>>15;if(f&=16383,1==p)for(;o>524287;)o-=1048576;if(1==u)for(;f>8191;)f-=16384;return{r:o,c:f,cRel:u,rRel:p}}(e,0,t);return[s,o]}},45:{n:"PtgAreaN",f:function hm(e,r,t){var s=(96&e[e.l++])>>5,o=function nm(e,r,t){if(t.biff<8)return th(e);var s=e.read_shift(12==t.biff?4:2),o=e.read_shift(12==t.biff?4:2),f=Tn(e,2),u=Tn(e,2);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}(e,0,t);return[s,o]}},46:{n:"PtgMemAreaN",f:function zm(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function $m(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function ch(e,r,t){return 5==t.biff?function Am(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[r,t,s]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function ll(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var o=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[s,o,rh(e,0,t)]}},59:{n:"PtgArea3d",f:function cm(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2,"i");if(t&&5===t.biff)e.l+=12;return[s,o,cl(e,0,t)]}},60:{n:"PtgRefErr3d",f:function Im(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2),f=4;if(t)switch(t.biff){case 5:f=15;break;case 12:f=6}return e.l+=f,[s,o]}},61:{n:"PtgAreaErr3d",f:function fm(e,r,t){var s=(96&e[e.l++])>>5,o=e.read_shift(2),f=8;if(t)switch(t.biff){case 5:e.l+=12,f=6;break;case 12:f=12}return e.l+=f,[s,o]}},255:{}},dl={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jm={1:{n:"PtgElfLel",f:hh},2:{n:"PtgElfRw",f:Ms},3:{n:"PtgElfCol",f:Ms},6:{n:"PtgElfRwV",f:Ms},7:{n:"PtgElfColV",f:Ms},10:{n:"PtgElfRadical",f:Ms},11:{n:"PtgElfRadicalS",f:hl},13:{n:"PtgElfColS",f:hl},15:{n:"PtgElfColSV",f:hl},16:{n:"PtgElfRadicalLel",f:hh},25:{n:"PtgList",f:function Wm(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),o=e.read_shift(2),f=e.read_shift(2);return{ixti:r,coltype:3&t,rt:Hm[t>>2&31],idx:s,c:o,C:f}}},29:{n:"PtgSxName",f:function dh(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Gm={0:{n:"PtgAttrNoop",f:function ul(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function gm(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[s]}},2:{n:"PtgAttrIf",f:function pm(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function Xa(e,r,t){e.l+=2;for(var s=e.read_shift(t&&2==t.biff?1:2),o=[],f=0;f<=s;++f)o.push(e.read_shift(t&&2==t.biff?1:2));return o}},8:{n:"PtgAttrGoto",f:function dm(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function X1(e,r,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:nh},33:{n:"PtgAttrBaxcel",f:nh},64:{n:"PtgAttrSpace",f:function xm(e){return e.read_shift(2),ga(e)}},65:{n:"PtgAttrSpaceSemi",f:function _m(e){return e.read_shift(2),ga(e)}},128:{n:"PtgAttrIfError",f:function mm(e){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(2)]}},255:{}};function Ya(e,r,t,s){if(s.biff<8)return nn(e,r);for(var o=e.l+r,f=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=Cm(e,0,s),f.push(t[u][1]);break;case"PtgMemArea":t[u][2]=Em(e,0,s),f.push(t[u][2]);break;case"PtgExp":s&&12==s.biff&&(t[u][1][1]=e.read_shift(4),f.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return 0!=(r=o-e.l)&&f.push(nn(e,r)),f}function pl(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t],o=[],f=0;f<s.length;++f){var u=s[f];o.push(u?2===u[0]?'"'+u[1].replace(/"/g,'""')+'"':u[1]:"")}r.push(o.join(","))}return r.join(";")}var Xm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gh(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":e.XTI[r-1];if(!s)return"SH33TJSERR1";var o="";if(t.biff>8)switch(e[s[0]][0]){case 357:return o=-1==s[1]?"#REF":e.SheetNames[s[1]],s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return o=-1==s[1]?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(f){return f.Name}).join(";;");default:return e[s[0]][0][3]?(o=-1==s[1]?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?o:o+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function xh(e,r,t){var s=gh(e,r,t);return"#REF"==s?s:function Ym(e,r){if(!(e||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(s,t)}function Qr(e,r,t,s,o){var x,_,y,C,f=o&&o.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},p=[],T=0,E=0,A="";if(!e[0]||!e[0][0])return"";for(var k=-1,F="",N=0,L=e[0].length;N<L;++N){var M=e[0][N];switch(M[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(x=p.pop(),_=p.pop(),k>=0){switch(e[0][k][1][0]){case 0:F=cr(" ",e[0][k][1][1]);break;case 1:F=cr("\r",e[0][k][1][1]);break;default:if(F="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}_+=F,k=-1}p.push(_+Xm[M[0]]+x);break;case"PtgIsect":x=p.pop(),_=p.pop(),p.push(_+" "+x);break;case"PtgUnion":x=p.pop(),_=p.pop(),p.push(_+","+x);break;case"PtgRange":x=p.pop(),_=p.pop(),p.push(_+":"+x);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":y=Oa(M[1][1],u,o),p.push(Ia(y,f));break;case"PtgRefN":y=t?Oa(M[1][1],t,o):M[1][1],p.push(Ia(y,f));break;case"PtgRef3d":T=M[1][1],y=Oa(M[1][2],u,o),A=xh(s,T,o),p.push(A+"!"+Ia(y,f));break;case"PtgFunc":case"PtgFuncVar":var ae=M[1][0],ve=M[1][1];ae||(ae=0);var G=0==(ae&=127)?[]:p.slice(-ae);p.length-=ae,"User"===ve&&(ve=G.shift()),p.push(ve+"("+G.join(",")+")");break;case"PtgBool":p.push(M[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":p.push(M[1]);break;case"PtgNum":p.push(String(M[1]));break;case"PtgStr":p.push('"'+M[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":C=i0(M[1][1],t?{s:t}:u,o),p.push(fo(C,o));break;case"PtgArea":C=i0(M[1][1],u,o),p.push(fo(C,o));break;case"PtgArea3d":C=M[1][2],A=xh(s,T=M[1][1],o),p.push(A+"!"+fo(C,o));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgName":var ie=(s.names||[])[(E=M[1][2])-1]||(s[0]||[])[E],ee=ie?ie.Name:"SH33TJSNAME"+String(E);ee&&"_xlfn."==ee.slice(0,6)&&!o.xlfn&&(ee=ee.slice(6)),p.push(ee);break;case"PtgNameX":var ye,we=M[1][1];if(E=M[1][2],!(o.biff<=5)){var re="";if(14849==((s[we]||[])[0]||[])[0]||(1025==((s[we]||[])[0]||[])[0]?s[we][E]&&s[we][E].itab>0&&(re=s.SheetNames[s[we][E].itab-1]+"!"):re=s.SheetNames[E-1]+"!"),s[we]&&s[we][E])re+=s[we][E].Name;else if(s[0]&&s[0][E])re+=s[0][E].Name;else{var ze=(gh(s,we,o)||"").split(";;");ze[E-1]?re=ze[E-1]:re+="SH33TJSERRX"}p.push(re);break}we<0&&(we=-we),s[we]&&(ye=s[we][E]),ye||(ye={Name:"SH33TJSERRY"}),p.push(ye.Name);break;case"PtgParen":var ct="(",Ge=")";if(k>=0){switch(F="",e[0][k][1][0]){case 2:ct=cr(" ",e[0][k][1][1])+ct;break;case 3:ct=cr("\r",e[0][k][1][1])+ct;break;case 4:Ge=cr(" ",e[0][k][1][1])+Ge;break;case 5:Ge=cr("\r",e[0][k][1][1])+Ge;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}k=-1}p.push(ct+p.pop()+Ge);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":p.push("#REF!");break;case"PtgExp":var vt={c:t.c,r:t.r};if(s.sharedf[_t(y={c:M[1][1],r:M[1][0]})]){var dt=s.sharedf[_t(y)];p.push(Qr(dt,0,vt,s,o))}else{var Wt=!1;for(x=0;x!=s.arrayf.length;++x)if(!(y.c<(_=s.arrayf[x])[0].s.c||y.c>_[0].e.c||y.r<_[0].s.r||y.r>_[0].e.r)){p.push(Qr(_[1],0,vt,s,o)),Wt=!0;break}Wt||p.push(M[1])}break;case"PtgArray":p.push("{"+pl(M[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=N;break;case"PtgMissArg":p.push("");break;case"PtgList":p.push("Table"+M[1].idx+"[#"+M[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(M))}if(3!=o.biff&&k>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][N][0])){var bt=!0;switch((M=e[0][k])[1][0]){case 4:bt=!1;case 0:F=cr(" ",M[1][1]);break;case 5:bt=!1;case 1:F=cr("\r",M[1][1]);break;default:if(F="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+M[1][0])}p.push((bt?F:"")+p.pop()+(bt?"":F)),k=-1}}if(p.length>1&&o.WTF)throw new Error("bad formula stack");return p[0]}function jo(e,r,t){var s=e.read_shift(4),o=function Ls(e,r,t){for(var o,f,s=e.l+r,u=[];s!=e.l;)r=s-e.l,o=mh[f=e[e.l]]||mh[dl[f]],(24===f||25===f)&&(o=(24===f?jm:Gm)[e[e.l+1]]),o&&o.f?u.push([o.n,o.f(e,r,t)]):nn(e,r);return u}(e,s,t),f=e.read_shift(4);return[o,f>0?Ya(e,f,o,t):null]}var yh=jo,Go=jo,qm=jo,eg=jo,tg={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},bh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},rg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ng(e){return("of:="+e.replace(sl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function ig(e){return e.replace(/\./,"!")}var Ns=typeof Map<"u";function xl(e,r,t){var s=0,o=e.length;if(t){if(Ns?t.has(r):Object.prototype.hasOwnProperty.call(t,r))for(var f=Ns?t.get(r):t[r];s<f.length;++s)if(e[f[s]].t===r)return e.Count++,f[s]}else for(;s<o;++s)if(e[s].t===r)return e.Count++,s;return e[o]={t:r},e.Count++,e.Unique++,t&&(Ns?(t.has(r)||t.set(r,[]),t.get(r).push(o)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(o))),o}function Yo(e,r){var t={min:e+1,max:e+1},s=-1;return r.MDW&&(on=r.MDW),null!=r.width?t.customWidth=1:null!=r.wpx?s=Hi(r.wpx):null!=r.wch&&(s=r.wch),s>-1?(t.width=Jr(s),t.customWidth=1):null!=r.width&&(t.width=r.width),r.hidden&&(t.hidden=!0),null!=r.level&&(t.outlineLevel=t.level=r.level),t}function xa(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function Wi(e,r,t){var s=t.revssf[null!=r.z?r.z:"General"],o=60,f=e.length;if(null==s&&t.ssf)for(;o<392;++o)if(null==t.ssf[o]){Fe(r.z,o),t.ssf[o]=r.z,t.revssf[r.z]=s=o;break}for(o=0;o!=f;++o)if(e[o].numFmtId===s)return o;return e[f]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function sg(e,r,t){if(e&&e["!ref"]){var s=Ht(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}var _g=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vl=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Cg(e,r,t,s){if(e.c&&t["!comments"].push([r,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var o="",f=e.t,u=e.v;if("z"!==e.t)switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=mi[e.v];break;case"d":s&&s.cellDates?o=or(e.v,-1).toISOString():((e=Qt(e)).t="n",o=""+(e.v=Gr(or(e.v)))),typeof e.z>"u"&&(e.z=gt[14]);break;default:o=e.v}var p=Xr("v",Jt(o)),x={r},_=Wi(s.cellXfs,e,s);switch(0!==_&&(x.s=_),e.t){case"n":case"z":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){p=Xr("v",""+xl(s.Strings,e.v,s.revStrings)),x.t="s";break}x.t="str"}if(e.t!=f&&(e.t=f,e.v=u),"string"==typeof e.f&&e.f){var y=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;p=Le("f",Jt(e.f),y)+(null!=e.v?p:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(x.cm=1),Le("c",p,x)}function Fh(e,r,t,s){var u,o=[pr,Le("worksheet",null,{xmlns:Ii[0],"xmlns:r":Ar.r})],p="",x=t.Sheets[t.SheetNames[e]];null==x&&(x={});var _=x["!ref"]||"A1",y=Ht(_);if(y.e.c>16383||y.e.r>1048575){if(r.WTF)throw new Error("Range "+_+" exceeds format limit A1:XFD1048576");y.e.c=Math.min(y.e.c,16383),y.e.r=Math.min(y.e.c,1048575),_=St(y)}s||(s={}),x["!comments"]=[];var T=[];(function Bs(e,r,t,s,o){var f=!1,u={},p=null;if("xlsx"!==s.bookType&&r.vbaraw){var x=r.SheetNames[t];try{r.Workbook&&(x=r.Workbook.Sheets[t].CodeName||x)}catch{}f=!0,u.codeName=fr(Jt(x))}if(e&&e["!outline"]){var _={summaryBelow:1,summaryRight:1};e["!outline"].above&&(_.summaryBelow=0),e["!outline"].left&&(_.summaryRight=0),p=(p||"")+Le("outlinePr",null,_)}!f&&!p||(o[o.length]=Le("sheetPr",p,u))})(x,t,e,r,o),o[o.length]=Le("dimension",null,{ref:_}),o[o.length]=function Eg(e,r,t,s){var o={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Le("sheetViews",Le("sheetView",null,o),{})}(0,0,0,t),r.sheetFormat&&(o[o.length]=Le("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=x["!cols"]&&x["!cols"].length>0&&(o[o.length]=function yg(e,r){for(var s,t=["<cols>"],o=0;o!=r.length;++o)(s=r[o])&&(t[t.length]=Le("col",null,Yo(o,s)));return t[t.length]="</cols>",t.join("")}(0,x["!cols"])),o[u=o.length]="<sheetData/>",x["!links"]=[],null!=x["!ref"]&&(p=function Ag(e,r,t,s){var x,F,o=[],f=[],u=Ht(e["!ref"]),p="",_="",y=[],T=0,E=0,C=e["!rows"],A=Array.isArray(e),k={r:_},N=-1;for(E=u.s.c;E<=u.e.c;++E)y[E]=lr(E);for(T=u.s.r;T<=u.e.r;++T){for(f=[],_=wr(T),E=u.s.c;E<=u.e.c;++E){x=y[E]+_;var L=A?(e[T]||[])[E]:e[x];void 0!==L&&null!=(p=Cg(L,x,e,r))&&f.push(p)}(f.length>0||C&&C[T])&&(k={r:_},C&&C[T]&&((F=C[T]).hidden&&(k.hidden=1),N=-1,F.hpx?N=Va(F.hpx):F.hpt&&(N=F.hpt),N>-1&&(k.ht=N,k.customHeight=1),F.level&&(k.outlineLevel=F.level)),o[o.length]=Le("row",f.join(""),k))}if(C)for(;T<C.length;++T)C&&C[T]&&(k={r:T+1},(F=C[T]).hidden&&(k.hidden=1),N=-1,F.hpx?N=Va(F.hpx):F.hpt&&(N=F.hpt),N>-1&&(k.ht=N,k.customHeight=1),F.level&&(k.outlineLevel=F.level),o[o.length]=Le("row","",k));return o.join("")}(x,r),p.length>0&&(o[o.length]=p)),o.length>u+1&&(o[o.length]="</sheetData>",o[u]=o[u].replace("/>",">")),x["!protect"]&&(o[o.length]=function vg(e){var r={sheet:1};return _g.forEach(function(t){null!=e[t]&&e[t]&&(r[t]="1")}),vl.forEach(function(t){null!=e[t]&&!e[t]&&(r[t]="0")}),e.password&&(r.password=As(e.password).toString(16).toUpperCase()),Le("sheetProtection",null,r)}(x["!protect"])),null!=x["!autofilter"]&&(o[o.length]=function bg(e,r,t,s){var o="string"==typeof e.ref?e.ref:St(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,u=un(o);u.s.r==u.e.r&&(u.e.r=un(r["!ref"]).e.r,o=St(u));for(var p=0;p<f.length;++p){var x=f[p];if("_xlnm._FilterDatabase"==x.Name&&x.Sheet==s){x.Ref="'"+t.SheetNames[s]+"'!"+o;break}}return p==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+o}),Le("autoFilter",null,{ref:o})}(x["!autofilter"],x,t,e)),null!=x["!merges"]&&x["!merges"].length>0&&(o[o.length]=function xg(e){if(0===e.length)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+St(e[t])+'"/>';return r+"</mergeCells>"}(x["!merges"]));var C,E=-1,A=-1;return x["!links"].length>0&&(o[o.length]="<hyperlinks>",x["!links"].forEach(function(k){k[1].Target&&(C={ref:k[0]},"#"!=k[1].Target.charAt(0)&&(A=kt(s,-1,Jt(k[1].Target).replace(/#.*$/,""),At.HLINK),C["r:id"]="rId"+A),(E=k[1].Target.indexOf("#"))>-1&&(C.location=Jt(k[1].Target.slice(E+1))),k[1].Tooltip&&(C.tooltip=Jt(k[1].Tooltip)),o[o.length]=Le("hyperlink",null,C))}),o[o.length]="</hyperlinks>"),delete x["!links"],null!=x["!margins"]&&(o[o.length]=function wg(e){return xa(e),Le("pageMargins",null,e)}(x["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&(o[o.length]=Xr("ignoredErrors",Le("ignoredError",null,{numberStoredAsText:1,sqref:_}))),T.length>0&&(A=kt(s,-1,"../drawings/drawing"+(e+1)+".xml",At.DRAW),o[o.length]=Le("drawing",null,{"r:id":"rId"+A}),x["!drawing"]=T),x["!comments"].length>0&&(A=kt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",At.VML),o[o.length]=Le("legacyDrawing",null,{"r:id":"rId"+A}),x["!legacy"]=A),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function Og(e,r,t,s){var o=function Dg(e,r,t){var s=xe(145),o=(t["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var f=320;o.hpx?f=20*Va(o.hpx):o.hpt&&(f=20*o.hpt),s.write_shift(2,f),s.write_shift(1,0);var u=0;o.level&&(u|=o.level),o.hidden&&(u|=16),(o.hpx||o.hpt)&&(u|=32),s.write_shift(1,u),s.write_shift(1,0);var p=0,x=s.l;s.l+=4;for(var _={r:e,c:0},y=0;y<16;++y)if(!(r.s.c>y+1<<10||r.e.c<y<<10)){for(var T=-1,E=-1,C=y<<10;C<y+1<<10;++C)_.c=C,(Array.isArray(t)?(t[_.r]||[])[_.c]:t[_t(_)])&&(T<0&&(T=C),E=C);T<0||(++p,s.write_shift(4,T),s.write_shift(4,E))}var k=s.l;return s.l=x,s.write_shift(4,p),s.l=k,s.length>s.l?s.slice(0,s.l):s}(s,t,r);(o.length>17||(r["!rows"]||[])[s])&&Ce(e,0,o)}var Dh=sa,Ig=Pa;var f1=sa,h1=Pa,Rh=["left","right","top","bottom","header","footer"];function n(e,r,t,s,o,f,u){if(void 0===r.v)return!1;var p="";switch(r.t){case"b":p=r.v?"1":"0";break;case"d":(r=Qt(r)).z=r.z||gt[14],r.v=Gr(or(r.v)),r.t="n";break;case"n":case"e":p=""+r.v;break;default:p=r.v}var x={r:t,c:s};switch(x.s=Wi(o.cellXfs,r,o),r.l&&f["!links"].push([_t(x),r.l]),r.c&&f["!comments"].push([_t(x),r.c]),r.t){case"s":case"str":return o.bookSST?(p=xl(o.Strings,r.v,o.revStrings),x.t="s",x.v=p,u?Ce(e,18,function Ph(e,r,t){return null==t&&(t=xe(8)),Ri(r,t),t.write_shift(4,r.v),t}(0,x)):Ce(e,7,function Xg(e,r,t){return null==t&&(t=xe(12)),Un(r,t),t.write_shift(4,r.v),t}(0,x))):(x.t="str",u?Ce(e,17,function s1(e,r,t){return null==t&&(t=xe(8+4*e.v.length)),Ri(r,t),zr(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,x)):Ce(e,6,function i1(e,r,t){return null==t&&(t=xe(12+4*e.v.length)),Un(r,t),zr(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,x))),!0;case"n":return r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?u?Ce(e,13,function t1(e,r,t){return null==t&&(t=xe(8)),Ri(r,t),Ec(e.v,t),t}(r,x)):Ce(e,2,function qg(e,r,t){return null==t&&(t=xe(12)),Un(r,t),Ec(e.v,t),t}(r,x)):u?Ce(e,16,function Jg(e,r,t){return null==t&&(t=xe(12)),Ri(r,t),oa(e.v,t),t}(r,x)):Ce(e,5,function Kg(e,r,t){return null==t&&(t=xe(16)),Un(r,t),oa(e.v,t),t}(r,x)),!0;case"b":return x.t="b",u?Ce(e,15,function Oh(e,r,t){return null==t&&(t=xe(5)),Ri(r,t),t.write_shift(1,e.v?1:0),t}(r,x)):Ce(e,4,function Wg(e,r,t){return null==t&&(t=xe(9)),Un(r,t),t.write_shift(1,e.v?1:0),t}(r,x)),!0;case"e":return x.t="e",u?Ce(e,14,function Gg(e,r,t){return null==t&&(t=xe(8)),Ri(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}(r,x)):Ce(e,3,function $g(e,r,t){return null==t&&(t=xe(9)),Un(r,t),t.write_shift(1,e.v),t}(r,x)),!0}return u?Ce(e,12,function Ug(e,r,t){return null==t&&(t=xe(4)),Ri(r,t)}(0,x)):Ce(e,1,function Ng(e,r,t){return null==t&&(t=xe(8)),Un(r,t)}(0,x)),!0}function I(e,r,t,s){var o=an(),f=t.SheetNames[e],u=t.Sheets[f]||{},p=f;try{t&&t.Workbook&&(p=t.Workbook.Sheets[e].CodeName||p)}catch{}var x=Ht(u["!ref"]||"A1");if(x.e.c>16383||x.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Ce(o,129),(t.vbaraw||u["!outline"])&&Ce(o,147,function Rg(e,r,t){null==t&&(t=xe(84+4*e.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),t.write_shift(1,s);for(var o=1;o<3;++o)t.write_shift(1,0);return go({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),pi(e,t),t.slice(0,t.l)}(p,u["!outline"])),Ce(o,148,Ig(x)),function b(e,r,t){Ce(e,133),Ce(e,137,function _1(e,r,t){null==t&&(t=xe(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}(0,t)),Ce(e,138),Ce(e,134)}(o,0,t.Workbook),function h(e,r){!r||!r["!cols"]||(Ce(e,390),r["!cols"].forEach(function(t,s){t&&Ce(e,60,function g1(e,r,t){null==t&&(t=xe(18));var s=Yo(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,256*(s.width||10)),t.write_shift(4,0);var o=0;return r.hidden&&(o|=1),"number"==typeof s.width&&(o|=2),r.level&&(o|=r.level<<8),t.write_shift(2,o),t}(s,t))}),Ce(e,391))}(o,u),function c(e,r,t,s){var o=Ht(r["!ref"]||"A1"),u="",p=[];Ce(e,145);var x=Array.isArray(r),_=o.e.r;r["!rows"]&&(_=Math.max(o.e.r,r["!rows"].length-1));for(var y=o.s.r;y<=_;++y){u=wr(y),Og(e,r,o,y);var T=!1;if(y<=o.e.r)for(var E=o.s.c;E<=o.e.c;++E){y===o.s.r&&(p[E]=lr(E));var C=x?(r[y]||[])[E]:r[p[E]+u];T=!!C&&n(e,C,y,E,s,r,T)}}Ce(e,146)}(o,u,0,r),function O(e,r){r["!protect"]&&Ce(e,535,function Lh(e,r){return null==r&&(r=xe(66)),r.write_shift(2,e.password?As(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){r.write_shift(4,t[1]?null==e[t[0]]||e[t[0]]?0:1:null!=e[t[0]]&&e[t[0]]?0:1)}),r}(r["!protect"]))}(o,u),function w(e,r,t,s){if(r["!autofilter"]){var o=r["!autofilter"],f="string"==typeof o.ref?o.ref:St(o.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,p=un(f);p.s.r==p.e.r&&(p.e.r=un(r["!ref"]).e.r,f=St(p));for(var x=0;x<u.length;++x){var _=u[x];if("_xlnm._FilterDatabase"==_.Name&&_.Sheet==s){_.Ref="'"+t.SheetNames[s]+"'!"+f;break}}x==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+f}),Ce(e,161,Pa(Ht(f))),Ce(e,162)}}(o,u,t,e),function l(e,r){!r||!r["!merges"]||(Ce(e,177,function u1(e,r){return null==r&&(r=xe(4)),r.write_shift(4,e),r}(r["!merges"].length)),r["!merges"].forEach(function(t){Ce(e,176,h1(t))}),Ce(e,178))}(o,u),function m(e,r,t){r["!links"].forEach(function(s){if(s[1].Target){var o=kt(t,-1,s[1].Target.replace(/#.*$/,""),At.HLINK);Ce(e,494,function K1(e,r){var t=xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Pa({s:yr(e[0]),e:yr(e[0])},t),Tc("rId"+r,t);var s=e[1].Target.indexOf("#");return zr((-1==s?"":e[1].Target.slice(s+1))||"",t),zr(e[1].Tooltip||"",t),zr("",t),t.slice(0,t.l)}(s,o))}}),delete r["!links"]}(o,u,s),u["!margins"]&&Ce(o,476,function Vi(e,r){return null==r&&(r=xe(48)),xa(e),Rh.forEach(function(t){oa(e[t],r)}),r}(u["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&function d(e,r){!r||!r["!ref"]||(Ce(e,648),Ce(e,649,function zi(e){var r=xe(24);return r.write_shift(4,4),r.write_shift(4,1),Pa(e,r),r}(Ht(r["!ref"]))),Ce(e,650))}(o,u),function g(e,r,t,s){if(r["!comments"].length>0){var o=kt(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML);Ce(e,551,Tc("rId"+o)),r["!legacy"]=o}}(o,u,e,s),Ce(o,130),o.end()}var Ee=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qr="][*?/\\".split("");function gn(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return qr.forEach(function(s){if(-1!=e.indexOf(s)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function en(e){var r=[pr];r[r.length]=Le("workbook",null,{xmlns:Ii[0],"xmlns:r":Ar.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ee.forEach(function(p){null!=e.Workbook.WBProps[p[0]]&&e.Workbook.WBProps[p[0]]!=p[1]&&(s[p[0]]=e.Workbook.WBProps[p[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=Le("workbookPr",null,s);var o=e.Workbook&&e.Workbook.Sheets||[],f=0;if(o&&o[0]&&o[0].Hidden){for(r[r.length]="<bookViews>",f=0;f!=e.SheetNames.length&&o[f]&&o[f].Hidden;++f);f==e.SheetNames.length&&(f=0),r[r.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",f=0;f!=e.SheetNames.length;++f){var u={name:Jt(e.SheetNames[f].slice(0,31))};if(u.sheetId=""+(f+1),u["r:id"]="rId"+(f+1),o[f])switch(o[f].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden"}r[r.length]=Le("sheet",null,u)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(p){var x={name:p.Name};p.Comment&&(x.comment=p.Comment),null!=p.Sheet&&(x.localSheetId=""+p.Sheet),p.Hidden&&(x.hidden="1"),p.Ref&&(r[r.length]=Le("definedName",Jt(p.Ref),x))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Zo(e,r){return r||(r=xe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),Tc(e.strRelID,r),zr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Ux(e,r){var t=an();return Ce(t,131),Ce(t,128,function Lx(e,r){r||(r=xe(127));for(var t=0;4!=t;++t)r.write_shift(4,0);return zr("SheetJS",r),zr(W.version,r),zr(W.version,r),zr("7262",r),r.length>r.l?r.slice(0,r.l):r}()),Ce(t,153,function Us(e,r){r||(r=xe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),pi(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}(e.Workbook&&e.Workbook.WBProps||null)),function Bx(e,r){if(r.Workbook&&r.Workbook.Sheets){for(var t=r.Workbook.Sheets,s=0,o=-1,f=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&-1==o?o=s:1==t[s].Hidden&&-1==f&&(f=s);f>o||(Ce(e,135),Ce(e,158,function Nx(e,r){return r||(r=xe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r}(o)),Ce(e,136))}}(t,e),function Rx(e,r){Ce(e,143);for(var t=0;t!=r.SheetNames.length;++t)Ce(e,156,Zo({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]}));Ce(e,144)}(t,e),Ce(t,132),t.end()}function qx(e,r,t,s,o){return(".bin"===r.slice(-4)?I:Fh)(e,t,s,o)}function r_(e,r,t){return(".bin"===r.slice(-4)?Ps:Jf)(e,t)}function q1(e){return Le("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ol(e.Ref,{r:0,c:0})})}function __(e,r,t,s,o,f,u){if(!e||null==e.v&&null==e.f)return"";var p={};if(e.f&&(p["ss:Formula"]="="+Jt(ol(e.f,u))),e.F&&e.F.slice(0,r.length)==r){var x=yr(e.F.slice(r.length+1));p["ss:ArrayRange"]="RC:R"+(x.r==u.r?"":"["+(x.r-u.r)+"]")+"C"+(x.c==u.c?"":"["+(x.c-u.c)+"]")}if(e.l&&e.l.Target&&(p["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(p["x:HRefScreenTip"]=Jt(e.l.Tooltip))),t["!merges"])for(var _=t["!merges"],y=0;y!=_.length;++y)_[y].s.c!=u.c||_[y].s.r!=u.r||(_[y].e.c>_[y].s.c&&(p["ss:MergeAcross"]=_[y].e.c-_[y].s.c),_[y].e.r>_[y].s.r&&(p["ss:MergeDown"]=_[y].e.r-_[y].s.r));var T="",E="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":T="Number",E=String(e.v);break;case"b":T="Boolean",E=e.v?"1":"0";break;case"e":T="Error",E=mi[e.v];break;case"d":T="DateTime",E=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||gt[14]);break;case"s":T="String",E=function Qi(e){return(e+"").replace(Ta,function(t){return Ln[t]}).replace(Xl,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var C=Wi(s.cellXfs,e,s);p["ss:StyleID"]="s"+(21+C),p["ss:Index"]=u.c+1;var k="z"==e.t?"":'<Data ss:Type="'+T+'">'+(null!=e.v?E:"")+"</Data>";return(e.c||[]).length>0&&(k+=function x_(e){return e.map(function(r){var t=function Yh(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}(r.t||""),s=Le("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Le("Comment",s,{"ss:Author":r.a})}).join("")}(e.c)),Le("Cell",k,p)}function v_(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Lo(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function y_(e,r,t){var s=[],f=t.Sheets[t.SheetNames[e]],u=f?function m_(e,r,t,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var o=s.Workbook.Names,f=[],u=0;u<o.length;++u){var p=o[u];p.Sheet==t&&(p.Name.match(/^_xlfn\./)||f.push(q1(p)))}return f.join("")}(f,0,e,t):"";return u.length>0&&s.push("<Names>"+u+"</Names>"),u=f?function w_(e,r,t,s){if(!e["!ref"])return"";var o=Ht(e["!ref"]),f=e["!merges"]||[],u=0,p=[];e["!cols"]&&e["!cols"].forEach(function(F,N){yi(F);var L=!!F.width,M=Yo(N,F),q={"ss:Index":N+1};L&&(q["ss:Width"]=wi(M.width)),F.hidden&&(q["ss:Hidden"]="1"),p.push(Le("Column",null,q))});for(var x=Array.isArray(e),_=o.s.r;_<=o.e.r;++_){for(var y=[v_(_,(e["!rows"]||[])[_])],T=o.s.c;T<=o.e.c;++T){var E=!1;for(u=0;u!=f.length;++u)if(!(f[u].s.c>T||f[u].s.r>_||f[u].e.c<T||f[u].e.r<_)){(f[u].s.c!=T||f[u].s.r!=_)&&(E=!0);break}if(!E){var C={r:_,c:T},A=_t(C);y.push(__(x?(e[_]||[])[T]:e[A],A,e,r,0,0,C))}}y.push("</Row>"),y.length>2&&p.push(y.join(""))}return p.join("")}(f,r):"",u.length>0&&s.push("<Table>"+u+"</Table>"),s.push(function g_(e,r,t,s){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(Le("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(Le("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(Le("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)o.push(Le("Visible",1==s.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<t&&(!s.Workbook.Sheets[f]||s.Workbook.Sheets[f].Hidden);++f);f==t&&o.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(Xr("ProtectContents","True")),e["!protect"].objects&&o.push(Xr("ProtectObjects","True")),e["!protect"].scenarios&&o.push(Xr("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null!=e["!protect"].selectUnlockedCells&&!e["!protect"].selectUnlockedCells&&o.push(Xr("EnableSelection","UnlockedCells")):o.push(Xr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&o.push("<"+u[1]+"/>")})),0==o.length?"":Le("WorksheetOptions",o.join(""),{xmlns:hn.x})}(f,0,e,t)),s.join("")}function b_(e,r){r||(r={}),e.SSF||(e.SSF=Qt(gt)),e.SSF&&(Qe(),Be(e.SSF),r.revssf=no(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Wi(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(function h_(e,r){var t=[];return e.Props&&t.push(function Hn(e,r){var t=[];return vr(Rc).map(function(s){for(var o=0;o<xi.length;++o)if(xi[o][1]==s)return xi[o];for(o=0;o<fa.length;++o)if(fa[o][1]==s)return fa[o];throw s}).forEach(function(s){if(null!=e[s[1]]){var o=r&&r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e[s[1]];"date"===s[2]&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof o?o=String(o):!0===o||!1===o?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),t.push(Xr(Rc[s[1]]||s[1],o))}}),Le("DocumentProperties",t.join(""),{xmlns:hn.o})}(e.Props,r)),e.Custprops&&t.push(function Eu(e,r){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",o=[];return e&&vr(e).forEach(function(f){if(Object.prototype.hasOwnProperty.call(e,f)){for(var u=0;u<xi.length;++u)if(f==xi[u][1])return;for(u=0;u<fa.length;++u)if(f==fa[u][1])return;for(u=0;u<t.length;++u)if(f==t[u])return;var p=e[f],x="string";"number"==typeof p?(x="float",p=String(p)):!0===p||!1===p?(x="boolean",p=p?"1":"0"):p=String(p),o.push(Le(Gl(f),p,{"dt:dt":x}))}}),r&&vr(r).forEach(function(f){if(Object.prototype.hasOwnProperty.call(r,f)&&(!e||!Object.prototype.hasOwnProperty.call(e,f))){var u=r[f],p="string";"number"==typeof u?(p="float",u=String(u)):!0===u||!1===u?(p="boolean",u=u?"1":"0"):u instanceof Date?(p="dateTime.tz",u=u.toISOString()):u=String(u),o.push(Le(Gl(f),u,{"dt:dt":p}))}}),"<"+s+' xmlns="'+hn.o+'">'+o.join("")+"</"+s+">"}(e.Props,e.Custprops)),t.join("")}(e,r)),t.push(""),t.push(""),t.push("");for(var s=0;s<e.SheetNames.length;++s)t.push(Le("Worksheet",y_(s,r,e),{"ss:Name":Jt(e.SheetNames[s])}));return t[2]=function d_(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,o){var f=[];f.push(Le("NumberFormat",null,{"ss:Format":Jt(gt[s.numFmtId])}));var u={"ss:ID":"s"+(21+o)};t.push(Le("Style",f.join(""),u))}),Le("Styles",t.join(""))}(0,r),t[3]=function p_(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],s=0;s<r.length;++s){var o=r[s];null==o.Sheet&&(o.Name.match(/^_xlfn\./)||t.push(q1(o)))}return Le("Names",t.join(""))}(e),pr+Le("Workbook",t.join(""),{xmlns:hn.ss,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:ss":hn.ss,"xmlns:dt":hn.dt,"xmlns:html":hn.html})}var Tl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};var El={0:{f:function Fg(e,r){var t={},s=e.l+r;t.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var f=e.read_shift(1);return e.l=s,7&f&&(t.level=7&f),16&f&&(t.hidden=!0),32&f&&(t.hpt=o/20),t}},1:{f:function Lg(e){return[An(e)]}},2:{f:function Qg(e){return[An(e),po(e),"n"]}},3:{f:function zg(e){return[An(e),e.read_shift(1),"e"]}},4:{f:function Hg(e){return[An(e),e.read_shift(1),"b"]}},5:{f:function Zg(e){return[An(e),Kr(e),"n"]}},6:{f:function n1(e){return[An(e),Zr(e),"str"]}},7:{f:function Ih(e){return[An(e),e.read_shift(4),"s"]}},8:{f:function l1(e,r,t){var s=e.l+r,o=An(e);o.r=t["!row"];var u=[o,Zr(e),"str"];if(t.cellFormula){e.l+=2;var p=Go(e,s-e.l,t);u[3]=Qr(p,0,o,t.supbooks,t)}else e.l=s;return u}},9:{f:function c1(e,r,t){var s=e.l+r,o=An(e);o.r=t["!row"];var u=[o,Kr(e),"n"];if(t.cellFormula){e.l+=2;var p=Go(e,s-e.l,t);u[3]=Qr(p,0,o,t.supbooks,t)}else e.l=s;return u}},10:{f:function Z1(e,r,t){var s=e.l+r,o=An(e);o.r=t["!row"];var u=[o,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var p=Go(e,s-e.l,t);u[3]=Qr(p,0,o,t.supbooks,t)}else e.l=s;return u}},11:{f:function o1(e,r,t){var s=e.l+r,o=An(e);o.r=t["!row"];var u=[o,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var p=Go(e,s-e.l,t);u[3]=Qr(p,0,o,t.supbooks,t)}else e.l=s;return u}},12:{f:function Bg(e){return[di(e)]}},13:{f:function e1(e){return[di(e),po(e),"n"]}},14:{f:function jg(e){return[di(e),e.read_shift(1),"e"]}},15:{f:function Vg(e){return[di(e),e.read_shift(1),"b"]}},16:{f:function yl(e){return[di(e),Kr(e),"n"]}},17:{f:function a1(e){return[di(e),Zr(e),"str"]}},18:{f:function Yg(e){return[di(e),e.read_shift(4),"s"]}},19:{f:ho},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function Ws(e,r,t){var s=e.l+r;e.l+=4,e.l+=1;var o=e.read_shift(4),f=cu(e),u=qm(e,0,t),p=bc(e);e.l=s;var x={Name:f,Ptg:u};return o<268435455&&(x.Sheet=o),p&&(x.Comment=p),x}},40:{},42:{},43:{f:function rp(e,r,t){var s={};s.sz=e.read_shift(2)/20;var o=function fu(e){var r=e.read_shift(1);return e.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(e);switch(o.fItalic&&(s.italic=1),o.fCondense&&(s.condense=1),o.fExtend&&(s.extend=1),o.fShadow&&(s.shadow=1),o.fOutline&&(s.outline=1),o.fStrikeout&&(s.strike=1),700===e.read_shift(2)&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript"}var u=e.read_shift(1);0!=u&&(s.underline=u);var p=e.read_shift(1);p>0&&(s.family=p);var x=e.read_shift(1);switch(x>0&&(s.charset=x),e.l++,s.color=function f0(e){var r={},s=e.read_shift(1)>>>1,o=e.read_shift(1),f=e.read_shift(2,"i"),u=e.read_shift(1),p=e.read_shift(1),x=e.read_shift(1);switch(e.l++,s){case 0:r.auto=1;break;case 1:r.index=o;var _=ca[o];_&&(r.rgb=Fs(_));break;case 2:r.rgb=Fs([u,p,x]);break;case 3:r.theme=o}return 0!=f&&(r.tint=f>0?f/32767:f/32768),r}(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor"}return s.name=Zr(e),s}},44:{f:function tp(e,r){return[e.read_shift(2),Zr(e)]}},45:{f:ap},46:{f:op},47:{f:function sp(e,r){var t=e.l+r,s=e.read_shift(2),o=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:o}}},48:{},49:{f:function c0(e){return e.read_shift(4,"i")}},50:{},51:{f:function Op(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:function uf(e,r,t){if(!t.cellStyles)return nn(e,r);var s=t&&t.biff>=12?4:2,o=e.read_shift(s),f=e.read_shift(s),u=e.read_shift(s),p=e.read_shift(s),x=e.read_shift(2);2==s&&(e.l+=2);var _={s:o,e:f,w:u,ixfe:p,flags:x};return(t.biff>=5||!t.biff)&&(_.level=x>>8&7),_}},62:{f:function r1(e){return[An(e),ho(e),"is"]}},63:{f:function Np(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=_t(t);var s=e.read_shift(1);return 2&s&&(r.l="1"),8&s&&(r.a="1"),r}},64:{f:function v1(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function bl(e){var r=e.read_shift(2);return e.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function Mg(e,r){var t={},s=e[e.l];return++e.l,t.above=!(64&s),t.left=!(128&s),e.l+=18,t.name=ou(e,r-19),t}},148:{f:Dh,p:16},151:{f:function p1(){}},152:{},153:{f:function Ja(e,r){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var o=r>8?Zr(e):"";return o.length>0&&(t.CodeName=o),t.autoCompressPictures=!!(65536&s),t.backupFile=!!(64&s),t.checkCompatibility=!!(4096&s),t.date1904=!!(1&s),t.filterPrivacy=!!(8&s),t.hidePivotFieldList=!!(1024&s),t.promptedSolutions=!!(16&s),t.publishItems=!!(2048&s),t.refreshAllConnections=!!(262144&s),t.saveExternalLinkValues=!!(128&s),t.showBorderUnselectedTables=!!(4&s),t.showInkAnnotation=!!(32&s),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(32768&s),t.updateLinks=["userSet","never","always"][s>>8&3],t}},154:{},155:{},156:{f:function Ka(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=kc(e,r-8),t.name=Zr(e),t}},157:{},158:{},159:{T:1,f:function Ef(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:sa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:f1},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function Fp(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}},336:{T:-1},337:{f:function nl(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:function sf(e,r,t){if(t.biff<8)return function ad(e,r,t){3==e[e.l+1]&&e[e.l]++;var s=gs(e,0,t);return 3==s.charCodeAt(0)?s.slice(1):s}(e,0,t);for(var s=[],o=e.l+r,f=e.read_shift(t.biff>8?4:2);0!=f--;)s.push(z0(e,0,t));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return s}},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function Mh(e,r,t){var s=e.l+r,o=mo(e),f=e.read_shift(1),u=[o];if(u[2]=f,t.cellFormula){var p=yh(e,s-e.l,t);u[1]=p}else e.l=s;return u}},427:{f:function m1(e,r,t){var s=e.l+r,f=[sa(e,16)];if(t.cellFormula){var u=eg(e,s-e.l,t);f[1]=u,e.l=s}else e.l=s;return f}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function x1(e){var r={};return Rh.forEach(function(t){r[t]=Kr(e)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function Pg(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function d1(e,r){var t=e.l+r,s=sa(e,16),o=bc(e),f=Zr(e),u=Zr(e),p=Zr(e);e.l=t;var x={rfx:s,relId:o,loc:f,display:p};return u&&(x.Tooltip=u),x}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xp},633:{T:1},634:{T:-1},635:{T:1,f:function Gp(e){var r={};r.iauthor=e.read_shift(4);var t=sa(e,16);return r.rfx=t.s,r.ref=_t(t.s),e.l+=16,r}},636:{T:-1},637:{f:yc},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function ge(e,r){return e.l+=10,{name:Zr(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function i(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ve(e,r,t,s){var o=r;if(!isNaN(o)){var f=s||(t||[]).length||0,u=e.next(4);u.write_shift(2,o),u.write_shift(2,f),f>0&&_c(t)&&e.push(t)}}function Cl(e,r,t){return e||(e=xe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function P_(e,r,t,s){if(null!=r.v)switch(r.t){case"d":case"n":var o="d"==r.t?Gr(or(r.v)):r.v;return void(o==(0|o)&&o>=0&&o<65536?Ve(e,2,function Cd(e,r,t){var s=xe(9);return Cl(s,e,r),s.write_shift(2,t),s}(t,s,o)):Ve(e,3,function xf(e,r,t){var s=xe(15);return Cl(s,e,r),s.write_shift(8,t,"f"),s}(t,s,o)));case"b":case"e":return void Ve(e,5,function O_(e,r,t,s){var o=xe(9);return Cl(o,e,r),R0(t,s||"b",o),o}(t,s,r.v,r.t));case"s":case"str":return void Ve(e,4,function I_(e,r,t){var s=xe(8+2*t.length);return Cl(s,e,r),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}(t,s,(r.v||"").slice(0,255)))}Ve(e,1,Cl(null,t,s))}function V_(e,r,t,s,o){var f=16+Wi(o.cellXfs,r,o);if(null!=r.v||r.bf)if(r.bf)Ve(e,6,function Qm(e,r,t,s,o){var f=da(r,t,o),u=function wh(e){if(null==e){var r=xe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}return oa("number"==typeof e?e:0)}(e.v),p=xe(6);p.write_shift(2,33),p.write_shift(4,0);for(var _=xe(e.bf.length),y=0;y<e.bf.length;++y)_[y]=e.bf[y];return br([f,u,p,_])}(r,t,s,0,f));else switch(r.t){case"d":case"n":Ve(e,515,function nd(e,r,t,s){var o=xe(14);return da(e,r,s,o),oa(t,o),o}(t,s,"d"==r.t?Gr(or(r.v)):r.v,f));break;case"b":case"e":Ve(e,517,function rd(e,r,t,s,o,f){var u=xe(8);return da(e,r,s,u),R0(t,f,u),u}(t,s,r.v,f,0,r.t));break;case"s":case"str":o.bookSST?Ve(e,253,function Bi(e,r,t,s){var o=xe(10);return da(e,r,s,o),o.write_shift(4,t),o}(t,s,xl(o.Strings,r.v,o.revStrings),f)):Ve(e,516,function Ku(e,r,t,s,o){var f=!o||8==o.biff,u=xe(+f+8+(1+f)*t.length);return da(e,r,s,u),u.write_shift(2,t.length),f&&u.write_shift(1,1),u.write_shift((1+f)*t.length,t,f?"utf16le":"sbcs"),u}(t,s,(r.v||"").slice(0,255),f,o));break;default:Ve(e,513,da(t,s,f))}else Ve(e,513,da(t,s,f))}function z_(e,r,t){var y,s=an(),o=t.SheetNames[e],f=t.Sheets[o]||{},u=(t||{}).Workbook||{},p=(u.Sheets||[])[e]||{},x=Array.isArray(f),_=8==r.biff,T="",E=[],C=Ht(f["!ref"]||"A1"),A=_?65536:16384;if(C.e.c>255||C.e.r>=A){if(r.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,A-1)}Ve(s,2057,zc(0,16,r)),Ve(s,13,Fn(1)),Ve(s,12,Fn(100)),Ve(s,15,dn(!0)),Ve(s,17,dn(!1)),Ve(s,16,oa(.001)),Ve(s,95,dn(!0)),Ve(s,42,dn(!1)),Ve(s,43,dn(!1)),Ve(s,130,Fn(1)),Ve(s,128,function td(e){var r=xe(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}([0,0])),Ve(s,131,dn(!1)),Ve(s,132,dn(!1)),_&&function W_(e,r){if(r){var t=0;r.forEach(function(s,o){++t<=256&&s&&Ve(e,125,function wd(e,r){var t=xe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,256*e.width),t.write_shift(2,0);var s=0;return e.hidden&&(s|=1),t.write_shift(1,s),t.write_shift(1,s=e.level||0),t.write_shift(2,0),t}(Yo(o,s),o))})}}(s,f["!cols"]),Ve(s,512,function Gc(e,r){var t=8!=r.biff&&r.biff?2:4,s=xe(2*t+6);return s.write_shift(t,e.s.r),s.write_shift(t,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}(C,r)),_&&(f["!links"]=[]);for(var k=C.s.r;k<=C.e.r;++k){T=wr(k);for(var F=C.s.c;F<=C.e.c;++F){k===C.s.r&&(E[F]=lr(F)),y=E[F]+T;var N=x?(f[k]||[])[F]:f[y];N&&(V_(s,N,k,F,r),_&&N.l&&f["!links"].push([y,N.l]))}}var L=p.CodeName||p.name||o;return _&&Ve(s,574,function Xu(e){var r=xe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}((u.Views||[])[0])),_&&(f["!merges"]||[]).length&&Ve(s,229,function od(e){var r=xe(2+8*e.length);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)ys(e[t],r);return r}(f["!merges"])),_&&function H_(e,r){for(var t=0;t<r["!links"].length;++t){var s=r["!links"][t];Ve(e,440,dd(s)),s[1].Tooltip&&Ve(e,2048,md(s))}delete r["!links"]}(s,f),Ve(s,442,N0(L)),_&&function B_(e,r){var t=xe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ve(e,2151,t),(t=xe(39)).write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),ys(Ht(r["!ref"]||"A1"),t),t.write_shift(4,4),Ve(e,2152,t)}(s,f),Ve(s,10),s.end()}function $_(e,r,t){var s=an(),o=(e||{}).Workbook||{},f=o.Sheets||[],u=o.WBProps||{},p=8==t.biff,x=5==t.biff;Ve(s,2057,zc(0,5,t)),"xla"==t.bookType&&Ve(s,135),Ve(s,225,p?Fn(1200):null),Ve(s,193,function Fu(e,r){r||(r=xe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}(2)),x&&Ve(s,191),x&&Ve(s,192),Ve(s,226),Ve(s,92,function Bu(e,r){var t=!r||8==r.biff,s=xe(t?112:54);for(s.write_shift(8==r.biff?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}(0,t)),Ve(s,66,Fn(p?1200:1252)),p&&Ve(s,353,Fn(0)),p&&Ve(s,448),Ve(s,317,function df(e){for(var r=xe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}(e.SheetNames.length)),p&&e.vbaraw&&Ve(s,211),p&&e.vbaraw&&Ve(s,442,N0(u.CodeName||"ThisWorkbook")),Ve(s,156,Fn(17)),Ve(s,25,dn(!1)),Ve(s,18,dn(!1)),Ve(s,19,Fn(0)),p&&Ve(s,431,dn(!1)),p&&Ve(s,444,Fn(0)),Ve(s,61,function ju(){var e=xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Ve(s,64,dn(!1)),Ve(s,141,Fn(0)),Ve(s,34,dn("true"==function Nt(e){return e.Workbook&&e.Workbook.WBProps&&function gr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Ve(s,14,dn(!0)),p&&Ve(s,439,dn(!1)),Ve(s,218,Fn(0)),function L_(e,r,t){Ve(e,49,function Yu(e,r){var t=e.name||"Arial",s=r&&5==r.biff,f=xe(s?15+t.length:16+2*t.length);return f.write_shift(2,20*(e.sz||12)),f.write_shift(4,0),f.write_shift(2,400),f.write_shift(4,0),f.write_shift(2,0),f.write_shift(1,t.length),s||f.write_shift(1,1),f.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),f}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}(s,0,t),function N_(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)null!=r[o]&&Ve(e,1054,jc(o,r[o],t))})}(s,e.SSF,t),function U_(e,r){for(var t=0;t<16;++t)Ve(e,224,Yc({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){Ve(e,224,Yc(s,0,r))})}(s,t),p&&Ve(s,352,dn(!1));var y=s.end(),T=an();p&&Ve(T,140,function hf(e){return e||(e=xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),p&&t.Strings&&function D_(e,r,t,s){var o=s||(t||[]).length||0;if(o<=8224)return Ve(e,r,t,o);var f=r;if(!isNaN(f)){for(var u=t.parts||[],p=0,x=0,_=0;_+(u[p]||8224)<=8224;)_+=u[p]||8224,p++;var y=e.next(4);for(y.write_shift(2,f),y.write_shift(2,_),e.push(t.slice(x,x+_)),x+=_;x<o;){for((y=e.next(4)).write_shift(2,60),_=0;_+(u[p]||8224)<=8224;)_+=u[p]||8224,p++;y.write_shift(2,_),e.push(t.slice(x,x+_)),x+=_}}}(T,252,function Wu(e,r){var t=xe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var s=[],o=0;o<e.length;++o)s[o]=Du(e[o]);var f=br([t].concat(s));return f.parts=[t.length].concat(s.map(function(u){return u.length})),f}(t.Strings)),Ve(T,10);var E=T.end(),C=an(),A=0,k=0;for(k=0;k<e.SheetNames.length;++k)A+=(p?12:11)+(p?2:1)*e.SheetNames[k].length;var F=y.length+A+E.length;for(k=0;k<e.SheetNames.length;++k)Ve(C,133,G0({pos:F,hs:(f[k]||{}).Hidden||0,dt:0,name:e.SheetNames[k]},t)),F+=r[k].length;var L=C.end();if(A!=L.length)throw new Error("BS8 "+A+" != "+L.length);var M=[];return y.length&&M.push(y),L.length&&M.push(L),E.length&&M.push(E),br(M)}function tx(e,r){for(var t=0;t<=e.SheetNames.length;++t){var s=e.Sheets[e.SheetNames[t]];s&&s["!ref"]&&un(s["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}var f=r||{};switch(f.biff||2){case 8:case 5:return function j_(e,r){var t=r||{},s=[];e&&!e.SSF&&(e.SSF=Qt(gt)),e&&e.SSF&&(Qe(),Be(e.SSF),t.revssf=no(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,F1(t),t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)s[s.length]=z_(o,t,e);return s.unshift($_(e,s,t)),br(s)}(e,r);case 4:case 3:case 2:return function R_(e,r){var t=r||{};null!=Ne&&null==t.dense&&(t.dense=Ne);for(var s=an(),o=0,f=0;f<e.SheetNames.length;++f)e.SheetNames[f]==t.sheet&&(o=f);if(0==o&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ve(s,4==t.biff?1033:3==t.biff?521:9,zc(0,16,t)),function M_(e,r,t,s){var u,o=Array.isArray(r),f=Ht(r["!ref"]||"A1"),p="",x=[];if(f.e.c>255||f.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,16383),u=St(f)}for(var _=f.s.r;_<=f.e.r;++_){p=wr(_);for(var y=f.s.c;y<=f.e.c;++y){_===f.s.r&&(x[y]=lr(y)),u=x[y]+p;var T=o?(r[_]||[])[y]:r[u];T&&P_(e,T,_,y)}}}(s,e.Sheets[e.SheetNames[o]],0,t),Ve(s,10),s.end()}(e,r)}throw new Error("invalid type "+f.bookType+" for BIFF")}function nx(e,r,t,s){for(var o=e["!merges"]||[],f=[],u=r.s.c;u<=r.e.c;++u){for(var p=0,x=0,_=0;_<o.length;++_)if(!(o[_].s.r>t||o[_].s.c>u||o[_].e.r<t||o[_].e.c<u)){if(o[_].s.r<t||o[_].s.c<u){p=-1;break}p=o[_].e.r-o[_].s.r+1,x=o[_].e.c-o[_].s.c+1;break}if(!(p<0)){var y=_t({r:t,c:u}),T=s.dense?(e[t]||[])[u]:e[y],E=T&&null!=T.v&&(T.h||Yl(T.w||(Nn(T),T.w)||""))||"",C={};p>1&&(C.rowspan=p),x>1&&(C.colspan=x),s.editable?E='<span contenteditable="true">'+E+"</span>":T&&(C["data-t"]=T&&T.t||"z",null!=T.v&&(C["data-v"]=T.v),null!=T.z&&(C["data-z"]=T.z),T.l&&"#"!=(T.l.Target||"#").charAt(0)&&(E='<a href="'+T.l.Target+'">'+E+"</a>")),C.id=(s.id||"sjs")+"-"+y,f.push(Le("td",E,C))}}return"<tr>"+f.join("")+"</tr>"}var ix='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ax="</body></html>";function ox(e,r){var t=r||{},o=null!=t.footer?t.footer:ax,f=[null!=t.header?t.header:ix],u=un(e["!ref"]);t.dense=Array.isArray(e),f.push(function sx(e,r,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var p=u.s.r;p<=u.e.r;++p)f.push(nx(e,u,p,t));return f.push("</table>"+o),f.join("")}function cx(e,r,t){var s=t||{};null!=Ne&&(s.dense=Ne);var o=0,f=0;if(null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var u="string"==typeof s.origin?yr(s.origin):s.origin;o=u.r,f=u.c}var p=r.getElementsByTagName("tr"),x=Math.min(s.sheetRows||1e7,p.length),_={s:{r:0,c:0},e:{r:o,c:f}};if(e["!ref"]){var y=un(e["!ref"]);_.s.r=Math.min(_.s.r,y.s.r),_.s.c=Math.min(_.s.c,y.s.c),_.e.r=Math.max(_.e.r,y.e.r),_.e.c=Math.max(_.e.c,y.e.c),-1==o&&(_.e.r=o=y.e.r+1)}var T=[],E=0,C=e["!rows"]||(e["!rows"]=[]),A=0,k=0,F=0,N=0,L=0,M=0;for(e["!cols"]||(e["!cols"]=[]);A<p.length&&k<x;++A){var q=p[A];if(fx(q)){if(s.display)continue;C[k]={hidden:!0}}var ae=q.children;for(F=N=0;F<ae.length;++F){var ve=ae[F];if(!s.display||!fx(ve)){var G=ve.hasAttribute("data-v")?ve.getAttribute("data-v"):ve.hasAttribute("v")?ve.getAttribute("v"):Ca(ve.innerHTML),ie=ve.getAttribute("data-z")||ve.getAttribute("z");for(E=0;E<T.length;++E){var ee=T[E];ee.s.c==N+f&&ee.s.r<k+o&&k+o<=ee.e.r&&(N=ee.e.c+1-f,E=-1)}M=+ve.getAttribute("colspan")||1,((L=+ve.getAttribute("rowspan")||1)>1||M>1)&&T.push({s:{r:k+o,c:N+f},e:{r:k+o+(L||1)-1,c:N+f+(M||1)-1}});var we={t:"s",v:G},ye=ve.getAttribute("data-t")||ve.getAttribute("t")||"";null!=G&&(0==G.length?we.t=ye||"z":s.raw||0==G.trim().length||"s"==ye||("TRUE"===G?we={t:"b",v:!0}:"FALSE"===G?we={t:"b",v:!1}:isNaN(yn(G))?isNaN(Di(G).getDate())||(we={t:"d",v:or(G)},s.cellDates||(we={t:"n",v:Gr(we.v)}),we.z=s.dateNF||gt[14]):we={t:"n",v:yn(G)})),void 0===we.z&&null!=ie&&(we.z=ie);var re="",ze=ve.getElementsByTagName("A");if(ze&&ze.length)for(var ct=0;ct<ze.length&&(!ze[ct].hasAttribute("href")||"#"==(re=ze[ct].getAttribute("href")).charAt(0));++ct);re&&"#"!=re.charAt(0)&&(we.l={Target:re}),s.dense?(e[k+o]||(e[k+o]=[]),e[k+o][N+f]=we):e[_t({c:N+f,r:k+o})]=we,_.e.c<N+f&&(_.e.c=N+f),N+=M}}++k}return T.length&&(e["!merges"]=(e["!merges"]||[]).concat(T)),_.e.r=Math.max(_.e.r,k-1+o),e["!ref"]=St(_),k>=x&&(e["!fullref"]=St((_.e.r=p.length-A+k-1+o,_))),e}function lx(e,r){return cx((r||{}).dense?[]:{},e,r)}function fx(e){var r="",t=function Y_(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),"none"===r}var K_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+ea({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+r}}(),mx=function(){var e=function(f){return Jt(f).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",s=function(f,u,p){var x=[];x.push('      <table:table table:name="'+Jt(u.SheetNames[p])+'" table:style-name="ta1">\n');var _=0,y=0,T=un(f["!ref"]||"A1"),E=f["!merges"]||[],C=0,A=Array.isArray(f);if(f["!cols"])for(y=0;y<=T.e.c;++y)x.push("        <table:table-column"+(f["!cols"][y]?' table:style-name="co'+f["!cols"][y].ods+'"':"")+"></table:table-column>\n");var F=f["!rows"]||[];for(_=0;_<T.s.r;++_)x.push("        <table:table-row"+(F[_]?' table:style-name="ro'+F[_].ods+'"':"")+"></table:table-row>\n");for(;_<=T.e.r;++_){for(x.push("        <table:table-row"+(F[_]?' table:style-name="ro'+F[_].ods+'"':"")+">\n"),y=0;y<T.s.c;++y)x.push(r);for(;y<=T.e.c;++y){var N=!1,L={},M="";for(C=0;C!=E.length;++C)if(!(E[C].s.c>y||E[C].s.r>_||E[C].e.c<y||E[C].e.r<_)){(E[C].s.c!=y||E[C].s.r!=_)&&(N=!0),L["table:number-columns-spanned"]=E[C].e.c-E[C].s.c+1,L["table:number-rows-spanned"]=E[C].e.r-E[C].s.r+1;break}if(N)x.push("          <table:covered-table-cell/>\n");else{var q=_t({r:_,c:y}),ae=A?(f[_]||[])[y]:f[q];if(ae&&ae.f&&(L["table:formula"]=Jt(ng(ae.f)),ae.F&&ae.F.slice(0,q.length)==q)){var ve=un(ae.F);L["table:number-matrix-columns-spanned"]=ve.e.c-ve.s.c+1,L["table:number-matrix-rows-spanned"]=ve.e.r-ve.s.r+1}if(ae){switch(ae.t){case"b":M=ae.v?"TRUE":"FALSE",L["office:value-type"]="boolean",L["office:boolean-value"]=ae.v?"true":"false";break;case"n":M=ae.w||String(ae.v||0),L["office:value-type"]="float",L["office:value"]=ae.v||0;break;case"s":case"str":M=null==ae.v?"":ae.v,L["office:value-type"]="string";break;case"d":M=ae.w||or(ae.v).toISOString(),L["office:value-type"]="date",L["office:date-value"]=or(ae.v).toISOString(),L["table:style-name"]="ce1";break;default:x.push(r);continue}var G=e(M);if(ae.l&&ae.l.Target){var ie=ae.l.Target;"#"!=(ie="#"==ie.charAt(0)?"#"+ig(ie.slice(1)):ie).charAt(0)&&!ie.match(/^\w+:/)&&(ie="../"+ie),G=Le("text:a",G,{"xlink:href":ie.replace(/&/g,"&amp;")})}x.push("          "+Le("table:table-cell",Le("text:p",G,{}),L)+"\n")}else x.push(r)}}x.push("        </table:table-row>\n")}return x.push("      </table:table>\n"),x.join("")};return function(u,p){var x=[pr],_=ea({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),y=ea({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==p.bookType?(x.push("<office:document"+_+y+">\n"),x.push(Pc().replace(/office:document-meta/g,"office:meta"))):x.push("<office:document-content"+_+">\n"),function(f,u){f.push(" <office:automatic-styles>\n"),f.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),f.push('   <number:month number:style="long"/>\n'),f.push("   <number:text>/</number:text>\n"),f.push('   <number:day number:style="long"/>\n'),f.push("   <number:text>/</number:text>\n"),f.push("   <number:year/>\n"),f.push("  </number:date-style>\n");var p=0;u.SheetNames.map(function(_){return u.Sheets[_]}).forEach(function(_){if(_&&_["!cols"])for(var y=0;y<_["!cols"].length;++y)if(_["!cols"][y]){var T=_["!cols"][y];if(null==T.width&&null==T.wpx&&null==T.wch)continue;yi(T),T.ods=p;var E=_["!cols"][y].wpx+"px";f.push('  <style:style style:name="co'+p+'" style:family="table-column">\n'),f.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+E+'"/>\n'),f.push("  </style:style>\n"),++p}});var x=0;u.SheetNames.map(function(_){return u.Sheets[_]}).forEach(function(_){if(_&&_["!rows"])for(var y=0;y<_["!rows"].length;++y)if(_["!rows"][y]){_["!rows"][y].ods=x;var T=_["!rows"][y].hpx+"px";f.push('  <style:style style:name="ro'+x+'" style:family="table-row">\n'),f.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+T+'"/>\n'),f.push("  </style:style>\n"),++x}}),f.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),f.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),f.push("  </style:style>\n"),f.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),f.push(" </office:automatic-styles>\n")}(x,u),x.push("  <office:body>\n"),x.push("    <office:spreadsheet>\n");for(var T=0;T!=u.SheetNames.length;++T)x.push(s(u.Sheets[u.SheetNames[T]],u,T));return x.push("    </office:spreadsheet>\n"),x.push("  </office:body>\n"),x.push("fods"==p.bookType?"</office:document>":"</office:document-content>"),x.join("")}}();function gx(e,r){if("fods"==r.bookType)return mx(e,r);var t=li(),s="",o=[],f=[];return Ot(t,s="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ot(t,s="content.xml",mx(e,r)),o.push([s,"text/xml"]),f.push([s,"ContentFile"]),Ot(t,s="styles.xml",K_(e,r)),o.push([s,"text/xml"]),f.push([s,"StylesFile"]),Ot(t,s="meta.xml",pr+Pc()),o.push([s,"text/xml"]),f.push([s,"MetadataFile"]),Ot(t,s="manifest.rdf",function wu(e){var r=[pr];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=e.length;++t)r.push(g0(e[t][0],e[t][1])),r.push(x0("",e[t][0]));return r.push(g0("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(f)),o.push([s,"application/rdf+xml"]),Ot(t,s="META-INF/manifest.xml",function bo(e){var r=[pr];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}(o)),t}function zs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function J_(e){return typeof TextEncoder<"u"?(new TextEncoder).encode(e):Ur(fr(e))}function Qa(e){var r=e.reduce(function(o,f){return o+f.length},0),t=new Uint8Array(r),s=0;return e.forEach(function(o){t.set(o,s),s+=o.length}),t}function Sl(e,r){var t=r?r[0]:0,s=127&e[t];e:if(e[t++]>=128&&(s|=(127&e[t])<<7,e[t++]<128||(s|=(127&e[t])<<14,e[t++]<128)||(s|=(127&e[t])<<21,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)||(s+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),s}function er(e){var r=new Uint8Array(7);r[0]=127&e;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Or(e){var r=0,t=127&e[r];e:if(e[r++]>=128){if(t|=(127&e[r])<<7,e[r++]<128||(t|=(127&e[r])<<14,e[r++]<128)||(t|=(127&e[r])<<21,e[r++]<128))break e;t|=(127&e[r])<<28}return t}function Zt(e){for(var r=[],t=[0];t[0]<e.length;){var p,s=t[0],o=Sl(e,t),f=7&o,u=0;if(0==(o=Math.floor(o/8)))break;switch(f){case 0:for(var x=t[0];e[t[0]++]>=128;);p=e.slice(x,t[0]);break;case 5:p=e.slice(t[0],t[0]+(u=4)),t[0]+=u;break;case 1:p=e.slice(t[0],t[0]+(u=8)),t[0]+=u;break;case 2:u=Sl(e,t),p=e.slice(t[0],t[0]+u),t[0]+=u;break;default:throw new Error("PB Type ".concat(f," for Field ").concat(o," at offset ").concat(s))}var _={data:p,type:f};null==r[o]?r[o]=[_]:r[o].push(_)}return r}function cn(e){var r=[];return e.forEach(function(t,s){t.forEach(function(o){o.data&&(r.push(er(8*s+o.type)),2==o.type&&r.push(er(o.data.length)),r.push(o.data))})}),Qa(r)}function ei(e){for(var r,t=[],s=[0];s[0]<e.length;){var o=Sl(e,s),f=Zt(e.slice(s[0],s[0]+o));s[0]+=o;var u={id:Or(f[1][0].data),messages:[]};f[2].forEach(function(p){var x=Zt(p.data),_=Or(x[3][0].data);u.messages.push({meta:x,data:e.slice(s[0],s[0]+_)}),s[0]+=_}),null!=(r=f[3])&&r[0]&&(u.merge=Or(f[3][0].data)>>>0>0),t.push(u)}return t}function Ko(e){var r=[];return e.forEach(function(t){var s=[];s[1]=[{data:er(t.id),type:0}],s[2]=[],null!=t.merge&&(s[3]=[{data:er(+!!t.merge),type:0}]);var o=[];t.messages.forEach(function(u){o.push(u.data),u.meta[3]=[{type:0,data:er(u.data.length)}],s[2].push({data:cn(u.meta),type:2})});var f=cn(s);r.push(er(f.length)),r.push(f),o.forEach(function(u){return r.push(u)})}),Qa(r)}function tv(e,r){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=Sl(r,t),o=[];t[0]<r.length;){var f=3&r[t[0]];if(0!=f){var x=0,_=0;if(1==f?(_=4+(r[t[0]]>>2&7),x=(224&r[t[0]++])<<3,x|=r[t[0]++]):(_=1+(r[t[0]++]>>2),2==f?(x=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(x=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),o=[Qa(o)],0==x)throw new Error("Invalid offset 0");if(x>o[0].length)throw new Error("Invalid offset beyond length");if(_>=x)for(o.push(o[0].slice(-x)),_-=x;_>=o[o.length-1].length;)o.push(o[o.length-1]),_-=o[o.length-1].length;o.push(o[0].slice(-x,-x+_))}else{var u=r[t[0]++]>>2;if(u<60)++u;else{var p=u-59;u=r[t[0]],p>1&&(u|=r[t[0]+1]<<8),p>2&&(u|=r[t[0]+2]<<16),p>3&&(u|=r[t[0]+3]<<24),u>>>=0,u++,t[0]+=p}o.push(r.slice(t[0],t[0]+u)),t[0]+=u}}var y=Qa(o);if(y.length!=s)throw new Error("Unexpected length: ".concat(y.length," != ").concat(s));return y}function ti(e){for(var r=[],t=0;t<e.length;){var s=e[t++],o=e[t]|e[t+1]<<8|e[t+2]<<16;r.push(tv(s,e.slice(t+=3,t+o))),t+=o}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Qa(r)}function Jo(e){for(var r=[],t=0;t<e.length;){var s=Math.min(e.length-t,268435455),o=new Uint8Array(4);r.push(o);var f=er(s),u=f.length;r.push(f),s<=60?(u++,r.push(new Uint8Array([s-1<<2]))):s<=256?(u+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(u+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(u+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(u+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(e.slice(t,t+s)),u+=s,o[0]=0,o[1]=255&u,o[2]=u>>8&255,o[3]=u>>16&255,t+=s}return Qa(r)}function E1(e,r){var t=new Uint8Array(32),s=zs(t),o=12,f=0;switch(t[0]=5,e.t){case"n":t[1]=2,function ev(e,r,t){var s=Math.floor(0==t?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,o=t/Math.pow(10,s-6176);e[r+15]|=s>>7,e[r+14]|=(127&s)<<1;for(var f=0;o>=1;++f,o/=256)e[r+f]=255&o;e[r+15]|=t>=0?0:128}(t,o,e.v),f|=1,o+=16;break;case"b":t[1]=6,s.setFloat64(o,e.v?1:0,!0),f|=2,o+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,s.setUint32(o,r.indexOf(e.v),!0),f|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,f,!0),t.slice(0,o)}function C1(e,r){var t=new Uint8Array(32),s=zs(t),o=12,f=0;switch(t[0]=3,e.t){case"n":t[2]=2,s.setFloat64(o,e.v,!0),f|=32,o+=8;break;case"b":t[2]=6,s.setFloat64(o,e.v?1:0,!0),f|=32,o+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,s.setUint32(o,r.indexOf(e.v),!0),f|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,f,!0),t.slice(0,o)}function xn(e){return Sl(Zt(e)[1][0].data)}function hv(e,r,t){var s,o,f,u;if(null==(s=e[6])||!s[0]||null==(o=e[7])||!o[0])throw"Mutation only works on post-BNC storages!";if((null==(u=null==(f=e[8])?void 0:f[0])?void 0:u.data)&&Or(e[8][0].data)>0)throw"Math only works with normal offsets";for(var x=0,_=zs(e[7][0].data),y=0,T=[],E=zs(e[4][0].data),C=0,A=[],k=0;k<r.length;++k)if(null!=r[k]){var F,N;switch(_.setUint16(2*k,y,!0),E.setUint16(2*k,C,!0),typeof r[k]){case"string":F=E1({t:"s",v:r[k]},t),N=C1({t:"s",v:r[k]},t);break;case"number":F=E1({t:"n",v:r[k]},t),N=C1({t:"n",v:r[k]},t);break;case"boolean":F=E1({t:"b",v:r[k]},t),N=C1({t:"b",v:r[k]},t);break;default:throw new Error("Unsupported value "+r[k])}T.push(F),y+=F.length,A.push(N),C+=N.length,++x}else _.setUint16(2*k,65535,!0),E.setUint16(2*k,65535);for(e[2][0].data=er(x);k<e[7][0].data.length/2;++k)_.setUint16(2*k,65535,!0),E.setUint16(2*k,65535,!0);return e[6][0].data=Qa(T),e[3][0].data=Qa(A),x}function F1(e){!function vx(e){return function(t){for(var s=0;s!=e.length;++s){var o=e[s];void 0===t[o[0]]&&(t[o[0]]=o[1]),"n"===o[2]&&(t[o[0]]=Number(t[o[0]]))}}}([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function _v(e,r){return"ods"==r.bookType?gx(e,r):"numbers"==r.bookType?function uv(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=un(t["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>9&&(o=!0,s.e.c=9),s.e.r>49&&(o=!0,s.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(St(s)));var f=Uh(t,{range:s,header:1}),u=["~Sh33tJ5~"];f.forEach(function(Q){return Q.forEach(function(J){"string"==typeof J&&u.push(J)})});var p={},x=[],_=lt.read(r.numbers,{type:"base64"});_.FileIndex.map(function(Q,J){return[Q,_.FullPaths[J]]}).forEach(function(Q){var J=Q[0],ke=Q[1];2==J.type&&J.name.match(/\.iwa/)&&ei(ti(J.content)).forEach(function(Ae){x.push(Ae.id),p[Ae.id]={deps:[],location:ke,type:Or(Ae.messages[0].meta[1][0].data)}})}),x.sort(function(Q,J){return Q-J});var y=x.filter(function(Q){return Q>1}).map(function(Q){return[Q,er(Q)]});_.FileIndex.map(function(Q,J){return[Q,_.FullPaths[J]]}).forEach(function(Q){var J=Q[0];J.name.match(/\.iwa/)&&ei(ti(J.content)).forEach(function(He){He.messages.forEach(function(We){y.forEach(function(Ae){He.messages.some(function(Lt){return 11006!=Or(Lt.meta[1][0].data)&&function Q_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var s=0;s<r.length;++s)if(e[t+s]!=r[s])continue e;return!0}return!1}(Lt.data,Ae[1])})&&p[Ae[0]].deps.push(He.id)})})})});for(var A,E=lt.find(_,p[1].location),C=ei(ti(E.content)),k=0;k<C.length;++k){var F=C[k];1==F.id&&(A=F)}var N=xn(Zt(A.messages[0].data)[1][0].data);for(C=ei(ti((E=lt.find(_,p[N].location)).content)),k=0;k<C.length;++k)(F=C[k]).id==N&&(A=F);for(N=xn(Zt(A.messages[0].data)[2][0].data),C=ei(ti((E=lt.find(_,p[N].location)).content)),k=0;k<C.length;++k)(F=C[k]).id==N&&(A=F);for(N=xn(Zt(A.messages[0].data)[2][0].data),C=ei(ti((E=lt.find(_,p[N].location)).content)),k=0;k<C.length;++k)(F=C[k]).id==N&&(A=F);var L=Zt(A.messages[0].data);L[6][0].data=er(s.e.r+1),L[7][0].data=er(s.e.c+1);for(var M=xn(L[46][0].data),q=lt.find(_,p[M].location),ae=ei(ti(q.content)),ve=0;ve<ae.length&&ae[ve].id!=M;++ve);if(ae[ve].id!=M)throw"Bad ColumnRowUIDMapArchive";var G=Zt(ae[ve].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var ie=0;ie<=s.e.c;++ie){var ee=[];ee[1]=ee[2]=[{type:0,data:er(ie+420690)}],G[1].push({type:2,data:cn(ee)}),G[2].push({type:0,data:er(ie)}),G[3].push({type:0,data:er(ie)})}G[4]=[],G[5]=[],G[6]=[];for(var we=0;we<=s.e.r;++we)(ee=[])[1]=ee[2]=[{type:0,data:er(we+726270)}],G[4].push({type:2,data:cn(ee)}),G[5].push({type:0,data:er(we)}),G[6].push({type:0,data:er(we)});ae[ve].messages[0].data=cn(G),q.content=Jo(Ko(ae)),q.size=q.content.length,delete L[46];var ye=Zt(L[4][0].data);ye[7][0].data=er(s.e.r+1);var ze=xn(Zt(ye[1][0].data)[2][0].data);if((ae=ei(ti((q=lt.find(_,p[ze].location)).content)))[0].id!=ze)throw"Bad HeaderStorageBucket";var ct=Zt(ae[0].messages[0].data);for(we=0;we<f.length;++we){var Ge=Zt(ct[2][0].data);Ge[1][0].data=er(we),Ge[4][0].data=er(f[we].length),ct[2][we]={type:ct[2][0].type,data:cn(Ge)}}ae[0].messages[0].data=cn(ct),q.content=Jo(Ko(ae)),q.size=q.content.length;var vt=xn(ye[2][0].data);if((ae=ei(ti((q=lt.find(_,p[vt].location)).content)))[0].id!=vt)throw"Bad HeaderStorageBucket";for(ct=Zt(ae[0].messages[0].data),ie=0;ie<=s.e.c;++ie)(Ge=Zt(ct[2][0].data))[1][0].data=er(ie),Ge[4][0].data=er(s.e.r+1),ct[2][ie]={type:ct[2][0].type,data:cn(Ge)};ae[0].messages[0].data=cn(ct),q.content=Jo(Ko(ae)),q.size=q.content.length;var dt=xn(ye[4][0].data);!function(){for(var ke,Q=lt.find(_,p[dt].location),J=ei(ti(Q.content)),Je=0;Je<J.length;++Je){var He=J[Je];He.id==dt&&(ke=He)}var We=Zt(ke.messages[0].data);We[3]=[];var Ae=[];u.forEach(function(ir,Vt){Ae[1]=[{type:0,data:er(Vt)}],Ae[2]=[{type:0,data:er(1)}],Ae[3]=[{type:2,data:J_(ir)}],We[3].push({type:2,data:cn(Ae)})}),ke.messages[0].data=cn(We);var z=Jo(Ko(J));Q.content=z,Q.size=Q.content.length}();var Wt=Zt(ye[3][0].data),nt=Wt[1][0];delete Wt[2];var bt=Zt(nt.data),De=xn(bt[2][0].data);!function(){for(var ke,Q=lt.find(_,p[De].location),J=ei(ti(Q.content)),Je=0;Je<J.length;++Je){var He=J[Je];He.id==De&&(ke=He)}var We=Zt(ke.messages[0].data);delete We[6],delete Wt[7];var Ae=new Uint8Array(We[5][0].data);We[5]=[];for(var Lt=0,z=0;z<=s.e.r;++z){var ir=Zt(Ae);Lt+=hv(ir,f[z],u),ir[1][0].data=er(z),We[5].push({data:cn(ir),type:2})}We[1]=[{type:0,data:er(s.e.c+1)}],We[2]=[{type:0,data:er(s.e.r+1)}],We[3]=[{type:0,data:er(Lt)}],We[4]=[{type:0,data:er(s.e.r+1)}],ke.messages[0].data=cn(We);var ar=Jo(Ko(J));Q.content=ar,Q.size=Q.content.length}(),nt.data=cn(bt),ye[3][0].data=cn(Wt),L[4][0].data=cn(ye),A.messages[0].data=cn(L);var pe=Jo(Ko(C));return E.content=pe,E.size=E.content.length,_}(e,r):"xlsb"==r.bookType?function vv(e,r){ja=1024,e&&!e.SSF&&(e.SSF=Qt(gt)),e&&e.SSF&&(Qe(),Be(e.SSF),r.revssf=no(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ns?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xlsb"==r.bookType?"bin":"xml",s=qf.indexOf(r.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};F1(r=r||{});var f=li(),u="",p=0;if(r.cellXfs=[],Wi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ot(f,u="docProps/core.xml",v0(e.Props,r)),o.coreprops.push(u),kt(r.rels,2,u,At.CORE_PROPS),u="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var x=[],_=0;_<e.SheetNames.length;++_)2!=(e.Workbook.Sheets[_]||{}).Hidden&&x.push(e.SheetNames[_]);e.Props.SheetNames=x}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,Ot(f,u,y0(e.Props)),o.extprops.push(u),kt(r.rels,3,u,At.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(Ot(f,u="docProps/custom.xml",ko(e.Custprops)),o.custprops.push(u),kt(r.rels,4,u,At.CUST_PROPS)),p=1;p<=e.SheetNames.length;++p){var y={"!id":{}},T=e.Sheets[e.SheetNames[p-1]];if(Ot(f,u="xl/worksheets/sheet"+p+"."+t,qx(p-1,u,r,e,y)),o.sheets.push(u),kt(r.wbrels,-1,"worksheets/sheet"+p+"."+t,At.WS[0]),T){var C=T["!comments"],A=!1,k="";C&&C.length>0&&(Ot(f,k="xl/comments"+p+"."+t,r_(C,k,r)),o.comments.push(k),kt(y,-1,"../comments"+p+"."+t,At.CMNT),A=!0),T["!legacy"]&&A&&Ot(f,"xl/drawings/vmlDrawing"+p+".vml",Zf(p,T["!comments"])),delete T["!comments"],delete T["!legacy"]}y["!id"].rId1&&Ot(f,gi(u),la(y))}return null!=r.Strings&&r.Strings.length>0&&(Ot(f,u="xl/sharedStrings."+t,function t_(e,r,t){return(".bin"===r.slice(-4)?Ld:Tf)(e,t)}(r.Strings,u,r)),o.strs.push(u),kt(r.wbrels,-1,"sharedStrings."+t,At.SST)),Ot(f,u="xl/workbook."+t,function Qx(e,r,t){return(".bin"===r.slice(-4)?Ux:en)(e,t)}(e,u,r)),o.workbooks.push(u),kt(r.rels,1,u,At.WB),Ot(f,u="xl/theme/theme1.xml",rl(e.Themes,r)),o.themes.push(u),kt(r.wbrels,-1,"theme/theme1.xml",At.THEME),Ot(f,u="xl/styles."+t,function e_(e,r,t){return(".bin"===r.slice(-4)?$a:Ds)(e,t)}(e,u,r)),o.styles.push(u),kt(r.wbrels,-1,"styles."+t,At.STY),e.vbaraw&&s&&(Ot(f,u="xl/vbaProject.bin",e.vbaraw),o.vba.push(u),kt(r.wbrels,-1,"vbaProject.bin",At.VBA)),Ot(f,u="xl/metadata."+t,function n_(e){return(".bin"===e.slice(-4)?Xf:Yf)()}(u)),o.metadata.push(u),kt(r.wbrels,-1,"metadata."+t,At.XLMETA),Ot(f,"[Content_Types].xml",p0(o,r)),Ot(f,"_rels/.rels",la(r.rels)),Ot(f,"xl/_rels/workbook."+t+".rels",la(r.wbrels)),delete r.revssf,delete r.ssf,f}(e,r):function wx(e,r){ja=1024,e&&!e.SSF&&(e.SSF=Qt(gt)),e&&e.SSF&&(Qe(),Be(e.SSF),r.revssf=no(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ns?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",s=qf.indexOf(r.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};F1(r=r||{});var f=li(),u="",p=0;if(r.cellXfs=[],Wi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ot(f,u="docProps/core.xml",v0(e.Props,r)),o.coreprops.push(u),kt(r.rels,2,u,At.CORE_PROPS),u="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var x=[],_=0;_<e.SheetNames.length;++_)2!=(e.Workbook.Sheets[_]||{}).Hidden&&x.push(e.SheetNames[_]);e.Props.SheetNames=x}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ot(f,u,y0(e.Props)),o.extprops.push(u),kt(r.rels,3,u,At.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(Ot(f,u="docProps/custom.xml",ko(e.Custprops)),o.custprops.push(u),kt(r.rels,4,u,At.CUST_PROPS));var y=["SheetJ5"];for(r.tcid=0,p=1;p<=e.SheetNames.length;++p){var T={"!id":{}},E=e.Sheets[e.SheetNames[p-1]];if(Ot(f,u="xl/worksheets/sheet"+p+"."+t,Fh(p-1,r,e,T)),o.sheets.push(u),kt(r.wbrels,-1,"worksheets/sheet"+p+"."+t,At.WS[0]),E){var A=E["!comments"],k=!1,F="";if(A&&A.length>0){var N=!1;A.forEach(function(L){L[1].forEach(function(M){1==M.T&&(N=!0)})}),N&&(Ot(f,F="xl/threadedComments/threadedComment"+p+"."+t,zp(A,y,r)),o.threadedcomments.push(F),kt(T,-1,"../threadedComments/threadedComment"+p+"."+t,At.TCMNT)),Ot(f,F="xl/comments"+p+"."+t,Jf(A)),o.comments.push(F),kt(T,-1,"../comments"+p+"."+t,At.CMNT),k=!0}E["!legacy"]&&k&&Ot(f,"xl/drawings/vmlDrawing"+p+".vml",Zf(p,E["!comments"])),delete E["!comments"],delete E["!legacy"]}T["!id"].rId1&&Ot(f,gi(u),la(T))}return null!=r.Strings&&r.Strings.length>0&&(Ot(f,u="xl/sharedStrings."+t,Tf(r.Strings,r)),o.strs.push(u),kt(r.wbrels,-1,"sharedStrings."+t,At.SST)),Ot(f,u="xl/workbook."+t,en(e)),o.workbooks.push(u),kt(r.rels,1,u,At.WB),Ot(f,u="xl/theme/theme1.xml",rl(e.Themes,r)),o.themes.push(u),kt(r.wbrels,-1,"theme/theme1.xml",At.THEME),Ot(f,u="xl/styles."+t,Ds(e,r)),o.styles.push(u),kt(r.wbrels,-1,"styles."+t,At.STY),e.vbaraw&&s&&(Ot(f,u="xl/vbaProject.bin",e.vbaraw),o.vba.push(u),kt(r.wbrels,-1,"vbaProject.bin",At.VBA)),Ot(f,u="xl/metadata."+t,Yf()),o.metadata.push(u),kt(r.wbrels,-1,"metadata."+t,At.XLMETA),y.length>1&&(Ot(f,u="xl/persons/person.xml",function jp(e){var r=[pr,Le("personList",null,{xmlns:Ar.TCMNT,"xmlns:x":Ii[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,s){r.push(Le("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}(y)),o.people.push(u),kt(r.wbrels,-1,"persons/person.xml",At.PEOPLE)),Ot(f,"[Content_Types].xml",p0(o,r)),Ot(f,"_rels/.rels",la(r.rels)),Ot(f,"xl/_rels/workbook.xml.rels",la(r.wbrels)),delete r.revssf,delete r.ssf,f}(e,r)}function bx(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Zn(r.file,lt.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return lt.write(e,r)}function ji(e,r,t){t||(t="");var s=t+e;switch(r.type){case"base64":return Pt(fr(s));case"binary":return fr(s);case"string":return e;case"file":return Zn(r.file,s,"utf8");case"buffer":return xt?_n(s,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(s):ji(s,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Bh(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return"base64"==r.type?Pt(t):"string"==r.type?Yt(t):t;case"file":return Zn(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function P1(e,r){(function pt(){ft(1200),function et(){rt(1252)}()})(),function ur(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");!function qt(e,r,t){e.forEach(function(s,o){gn(s);for(var f=0;f<o;++f)if(s==e[f])throw new Error("Duplicate Sheet Name: "+s);if(t){var u=r&&r[o]&&r[o].CodeName||s;if(95==u.charCodeAt(0)&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}(e.SheetNames,e.Workbook&&e.Workbook.Sheets||[],!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)sg(e.Sheets[e.SheetNames[t]],0,t)}(e);var t=Qt(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var s=P1(e,t);return t.type="array",ai(s)}var o=0;if(t.sheet&&(o="number"==typeof t.sheet?t.sheet:e.SheetNames.indexOf(t.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ji(b_(e,t),t);case"slk":case"sylk":return ji(vf.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"htm":case"html":return ji(ox(e.Sheets[e.SheetNames[o]],t),t);case"txt":return function Av(e,r){switch(r.type){case"base64":return Pt(e);case"binary":case"string":return e;case"file":return Zn(r.file,e,"binary");case"buffer":return xt?_n(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}(Ax(e.Sheets[e.SheetNames[o]],t),t);case"csv":return ji(R1(e.Sheets[e.SheetNames[o]],t),t,"\ufeff");case"dif":return ji(wf.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"dbf":return Bh(ks.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"prn":return ji(Wa.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"rtf":return ji(Mf.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"eth":return ji(Ts.from_sheet(e.Sheets[e.SheetNames[o]],t),t);case"fods":return ji(gx(e,t),t);case"wk1":return Bh(sn.sheet_to_wk1(e.Sheets[e.SheetNames[o]],t),t);case"wk3":return Bh(sn.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Bh(tx(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),function Sv(e,r){var t=r||{};return bx(function F_(e,r){var t=r||{},s=lt.utils.cfb_new({root:"R"}),o="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":o="/Workbook",t.biff=8;break;case"biff5":o="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return lt.utils.cfb_add(s,o,tx(e,t)),8==t.biff&&(e.Props||e.Custprops)&&function A_(e,r){var u,t=[],s=[],o=[],f=0,p=Rl(wo,"n"),x=Rl(Dc,"n");if(e.Props)for(u=vr(e.Props),f=0;f<u.length;++f)(Object.prototype.hasOwnProperty.call(p,u[f])?t:Object.prototype.hasOwnProperty.call(x,u[f])?s:o).push([u[f],e.Props[u[f]]]);if(e.Custprops)for(u=vr(e.Custprops),f=0;f<u.length;++f)Object.prototype.hasOwnProperty.call(e.Props||{},u[f])||(Object.prototype.hasOwnProperty.call(p,u[f])?t:Object.prototype.hasOwnProperty.call(x,u[f])?s:o).push([u[f],e.Custprops[u[f]]]);var _=[];for(f=0;f<o.length;++f)O0.indexOf(o[f][0])>-1||Na.indexOf(o[f][0])>-1||null!=o[f][1]&&_.push(o[f]);s.length&&lt.utils.cfb_add(r,"/\x05SummaryInformation",P0(s,Tl.SI,x,Dc)),(t.length||_.length)&&lt.utils.cfb_add(r,"/\x05DocumentSummaryInformation",P0(t,Tl.DSI,p,wo,_.length?_:null,Tl.UDI))}(e,s),8==t.biff&&e.vbaraw&&function Jp(e,r){r.FullPaths.forEach(function(t,s){if(0!=s){var o=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==o.slice(-1)&&lt.utils.cfb_add(e,o,r.FileIndex[s].content)}})}(s,lt.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),s}(e,t),t)}(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function Ev(e,r){var t=Qt(r||{});return function kx(e,r){var t={},s=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=s;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var o=e.FullPaths?lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&"string"==typeof o){if("binary"==r.type||"base64"==r.type)return o;o=new Uint8Array(ai(o))}return r.password&&typeof encrypt_agile<"u"?bx(encrypt_agile(o,r.password),r):"file"===r.type?Zn(r.file,o):"string"==r.type?Yt(o):o}(_v(e,t),t)}(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Ex(e,r,t,s,o,f,u,p){var x=wr(t),_=p.defval,y=p.raw||!Object.prototype.hasOwnProperty.call(p,"raw"),T=!0,E=1===o?[]:{};if(1!==o)if(Object.defineProperty)try{Object.defineProperty(E,"__rowNum__",{value:t,enumerable:!1})}catch{E.__rowNum__=t}else E.__rowNum__=t;if(!u||e[t])for(var C=r.s.c;C<=r.e.c;++C){var A=u?e[t][C]:e[s[C]+x];if(void 0!==A&&void 0!==A.t){var k=A.v;switch(A.t){case"z":if(null==k)break;continue;case"e":k=0==k?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+A.t)}if(null!=f[C]){if(null==k)if("e"==A.t&&null===k)E[f[C]]=null;else if(void 0!==_)E[f[C]]=_;else{if(!y||null!==k)continue;E[f[C]]=null}else E[f[C]]=y&&("n"!==A.t||"n"===A.t&&!1!==p.rawNumbers)?k:Nn(A,k,p);null!=k&&(T=!1)}}else{if(void 0===_)continue;null!=f[C]&&(E[f[C]]=_)}}return{row:E,isempty:T}}function Uh(e,r){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},s=0,o=1,f=[],u=0,p="",x={s:{r:0,c:0},e:{r:0,c:0}},_=r||{},y=null!=_.range?_.range:e["!ref"];switch(1===_.header?s=1:"A"===_.header?s=2:Array.isArray(_.header)?s=3:null==_.header&&(s=0),typeof y){case"string":x=Ht(y);break;case"number":(x=Ht(e["!ref"])).s.r=y;break;default:x=y}s>0&&(o=0);var T=wr(x.s.r),E=[],C=[],A=0,k=0,F=Array.isArray(e),N=x.s.r,L=0,M={};F&&!e[N]&&(e[N]=[]);var q=_.skipHidden&&e["!cols"]||[],ae=_.skipHidden&&e["!rows"]||[];for(L=x.s.c;L<=x.e.c;++L)if(!(q[L]||{}).hidden)switch(E[L]=lr(L),t=F?e[N][L]:e[E[L]+T],s){case 1:f[L]=L-x.s.c;break;case 2:f[L]=E[L];break;case 3:f[L]=_.header[L-x.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),p=u=Nn(t,null,_),k=M[u]||0){do{p=u+"_"+k++}while(M[p]);M[u]=k,M[p]=1}else M[u]=1;f[L]=p}for(N=x.s.r+o;N<=x.e.r;++N)if(!(ae[N]||{}).hidden){var ve=Ex(e,x,N,E,s,f,F,_);(!1===ve.isempty||(1===s?!1!==_.blankrows:_.blankrows))&&(C[A++]=ve.row)}return C.length=A,C}var Cx=/"/g;function Sx(e,r,t,s,o,f,u,p){for(var x=!0,_=[],y="",T=wr(t),E=r.s.c;E<=r.e.c;++E)if(s[E]){var C=p.dense?(e[t]||[])[E]:e[s[E]+T];if(null==C)y="";else if(null!=C.v){x=!1,y=""+(p.rawNumbers&&"n"==C.t?C.v:Nn(C,null,p));for(var A=0,k=0;A!==y.length;++A)if((k=y.charCodeAt(A))===o||k===f||34===k||p.forceQuotes){y='"'+y.replace(Cx,'""')+'"';break}"ID"==y&&(y='"ID"')}else null==C.f||C.F?y="":(x=!1,(y="="+C.f).indexOf(",")>=0&&(y='"'+y.replace(Cx,'""')+'"'));_.push(y)}return!1===p.blankrows&&x?null:_.join(u)}function R1(e,r){var t=[],s=r??{};if(null==e||null==e["!ref"])return"";var o=Ht(e["!ref"]),f=void 0!==s.FS?s.FS:",",u=f.charCodeAt(0),p=void 0!==s.RS?s.RS:"\n",x=p.charCodeAt(0),_=new RegExp(("|"==f?"\\|":f)+"+$"),y="",T=[];s.dense=Array.isArray(e);for(var E=s.skipHidden&&e["!cols"]||[],C=s.skipHidden&&e["!rows"]||[],A=o.s.c;A<=o.e.c;++A)(E[A]||{}).hidden||(T[A]=lr(A));for(var k=0,F=o.s.r;F<=o.e.r;++F)(C[F]||{}).hidden||null!=(y=Sx(e,o,F,T,u,x,f,s))&&(s.strip&&(y=y.replace(_,"")),(y||!1!==s.blankrows)&&t.push((k++?p:"")+y));return delete s.dense,t.join("")}function Ax(e,r){r||(r={}),r.FS="\t",r.RS="\n";var t=R1(e,r);if(typeof he>"u"||"string"==r.type)return t;var s=he.utils.encode(1200,t,"str");return String.fromCharCode(255)+String.fromCharCode(254)+s}function Fx(e,r,t){var s=t||{},o=+!s.skipHeader,f=e||{},u=0,p=0;if(f&&null!=s.origin)if("number"==typeof s.origin)u=s.origin;else{var x="string"==typeof s.origin?yr(s.origin):s.origin;u=x.r,p=x.c}var _,y={s:{c:0,r:0},e:{c:p,r:u+r.length-1+o}};if(f["!ref"]){var T=Ht(f["!ref"]);y.e.c=Math.max(y.e.c,T.e.c),y.e.r=Math.max(y.e.r,T.e.r),-1==u&&(y.e.r=(u=T.e.r+1)+r.length-1+o)}else-1==u&&(u=0,y.e.r=r.length-1+o);var E=s.header||[],C=0;r.forEach(function(k,F){vr(k).forEach(function(N){-1==(C=E.indexOf(N))&&(E[C=E.length]=N);var L=k[N],M="z",q="",ae=_t({c:p+C,r:u+F+o});_=Al(f,ae),!L||"object"!=typeof L||L instanceof Date?("number"==typeof L?M="n":"boolean"==typeof L?M="b":"string"==typeof L?M="s":L instanceof Date?(M="d",s.cellDates||(M="n",L=Gr(L)),q=s.dateNF||gt[14]):null===L&&s.nullError&&(M="e",L=0),_?(_.t=M,_.v=L,delete _.w,delete _.R,q&&(_.z=q)):f[ae]=_={t:M,v:L},q&&(_.z=q)):f[ae]=L})}),y.e.c=Math.max(y.e.c,p+E.length-1);var A=wr(u);if(o)for(C=0;C<E.length;++C)f[lr(C+p)+A]={t:"s",v:E[C]};return f["!ref"]=St(y),f}function Al(e,r,t){if("string"==typeof r){if(Array.isArray(e)){var s=yr(r);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return Al(e,_t("number"!=typeof r?r:{r,c:t||0}))}function Dx(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}var Fl={encode_col:lr,encode_row:wr,encode_cell:_t,encode_range:St,decode_col:wc,decode_row:vc,split_cell:function ui(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:yr,decode_range:un,format_cell:Nn,sheet_add_aoa:o0,sheet_add_json:Fx,sheet_add_dom:cx,aoa_to_sheet:aa,json_to_sheet:function Ov(e,r){return Fx(null,e,r)},table_to_sheet:lx,table_to_book:function X_(e,r){return Mi(lx(e,r),r)},sheet_to_csv:R1,sheet_to_txt:Ax,sheet_to_json:Uh,sheet_to_html:ox,sheet_to_formulae:function Dv(e){var t,r="",s="";if(null==e||null==e["!ref"])return[];var p,o=Ht(e["!ref"]),f="",u=[],x=[],_=Array.isArray(e);for(p=o.s.c;p<=o.e.c;++p)u[p]=lr(p);for(var y=o.s.r;y<=o.e.r;++y)for(f=wr(y),p=o.s.c;p<=o.e.c;++p)if(r=u[p]+f,s="",void 0!==(t=_?(e[y]||[])[p]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;s=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)s=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)s=""+t.v;else if("b"==t.t)s=t.v?"TRUE":"FALSE";else if(void 0!==t.w)s="'"+t.w;else{if(void 0===t.v)continue;s="s"==t.t?"'"+t.v:""+t.v}}x[x.length]=r+"="+s}return x},sheet_to_row_object_array:Uh,sheet_get_cell:Al,book_new:function L1(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function N1(e,r,t,s){var o=1;if(!t)for(;o<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+o);++o,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var f=t.match(/(^.*?)(\d+)$/);o=f&&+f[2]||0;var u=f&&f[1]||t;for(++o;o<=65535&&-1!=e.SheetNames.indexOf(t=u+o);++o);}if(gn(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t},book_set_sheet_visibility:function Pv(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=function Iv(e,r){if("number"==typeof r){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(e,r);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t},cell_set_number_format:function Mv(e,r){return e.z=r,e},cell_set_hyperlink:Dx,cell_set_internal_link:function Rv(e,r,t){return Dx(e,"#"+r,t)},cell_add_comment:function Lv(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})},sheet_set_array_formula:function Nv(e,r,t,s){for(var o="string"!=typeof r?r:Ht(r),f="string"==typeof r?r:St(r),u=o.s.r;u<=o.e.r;++u)for(var p=o.s.c;p<=o.e.c;++p){var x=Al(e,u,p);x.t="n",x.F=f,delete x.v,u==o.s.r&&p==o.s.c&&(x.f=t,s&&(x.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},B1=te(5936),Vv=te(5879);let zv=(()=>{var e;class r{constructor(){}saveToFile(s,o){switch(o){case v.W.CSV:this.saveCsvFile(s);break;case v.W.XLSX:this.saveExcelFile(s);break;default:this.saveJsonFile(s)}}getExportComplect(s){return{name:s.complect.name,description:s.complect.description,groups:s.complect.groups.map(o=>({name:o.name,items:o.items.map(f=>this.getExportItem(f,s.items))}))}}getExportItem(s,o){return{id:s.itemId,count:s.count,values:o.find(f=>f.id===s.itemId)?.values?.map(f=>({id:f.id,attributes:f.attributes,name:f.name,valueType:f.valueType,value:f.value}))}}getDataArray(s){const o=[];return s.forEach(f=>{f.items.forEach(u=>{let p=[f.name];p=p.concat(u.values.map(x=>{switch(x.valueType){case B1.B.Number:case B1.B.Decimal:return x.value?+x.value:x.value;case B1.B.Date:return x.value?new Date(Date.parse(x.value)).toLocaleDateString():null;default:return x.value}})),o.push(p)})}),o}downoadFile(s){const o=document.createElement("a");o.setAttribute("href",`${s.type},${encodeURIComponent(s.data)}`),o.setAttribute("download",s.name),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}saveExcelFile(s){const o=this.getExportComplect(s),f=["Group"];o.groups[0]?.items[0]?.values.forEach(x=>{f.push(x.name)});const u=Fl.book_new(),p=Fl.json_to_sheet([]);Fl.sheet_add_aoa(p,[f]),Fl.sheet_add_aoa(p,this.getDataArray(o.groups),{origin:"A2"}),Fl.book_append_sheet(u,p,o.name),function Fv(e,r,t){var s=t||{};s.type="file",s.file=r,function M1(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(s),P1(e,s)}(u,`${o.name}.xlsx`)}saveJsonFile(s){const o=this.getExportComplect(s);this.downoadFile({data:JSON.stringify(o),name:`${o.name}.json`,type:"data:text/json;charset=utf-8"})}saveCsvFile(s){const o=this.getExportComplect(s);let f="";const u=["Group"];o.groups[0]?.items[0]?.values.forEach(x=>{u.push(x.name)}),f+=u.join(",")+"\n",this.getDataArray(o.groups).forEach(x=>{f+=x.map(_=>_||"").join(",")+"\n"}),this.downoadFile({data:f,name:`${o.name}.csv`,type:"data:text/csv;charset=utf-8"})}}return(e=r).\u0275fac=function(s){return new(s||e)},e.\u0275prov=Vv.Yz7({token:e,factory:e.\u0275fac}),r})()},1859:(Cr,Ct,te)=>{te.d(Ct,{L:()=>Te});var v=te(5619),W=te(2572),qe=te(7398),Ze=te(8180),oe=te(6452),it=te(7990),rt=te(5744),et=te(2372),ft=te(1647),pt=te(5879),mt=te(4826),at=te(9862);let Xe=(()=>{var he;class wt extends mt.q{constructor(Me){super(Me,"items")}getAll(){return this.http.get(`${this.rootUrl}getall`)}add(Me){return this.http.post(`${this.rootUrl}add`,Me)}edit(Me){return this.http.put(`${this.rootUrl}edit`,Me)}delete(Me){const ot=(new at.LE).set("id",Me);return this.http.delete(`${this.rootUrl}delete`,{params:ot})}}return(he=wt).\u0275fac=function(Me){return new(Me||he)(pt.LFG(at.eN))},he.\u0275prov=pt.Yz7({token:he,factory:he.\u0275fac,providedIn:"root"}),wt})(),Se=(()=>{var he;class wt extends mt.q{constructor(Me){super(Me,"properties")}getAll(){return this.http.get(`${this.rootUrl}getall`)}updateParam(Me){return this.http.put(`${this.rootUrl}updateParam`,Me)}updateParams(Me){return this.http.put(`${this.rootUrl}updateParams`,Me)}}return(he=wt).\u0275fac=function(Me){return new(Me||he)(pt.LFG(at.eN))},he.\u0275prov=pt.Yz7({token:he,factory:he.\u0275fac,providedIn:"root"}),wt})();var se=te(6719);let Te=(()=>{var he;class wt extends rt.B{constructor(Me,ot,Pt){super(Pt),this.itemsHttp=Me,this.propertiesHttp=ot,this.itemsSource=new v.X([]),this.items$=this.itemsSource.asObservable(),this.propertiesSource=new v.X([]),this.properties$=this.propertiesSource.asObservable(),this.itemObjects$=(0,W.a)({properties:this.properties$,items:this.items$}).pipe((0,qe.U)(Kt=>Kt.items.map(xt=>ft.O.getItem(xt,Kt.properties)))),this.init()}cleanData(){localStorage.removeItem("items"),this.itemsSource.next([])}mergeData(){this.loadProperties().subscribe(Me=>{this.loadItems().subscribe(ot=>{})})}loadAll(){this.loadProperties().subscribe(Me=>{if(this.userId)this.loadItems().subscribe(ot=>{});else{const ot=localStorage.getItem("items");if(ot){const Pt=JSON.parse(ot);this.itemsSource.next(Pt)}}this.items$.subscribe(ot=>{localStorage.setItem("items",JSON.stringify(ot))})})}loadProperties(){return this.propertiesHttp.getAll().pipe((0,qe.U)(Me=>{const ot=Me??[];return this.propertiesSource.next(ot),ot}))}loadItems(){return this.itemsHttp.getAll().pipe((0,qe.U)(Me=>{const ot=Me??[];return this.itemsSource.next(ot),ot}))}createNewItem(){const Me=new oe.c;return Me.values=(this.propertiesSource.getValue()??[]).map(ot=>Object.assign(new it.Z,ot)),Me}saveItem(Me){return Me.id?this.updateItem(Me):this.addItem(Me)}addItem(Me){const ot={id:(0,et.Z)(),values:Me.values.map(Pt=>({propertyId:Pt.id,value:Pt.value}))};return this.items$.pipe((0,Ze.q)(1)).subscribe(Pt=>{Pt.push(ot),this.itemsSource.next(Pt)}),this.execAuthorisedHttp(this.itemsHttp.add(ot)),ot}updateItem(Me){const ot={id:Me.id,values:Me.values.map(Pt=>({propertyId:Pt.id,value:Pt.value}))};return this.items$.pipe((0,Ze.q)(1)).subscribe(Pt=>{var Kt=Pt.findIndex(xt=>xt.id===ot.id);Pt[Kt]=ot,this.itemsSource.next(Pt)}),this.execAuthorisedHttp(this.itemsHttp.edit(ot)),ot}deleteItem(Me){return this.items$.pipe((0,Ze.q)(1)).subscribe(ot=>{const Pt=ot.filter(Kt=>Kt.id!==Me);this.itemsSource.next(Pt)}),this.execAuthorisedHttp(this.itemsHttp.delete(Me)),!0}updatePropertyParam(Me){this.resetPropertyParams([Me]),this.execAuthorisedHttp(this.propertiesHttp.updateParam(Me))}updatePropertyParams(Me){this.resetPropertyParams(Me),this.execAuthorisedHttp(this.propertiesHttp.updateParams(Me))}resetPropertyParams(Me){this.properties$.pipe((0,Ze.q)(1)).subscribe(ot=>{Me.forEach(Pt=>{const Kt=ot.find(xt=>xt.id===Pt.propertyId);Kt&&(Kt.params=Pt)}),this.propertiesSource.next(ot)})}}return(he=wt).\u0275fac=function(Me){return new(Me||he)(pt.LFG(Xe),pt.LFG(Se),pt.LFG(se.B))},he.\u0275prov=pt.Yz7({token:he,factory:he.\u0275fac}),wt})()},2372:(Cr,Ct,te)=>{te.d(Ct,{Z:()=>at});var v,W=new Uint8Array(16);function qe(){if(!v&&!(v=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(W)}const Ze=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var rt=[],et=0;et<256;++et)rt.push((et+256).toString(16).substr(1));const pt=function ft(Xe){var Se=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,se=(rt[Xe[Se+0]]+rt[Xe[Se+1]]+rt[Xe[Se+2]]+rt[Xe[Se+3]]+"-"+rt[Xe[Se+4]]+rt[Xe[Se+5]]+"-"+rt[Xe[Se+6]]+rt[Xe[Se+7]]+"-"+rt[Xe[Se+8]]+rt[Xe[Se+9]]+"-"+rt[Xe[Se+10]]+rt[Xe[Se+11]]+rt[Xe[Se+12]]+rt[Xe[Se+13]]+rt[Xe[Se+14]]+rt[Xe[Se+15]]).toLowerCase();if(!function oe(Xe){return"string"==typeof Xe&&Ze.test(Xe)}(se))throw TypeError("Stringified UUID is invalid");return se},at=function mt(Xe,Se,se){var Te=(Xe=Xe||{}).random||(Xe.rng||qe)();if(Te[6]=15&Te[6]|64,Te[8]=63&Te[8]|128,Se){se=se||0;for(var he=0;he<16;++he)Se[se+he]=Te[he];return Se}return pt(Te)}},9886:(Cr,Ct,te)=>{te.d(Ct,{jh:()=>g1,vQ:()=>v1});var v=te(5879);function W(i){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(i)}function oe(i,a,n){return(a=function Ze(i){var a=function qe(i,a){if("object"!==W(i)||null===i)return i;var n=i[Symbol.toPrimitive];if(void 0!==n){var c=n.call(i,a||"default");if("object"!==W(c))return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(i)}(i,"string");return"symbol"===W(a)?a:String(a)}(a))in i?Object.defineProperty(i,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[a]=n,i}function it(i){return i+.5|0}const rt=(i,a,n)=>Math.max(Math.min(i,n),a);function et(i){return rt(it(2.55*i),0,255)}function pt(i){return rt(it(255*i),0,255)}function mt(i){return rt(it(i/2.55)/100,0,1)}function at(i){return rt(it(100*i),0,100)}const Xe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Se=[..."0123456789ABCDEF"],se=i=>Se[15&i],Te=i=>Se[(240&i)>>4]+Se[15&i],he=i=>(240&i)>>4==(15&i);const Pt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Kt(i,a,n){const c=a*Math.min(n,1-n),l=(h,d=(h+i/30)%12)=>n-c*Math.max(Math.min(d-3,9-d,1),-1);return[l(0),l(8),l(4)]}function xt(i,a,n){const c=(l,h=(l+i/60)%6)=>n-n*a*Math.max(Math.min(h,4-h,1),0);return[c(5),c(3),c(1)]}function _n(i,a,n){const c=Kt(i,1,.5);let l;for(a+n>1&&(l=1/(a+n),a*=l,n*=l),l=0;l<3;l++)c[l]*=1-a-n,c[l]+=a;return c}function On(i){const n=i.r/255,c=i.g/255,l=i.b/255,h=Math.max(n,c,l),d=Math.min(n,c,l),m=(h+d)/2;let g,w,b;return h!==d&&(b=h-d,w=m>.5?b/(2-h-d):b/(h+d),g=function $n(i,a,n,c,l){return i===l?(a-n)/c+(a<n?6:0):a===l?(n-i)/c+2:(i-a)/c+4}(n,c,l,b,h),g=60*g+.5),[0|g,w||0,m]}function Ur(i,a,n,c){return(Array.isArray(a)?i(a[0],a[1],a[2]):i(a,n,c)).map(pt)}function ai(i,a,n){return Ur(Kt,i,a,n)}function jn(i){return(i%360+360)%360}const si={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Gn={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let ki;const Qo=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Xn=i=>i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055,In=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function Ti(i,a,n){if(i){let c=On(i);c[a]=Math.max(0,Math.min(c[a]+c[a]*n,0===a?360:1)),c=ai(c),i.r=c[0],i.g=c[1],i.b=c[2]}}function Zs(i,a){return i&&Object.assign(a||{},i)}function gt(i){var a={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(a={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(a.a=pt(i[3]))):(a=Zs(i,{r:0,g:0,b:0,a:1})).a=pt(a.a),a}function Ks(i){return"r"===i.charAt(0)?function qo(i){const a=Qo.exec(i);let c,l,h,n=255;if(a){if(a[7]!==c){const d=+a[7];n=a[8]?et(d):rt(255*d,0,255)}return c=+a[1],l=+a[3],h=+a[5],c=255&(a[2]?et(c):rt(c,0,255)),l=255&(a[4]?et(l):rt(l,0,255)),h=255&(a[6]?et(h):rt(h,0,255)),{r:c,g:l,b:h,a:n}}}(i):function br(i){const a=Pt.exec(i);let c,n=255;if(!a)return;a[5]!==c&&(n=a[6]?et(+a[5]):pt(+a[5]));const l=jn(+a[2]),h=+a[3]/100,d=+a[4]/100;return c="hwb"===a[1]?function Sr(i,a,n){return Ur(_n,i,a,n)}(l,h,d):"hsv"===a[1]?function Yi(i,a,n){return Ur(xt,i,a,n)}(l,h,d):ai(l,h,d),{r:c[0],g:c[1],b:c[2],a:n}}(i)}class Ei{constructor(a){if(a instanceof Ei)return a;const n=typeof a;let c;"object"===n?c=gt(a):"string"===n&&(c=function Ne(i){var n,a=i.length;return"#"===i[0]&&(4===a||5===a?n={r:255&17*Xe[i[1]],g:255&17*Xe[i[2]],b:255&17*Xe[i[3]],a:5===a?17*Xe[i[4]]:255}:(7===a||9===a)&&(n={r:Xe[i[1]]<<4|Xe[i[2]],g:Xe[i[3]]<<4|Xe[i[4]],b:Xe[i[5]]<<4|Xe[i[6]],a:9===a?Xe[i[7]]<<4|Xe[i[8]]:255})),n}(a)||function ya(i){ki||(ki=function vn(){const i={},a=Object.keys(Gn),n=Object.keys(si);let c,l,h,d,m;for(c=0;c<a.length;c++){for(d=m=a[c],l=0;l<n.length;l++)h=n[l],m=m.replace(h,si[h]);h=parseInt(Gn[d],16),i[m]=[h>>16&255,h>>8&255,255&h]}return i}(),ki.transparent=[0,0,0,0]);const a=ki[i.toLowerCase()];return a&&{r:a[0],g:a[1],b:a[2],a:4===a.length?a[3]:255}}(a)||Ks(a)),this._rgb=c,this._valid=!!c}get valid(){return this._valid}get rgb(){var a=Zs(this._rgb);return a&&(a.a=mt(a.a)),a}set rgb(a){this._rgb=gt(a)}rgbString(){return this._valid?function Xs(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${mt(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}(this._rgb):void 0}hexString(){return this._valid?function ot(i){var a=(i=>he(i.r)&&he(i.g)&&he(i.b)&&he(i.a))(i)?se:Te;return i?"#"+a(i.r)+a(i.g)+a(i.b)+((i,a)=>i<255?a(i):"")(i.a,a):void 0}(this._rgb):void 0}hslString(){return this._valid?function Hr(i){if(!i)return;const a=On(i),n=a[0],c=at(a[1]),l=at(a[2]);return i.a<255?`hsla(${n}, ${c}%, ${l}%, ${mt(i.a)})`:`hsl(${n}, ${c}%, ${l}%)`}(this._rgb):void 0}mix(a,n){if(a){const c=this.rgb,l=a.rgb;let h;const d=n===h?.5:n,m=2*d-1,g=c.a-l.a,w=((m*g==-1?m:(m+g)/(1+m*g))+1)/2;h=1-w,c.r=255&w*c.r+h*l.r+.5,c.g=255&w*c.g+h*l.g+.5,c.b=255&w*c.b+h*l.b+.5,c.a=d*c.a+(1-d)*l.a,this.rgb=c}return this}interpolate(a,n){return a&&(this._rgb=function Ys(i,a,n){const c=In(mt(i.r)),l=In(mt(i.g)),h=In(mt(i.b));return{r:pt(Xn(c+n*(In(mt(a.r))-c))),g:pt(Xn(l+n*(In(mt(a.g))-l))),b:pt(Xn(h+n*(In(mt(a.b))-h))),a:i.a+n*(a.a-i.a)}}(this._rgb,a._rgb,n)),this}clone(){return new Ei(this.rgb)}alpha(a){return this._rgb.a=pt(a),this}clearer(a){return this._rgb.a*=1-a,this}greyscale(){const a=this._rgb,n=it(.3*a.r+.59*a.g+.11*a.b);return a.r=a.g=a.b=n,this}opaquer(a){return this._rgb.a*=1+a,this}negate(){const a=this._rgb;return a.r=255-a.r,a.g=255-a.g,a.b=255-a.b,this}lighten(a){return Ti(this._rgb,2,a),this}darken(a){return Ti(this._rgb,2,-a),this}saturate(a){return Ti(this._rgb,1,a),this}desaturate(a){return Ti(this._rgb,1,-a),this}rotate(a){return function Gs(i,a){var n=On(i);n[0]=jn(n[0]+a),n=ai(n),i.r=n[0],i.g=n[1],i.b=n[2]}(this._rgb,a),this}}function Wr(){}const Js=(()=>{let i=0;return()=>i++})();function Ut(i){return null===i||typeof i>"u"}function tr(i){if(Array.isArray&&Array.isArray(i))return!0;const a=Object.prototype.toString.call(i);return"[object"===a.slice(0,7)&&"Array]"===a.slice(-6)}function Mt(i){return null!==i&&"[object Object]"===Object.prototype.toString.call(i)}function sr(i){return("number"==typeof i||i instanceof Number)&&isFinite(+i)}function ln(i,a){return sr(i)?i:a}function Tt(i,a){return typeof i>"u"?a:i}const Ci=(i,a)=>"string"==typeof i&&i.endsWith("%")?parseFloat(i)/100*a:+i;function $t(i,a,n){if(i&&"function"==typeof i.call)return i.apply(n,a)}function Gt(i,a,n,c){let l,h,d;if(tr(i))if(h=i.length,c)for(l=h-1;l>=0;l--)a.call(n,i[l],l);else for(l=0;l<h;l++)a.call(n,i[l],l);else if(Mt(i))for(d=Object.keys(i),h=d.length,l=0;l<h;l++)a.call(n,i[d[l]],d[l])}function ba(i,a){let n,c,l,h;if(!i||!a||i.length!==a.length)return!1;for(n=0,c=i.length;n<c;++n)if(l=i[n],h=a[n],l.datasetIndex!==h.datasetIndex||l.index!==h.index)return!1;return!0}function wn(i){if(tr(i))return i.map(wn);if(Mt(i)){const a=Object.create(null),n=Object.keys(i),c=n.length;let l=0;for(;l<c;++l)a[n[l]]=wn(i[n[l]]);return a}return i}function rs(i){return-1===["__proto__","prototype","constructor"].indexOf(i)}function tc(i,a,n,c){if(!rs(i))return;const l=a[i],h=n[i];Mt(l)&&Mt(h)?Zi(l,h,c):a[i]=wn(h)}function Zi(i,a,n){const c=tr(a)?a:[a],l=c.length;if(!Mt(i))return i;const h=(n=n||{}).merger||tc;let d;for(let m=0;m<l;++m){if(d=c[m],!Mt(d))continue;const g=Object.keys(d);for(let w=0,b=g.length;w<b;++w)h(g[w],i,d,n)}return i}function Si(i,a){return Zi(i,a,{merger:Qs})}function Qs(i,a,n){if(!rs(i))return;const c=a[i],l=n[i];Mt(c)&&Mt(l)?Si(c,l):Object.prototype.hasOwnProperty.call(a,i)||(a[i]=wn(l))}const qs={"":i=>i,x:i=>i.x,y:i=>i.y};function Pn(i,a){return(qs[a]||(qs[a]=function to(i){const a=function eo(i){const a=i.split("."),n=[];let c="";for(const l of a)c+=l,c.endsWith("\\")?c=c.slice(0,-1)+".":(n.push(c),c="");return n}(i);return n=>{for(const c of a){if(""===c)break;n=n&&n[c]}return n}}(a)))(i)}function Ir(i){return i.charAt(0).toUpperCase()+i.slice(1)}const Ai=i=>typeof i<"u",Mn=i=>"function"==typeof i,ro=(i,a)=>{if(i.size!==a.size)return!1;for(const n of i)if(!a.has(n))return!1;return!0},Rt=Math.PI,rr=2*Rt,nc=rr+Rt,Ki=Number.POSITIVE_INFINITY,Cn=Rt/180,Xt=Rt/2,oi=Rt/4,ns=2*Rt/3,ce=Math.log10,Ye=Math.sign;function le(i,a,n){return Math.abs(i-a)<n}function Y(i){const a=Math.round(i);i=le(i,a,i/1e3)?a:i;const n=Math.pow(10,Math.floor(ce(i))),c=i/n;return(c<=1?1:c<=2?2:c<=5?5:10)*n}function ne(i){return!isNaN(parseFloat(i))&&isFinite(i)}function Be(i,a,n){let c,l,h;for(c=0,l=i.length;c<l;c++)h=i[c][n],isNaN(h)||(a.min=Math.min(a.min,h),a.max=Math.max(a.max,h))}function Qe(i){return i*(Rt/180)}function yt(i){return i*(180/Rt)}function xr(i){if(!sr(i))return;let a=1,n=0;for(;Math.round(i*a)/a!==i;)a*=10,n++;return n}function kr(i,a){const n=a.x-i.x,c=a.y-i.y,l=Math.sqrt(n*n+c*c);let h=Math.atan2(c,n);return h<-.5*Rt&&(h+=rr),{angle:h,distance:l}}function fn(i,a){return Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2))}function Yn(i,a){return(i-a+nc)%rr-Rt}function Pr(i){return(i%rr+rr)%rr}function lt(i,a,n,c){const l=Pr(i),h=Pr(a),d=Pr(n),m=Pr(h-l),g=Pr(d-l),w=Pr(l-h),b=Pr(l-d);return l===h||l===d||c&&h===d||m>g&&w<b}function nr(i,a,n){return Math.max(a,Math.min(n,i))}function Rn(i,a,n,c=1e-6){return i>=Math.min(a,n)-c&&i<=Math.max(a,n)+c}function Zn(i,a,n){n=n||(d=>i[d]<a);let h,c=i.length-1,l=0;for(;c-l>1;)h=l+c>>1,n(h)?l=h:c=h;return{lo:l,hi:c}}const ci=(i,a,n,c)=>Zn(i,n,c?l=>{const h=i[l][a];return h<n||h===n&&i[l+1][a]===n}:l=>i[l][a]<n),vr=(i,a,n)=>Zn(i,n,c=>i[c][a]>=n),is=["push","pop","shift","splice","unshift"];function Ll(i,a){const n=i._chartjs;if(!n)return;const c=n.listeners,l=c.indexOf(a);-1!==l&&c.splice(l,1),!(c.length>0)&&(is.forEach(h=>{delete i[h]}),delete i._chartjs)}function as(i){const a=new Set(i);return a.size===i.length?i:Array.from(a)}const ic=typeof window>"u"?function(i){return i()}:window.requestAnimationFrame;function Nl(i,a){let n=[],c=!1;return function(...l){n=l,c||(c=!0,ic.call(window,()=>{c=!1,i.apply(a,n)}))}}const ss=i=>"start"===i?"left":"end"===i?"right":"center",rn=(i,a,n)=>"start"===i?a:"end"===i?n:(a+n)/2;function ac(i,a,n){const c=a.length;let l=0,h=c;if(i._sorted){const{iScale:d,_parsed:m}=i,g=d.axis,{min:w,max:b,minDefined:S,maxDefined:O}=d.getUserBounds();S&&(l=nr(Math.min(ci(m,g,w).lo,n?c:ci(a,g,d.getPixelForValue(w)).lo),0,c-1)),h=O?nr(Math.max(ci(m,d.axis,b,!0).hi+1,n?0:ci(a,g,d.getPixelForValue(b),!0).hi+1),l,c)-l:c-l}return{start:l,count:h}}function Hl(i){const{xScale:a,yScale:n,_scaleRanges:c}=i,l={xmin:a.min,xmax:a.max,ymin:n.min,ymax:n.max};if(!c)return i._scaleRanges=l,!0;const h=c.xmin!==a.min||c.xmax!==a.max||c.ymin!==n.min||c.ymax!==n.max;return Object.assign(c,l),h}const or=i=>0===i||1===i,Fi=(i,a,n)=>-Math.pow(2,10*(i-=1))*Math.sin((i-a)*rr/n),Qt=(i,a,n)=>Math.pow(2,-10*i)*Math.sin((i-a)*rr/n)+1,cr={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>1-Math.cos(i*Xt),easeOutSine:i=>Math.sin(i*Xt),easeInOutSine:i=>-.5*(Math.cos(Rt*i)-1),easeInExpo:i=>0===i?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>1===i?1:1-Math.pow(2,-10*i),easeInOutExpo:i=>or(i)?i:i<.5?.5*Math.pow(2,10*(2*i-1)):.5*(2-Math.pow(2,-10*(2*i-1))),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>or(i)?i:Fi(i,.075,.3),easeOutElastic:i=>or(i)?i:Qt(i,.075,.3),easeInOutElastic:i=>or(i)?i:i<.5?.5*Fi(2*i,.1125,.45):.5+.5*Qt(2*i-1,.1125,.45),easeInBack:i=>i*i*(2.70158*i-1.70158),easeOutBack:i=>(i-=1)*i*(2.70158*i+1.70158)+1,easeInOutBack(i){let a=1.70158;return(i/=.5)<1?i*i*((1+(a*=1.525))*i-a)*.5:.5*((i-=2)*i*((1+(a*=1.525))*i+a)+2)},easeInBounce:i=>1-cr.easeOutBounce(1-i),easeOutBounce:i=>i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375,easeInOutBounce:i=>i<.5?.5*cr.easeInBounce(2*i):.5*cr.easeOutBounce(2*i-1)+.5};function yn(i){if(i&&"object"==typeof i){const a=i.toString();return"[object CanvasPattern]"===a||"[object CanvasGradient]"===a}return!1}function Wl(i){return yn(i)?i:new Ei(i)}function Di(i){return yn(i)?i:new Ei(i).saturate(.5).darken(.1).hexString()}const Vh=["x","y","borderWidth","radius","tension"],Vl=["color","borderColor","backgroundColor"],bn=new Map;function dr(i,a,n){return function sc(i,a){a=a||{};const n=i+JSON.stringify(a);let c=bn.get(n);return c||(c=new Intl.NumberFormat(i,a),bn.set(n,c)),c}(a,n).format(i)}const pn={values:i=>tr(i)?i:""+i,numeric(i,a,n){if(0===i)return"0";const c=this.chart.options.locale;let l,h=i;if(n.length>1){const w=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(w<1e-4||w>1e15)&&(l="scientific"),h=function $l(i,a){let n=a.length>3?a[2].value-a[1].value:a[1].value-a[0].value;return Math.abs(n)>=1&&i!==Math.floor(i)&&(n=i-Math.floor(i)),n}(i,n)}const d=ce(Math.abs(h)),m=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),g={notation:l,minimumFractionDigits:m,maximumFractionDigits:m};return Object.assign(g,this.options.ticks.format),dr(i,c,g)},logarithmic(i,a,n){if(0===i)return"0";const c=n[a].significand||i/Math.pow(10,Math.floor(ce(i)));return[1,2,3,5,10,15].includes(c)||a>.8*n.length?pn.numeric.call(this,i,a,n):""}};var os={formatters:pn};const li=Object.create(null),io=Object.create(null);function fi(i,a){if(!a)return i;const n=a.split(".");for(let c=0,l=n.length;c<l;++c){const h=n[c];i=i[h]||(i[h]=Object.create(null))}return i}function pr(i,a,n){return"string"==typeof a?Zi(fi(i,a),n):Zi(fi(i,""),a)}class $h{constructor(a,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=c=>c.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(c,l)=>Di(l.backgroundColor),this.hoverBorderColor=(c,l)=>Di(l.borderColor),this.hoverColor=(c,l)=>Di(l.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(a),this.apply(n)}set(a,n){return pr(this,a,n)}get(a){return fi(this,a)}describe(a,n){return pr(io,a,n)}override(a,n){return pr(li,a,n)}route(a,n,c,l){const h=fi(this,a),d=fi(this,c),m="_"+n;Object.defineProperties(h,{[m]:{value:h[n],writable:!0},[n]:{enumerable:!0,get(){const g=this[m],w=d[l];return Mt(g)?Object.assign({},w,g):Tt(g,w)},set(g){this[m]=g}}})}apply(a){a.forEach(n=>n(this))}}var mr=new $h({_scriptable:i=>!i.startsWith("on"),_indexable:i=>"events"!==i,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function zl(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:a=>"onProgress"!==a&&"onComplete"!==a&&"fn"!==a}),i.set("animations",{colors:{type:"color",properties:Vl},numbers:{type:"number",properties:Vh}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:a=>0|a}}}})},function zh(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function Ot(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(a,n)=>n.lineWidth,tickColor:(a,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:os.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:a=>!a.startsWith("before")&&!a.startsWith("after")&&"callback"!==a&&"parser"!==a,_indexable:a=>"borderDash"!==a&&"tickBorderDash"!==a&&"dash"!==a}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:a=>"backdropPadding"!==a&&"callback"!==a,_indexable:a=>"backdropPadding"!==a})}]);function Mr(i,a,n,c,l){let h=a[l];return h||(h=a[l]=i.measureText(l).width,n.push(l)),h>c&&(c=h),c}function Gh(i,a,n,c){let l=(c=c||{}).data=c.data||{},h=c.garbageCollect=c.garbageCollect||[];c.font!==a&&(l=c.data={},h=c.garbageCollect=[],c.font=a),i.save(),i.font=a;let d=0;const m=n.length;let g,w,b,S,O;for(g=0;g<m;g++)if(S=n[g],null==S||tr(S)){if(tr(S))for(w=0,b=S.length;w<b;w++)O=S[w],null!=O&&!tr(O)&&(d=Mr(i,l,h,d,O))}else d=Mr(i,l,h,d,S);i.restore();const I=h.length/2;if(I>n.length){for(g=0;g<I;g++)delete l[h[g]];h.splice(0,I)}return d}function Ji(i,a,n){const c=i.currentDevicePixelRatio,l=0!==n?Math.max(n/2,.5):0;return Math.round((a-l)*c)/c+l}function Et(i,a){(a=a||i.getContext("2d")).save(),a.resetTransform(),a.clearRect(0,0,i.width,i.height),a.restore()}function Sn(i,a,n,c){jl(i,a,n,c,null)}function jl(i,a,n,c,l){let h,d,m,g,w,b,S,O;const I=a.pointStyle,V=a.rotation,X=a.radius;let K=(V||0)*Cn;if(I&&"object"==typeof I&&(h=I.toString(),"[object HTMLImageElement]"===h||"[object HTMLCanvasElement]"===h))return i.save(),i.translate(n,c),i.rotate(K),i.drawImage(I,-I.width/2,-I.height/2,I.width,I.height),void i.restore();if(!(isNaN(X)||X<=0)){switch(i.beginPath(),I){default:l?i.ellipse(n,c,l/2,X,0,0,rr):i.arc(n,c,X,0,rr),i.closePath();break;case"triangle":b=l?l/2:X,i.moveTo(n+Math.sin(K)*b,c-Math.cos(K)*X),K+=ns,i.lineTo(n+Math.sin(K)*b,c-Math.cos(K)*X),K+=ns,i.lineTo(n+Math.sin(K)*b,c-Math.cos(K)*X),i.closePath();break;case"rectRounded":w=.516*X,g=X-w,d=Math.cos(K+oi)*g,S=Math.cos(K+oi)*(l?l/2-w:g),m=Math.sin(K+oi)*g,O=Math.sin(K+oi)*(l?l/2-w:g),i.arc(n-S,c-m,w,K-Rt,K-Xt),i.arc(n+O,c-d,w,K-Xt,K),i.arc(n+S,c+m,w,K,K+Xt),i.arc(n-O,c+d,w,K+Xt,K+Rt),i.closePath();break;case"rect":if(!V){g=Math.SQRT1_2*X,b=l?l/2:g,i.rect(n-b,c-g,2*b,2*g);break}K+=oi;case"rectRot":S=Math.cos(K)*(l?l/2:X),d=Math.cos(K)*X,m=Math.sin(K)*X,O=Math.sin(K)*(l?l/2:X),i.moveTo(n-S,c-m),i.lineTo(n+O,c-d),i.lineTo(n+S,c+m),i.lineTo(n-O,c+d),i.closePath();break;case"crossRot":K+=oi;case"cross":S=Math.cos(K)*(l?l/2:X),d=Math.cos(K)*X,m=Math.sin(K)*X,O=Math.sin(K)*(l?l/2:X),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d);break;case"star":S=Math.cos(K)*(l?l/2:X),d=Math.cos(K)*X,m=Math.sin(K)*X,O=Math.sin(K)*(l?l/2:X),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d),K+=oi,S=Math.cos(K)*(l?l/2:X),d=Math.cos(K)*X,m=Math.sin(K)*X,O=Math.sin(K)*(l?l/2:X),i.moveTo(n-S,c-m),i.lineTo(n+S,c+m),i.moveTo(n+O,c-d),i.lineTo(n-O,c+d);break;case"line":d=l?l/2:Math.cos(K)*X,m=Math.sin(K)*X,i.moveTo(n-d,c-m),i.lineTo(n+d,c+m);break;case"dash":i.moveTo(n,c),i.lineTo(n+Math.cos(K)*(l?l/2:X),c+Math.sin(K)*X);break;case!1:i.closePath()}i.fill(),a.borderWidth>0&&i.stroke()}}function Ln(i,a,n){return n=n||.5,!a||i&&i.x>a.left-n&&i.x<a.right+n&&i.y>a.top-n&&i.y<a.bottom+n}function jt(i,a){i.save(),i.beginPath(),i.rect(a.left,a.top,a.right-a.left,a.bottom-a.top),i.clip()}function Ta(i){i.restore()}function Xh(i,a,n,c,l){if(!a)return i.lineTo(n.x,n.y);if("middle"===l){const h=(a.x+n.x)/2;i.lineTo(h,a.y),i.lineTo(h,n.y)}else"after"===l!=!!c?i.lineTo(a.x,n.y):i.lineTo(n.x,a.y);i.lineTo(n.x,n.y)}function Jt(i,a,n,c){if(!a)return i.lineTo(n.x,n.y);i.bezierCurveTo(c?a.cp1x:a.cp2x,c?a.cp1y:a.cp2y,c?n.cp2x:n.cp1x,c?n.cp2y:n.cp1y,n.x,n.y)}function Xl(i,a,n,c,l){if(l.strikethrough||l.underline){const h=i.measureText(c),d=a-h.actualBoundingBoxLeft,m=a+h.actualBoundingBoxRight,w=n+h.actualBoundingBoxDescent,b=l.strikethrough?(n-h.actualBoundingBoxAscent+w)/2:w;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=l.decorationWidth||2,i.moveTo(d,b),i.lineTo(m,b),i.stroke()}}function Yl(i,a){const n=i.fillStyle;i.fillStyle=a.color,i.fillRect(a.left,a.top,a.width,a.height),i.fillStyle=n}function Qi(i,a,n,c,l,h={}){const d=tr(a)?a:[a],m=h.strokeWidth>0&&""!==h.strokeColor;let g,w;for(i.save(),i.font=l.string,function Gl(i,a){a.translation&&i.translate(a.translation[0],a.translation[1]),Ut(a.rotation)||i.rotate(a.rotation),a.color&&(i.fillStyle=a.color),a.textAlign&&(i.textAlign=a.textAlign),a.textBaseline&&(i.textBaseline=a.textBaseline)}(i,h),g=0;g<d.length;++g)w=d[g],h.backdrop&&Yl(i,h.backdrop),m&&(h.strokeColor&&(i.strokeStyle=h.strokeColor),Ut(h.strokeWidth)||(i.lineWidth=h.strokeWidth),i.strokeText(w,n,c,h.maxWidth)),i.fillText(w,n,c,h.maxWidth),Xl(i,n,c,w,h),c+=Number(l.lineHeight);i.restore()}function Ea(i,a){const{x:n,y:c,w:l,h,radius:d}=a;i.arc(n+d.topLeft,c+d.topLeft,d.topLeft,1.5*Rt,Rt,!0),i.lineTo(n,c+h-d.bottomLeft),i.arc(n+d.bottomLeft,c+h-d.bottomLeft,d.bottomLeft,Rt,Xt,!0),i.lineTo(n+l-d.bottomRight,c+h),i.arc(n+l-d.bottomRight,c+h-d.bottomRight,d.bottomRight,Xt,0,!0),i.lineTo(n+l,c+d.topRight),i.arc(n+l-d.topRight,c+d.topRight,d.topRight,0,-Xt,!0),i.lineTo(n+d.topLeft,c)}const Yh=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,gr=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function oc(i,a){const n=(""+i).match(Yh);if(!n||"normal"===n[1])return 1.2*a;switch(i=+n[2],n[3]){case"px":return i;case"%":i/=100}return a*i}const Zl=i=>+i||0;function ao(i,a){const n={},c=Mt(a),l=c?Object.keys(a):a,h=Mt(i)?c?d=>Tt(i[d],i[a[d]]):d=>i[d]:()=>i;for(const d of l)n[d]=Zl(h(d));return n}function cs(i){return ao(i,{top:"y",right:"x",bottom:"y",left:"x"})}function Yt(i){return ao(i,["topLeft","topRight","bottomLeft","bottomRight"])}function fr(i){const a=cs(i);return a.width=a.left+a.right,a.height=a.top+a.bottom,a}function Rr(i,a){let n=Tt((i=i||{}).size,(a=a||mr.font).size);"string"==typeof n&&(n=parseInt(n,10));let c=Tt(i.style,a.style);c&&!(""+c).match(gr)&&(console.warn('Invalid font style specified: "'+c+'"'),c=void 0);const l={family:Tt(i.family,a.family),lineHeight:oc(Tt(i.lineHeight,a.lineHeight),n),size:n,style:c,weight:Tt(i.weight,a.weight),string:""};return l.string=function jh(i){return!i||Ut(i.size)||Ut(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}(l),l}function Ca(i,a,n,c){let h,d,m,l=!0;for(h=0,d=i.length;h<d;++h)if(m=i[h],void 0!==m&&(void 0!==a&&"function"==typeof m&&(m=m(a),l=!1),void 0!==n&&tr(m)&&(m=m[n%m.length],l=!1),void 0!==m))return c&&!l&&(c.cacheable=!1),m}function Oi(i,a){return Object.assign(Object.create(i),a)}function cc(i,a=[""],n,c,l=(()=>i[0])){const h=n||i;typeof c>"u"&&(c=uc("_fallback",i));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:h,_fallback:c,_getTarget:l,override:m=>cc([m,...i],a,h,c)};return new Proxy(d,{deleteProperty:(m,g)=>(delete m[g],delete m._keys,delete i[0][g],!0),get:(m,g)=>Le(m,g,()=>function Jl(i,a,n,c){let l;for(const h of a)if(l=uc(Xr(h,i),n),typeof l<"u")return ea(i,l)?hn(n,c,i,l):l}(g,a,i,m)),getOwnPropertyDescriptor:(m,g)=>Reflect.getOwnPropertyDescriptor(m._scopes[0],g),getPrototypeOf:()=>Reflect.getPrototypeOf(i[0]),has:(m,g)=>dc(m).includes(g),ownKeys:m=>dc(m),set(m,g,w){const b=m._storage||(m._storage=l());return m[g]=b[g]=w,delete m._keys,!0}})}function qi(i,a,n,c){const l={_cacheable:!1,_proxy:i,_context:a,_subProxy:n,_stack:new Set,_descriptors:lc(i,c),setContext:h=>qi(i,h,n,c),override:h=>qi(i.override(h),a,n,c)};return new Proxy(l,{deleteProperty:(h,d)=>(delete h[d],delete i[d],!0),get:(h,d,m)=>Le(h,d,()=>function fc(i,a,n){const{_proxy:c,_context:l,_subProxy:h,_descriptors:d}=i;let m=c[a];return Mn(m)&&d.isScriptable(a)&&(m=function Kh(i,a,n,c){const{_proxy:l,_context:h,_subProxy:d,_stack:m}=n;if(m.has(i))throw new Error("Recursion detected: "+Array.from(m).join("->")+"->"+i);m.add(i);let g=a(h,d||c);return m.delete(i),ea(i,g)&&(g=hn(l._scopes,l,i,g)),g}(a,m,i,n)),tr(m)&&m.length&&(m=function hc(i,a,n,c){const{_proxy:l,_context:h,_subProxy:d,_descriptors:m}=n;if(typeof h.index<"u"&&c(i))return a[h.index%a.length];if(Mt(a[0])){const g=a,w=l._scopes.filter(b=>b!==g);a=[];for(const b of g){const S=hn(w,l,i,b);a.push(qi(S,h,d&&d[i],m))}}return a}(a,m,i,d.isIndexable)),ea(a,m)&&(m=qi(m,l,h&&h[a],d)),m}(h,d,m)),getOwnPropertyDescriptor:(h,d)=>h._descriptors.allKeys?Reflect.has(i,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,d),getPrototypeOf:()=>Reflect.getPrototypeOf(i),has:(h,d)=>Reflect.has(i,d),ownKeys:()=>Reflect.ownKeys(i),set:(h,d,m)=>(i[d]=m,delete h[d],!0)})}function lc(i,a={scriptable:!0,indexable:!0}){const{_scriptable:n=a.scriptable,_indexable:c=a.indexable,_allKeys:l=a.allKeys}=i;return{allKeys:l,scriptable:n,indexable:c,isScriptable:Mn(n)?n:()=>n,isIndexable:Mn(c)?c:()=>c}}const Xr=(i,a)=>i?i+Ir(a):a,ea=(i,a)=>Mt(a)&&"adapters"!==i&&(null===Object.getPrototypeOf(a)||a.constructor===Object);function Le(i,a,n){if(Object.prototype.hasOwnProperty.call(i,a))return i[a];const c=n();return i[a]=c,c}function Sa(i,a,n){return Mn(i)?i(a,n):i}const Ar=(i,a)=>!0===i?a:"string"==typeof i?Pn(a,i):void 0;function Ii(i,a,n,c,l){for(const h of a){const d=Ar(n,h);if(d){i.add(d);const m=Sa(d._fallback,n,l);if(typeof m<"u"&&m!==n&&m!==c)return m}else if(!1===d&&typeof c<"u"&&n!==c)return null}return!1}function hn(i,a,n,c){const l=a._rootScopes,h=Sa(a._fallback,n,c),d=[...i,...l],m=new Set;m.add(c);let g=Kl(m,d,n,h||n,c);return!(null===g||typeof h<"u"&&h!==n&&(g=Kl(m,d,h,g,c),null===g))&&cc(Array.from(m),[""],l,h,()=>function Jh(i,a,n){const c=i._getTarget();a in c||(c[a]={});const l=c[a];return tr(l)&&Mt(n)?n:l||{}}(a,n,c))}function Kl(i,a,n,c,l){for(;n;)n=Ii(i,a,n,c,l);return n}function uc(i,a){for(const n of a){if(!n)continue;const c=n[i];if(typeof c<"u")return c}}function dc(i){let a=i._keys;return a||(a=i._keys=function so(i){const a=new Set;for(const n of i)for(const c of Object.keys(n).filter(l=>!l.startsWith("_")))a.add(c);return Array.from(a)}(i._scopes)),a}function pc(i,a,n,c){const{iScale:l}=i,{key:h="r"}=this._parsing,d=new Array(c);let m,g,w,b;for(m=0,g=c;m<g;++m)w=m+n,b=a[w],d[m]={r:l.parse(Pn(b,h),w)};return d}const Ql=Number.EPSILON||1e-14,ta=(i,a)=>a<i.length&&!i[a].skip&&i[a],ra=i=>"x"===i?"y":"x";function ql(i,a,n,c){const l=i.skip?a:i,h=a,d=n.skip?a:n,m=fn(h,l),g=fn(d,h);let w=m/(m+g),b=g/(m+g);w=isNaN(w)?0:w,b=isNaN(b)?0:b;const S=c*w,O=c*b;return{previous:{x:h.x-S*(d.x-l.x),y:h.y-S*(d.y-l.y)},next:{x:h.x+O*(d.x-l.x),y:h.y+O*(d.y-l.y)}}}function ls(i,a,n){return Math.max(Math.min(i,n),a)}function t0(i,a,n,c,l){let h,d,m,g;if(a.spanGaps&&(i=i.filter(w=>!w.skip)),"monotone"===a.cubicInterpolationMode)!function gc(i,a="x"){const n=ra(a),c=i.length,l=Array(c).fill(0),h=Array(c);let d,m,g,w=ta(i,0);for(d=0;d<c;++d)if(m=g,g=w,w=ta(i,d+1),g){if(w){const b=w[a]-g[a];l[d]=0!==b?(w[n]-g[n])/b:0}h[d]=m?w?Ye(l[d-1])!==Ye(l[d])?0:(l[d-1]+l[d])/2:l[d-1]:l[d]}(function mc(i,a,n){const c=i.length;let l,h,d,m,g,w=ta(i,0);for(let b=0;b<c-1;++b)if(g=w,w=ta(i,b+1),g&&w){if(le(a[b],0,Ql)){n[b]=n[b+1]=0;continue}l=n[b]/a[b],h=n[b+1]/a[b],m=Math.pow(l,2)+Math.pow(h,2),!(m<=9)&&(d=3/Math.sqrt(m),n[b]=l*d*a[b],n[b+1]=h*d*a[b])}})(i,l,h),function e0(i,a,n="x"){const c=ra(n),l=i.length;let h,d,m,g=ta(i,0);for(let w=0;w<l;++w){if(d=m,m=g,g=ta(i,w+1),!m)continue;const b=m[n],S=m[c];d&&(h=(b-d[n])/3,m[`cp1${n}`]=b-h,m[`cp1${c}`]=S-h*a[w]),g&&(h=(g[n]-b)/3,m[`cp2${n}`]=b+h,m[`cp2${c}`]=S+h*a[w])}}(i,h,a)}(i,l);else{let w=c?i[i.length-1]:i[0];for(h=0,d=i.length;h<d;++h)m=i[h],g=ql(w,m,i[Math.min(h+1,d-(c?0:1))%d],a.tension),m.cp1x=g.previous.x,m.cp1y=g.previous.y,m.cp2x=g.next.x,m.cp2y=g.next.y,w=m}a.capBezierPoints&&function xc(i,a){let n,c,l,h,d,m=Ln(i[0],a);for(n=0,c=i.length;n<c;++n)d=h,h=m,m=n<c-1&&Ln(i[n+1],a),h&&(l=i[n],d&&(l.cp1x=ls(l.cp1x,a.left,a.right),l.cp1y=ls(l.cp1y,a.top,a.bottom)),m&&(l.cp2x=ls(l.cp2x,a.left,a.right),l.cp2y=ls(l.cp2y,a.top,a.bottom)))}(i,n)}function oo(){return typeof window<"u"&&typeof document<"u"}function co(i){let a=i.parentNode;return a&&"[object ShadowRoot]"===a.toString()&&(a=a.host),a}function Aa(i,a,n){let c;return"string"==typeof i?(c=parseInt(i,10),-1!==i.indexOf("%")&&(c=c/100*a.parentNode[n])):c=i,c}const fs=i=>i.ownerDocument.defaultView.getComputedStyle(i,null),_c=["top","right","bottom","left"];function Pi(i,a,n){const c={};n=n?"-"+n:"";for(let l=0;l<4;l++){const h=_c[l];c[h]=parseFloat(i[a+"-"+h+n])||0}return c.width=c.left+c.right,c.height=c.top+c.bottom,c}const Fa=(i,a,n)=>(i>0||a>0)&&(!n||!n.shadowRoot);function na(i,a){if("native"in i)return i;const{canvas:n,currentDevicePixelRatio:c}=a,l=fs(n),h="border-box"===l.boxSizing,d=Pi(l,"padding"),m=Pi(l,"border","width"),{x:g,y:w,box:b}=function hi(i,a){const n=i.touches,c=n&&n.length?n[0]:i,{offsetX:l,offsetY:h}=c;let m,g,d=!1;if(Fa(l,h,i.target))m=l,g=h;else{const w=a.getBoundingClientRect();m=c.clientX-w.left,g=c.clientY-w.top,d=!0}return{x:m,y:g,box:d}}(i,n),S=d.left+(b&&m.left),O=d.top+(b&&m.top);let{width:I,height:V}=a;return h&&(I-=d.width+m.width,V-=d.height+m.height),{x:Math.round((g-S)/I*n.width/c),y:Math.round((w-O)/V*n.height/c)}}const Kn=i=>Math.round(10*i)/10;function Da(i,a,n){const c=a||1,l=Math.floor(i.height*c),h=Math.floor(i.width*c);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const d=i.canvas;return d.style&&(n||!d.style.height&&!d.style.width)&&(d.style.height=`${i.height}px`,d.style.width=`${i.width}px`),(i.currentDevicePixelRatio!==c||d.height!==l||d.width!==h)&&(i.currentDevicePixelRatio=c,d.height=l,d.width=h,i.ctx.setTransform(c,0,0,c,0,0),!0)}const qh=function(){let i=!1;try{const a={get passive(){return i=!0,!1}};window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch{}return i}();function r0(i,a){const n=function lo(i,a){return fs(i).getPropertyValue(a)}(i,a),c=n&&n.match(/^(\d+)(\.\d+)?px$/);return c?+c[1]:void 0}function ia(i,a,n,c){return{x:i.x+n*(a.x-i.x),y:i.y+n*(a.y-i.y)}}function eu(i,a,n,c){return{x:i.x+n*(a.x-i.x),y:"middle"===c?n<.5?i.y:a.y:"after"===c?n<1?i.y:a.y:n>0?a.y:i.y}}function n0(i,a,n,c){const l={x:i.cp2x,y:i.cp2y},h={x:a.cp1x,y:a.cp1y},d=ia(i,l,n),m=ia(l,h,n),g=ia(h,a,n),w=ia(d,m,n),b=ia(m,g,n);return ia(w,b,n)}function xe(i,a,n){return i?function(i,a){return{x:n=>i+i+a-n,setWidth(n){a=n},textAlign:n=>"center"===n?n:"right"===n?"left":"right",xPlus:(n,c)=>n-c,leftForLtr:(n,c)=>n-c}}(a,n):{x:i=>i,setWidth(i){},textAlign:i=>i,xPlus:(i,a)=>i+a,leftForLtr:(i,a)=>i}}function Jn(i,a){let n,c;("ltr"===a||"rtl"===a)&&(n=i.canvas.style,c=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",a,"important"),i.prevTextDirection=c)}function an(i,a){void 0!==a&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",a[0],a[1]))}function Ce(i){return"angle"===i?{between:lt,compare:Yn,normalize:Pr}:{between:Rn,compare:(a,n)=>a-n,normalize:a=>a}}function Oa({start:i,end:a,count:n,loop:c,style:l}){return{start:i%n,end:a%n,loop:c&&(a-i+1)%n==0,style:l}}function Ia(i,a,n){if(!n)return[i];const{property:c,start:l,end:h}=n,d=a.length,{compare:m,between:g,normalize:w}=Ce(c),{start:b,end:S,loop:O,style:I}=function i0(i,a,n){const{property:c,start:l,end:h}=n,{between:d,normalize:m}=Ce(c),g=a.length;let O,I,{start:w,end:b,loop:S}=i;if(S){for(w+=g,b+=g,O=0,I=g;O<I&&d(m(a[w%g][c]),l,h);++O)w--,b--;w%=g,b%=g}return b<w&&(b+=g),{start:w,end:b,loop:S,style:i.style}}(i,a,n),V=[];let _e,ge,Oe,X=!1,K=null;for(let Ue=b,ut=b;Ue<=S;++Ue)ge=a[Ue%d],!ge.skip&&(_e=w(ge[c]),_e!==Oe&&(X=g(_e,l,h),null===K&&(X||g(l,Oe,_e)&&0!==m(l,Oe))&&(K=0===m(_e,l)?Ue:ut),null!==K&&(!X||0===m(h,_e)||g(h,Oe,_e))&&(V.push(Oa({start:K,end:Ue,loop:O,count:d,style:I})),K=null),ut=Ue,Oe=_e));return null!==K&&V.push(Oa({start:K,end:S,loop:O,count:d,style:I})),V}function fo(i,a){const n=[],c=i.segments;for(let l=0;l<c.length;l++){const h=Ia(c[l],i.points,a);h.length&&n.push(...h)}return n}function lr(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function ru(i,a){if(!a)return!1;const n=[],c=function(l,h){return yn(h)?(n.includes(h)||n.push(h),n.indexOf(h)):h};return JSON.stringify(i,c)!==JSON.stringify(a,c)}class nu{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(a,n,c,l){const d=n.duration;n.listeners[l].forEach(m=>m({chart:a,initial:n.initial,numSteps:d,currentStep:Math.min(c-n.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=ic.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(a=Date.now()){let n=0;this._charts.forEach((c,l)=>{if(!c.running||!c.items.length)return;const h=c.items;let g,d=h.length-1,m=!1;for(;d>=0;--d)g=h[d],g._active?(g._total>c.duration&&(c.duration=g._total),g.tick(a),m=!0):(h[d]=h[h.length-1],h.pop());m&&(l.draw(),this._notify(l,c,a,"progress")),h.length||(c.running=!1,this._notify(l,c,a,"complete"),c.initial=!1),n+=h.length}),this._lastDate=a,0===n&&(this._running=!1)}_getAnims(a){const n=this._charts;let c=n.get(a);return c||(c={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(a,c)),c}listen(a,n,c){this._getAnims(a).listeners[n].push(c)}add(a,n){!n||!n.length||this._getAnims(a).items.push(...n)}has(a){return this._getAnims(a).items.length>0}start(a){const n=this._charts.get(a);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((c,l)=>Math.max(c,l._duration),0),this._refresh())}running(a){if(!this._running)return!1;const n=this._charts.get(a);return!(!n||!n.running||!n.items.length)}stop(a){const n=this._charts.get(a);if(!n||!n.items.length)return;const c=n.items;let l=c.length-1;for(;l>=0;--l)c[l].cancel();n.items=[],this._notify(a,n,Date.now(),"complete")}remove(a){return this._charts.delete(a)}}var ui=new nu;const yr="transparent",_t={boolean:(i,a,n)=>n>.5?a:i,color(i,a,n){const c=Wl(i||yr),l=c.valid&&Wl(a||yr);return l&&l.valid?l.mix(c,n).hexString():a},number:(i,a,n)=>i+(a-i)*n};class un{constructor(a,n,c,l){const h=n[c];l=Ca([a.to,l,h,a.from]);const d=Ca([a.from,h,l]);this._active=!0,this._fn=a.fn||_t[a.type||typeof d],this._easing=cr[a.easing]||cr.linear,this._start=Math.floor(Date.now()+(a.delay||0)),this._duration=this._total=Math.floor(a.duration),this._loop=!!a.loop,this._target=n,this._prop=c,this._from=d,this._to=l,this._promises=void 0}active(){return this._active}update(a,n,c){if(this._active){this._notify(!1);const l=this._target[this._prop],h=c-this._start,d=this._duration-h;this._start=c,this._duration=Math.floor(Math.max(d,a.duration)),this._total+=h,this._loop=!!a.loop,this._to=Ca([a.to,n,l,a.from]),this._from=Ca([a.from,l,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(a){const n=a-this._start,c=this._duration,l=this._prop,h=this._from,d=this._loop,m=this._to;let g;if(this._active=h!==m&&(d||n<c),!this._active)return this._target[l]=m,void this._notify(!0);n<0?this._target[l]=h:(g=n/c%2,g=d&&g>1?2-g:g,g=this._easing(Math.min(1,Math.max(0,g))),this._target[l]=this._fn(h,m,g))}wait(){const a=this._promises||(this._promises=[]);return new Promise((n,c)=>{a.push({res:n,rej:c})})}_notify(a){const n=a?"res":"rej",c=this._promises||[];for(let l=0;l<c.length;l++)c[l][n]()}}class St{constructor(a,n){this._chart=a,this._properties=new Map,this.configure(n)}configure(a){if(!Mt(a))return;const n=Object.keys(mr.animation),c=this._properties;Object.getOwnPropertyNames(a).forEach(l=>{const h=a[l];if(!Mt(h))return;const d={};for(const m of n)d[m]=h[m];(tr(h.properties)&&h.properties||[l]).forEach(m=>{(m===l||!c.has(m))&&c.set(m,d)})})}_animateOptions(a,n){const c=n.options,l=function s0(i,a){if(!a)return;let n=i.options;if(n)return n.$shared&&(i.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;i.options=a}(a,c);if(!l)return[];const h=this._createAnimations(l,c);return c.$shared&&function Ht(i,a){const n=[],c=Object.keys(a);for(let l=0;l<c.length;l++){const h=i[c[l]];h&&h.active()&&n.push(h.wait())}return Promise.all(n)}(a.options.$animations,c).then(()=>{a.options=c},()=>{}),h}_createAnimations(a,n){const c=this._properties,l=[],h=a.$animations||(a.$animations={}),d=Object.keys(n),m=Date.now();let g;for(g=d.length-1;g>=0;--g){const w=d[g];if("$"===w.charAt(0))continue;if("options"===w){l.push(...this._animateOptions(a,n));continue}const b=n[w];let S=h[w];const O=c.get(w);if(S){if(O&&S.active()){S.update(O,b,m);continue}S.cancel()}O&&O.duration?(h[w]=S=new un(O,a,w,b),l.push(S)):a[w]=b}return l}update(a,n){if(0===this._properties.size)return void Object.assign(a,n);const c=this._createAnimations(a,n);return c.length?(ui.add(this._chart,c),!0):void 0}}function Nn(i,a){const n=i&&i.options||{},c=n.reverse,l=void 0===n.min?a:0,h=void 0===n.max?a:0;return{start:c?h:l,end:c?l:h}}function aa(i,a){const n=[],c=i._getSortedDatasetMetas(a);let l,h;for(l=0,h=c.length;l<h;++l)n.push(c[l].index);return n}function c0(i,a,n,c={}){const l=i.keys,h="single"===c.mode;let d,m,g,w;if(null!==a){for(d=0,m=l.length;d<m;++d){if(g=+l[d],g===n){if(c.all)continue;break}w=i.values[g],sr(w)&&(h||0===a||Ye(a)===Ye(w))&&(a+=w)}return a}}function Zr(i,a){const n=i&&i.options.stacked;return n||void 0===n&&void 0!==a.stack}function au(i,a,n){const c=i[a]||(i[a]={});return c[n]||(c[n]={})}function ho(i,a,n,c){for(const l of a.getMatchingVisibleMetas(c).reverse()){const h=i[l.index];if(n&&h>0||!n&&h<0)return l.index}return null}function l0(i,a){const{chart:n,_cachedMeta:c}=i,l=n._stacks||(n._stacks={}),{iScale:h,vScale:d,index:m}=c,g=h.axis,w=d.axis,b=function zr(i,a,n){return`${i.id}.${a.id}.${n.stack||n.type}`}(h,d,c),S=a.length;let O;for(let I=0;I<S;++I){const V=a[I],{[g]:X,[w]:K}=V;O=(V._stacks||(V._stacks={}))[w]=au(l,b,X),O[m]=K,O._top=ho(O,d,!0,c.type),O._bottom=ho(O,d,!1,c.type),(O._visualValues||(O._visualValues={}))[m]=K}}function yc(i,a){const n=i.scales;return Object.keys(n).filter(c=>n[c].axis===a).shift()}function Un(i,a){const n=i.controller.index,c=i.vScale&&i.vScale.axis;if(c){a=a||i._parsed;for(const l of a){const h=l._stacks;if(!h||void 0===h[c]||void 0===h[c][n])return;delete h[c][n],void 0!==h[c]._visualValues&&void 0!==h[c]._visualValues[n]&&delete h[c]._visualValues[n]}}}const di=i=>"reset"===i||"none"===i,Ri=(i,a)=>a?i:Object.assign({},i);let pi=(()=>{class i{constructor(n,c){this.chart=n,this._ctx=n.ctx,this.index=c,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const n=this._cachedMeta;this.configure(),this.linkScales(),n._stacked=Zr(n.vScale,n),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(n){this.index!==n&&Un(this._cachedMeta),this.index=n}linkScales(){const n=this.chart,c=this._cachedMeta,l=this.getDataset(),h=(O,I,V,X)=>"x"===O?I:"r"===O?X:V,d=c.xAxisID=Tt(l.xAxisID,yc(n,"x")),m=c.yAxisID=Tt(l.yAxisID,yc(n,"y")),g=c.rAxisID=Tt(l.rAxisID,yc(n,"r")),w=c.indexAxis,b=c.iAxisID=h(w,d,m,g),S=c.vAxisID=h(w,m,d,g);c.xScale=this.getScaleForId(d),c.yScale=this.getScaleForId(m),c.rScale=this.getScaleForId(g),c.iScale=this.getScaleForId(b),c.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(n){return this.chart.scales[n]}_getOtherScale(n){const c=this._cachedMeta;return n===c.iScale?c.vScale:c.iScale}reset(){this._update("reset")}_destroy(){const n=this._cachedMeta;this._data&&Ll(this._data,this),n._stacked&&Un(n)}_dataCheck(){const n=this.getDataset(),c=n.data||(n.data=[]),l=this._data;if(Mt(c))this._data=function Bn(i){const a=Object.keys(i),n=new Array(a.length);let c,l,h;for(c=0,l=a.length;c<l;++c)h=a[c],n[c]={x:h,y:i[h]};return n}(c);else if(l!==c){if(l){Ll(l,this);const h=this._cachedMeta;Un(h),h._parsed=[]}c&&Object.isExtensible(c)&&function no(i,a){i._chartjs?i._chartjs.listeners.push(a):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[a]}}),is.forEach(n=>{const c="_onData"+Ir(n),l=i[n];Object.defineProperty(i,n,{configurable:!0,enumerable:!1,value(...h){const d=l.apply(this,h);return i._chartjs.listeners.forEach(m=>{"function"==typeof m[c]&&m[c](...h)}),d}})}))}(c,this),this._syncList=[],this._data=c}}addElements(){const n=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(n.dataset=new this.datasetElementType)}buildOrUpdateElements(n){const c=this._cachedMeta,l=this.getDataset();let h=!1;this._dataCheck();const d=c._stacked;c._stacked=Zr(c.vScale,c),c.stack!==l.stack&&(h=!0,Un(c),c.stack=l.stack),this._resyncElements(n),(h||d!==c._stacked)&&l0(this,c._parsed)}configure(){const n=this.chart.config,c=n.datasetScopeKeys(this._type),l=n.getOptionScopes(this.getDataset(),c,!0);this.options=n.createResolver(l,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(n,c){const{_cachedMeta:l,_data:h}=this,{iScale:d,_stacked:m}=l,g=d.axis;let S,O,I,w=0===n&&c===h.length||l._sorted,b=n>0&&l._parsed[n-1];if(!1===this._parsing)l._parsed=h,l._sorted=!0,I=h;else{I=tr(h[n])?this.parseArrayData(l,h,n,c):Mt(h[n])?this.parseObjectData(l,h,n,c):this.parsePrimitiveData(l,h,n,c);const V=()=>null===O[g]||b&&O[g]<b[g];for(S=0;S<c;++S)l._parsed[S+n]=O=I[S],w&&(V()&&(w=!1),b=O);l._sorted=w}m&&l0(this,I)}parsePrimitiveData(n,c,l,h){const{iScale:d,vScale:m}=n,g=d.axis,w=m.axis,b=d.getLabels(),S=d===m,O=new Array(h);let I,V,X;for(I=0,V=h;I<V;++I)X=I+l,O[I]={[g]:S||d.parse(b[X],X),[w]:m.parse(c[X],X)};return O}parseArrayData(n,c,l,h){const{xScale:d,yScale:m}=n,g=new Array(h);let w,b,S,O;for(w=0,b=h;w<b;++w)S=w+l,O=c[S],g[w]={x:d.parse(O[0],S),y:m.parse(O[1],S)};return g}parseObjectData(n,c,l,h){const{xScale:d,yScale:m}=n,{xAxisKey:g="x",yAxisKey:w="y"}=this._parsing,b=new Array(h);let S,O,I,V;for(S=0,O=h;S<O;++S)I=S+l,V=c[I],b[S]={x:d.parse(Pn(V,g),I),y:m.parse(Pn(V,w),I)};return b}getParsed(n){return this._cachedMeta._parsed[n]}getDataElement(n){return this._cachedMeta.data[n]}applyStack(n,c,l){const d=this._cachedMeta,m=c[n.axis];return c0({keys:aa(this.chart,!0),values:c._stacks[n.axis]._visualValues},m,d.index,{mode:l})}updateRangeFromParsed(n,c,l,h){const d=l[c.axis];let m=null===d?NaN:d;const g=h&&l._stacks[c.axis];h&&g&&(h.values=g,m=c0(h,d,this._cachedMeta.index)),n.min=Math.min(n.min,m),n.max=Math.max(n.max,m)}getMinMax(n,c){const l=this._cachedMeta,h=l._parsed,d=l._sorted&&n===l.iScale,m=h.length,g=this._getOtherScale(n),w=((i,a,n)=>i&&!a.hidden&&a._stacked&&{keys:aa(this.chart,!0),values:null})(c,l),b={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:O}=function iu(i){const{min:a,max:n,minDefined:c,maxDefined:l}=i.getUserBounds();return{min:c?a:Number.NEGATIVE_INFINITY,max:l?n:Number.POSITIVE_INFINITY}}(g);let I,V;function X(){V=h[I];const K=V[g.axis];return!sr(V[n.axis])||S>K||O<K}for(I=0;I<m&&(X()||(this.updateRangeFromParsed(b,n,V,w),!d));++I);if(d)for(I=m-1;I>=0;--I)if(!X()){this.updateRangeFromParsed(b,n,V,w);break}return b}getAllParsedValues(n){const c=this._cachedMeta._parsed,l=[];let h,d,m;for(h=0,d=c.length;h<d;++h)m=c[h][n.axis],sr(m)&&l.push(m);return l}getMaxOverflow(){return!1}getLabelAndValue(n){const c=this._cachedMeta,l=c.iScale,h=c.vScale,d=this.getParsed(n);return{label:l?""+l.getLabelForValue(d[l.axis]):"",value:h?""+h.getLabelForValue(d[h.axis]):""}}_update(n){const c=this._cachedMeta;this.update(n||"default"),c._clip=function o0(i){let a,n,c,l;return Mt(i)?(a=i.top,n=i.right,c=i.bottom,l=i.left):a=n=c=l=i,{top:a,right:n,bottom:c,left:l,disabled:!1===i}}(Tt(this.options.clip,function Mi(i,a,n){if(!1===n)return!1;const c=Nn(i,n),l=Nn(a,n);return{top:l.end,right:c.end,bottom:l.start,left:c.start}}(c.xScale,c.yScale,this.getMaxOverflow())))}update(n){}draw(){const n=this._ctx,l=this._cachedMeta,h=l.data||[],d=this.chart.chartArea,m=[],g=this._drawStart||0,w=this._drawCount||h.length-g,b=this.options.drawActiveElementsOnTop;let S;for(l.dataset&&l.dataset.draw(n,d,g,w),S=g;S<g+w;++S){const O=h[S];O.hidden||(O.active&&b?m.push(O):O.draw(n,d))}for(S=0;S<m.length;++S)m[S].draw(n,d)}getStyle(n,c){const l=c?"active":"default";return void 0===n&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(l):this.resolveDataElementOptions(n||0,l)}getContext(n,c,l){const h=this.getDataset();let d;if(n>=0&&n<this._cachedMeta.data.length){const m=this._cachedMeta.data[n];d=m.$context||(m.$context=function An(i,a,n){return Oi(i,{active:!1,dataIndex:a,parsed:void 0,raw:void 0,element:n,index:a,mode:"default",type:"data"})}(this.getContext(),n,m)),d.parsed=this.getParsed(n),d.raw=h.data[n],d.index=d.dataIndex=n}else d=this.$context||(this.$context=function su(i,a){return Oi(i,{active:!1,dataset:void 0,datasetIndex:a,index:a,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),d.dataset=h,d.index=d.datasetIndex=this.index;return d.active=!!c,d.mode=l,d}resolveDatasetElementOptions(n){return this._resolveElementOptions(this.datasetElementType.id,n)}resolveDataElementOptions(n,c){return this._resolveElementOptions(this.dataElementType.id,c,n)}_resolveElementOptions(n,c="default",l){const h="active"===c,d=this._cachedDataOpts,m=n+"-"+c,g=d[m],w=this.enableOptionSharing&&Ai(l);if(g)return Ri(g,w);const b=this.chart.config,S=b.datasetElementScopeKeys(this._type,n),O=h?[`${n}Hover`,"hover",n,""]:[n,""],I=b.getOptionScopes(this.getDataset(),S),V=Object.keys(mr.elements[n]),K=b.resolveNamedOptions(I,V,()=>this.getContext(l,h,c),O);return K.$shared&&(K.$shared=w,d[m]=Object.freeze(Ri(K,w))),K}_resolveAnimations(n,c,l){const h=this.chart,d=this._cachedDataOpts,m=`animation-${c}`,g=d[m];if(g)return g;let w;if(!1!==h.options.animation){const S=this.chart.config,O=S.datasetAnimationScopeKeys(this._type,c),I=S.getOptionScopes(this.getDataset(),O);w=S.createResolver(I,this.getContext(n,l,c))}const b=new St(h,w&&w.animations);return w&&w._cacheable&&(d[m]=Object.freeze(b)),b}getSharedOptions(n){if(n.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},n))}includeOptions(n,c){return!c||di(n)||this.chart._animationsDisabled}_getSharedOptions(n,c){const l=this.resolveDataElementOptions(n,c),h=this._sharedOptions,d=this.getSharedOptions(l),m=this.includeOptions(c,d)||d!==h;return this.updateSharedOptions(d,c,l),{sharedOptions:d,includeOptions:m}}updateElement(n,c,l,h){di(h)?Object.assign(n,l):this._resolveAnimations(c,h).update(n,l)}updateSharedOptions(n,c,l){n&&!di(c)&&this._resolveAnimations(void 0,c).update(n,l)}_setStyle(n,c,l,h){n.active=h;const d=this.getStyle(c,h);this._resolveAnimations(c,l,h).update(n,{options:!h&&this.getSharedOptions(d)||d})}removeHoverStyle(n,c,l){this._setStyle(n,l,"active",!1)}setHoverStyle(n,c,l){this._setStyle(n,l,"active",!0)}_removeDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!1)}_setDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!0)}_resyncElements(n){const c=this._data,l=this._cachedMeta.data;for(const[g,w,b]of this._syncList)this[g](w,b);this._syncList=[];const h=l.length,d=c.length,m=Math.min(d,h);m&&this.parse(0,m),d>h?this._insertElements(h,d-h,n):d<h&&this._removeElements(d,h-d)}_insertElements(n,c,l=!0){const h=this._cachedMeta,d=h.data,m=n+c;let g;const w=b=>{for(b.length+=c,g=b.length-1;g>=m;g--)b[g]=b[g-c]};for(w(d),g=n;g<m;++g)d[g]=new this.dataElementType;this._parsing&&w(h._parsed),this.parse(n,c),l&&this.updateElements(d,n,c,"reset")}updateElements(n,c,l,h){}_removeElements(n,c){const l=this._cachedMeta;if(this._parsing){const h=l._parsed.splice(n,c);l._stacked&&Un(l,h)}l.data.splice(n,c)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[c,l,h]=n;this[c](l,h)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const n=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-n,n])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(n,c){c&&this._sync(["_removeElements",n,c]);const l=arguments.length-2;l&&this._sync(["_insertElements",n,l])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return oe(i,"defaults",{}),oe(i,"datasetElementType",null),oe(i,"dataElementType",null),i})();function uo(i){const a=i.iScale,n=function bc(i,a){if(!i._cache.$bar){const n=i.getMatchingVisibleMetas(a);let c=[];for(let l=0,h=n.length;l<h;l++)c=c.concat(n[l].controller.getAllParsedValues(i));i._cache.$bar=as(c.sort((l,h)=>l-h))}return i._cache.$bar}(a,i.type);let l,h,d,m,c=a._length;const g=()=>{32767===d||-32768===d||(Ai(m)&&(c=Math.min(c,Math.abs(d-m)||c)),m=d)};for(l=0,h=n.length;l<h;++l)d=a.getPixelForValue(n[l]),g();for(m=void 0,l=0,h=a.ticks.length;l<h;++l)d=a.getPixelForTick(l),g();return c}function po(i,a,n,c){return tr(i)?function Tc(i,a,n,c){const l=n.parse(i[0],c),h=n.parse(i[1],c),d=Math.min(l,h),m=Math.max(l,h);let g=d,w=m;Math.abs(d)>Math.abs(m)&&(g=m,w=d),a[n.axis]=w,a._custom={barStart:g,barEnd:w,start:l,end:h,min:d,max:m}}(i,a,n,c):a[n.axis]=n.parse(i,c),a}function Ec(i,a,n,c){const l=i.iScale,h=i.vScale,d=l.getLabels(),m=l===h,g=[];let w,b,S,O;for(w=n,b=n+c;w<b;++w)O=a[w],S={},S[l.axis]=m||l.parse(d[w],w),g.push(po(O,S,h,w));return g}function mo(i){return i&&void 0!==i.barStart&&void 0!==i.barEnd}function Pa(i,a,n,c){let l=a.borderSkipped;const h={};if(!l)return void(i.borderSkipped=h);if(!0===l)return void(i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:d,end:m,reverse:g,top:w,bottom:b}=function sa(i){let a,n,c,l,h;return i.horizontal?(a=i.base>i.x,n="left",c="right"):(a=i.base<i.y,n="bottom",c="top"),a?(l="end",h="start"):(l="start",h="end"),{start:n,end:c,reverse:a,top:l,bottom:h}}(i);"middle"===l&&n&&(i.enableBorderRadius=!0,(n._top||0)===c?l=w:(n._bottom||0)===c?l=b:(h[Kr(b,d,m,g)]=!0,l=w)),h[Kr(l,d,m,g)]=!0,i.borderSkipped=h}function Kr(i,a,n,c){return c?(i=function oa(i,a,n){return i===a?n:i===n?a:i}(i,a,n),i=f0(i,n,a)):i=f0(i,a,n),i}function f0(i,a,n){return"start"===i?a:"end"===i?n:i}function go(i,{inflateAmount:a},n){i.inflateAmount="auto"===a?1===n?.33:0:a}let fu=(()=>{class i extends pi{parsePrimitiveData(n,c,l,h){return Ec(n,c,l,h)}parseArrayData(n,c,l,h){return Ec(n,c,l,h)}parseObjectData(n,c,l,h){const{iScale:d,vScale:m}=n,{xAxisKey:g="x",yAxisKey:w="y"}=this._parsing,b="x"===d.axis?g:w,S="x"===m.axis?g:w,O=[];let I,V,X,K;for(I=l,V=l+h;I<V;++I)K=c[I],X={},X[d.axis]=d.parse(Pn(K,b),I),O.push(po(Pn(K,S),X,m,I));return O}updateRangeFromParsed(n,c,l,h){super.updateRangeFromParsed(n,c,l,h);const d=l._custom;d&&c===this._cachedMeta.vScale&&(n.min=Math.min(n.min,d.min),n.max=Math.max(n.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(n){const c=this._cachedMeta,{iScale:l,vScale:h}=c,d=this.getParsed(n),m=d._custom,g=mo(m)?"["+m.start+", "+m.end+"]":""+h.getLabelForValue(d[h.axis]);return{label:""+l.getLabelForValue(d[l.axis]),value:g}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(n){const c=this._cachedMeta;this.updateElements(c.data,0,c.data.length,n)}updateElements(n,c,l,h){const d="reset"===h,{index:m,_cachedMeta:{vScale:g}}=this,w=g.getBasePixel(),b=g.isHorizontal(),S=this._getRuler(),{sharedOptions:O,includeOptions:I}=this._getSharedOptions(c,h);for(let V=c;V<c+l;V++){const X=this.getParsed(V),K=d||Ut(X[g.axis])?{base:w,head:w}:this._calculateBarValuePixels(V),_e=this._calculateBarIndexPixels(V,S),ge=(X._stacks||{})[g.axis],Oe={horizontal:b,base:K.base,enableBorderRadius:!ge||mo(X._custom)||m===ge._top||m===ge._bottom,x:b?K.head:_e.center,y:b?_e.center:K.head,height:b?_e.size:Math.abs(K.size),width:b?Math.abs(K.size):_e.size};I&&(Oe.options=O||this.resolveDataElementOptions(V,n[V].active?"active":h));const Pe=Oe.options||n[V].options;Pa(Oe,Pe,ge,m),go(Oe,Pe,S.ratio),this.updateElement(n[V],V,Oe,h)}}_getStacks(n,c){const{iScale:l}=this._cachedMeta,h=l.getMatchingVisibleMetas(this._type).filter(w=>w.controller.options.grouped),d=l.options.stacked,m=[],g=w=>{const b=w.controller.getParsed(c),S=b&&b[w.vScale.axis];if(Ut(S)||isNaN(S))return!0};for(const w of h)if((void 0===c||!g(w))&&((!1===d||-1===m.indexOf(w.stack)||void 0===d&&void 0===w.stack)&&m.push(w.stack),w.index===n))break;return m.length||m.push(void 0),m}_getStackCount(n){return this._getStacks(void 0,n).length}_getStackIndex(n,c,l){const h=this._getStacks(n,l),d=void 0!==c?h.indexOf(c):-1;return-1===d?h.length-1:d}_getRuler(){const n=this.options,c=this._cachedMeta,l=c.iScale,h=[];let d,m;for(d=0,m=c.data.length;d<m;++d)h.push(l.getPixelForValue(this.getParsed(d)[l.axis],d));const g=n.barThickness;return{min:g||uo(c),pixels:h,start:l._startPixel,end:l._endPixel,stackCount:this._getStackCount(),scale:l,grouped:n.grouped,ratio:g?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(n){const{_cachedMeta:{vScale:c,_stacked:l,index:h},options:{base:d,minBarLength:m}}=this,g=d||0,w=this.getParsed(n),b=w._custom,S=mo(b);let X,K,O=w[c.axis],I=0,V=l?this.applyStack(c,w,l):O;V!==O&&(I=V-O,V=O),S&&(O=b.barStart,V=b.barEnd-b.barStart,0!==O&&Ye(O)!==Ye(b.barEnd)&&(I=0),I+=O);const _e=Ut(d)||S?I:d;let ge=c.getPixelForValue(_e);if(X=this.chart.getDataVisibility(n)?c.getPixelForValue(I+V):ge,K=X-ge,Math.abs(K)<m){K=function lu(i,a,n){return 0!==i?Ye(i):(a.isHorizontal()?1:-1)*(a.min>=n?1:-1)}(K,c,g)*m,O===g&&(ge-=K/2);const Oe=c.getPixelForDecimal(0),Pe=c.getPixelForDecimal(1),Ee=Math.min(Oe,Pe),Ie=Math.max(Oe,Pe);ge=Math.max(Math.min(ge,Ie),Ee),X=ge+K,l&&!S&&(w._stacks[c.axis]._visualValues[h]=c.getValueForPixel(X)-c.getValueForPixel(ge))}if(ge===c.getPixelForValue(g)){const Oe=Ye(K)*c.getLineWidthForValue(g)/2;ge+=Oe,K-=Oe}return{size:K,base:ge,head:X,center:X+K/2}}_calculateBarIndexPixels(n,c){const l=c.scale,h=this.options,d=h.skipNull,m=Tt(h.maxBarThickness,1/0);let g,w;if(c.grouped){const b=d?this._getStackCount(n):c.stackCount,S="flex"===h.barThickness?function kc(i,a,n,c){const l=a.pixels,h=l[i];let d=i>0?l[i-1]:null,m=i<l.length-1?l[i+1]:null;const g=n.categoryPercentage;null===d&&(d=h-(null===m?a.end-a.start:m-h)),null===m&&(m=h+h-d);const w=h-(h-Math.min(d,m))/2*g;return{chunk:Math.abs(m-d)/2*g/c,ratio:n.barPercentage,start:w}}(n,c,h,b):function cu(i,a,n,c){const l=n.barThickness;let h,d;return Ut(l)?(h=a.min*n.categoryPercentage,d=n.barPercentage):(h=l*c,d=1),{chunk:h/c,ratio:d,start:a.pixels[i]-h/2}}(n,c,h,b),O=this._getStackIndex(this.index,this._cachedMeta.stack,d?n:void 0);g=S.start+S.chunk*O+S.chunk/2,w=Math.min(m,S.chunk*S.ratio)}else g=l.getPixelForValue(this.getParsed(n)[l.axis],n),w=Math.min(m,c.min*c.ratio);return{base:g-w/2,head:g+w/2,center:g,size:w}}draw(){const n=this._cachedMeta,c=n.vScale,l=n.data,h=l.length;let d=0;for(;d<h;++d)null!==this.getParsed(d)[c.axis]&&l[d].draw(this._ctx)}}return oe(i,"id","bar"),oe(i,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),oe(i,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}}),i})(),hu=(()=>{class i extends pi{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(n,c,l,h){const d=super.parsePrimitiveData(n,c,l,h);for(let m=0;m<d.length;m++)d[m]._custom=this.resolveDataElementOptions(m+l).radius;return d}parseArrayData(n,c,l,h){const d=super.parseArrayData(n,c,l,h);for(let m=0;m<d.length;m++)d[m]._custom=Tt(c[l+m][2],this.resolveDataElementOptions(m+l).radius);return d}parseObjectData(n,c,l,h){const d=super.parseObjectData(n,c,l,h);for(let m=0;m<d.length;m++){const g=c[l+m];d[m]._custom=Tt(g&&g.r&&+g.r,this.resolveDataElementOptions(m+l).radius)}return d}getMaxOverflow(){const n=this._cachedMeta.data;let c=0;for(let l=n.length-1;l>=0;--l)c=Math.max(c,n[l].size(this.resolveDataElementOptions(l))/2);return c>0&&c}getLabelAndValue(n){const c=this._cachedMeta,l=this.chart.data.labels||[],{xScale:h,yScale:d}=c,m=this.getParsed(n),g=h.getLabelForValue(m.x),w=d.getLabelForValue(m.y),b=m._custom;return{label:l[n]||"",value:"("+g+", "+w+(b?", "+b:"")+")"}}update(n){const c=this._cachedMeta.data;this.updateElements(c,0,c.length,n)}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g}=this._cachedMeta,{sharedOptions:w,includeOptions:b}=this._getSharedOptions(c,h),S=m.axis,O=g.axis;for(let I=c;I<c+l;I++){const V=n[I],X=!d&&this.getParsed(I),K={},_e=K[S]=d?m.getPixelForDecimal(.5):m.getPixelForValue(X[S]),ge=K[O]=d?g.getBasePixel():g.getPixelForValue(X[O]);K.skip=isNaN(_e)||isNaN(ge),b&&(K.options=w||this.resolveDataElementOptions(I,V.active?"active":h),d&&(K.options.radius=0)),this.updateElement(V,I,K,h)}}resolveDataElementOptions(n,c){const l=this.getParsed(n);let h=super.resolveDataElementOptions(n,c);h.$shared&&(h=Object.assign({},h,{$shared:!1}));const d=h.radius;return"active"!==c&&(h.radius=0),h.radius+=Tt(l&&l._custom,d),h}}return oe(i,"id","bubble"),oe(i,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),oe(i,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}}),i})(),Cc=(()=>{class i extends pi{constructor(n,c){super(n,c),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,c){const l=this.getDataset().data,h=this._cachedMeta;if(!1===this._parsing)h._parsed=l;else{let m,g,d=w=>+l[w];if(Mt(l[n])){const{key:w="value"}=this._parsing;d=b=>+Pn(l[b],w)}for(m=n,g=n+c;m<g;++m)h._parsed[m]=d(m)}}_getRotation(){return Qe(this.options.rotation-90)}_getCircumference(){return Qe(this.options.circumference)}_getRotationExtents(){let n=rr,c=-rr;for(let l=0;l<this.chart.data.datasets.length;++l)if(this.chart.isDatasetVisible(l)&&this.chart.getDatasetMeta(l).type===this._type){const h=this.chart.getDatasetMeta(l).controller,d=h._getRotation(),m=h._getCircumference();n=Math.min(n,d),c=Math.max(c,d+m)}return{rotation:n,circumference:c-n}}update(n){const c=this.chart,{chartArea:l}=c,h=this._cachedMeta,d=h.data,m=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,g=Math.max((Math.min(l.width,l.height)-m)/2,0),w=Math.min(((i,a)=>"string"==typeof i&&i.endsWith("%")?parseFloat(i)/100:+i/a)(this.options.cutout,g),1),b=this._getRingWeight(this.index),{circumference:S,rotation:O}=this._getRotationExtents(),{ratioX:I,ratioY:V,offsetX:X,offsetY:K}=function h0(i,a,n){let c=1,l=1,h=0,d=0;if(a<rr){const m=i,g=m+a,w=Math.cos(m),b=Math.sin(m),S=Math.cos(g),O=Math.sin(g),I=(Oe,Pe,Ee)=>lt(Oe,m,g,!0)?1:Math.max(Pe,Pe*n,Ee,Ee*n),V=(Oe,Pe,Ee)=>lt(Oe,m,g,!0)?-1:Math.min(Pe,Pe*n,Ee,Ee*n),X=I(0,w,S),K=I(Xt,b,O),_e=V(Rt,w,S),ge=V(Rt+Xt,b,O);c=(X-_e)/2,l=(K-ge)/2,h=-(X+_e)/2,d=-(K+ge)/2}return{ratioX:c,ratioY:l,offsetX:h,offsetY:d}}(O,S,w),Oe=Math.max(Math.min((l.width-m)/I,(l.height-m)/V)/2,0),Pe=Ci(this.options.radius,Oe),Ie=(Pe-Math.max(Pe*w,0))/this._getVisibleDatasetWeightTotal();this.offsetX=X*Pe,this.offsetY=K*Pe,h.total=this.calculateTotal(),this.outerRadius=Pe-Ie*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Ie*b,0),this.updateElements(d,0,d.length,n)}_circumference(n,c){const l=this.options,h=this._cachedMeta,d=this._getCircumference();return c&&l.animation.animateRotate||!this.chart.getDataVisibility(n)||null===h._parsed[n]||h.data[n].hidden?0:this.calculateCircumference(h._parsed[n]*d/rr)}updateElements(n,c,l,h){const d="reset"===h,m=this.chart,g=m.chartArea,S=(g.left+g.right)/2,O=(g.top+g.bottom)/2,I=d&&m.options.animation.animateScale,V=I?0:this.innerRadius,X=I?0:this.outerRadius,{sharedOptions:K,includeOptions:_e}=this._getSharedOptions(c,h);let Oe,ge=this._getRotation();for(Oe=0;Oe<c;++Oe)ge+=this._circumference(Oe,d);for(Oe=c;Oe<c+l;++Oe){const Pe=this._circumference(Oe,d),Ee=n[Oe],Ie={x:S+this.offsetX,y:O+this.offsetY,startAngle:ge,endAngle:ge+Pe,circumference:Pe,outerRadius:X,innerRadius:V};_e&&(Ie.options=K||this.resolveDataElementOptions(Oe,Ee.active?"active":h)),ge+=Pe,this.updateElement(Ee,Oe,Ie,h)}}calculateTotal(){const n=this._cachedMeta,c=n.data;let h,l=0;for(h=0;h<c.length;h++){const d=n._parsed[h];null!==d&&!isNaN(d)&&this.chart.getDataVisibility(h)&&!c[h].hidden&&(l+=Math.abs(d))}return l}calculateCircumference(n){const c=this._cachedMeta.total;return c>0&&!isNaN(n)?rr*(Math.abs(n)/c):0}getLabelAndValue(n){const l=this.chart,h=l.data.labels||[],d=dr(this._cachedMeta._parsed[n],l.options.locale);return{label:h[n]||"",value:d}}getMaxBorderWidth(n){let c=0;const l=this.chart;let h,d,m,g,w;if(!n)for(h=0,d=l.data.datasets.length;h<d;++h)if(l.isDatasetVisible(h)){m=l.getDatasetMeta(h),n=m.data,g=m.controller;break}if(!n)return 0;for(h=0,d=n.length;h<d;++h)w=g.resolveDataElementOptions(h),"inner"!==w.borderAlign&&(c=Math.max(c,w.borderWidth||0,w.hoverBorderWidth||0));return c}getMaxOffset(n){let c=0;for(let l=0,h=n.length;l<h;++l){const d=this.resolveDataElementOptions(l);c=Math.max(c,d.offset||0,d.hoverOffset||0)}return c}_getRingWeightOffset(n){let c=0;for(let l=0;l<n;++l)this.chart.isDatasetVisible(l)&&(c+=this._getRingWeight(l));return c}_getRingWeight(n){return Math.max(Tt(this.chart.data.datasets[n].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return oe(i,"id","doughnut"),oe(i,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),oe(i,"descriptors",{_scriptable:a=>"spacing"!==a,_indexable:a=>"spacing"!==a&&!a.startsWith("borderDash")&&!a.startsWith("hoverBorderDash")}),oe(i,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(a){const n=a.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:c,color:l}}=a.legend.options;return n.labels.map((h,d)=>{const g=a.getDatasetMeta(0).controller.getStyle(d);return{text:h,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:l,lineWidth:g.borderWidth,pointStyle:c,hidden:!a.getDataVisibility(d),index:d}})}return[]}},onClick(a,n,c){c.chart.toggleDataVisibility(n.index),c.chart.update()}}}}),i})(),uu=(()=>{class i extends pi{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(n){const c=this._cachedMeta,{dataset:l,data:h=[],_dataset:d}=c,m=this.chart._animationsDisabled;let{start:g,count:w}=ac(c,h,m);this._drawStart=g,this._drawCount=w,Hl(c)&&(g=0,w=h.length),l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!d._decimated,l.points=h;const b=this.resolveDatasetElementOptions(n);this.options.showLine||(b.borderWidth=0),b.segment=this.options.segment,this.updateElement(l,void 0,{animated:!m,options:b},n),this.updateElements(h,g,w,n)}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g,_stacked:w,_dataset:b}=this._cachedMeta,{sharedOptions:S,includeOptions:O}=this._getSharedOptions(c,h),I=m.axis,V=g.axis,{spanGaps:X,segment:K}=this.options,_e=ne(X)?X:Number.POSITIVE_INFINITY,ge=this.chart._animationsDisabled||d||"none"===h,Oe=c+l,Pe=n.length;let Ee=c>0&&this.getParsed(c-1);for(let Ie=0;Ie<Pe;++Ie){const st=n[Ie],Ue=ge?st:{};if(Ie<c||Ie>=Oe){Ue.skip=!0;continue}const ut=this.getParsed(Ie),It=Ut(ut[V]),Ft=Ue[I]=m.getPixelForValue(ut[I],Ie),Nt=Ue[V]=d||It?g.getBasePixel():g.getPixelForValue(w?this.applyStack(g,ut,w):ut[V],Ie);Ue.skip=isNaN(Ft)||isNaN(Nt)||It,Ue.stop=Ie>0&&Math.abs(ut[I]-Ee[I])>_e,K&&(Ue.parsed=ut,Ue.raw=b.data[Ie]),O&&(Ue.options=S||this.resolveDataElementOptions(Ie,st.active?"active":h)),ge||this.updateElement(st,Ie,Ue,h),Ee=ut}}getMaxOverflow(){const n=this._cachedMeta,c=n.dataset,l=c.options&&c.options.borderWidth||0,h=n.data||[];if(!h.length)return l;const d=h[0].size(this.resolveDataElementOptions(0)),m=h[h.length-1].size(this.resolveDataElementOptions(h.length-1));return Math.max(l,d,m)/2}draw(){const n=this._cachedMeta;n.dataset.updateControlPoints(this.chart.chartArea,n.iScale.axis),super.draw()}}return oe(i,"id","line"),oe(i,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),oe(i,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}}),i})(),xo=(()=>{class i extends pi{constructor(n,c){super(n,c),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(n){const l=this.chart,h=l.data.labels||[],d=dr(this._cachedMeta._parsed[n].r,l.options.locale);return{label:h[n]||"",value:d}}parseObjectData(n,c,l,h){return pc.bind(this)(n,c,l,h)}update(n){const c=this._cachedMeta.data;this._updateRadius(),this.updateElements(c,0,c.length,n)}getMinMax(){const c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((l,h)=>{const d=this.getParsed(h).r;!isNaN(d)&&this.chart.getDataVisibility(h)&&(d<c.min&&(c.min=d),d>c.max&&(c.max=d))}),c}_updateRadius(){const n=this.chart,c=n.chartArea,l=n.options,h=Math.min(c.right-c.left,c.bottom-c.top),d=Math.max(h/2,0),g=(d-Math.max(l.cutoutPercentage?d/100*l.cutoutPercentage:1,0))/n.getVisibleDatasetCount();this.outerRadius=d-g*this.index,this.innerRadius=this.outerRadius-g}updateElements(n,c,l,h){const d="reset"===h,m=this.chart,w=m.options.animation,b=this._cachedMeta.rScale,S=b.xCenter,O=b.yCenter,I=b.getIndexAngle(0)-.5*Rt;let X,V=I;const K=360/this.countVisibleElements();for(X=0;X<c;++X)V+=this._computeAngle(X,h,K);for(X=c;X<c+l;X++){const _e=n[X];let ge=V,Oe=V+this._computeAngle(X,h,K),Pe=m.getDataVisibility(X)?b.getDistanceFromCenterForValue(this.getParsed(X).r):0;V=Oe,d&&(w.animateScale&&(Pe=0),w.animateRotate&&(ge=Oe=I));const Ee={x:S,y:O,innerRadius:0,outerRadius:Pe,startAngle:ge,endAngle:Oe,options:this.resolveDataElementOptions(X,_e.active?"active":h)};this.updateElement(_e,X,Ee,h)}}countVisibleElements(){let c=0;return this._cachedMeta.data.forEach((l,h)=>{!isNaN(this.getParsed(h).r)&&this.chart.getDataVisibility(h)&&c++}),c}_computeAngle(n,c,l){return this.chart.getDataVisibility(n)?Qe(this.resolveDataElementOptions(n,c).angle||l):0}}return oe(i,"id","polarArea"),oe(i,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),oe(i,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(a){const n=a.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:c,color:l}}=a.legend.options;return n.labels.map((h,d)=>{const g=a.getDatasetMeta(0).controller.getStyle(d);return{text:h,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:l,lineWidth:g.borderWidth,pointStyle:c,hidden:!a.getDataVisibility(d),index:d}})}return[]}},onClick(a,n,c){c.chart.toggleDataVisibility(n.index),c.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}}),i})();var _o=Object.freeze({__proto__:null,BarController:fu,BubbleController:hu,DoughnutController:Cc,LineController:uu,PieController:(()=>{class i extends Cc{}return oe(i,"id","pie"),oe(i,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"}),i})(),PolarAreaController:xo,RadarController:(()=>{class i extends pi{getLabelAndValue(n){const c=this._cachedMeta.vScale,l=this.getParsed(n);return{label:c.getLabels()[n],value:""+c.getLabelForValue(l[c.axis])}}parseObjectData(n,c,l,h){return pc.bind(this)(n,c,l,h)}update(n){const c=this._cachedMeta,l=c.dataset,h=c.data||[],d=c.iScale.getLabels();if(l.points=h,"resize"!==n){const m=this.resolveDatasetElementOptions(n);this.options.showLine||(m.borderWidth=0),this.updateElement(l,void 0,{_loop:!0,_fullLoop:d.length===h.length,options:m},n)}this.updateElements(h,0,h.length,n)}updateElements(n,c,l,h){const d=this._cachedMeta.rScale,m="reset"===h;for(let g=c;g<c+l;g++){const w=n[g],b=this.resolveDataElementOptions(g,w.active?"active":h),S=d.getPointPositionForValue(g,this.getParsed(g).r),O=m?d.xCenter:S.x,I=m?d.yCenter:S.y,V={x:O,y:I,angle:S.angle,skip:isNaN(O)||isNaN(I),options:b};this.updateElement(w,g,V,h)}}}return oe(i,"id","radar"),oe(i,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),oe(i,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}}),i})(),ScatterController:(()=>{class i extends pi{getLabelAndValue(n){const c=this._cachedMeta,l=this.chart.data.labels||[],{xScale:h,yScale:d}=c,m=this.getParsed(n),g=h.getLabelForValue(m.x),w=d.getLabelForValue(m.y);return{label:l[n]||"",value:"("+g+", "+w+")"}}update(n){const c=this._cachedMeta,{data:l=[]}=c,h=this.chart._animationsDisabled;let{start:d,count:m}=ac(c,l,h);if(this._drawStart=d,this._drawCount=m,Hl(c)&&(d=0,m=l.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:g,_dataset:w}=c;g._chart=this.chart,g._datasetIndex=this.index,g._decimated=!!w._decimated,g.points=l;const b=this.resolveDatasetElementOptions(n);b.segment=this.options.segment,this.updateElement(g,void 0,{animated:!h,options:b},n)}else this.datasetElementType&&(delete c.dataset,this.datasetElementType=!1);this.updateElements(l,d,m,n)}addElements(){const{showLine:n}=this.options;!this.datasetElementType&&n&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(n,c,l,h){const d="reset"===h,{iScale:m,vScale:g,_stacked:w,_dataset:b}=this._cachedMeta,S=this.resolveDataElementOptions(c,h),O=this.getSharedOptions(S),I=this.includeOptions(h,O),V=m.axis,X=g.axis,{spanGaps:K,segment:_e}=this.options,ge=ne(K)?K:Number.POSITIVE_INFINITY,Oe=this.chart._animationsDisabled||d||"none"===h;let Pe=c>0&&this.getParsed(c-1);for(let Ee=c;Ee<c+l;++Ee){const Ie=n[Ee],st=this.getParsed(Ee),Ue=Oe?Ie:{},ut=Ut(st[X]),It=Ue[V]=m.getPixelForValue(st[V],Ee),Ft=Ue[X]=d||ut?g.getBasePixel():g.getPixelForValue(w?this.applyStack(g,st,w):st[X],Ee);Ue.skip=isNaN(It)||isNaN(Ft)||ut,Ue.stop=Ee>0&&Math.abs(st[V]-Pe[V])>ge,_e&&(Ue.parsed=st,Ue.raw=b.data[Ee]),I&&(Ue.options=O||this.resolveDataElementOptions(Ee,Ie.active?"active":h)),Oe||this.updateElement(Ie,Ee,Ue,h),Pe=st}this.updateSharedOptions(O,h,S)}getMaxOverflow(){const n=this._cachedMeta,c=n.data||[];if(!this.options.showLine){let g=0;for(let w=c.length-1;w>=0;--w)g=Math.max(g,c[w].size(this.resolveDataElementOptions(w))/2);return g>0&&g}const l=n.dataset,h=l.options&&l.options.borderWidth||0;if(!c.length)return h;const d=c[0].size(this.resolveDataElementOptions(0)),m=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(h,d,m)/2}}return oe(i,"id","scatter"),oe(i,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),oe(i,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}}),i})()});function Ma(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ra{static override(a){Object.assign(Ra.prototype,a)}constructor(a){oe(this,"options",void 0),this.options=a||{}}init(){}formats(){return Ma()}parse(){return Ma()}format(){return Ma()}add(){return Ma()}diff(){return Ma()}startOf(){return Ma()}endOf(){return Ma()}}var pu__date=Ra;function mu(i,a,n,c){const{controller:l,data:h,_sorted:d}=i,m=l._cachedMeta.iScale;if(m&&a===m.axis&&"r"!==a&&d&&h.length){const g=m._reversePixels?vr:ci;if(!c)return g(h,a,n);if(l._sharedOptions){const w=h[0],b="function"==typeof w.getRange&&w.getRange(a);if(b){const S=g(h,a,n-b),O=g(h,a,n+b);return{lo:S.lo,hi:O.hi}}}}return{lo:0,hi:h.length-1}}function vo(i,a,n,c,l){const h=i.getSortedVisibleDatasetMetas(),d=n[a];for(let m=0,g=h.length;m<g;++m){const{index:w,data:b}=h[m],{lo:S,hi:O}=mu(h[m],a,d,l);for(let I=S;I<=O;++I){const V=b[I];V.skip||c(V,w,I)}}}function Ac(i,a,n,c,l){const h=[];return!l&&!i.isPointInArea(a)||vo(i,n,a,function(m,g,w){!l&&!Ln(m,i.chartArea,0)||m.inRange(a.x,a.y,c)&&h.push({element:m,datasetIndex:g,index:w})},!0),h}function Fc(i,a,n,c,l,h){return h||i.isPointInArea(a)?"r"!==n||c?function u0(i,a,n,c,l,h){let d=[];const m=function gu(i){const a=-1!==i.indexOf("x"),n=-1!==i.indexOf("y");return function(c,l){const h=a?Math.abs(c.x-l.x):0,d=n?Math.abs(c.y-l.y):0;return Math.sqrt(Math.pow(h,2)+Math.pow(d,2))}}(n);let g=Number.POSITIVE_INFINITY;return vo(i,n,a,function w(b,S,O){const I=b.inRange(a.x,a.y,l);if(c&&!I)return;const V=b.getCenterPoint(l);if(!h&&!i.isPointInArea(V)&&!I)return;const K=m(a,V);K<g?(d=[{element:b,datasetIndex:S,index:O}],g=K):K===g&&d.push({element:b,datasetIndex:S,index:O})}),d}(i,a,n,c,l,h):function $r(i,a,n,c){let l=[];return vo(i,n,a,function h(d,m,g){const{startAngle:w,endAngle:b}=d.getProps(["startAngle","endAngle"],c),{angle:S}=kr(d,{x:a.x,y:a.y});lt(S,w,b)&&l.push({element:d,datasetIndex:m,index:g})}),l}(i,a,n,l):[]}function wo(i,a,n,c,l){const h=[],d="x"===n?"inXRange":"inYRange";let m=!1;return vo(i,n,a,(g,w,b)=>{g[d](a[n],l)&&(h.push({element:g,datasetIndex:w,index:b}),m=m||g.inRange(a.x,a.y,l))}),c&&!m?[]:h}var Dc={evaluateInteractionItems:vo,modes:{index(i,a,n,c){const l=na(a,i),h=n.axis||"x",d=n.includeInvisible||!1,m=n.intersect?Ac(i,l,h,c,d):Fc(i,l,h,!1,c,d),g=[];return m.length?(i.getSortedVisibleDatasetMetas().forEach(w=>{const b=m[0].index,S=w.data[b];S&&!S.skip&&g.push({element:S,datasetIndex:w.index,index:b})}),g):[]},dataset(i,a,n,c){const l=na(a,i),h=n.axis||"xy",d=n.includeInvisible||!1;let m=n.intersect?Ac(i,l,h,c,d):Fc(i,l,h,!1,c,d);if(m.length>0){const g=m[0].datasetIndex,w=i.getDatasetMeta(g).data;m=[];for(let b=0;b<w.length;++b)m.push({element:w[b],datasetIndex:g,index:b})}return m},point:(i,a,n,c)=>Ac(i,na(a,i),n.axis||"xy",c,n.includeInvisible||!1),nearest:(i,a,n,c)=>Fc(i,na(a,i),n.axis||"xy",n.intersect,c,n.includeInvisible||!1),x:(i,a,n,c)=>wo(i,na(a,i),"x",n.intersect,c),y:(i,a,n,c)=>wo(i,na(a,i),"y",n.intersect,c)}};const Oc=["left","top","right","bottom"];function hs(i,a){return i.filter(n=>n.pos===a)}function d0(i,a){return i.filter(n=>-1===Oc.indexOf(n.pos)&&n.box.axis===a)}function us(i,a){return i.sort((n,c)=>{const l=a?c:n,h=a?n:c;return l.weight===h.weight?l.index-h.index:l.weight-h.weight})}function ds(i,a,n,c){return Math.max(i[n],a[n])+Math.max(i[c],a[c])}function yo(i,a){i.top=Math.max(i.top,a.top),i.left=Math.max(i.left,a.left),i.bottom=Math.max(i.bottom,a.bottom),i.right=Math.max(i.right,a.right)}function _u(i,a,n,c){const{pos:l,box:h}=n,d=i.maxPadding;if(!Mt(l)){n.size&&(i[l]-=n.size);const S=c[n.stack]||{size:0,count:1};S.size=Math.max(S.size,n.horizontal?h.height:h.width),n.size=S.size/S.count,i[l]+=n.size}h.getPadding&&yo(d,h.getPadding());const m=Math.max(0,a.outerWidth-ds(d,i,"left","right")),g=Math.max(0,a.outerHeight-ds(d,i,"top","bottom")),w=m!==i.w,b=g!==i.h;return i.w=m,i.h=g,n.horizontal?{same:w,other:b}:{same:b,other:w}}function At(i,a){const n=a.maxPadding;return function c(l){const h={left:0,top:0,right:0,bottom:0};return l.forEach(d=>{h[d]=Math.max(a[d],n[d])}),h}(i?["left","right"]:["top","bottom"])}function gi(i,a,n,c){const l=[];let h,d,m,g,w,b;for(h=0,d=i.length,w=0;h<d;++h){m=i[h],g=m.box,g.update(m.width||a.w,m.height||a.h,At(m.horizontal,a));const{same:S,other:O}=_u(a,n,m,c);w|=S&&l.length,b=b||O,g.fullSize||l.push(m)}return w&&gi(l,a,n,c)||b}function Li(i,a,n,c,l){i.top=n,i.left=a,i.right=a+c,i.bottom=n+l,i.width=c,i.height=l}function la(i,a,n,c){const l=n.padding;let{x:h,y:d}=a;for(const m of i){const g=m.box,w=c[m.stack]||{count:1,placed:0,weight:1},b=m.stackWeight/w.weight||1;if(m.horizontal){const S=a.w*b,O=w.size||g.height;Ai(w.start)&&(d=w.start),g.fullSize?Li(g,l.left,d,n.outerWidth-l.right-l.left,O):Li(g,a.left+w.placed,d,S,O),w.start=d,w.placed+=S,d=g.bottom}else{const S=a.h*b,O=w.size||g.width;Ai(w.start)&&(h=w.start),g.fullSize?Li(g,h,l.top,O,n.outerHeight-l.bottom-l.top):Li(g,h,a.top+w.placed,O,S),w.start=h,w.placed+=S,h=g.right}}a.x=h,a.y=d}var kt={addBox(i,a){i.boxes||(i.boxes=[]),a.fullSize=a.fullSize||!1,a.position=a.position||"top",a.weight=a.weight||0,a._layers=a._layers||function(){return[{z:0,draw(n){a.draw(n)}}]},i.boxes.push(a)},removeBox(i,a){const n=i.boxes?i.boxes.indexOf(a):-1;-1!==n&&i.boxes.splice(n,1)},configure(i,a,n){a.fullSize=n.fullSize,a.position=n.position,a.weight=n.weight},update(i,a,n,c){if(!i)return;const l=fr(i.options.layout.padding),h=Math.max(a-l.width,0),d=Math.max(n-l.height,0),m=function Ic(i){const a=function ca(i){const a=[];let n,c,l,h,d,m;for(n=0,c=(i||[]).length;n<c;++n)l=i[n],({position:h,options:{stack:d,stackWeight:m=1}}=l),a.push({index:n,box:l,pos:h,horizontal:l.isHorizontal(),weight:l.weight,stack:d&&h+d,stackWeight:m});return a}(i),n=us(a.filter(w=>w.box.fullSize),!0),c=us(hs(a,"left"),!0),l=us(hs(a,"right")),h=us(hs(a,"top"),!0),d=us(hs(a,"bottom")),m=d0(a,"x"),g=d0(a,"y");return{fullSize:n,leftAndTop:c.concat(h),rightAndBottom:l.concat(g).concat(d).concat(m),chartArea:hs(a,"chartArea"),vertical:c.concat(l).concat(g),horizontal:h.concat(d).concat(m)}}(i.boxes),g=m.vertical,w=m.horizontal;Gt(i.boxes,X=>{"function"==typeof X.beforeLayout&&X.beforeLayout()});const b=g.reduce((X,K)=>K.box.options&&!1===K.box.options.display?X:X+1,0)||1,S=Object.freeze({outerWidth:a,outerHeight:n,padding:l,availableWidth:h,availableHeight:d,vBoxMaxWidth:h/2/b,hBoxMaxHeight:d/2}),O=Object.assign({},l);yo(O,fr(c));const I=Object.assign({maxPadding:O,w:h,h:d,x:l.left,y:l.top},l),V=function xu(i,a){const n=function mi(i){const a={};for(const n of i){const{stack:c,pos:l,stackWeight:h}=n;if(!c||!Oc.includes(l))continue;const d=a[c]||(a[c]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=h}return a}(i),{vBoxMaxWidth:c,hBoxMaxHeight:l}=a;let h,d,m;for(h=0,d=i.length;h<d;++h){m=i[h];const{fullSize:g}=m.box,w=n[m.stack],b=w&&m.stackWeight/w.weight;m.horizontal?(m.width=b?b*c:g&&a.availableWidth,m.height=l):(m.width=c,m.height=b?b*l:g&&a.availableHeight)}return n}(g.concat(w),S);gi(m.fullSize,I,S,V),gi(g,I,S,V),gi(w,I,S,V)&&gi(g,I,S,V),function p0(i){const a=i.maxPadding;function n(c){const l=Math.max(a[c]-i[c],0);return i[c]+=l,l}i.y+=n("top"),i.x+=n("left"),n("right"),n("bottom")}(I),la(m.leftAndTop,I,S,V),I.x+=I.w,I.y+=I.h,la(m.rightAndBottom,I,S,V),i.chartArea={left:I.left,top:I.top,right:I.left+I.w,bottom:I.top+I.h,height:I.h,width:I.w},Gt(m.chartArea,X=>{const K=X.box;Object.assign(K,i.chartArea),K.update(I.w,I.h,{left:0,top:0,right:0,bottom:0})})}};class m0{acquireContext(a,n){}releaseContext(a){return!1}addEventListener(a,n,c){}removeEventListener(a,n,c){}getDevicePixelRatio(){return 1}getMaximumSize(a,n,c,l){return n=Math.max(0,n||a.width),c=c||a.height,{width:n,height:Math.max(0,l?Math.floor(n/l):c)}}isAttached(a){return!0}updateConfig(a){}}class vu extends m0{acquireContext(a){return a&&a.getContext&&a.getContext("2d")||null}updateConfig(a){a.options.animation=!1}}const bo="$chartjs",g0={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},x0=i=>null===i||""===i,Pc=!!qh&&{passive:!0};function yu(i,a,n){i.canvas.removeEventListener(a,n,Pc)}function La(i,a){for(const n of i)if(n===a||n.contains(a))return!0}function v0(i,a,n){const c=i.canvas,l=new MutationObserver(h=>{let d=!1;for(const m of h)d=d||La(m.addedNodes,c),d=d&&!La(m.removedNodes,c);d&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}function fa(i,a,n){const c=i.canvas,l=new MutationObserver(h=>{let d=!1;for(const m of h)d=d||La(m.removedNodes,c),d=d&&!La(m.addedNodes,c);d&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}const Na=new Map;let Mc=0;function w0(){const i=window.devicePixelRatio;i!==Mc&&(Mc=i,Na.forEach((a,n)=>{n.currentDevicePixelRatio!==i&&a()}))}function ku(i,a,n){const c=i.canvas,l=c&&co(c);if(!l)return;const h=Nl((m,g)=>{const w=l.clientWidth;n(m,g),w<l.clientWidth&&n()},window),d=new ResizeObserver(m=>{const g=m[0],w=g.contentRect.width,b=g.contentRect.height;0===w&&0===b||h(w,b)});return d.observe(l),function y0(i,a){Na.size||window.addEventListener("resize",w0),Na.set(i,a)}(i,h),d}function ko(i,a,n){n&&n.disconnect(),"resize"===a&&function bu(i){Na.delete(i),Na.size||window.removeEventListener("resize",w0)}(i)}function Rc(i,a,n){const c=i.canvas,l=Nl(h=>{null!==i.ctx&&n(function _0(i,a){const n=g0[i.type]||i.type,{x:c,y:l}=na(i,a);return{type:n,chart:a,native:i,x:void 0!==c?c:null,y:void 0!==l?l:null}}(h,i))},i);return function xi(i,a,n){i.addEventListener(a,n,Pc)}(c,a,l),l}class Lc extends m0{acquireContext(a,n){const c=a&&a.getContext&&a.getContext("2d");return c&&c.canvas===a?(function wu(i,a){const n=i.style,c=i.getAttribute("height"),l=i.getAttribute("width");if(i[bo]={initial:{height:c,width:l,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",x0(l)){const h=r0(i,"width");void 0!==h&&(i.width=h)}if(x0(c))if(""===i.style.height)i.height=i.width/(a||2);else{const h=r0(i,"height");void 0!==h&&(i.height=h)}}(a,n),c):null}releaseContext(a){const n=a.canvas;if(!n[bo])return!1;const c=n[bo].initial;["height","width"].forEach(h=>{const d=c[h];Ut(d)?n.removeAttribute(h):n.setAttribute(h,d)});const l=c.style||{};return Object.keys(l).forEach(h=>{n.style[h]=l[h]}),n.width=n.width,delete n[bo],!0}addEventListener(a,n,c){this.removeEventListener(a,n),(a.$proxies||(a.$proxies={}))[n]=({attach:v0,detach:fa,resize:ku}[n]||Rc)(a,n,c)}removeEventListener(a,n){const c=a.$proxies||(a.$proxies={}),l=c[n];l&&(({attach:ko,detach:ko,resize:ko}[n]||yu)(a,n,l),c[n]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(a,n,c,l){return function Qh(i,a,n,c){const l=fs(i),h=Pi(l,"margin"),d=Aa(l.maxWidth,i,"clientWidth")||Ki,m=Aa(l.maxHeight,i,"clientHeight")||Ki,g=function Vr(i,a,n){let c,l;if(void 0===a||void 0===n){const h=co(i);if(h){const d=h.getBoundingClientRect(),m=fs(h),g=Pi(m,"border","width"),w=Pi(m,"padding");a=d.width-w.width-g.width,n=d.height-w.height-g.height,c=Aa(m.maxWidth,h,"clientWidth"),l=Aa(m.maxHeight,h,"clientHeight")}else a=i.clientWidth,n=i.clientHeight}return{width:a,height:n,maxWidth:c||Ki,maxHeight:l||Ki}}(i,a,n);let{width:w,height:b}=g;if("content-box"===l.boxSizing){const O=Pi(l,"border","width"),I=Pi(l,"padding");w-=I.width+O.width,b-=I.height+O.height}return w=Math.max(0,w-h.width),b=Math.max(0,c?w/c:b-h.height),w=Kn(Math.min(w,d,g.maxWidth)),b=Kn(Math.min(b,m,g.maxHeight)),w&&!b&&(b=Kn(w/2)),(void 0!==a||void 0!==n)&&c&&g.height&&b>g.height&&(b=g.height,w=Kn(Math.floor(b*c))),{width:w,height:b}}(a,n,c,l)}isAttached(a){const n=co(a);return!(!n||!n.isConnected)}}class Hn{constructor(){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"active",!1),oe(this,"options",void 0),oe(this,"$animations",void 0)}tooltipPosition(a){const{x:n,y:c}=this.getProps(["x","y"],a);return{x:n,y:c}}hasValue(){return ne(this.x)&&ne(this.y)}getProps(a,n){const c=this.$animations;if(!n||!c)return this;const l={};return a.forEach(h=>{l[h]=c[h]&&c[h].active()?c[h]._to:this[h]}),l}}function ps(i,a,n,c,l){const h=Tt(c,0),d=Math.min(Tt(l,i.length),i.length);let g,w,b,m=0;for(n=Math.ceil(n),l&&(g=l-c,n=g/Math.floor(g/n)),b=h;b<0;)m++,b=Math.round(h+m*n);for(w=Math.max(h,0);w<d;w++)w===b&&(a.push(i[w]),m++,b=Math.round(h+m*n))}oe(Hn,"defaults",{}),oe(Hn,"defaultRoutes",void 0);const T0=(i,a,n)=>"top"===a||"left"===a?i[a]+n:i[a]-n,E0=(i,a)=>Math.min(a||i,i);function C0(i,a){const n=[],c=i.length/a,l=i.length;let h=0;for(;h<l;h+=c)n.push(i[Math.floor(h)]);return n}function Au(i,a,n){const c=i.ticks.length,l=Math.min(a,c-1),h=i._startPixel,d=i._endPixel,m=1e-6;let w,g=i.getPixelForTick(l);if(!(n&&(w=1===c?Math.max(g-h,d-g):0===a?(i.getPixelForTick(1)-g)/2:(g-i.getPixelForTick(l-1))/2,g+=l<a?w:-w,g<h-m||g>d+m)))return g}function Ba(i){return i.drawTicks?i.tickLength:0}function A0(i,a){if(!i.display)return 0;const n=Rr(i.font,a),c=fr(i.padding);return(tr(i.text)?i.text.length:1)*n.lineHeight+c.height}function D0(i,a,n){let c=ss(i);return(n&&"right"!==a||!n&&"right"===a)&&(c=(i=>"left"===i?"right":"right"===i?"left":i)(c)),c}class ha extends Hn{constructor(a){super(),this.id=a.id,this.type=a.type,this.options=void 0,this.ctx=a.ctx,this.chart=a.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(a){this.options=a.setContext(this.getContext()),this.axis=a.axis,this._userMin=this.parse(a.min),this._userMax=this.parse(a.max),this._suggestedMin=this.parse(a.suggestedMin),this._suggestedMax=this.parse(a.suggestedMax)}parse(a,n){return a}getUserBounds(){let{_userMin:a,_userMax:n,_suggestedMin:c,_suggestedMax:l}=this;return a=ln(a,Number.POSITIVE_INFINITY),n=ln(n,Number.NEGATIVE_INFINITY),c=ln(c,Number.POSITIVE_INFINITY),l=ln(l,Number.NEGATIVE_INFINITY),{min:ln(a,c),max:ln(n,l),minDefined:sr(a),maxDefined:sr(n)}}getMinMax(a){let d,{min:n,max:c,minDefined:l,maxDefined:h}=this.getUserBounds();if(l&&h)return{min:n,max:c};const m=this.getMatchingVisibleMetas();for(let g=0,w=m.length;g<w;++g)d=m[g].controller.getMinMax(this,a),l||(n=Math.min(n,d.min)),h||(c=Math.max(c,d.max));return n=h&&n>c?c:n,c=l&&n>c?n:c,{min:ln(n,ln(c,n)),max:ln(c,ln(n,c))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const a=this.chart.data;return this.options.labels||(this.isHorizontal()?a.xLabels:a.yLabels)||a.labels||[]}getLabelItems(a=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(a))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){$t(this.options.beforeUpdate,[this])}update(a,n,c){const{beginAtZero:l,grace:h,ticks:d}=this.options,m=d.sampleSize;this.beforeUpdate(),this.maxWidth=a,this.maxHeight=n,this._margins=c=Object.assign({left:0,right:0,top:0,bottom:0},c),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+c.left+c.right:this.height+c.top+c.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function Zh(i,a,n){const{min:c,max:l}=i,h=Ci(a,(l-c)/2),d=(m,g)=>n&&0===m?0:m+g;return{min:d(c,-Math.abs(h)),max:d(l,h)}}(this,h,l),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const g=m<this.ticks.length;this._convertTicksToLabels(g?C0(this.ticks,m):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||"auto"===d.source)&&(this.ticks=function Eu(i,a){const n=i.options.ticks,c=function Nc(i){const a=i.options.offset,n=i._tickSize();return Math.floor(Math.min(i._length/n+(a?0:1),i._maxLength/n))}(i),l=Math.min(n.maxTicksLimit||c,c),h=n.major.enabled?function b0(i){const a=[];let n,c;for(n=0,c=i.length;n<c;n++)i[n].major&&a.push(n);return a}(a):[],d=h.length,m=h[0],g=h[d-1],w=[];if(d>l)return function k0(i,a,n,c){let d,l=0,h=n[0];for(c=Math.ceil(c),d=0;d<i.length;d++)d===h&&(a.push(i[d]),l++,h=n[l*c])}(a,w,h,d/l),w;const b=function Cu(i,a,n){const c=function Bc(i){const a=i.length;let n,c;if(a<2)return!1;for(c=i[0],n=1;n<a;++n)if(i[n]-i[n-1]!==c)return!1;return c}(i),l=a.length/n;if(!c)return Math.max(l,1);const h=function Z(i){const a=[],n=Math.sqrt(i);let c;for(c=1;c<n;c++)i%c==0&&(a.push(c),a.push(i/c));return n===(0|n)&&a.push(n),a.sort((l,h)=>l-h).pop(),a}(c);for(let d=0,m=h.length-1;d<m;d++){const g=h[d];if(g>l)return g}return Math.max(l,1)}(h,a,l);if(d>0){let S,O;const I=d>1?Math.round((g-m)/(d-1)):null;for(ps(a,w,b,Ut(I)?0:m-I,m),S=0,O=d-1;S<O;S++)ps(a,w,b,h[S],h[S+1]);return ps(a,w,b,g,Ut(I)?a.length:g+I),w}return ps(a,w,b),w}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),g&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n,c,a=this.options.reverse;this.isHorizontal()?(n=this.left,c=this.right):(n=this.top,c=this.bottom,a=!a),this._startPixel=n,this._endPixel=c,this._reversePixels=a,this._length=c-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){$t(this.options.afterUpdate,[this])}beforeSetDimensions(){$t(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){$t(this.options.afterSetDimensions,[this])}_callHooks(a){this.chart.notifyPlugins(a,this.getContext()),$t(this.options[a],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){$t(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(a){const n=this.options.ticks;let c,l,h;for(c=0,l=a.length;c<l;c++)h=a[c],h.label=$t(n.callback,[h.value,c,a],this)}afterTickToLabelConversion(){$t(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){$t(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const a=this.options,n=a.ticks,c=E0(this.ticks.length,a.ticks.maxTicksLimit),l=n.minRotation||0,h=n.maxRotation;let m,g,w,d=l;if(!this._isVisible()||!n.display||l>=h||c<=1||!this.isHorizontal())return void(this.labelRotation=l);const b=this._getLabelSizes(),S=b.widest.width,O=b.highest.height,I=nr(this.chart.width-S,0,this.maxWidth);m=a.offset?this.maxWidth/c:I/(c-1),S+6>m&&(m=I/(c-(a.offset?.5:1)),g=this.maxHeight-Ba(a.grid)-n.padding-A0(a.title,this.chart.options.font),w=Math.sqrt(S*S+O*O),d=yt(Math.min(Math.asin(nr((b.highest.height+6)/m,-1,1)),Math.asin(nr(g/w,-1,1))-Math.asin(nr(O/w,-1,1)))),d=Math.max(l,Math.min(h,d))),this.labelRotation=d}afterCalculateLabelRotation(){$t(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){$t(this.options.beforeFit,[this])}fit(){const a={width:0,height:0},{chart:n,options:{ticks:c,title:l,grid:h}}=this,d=this._isVisible(),m=this.isHorizontal();if(d){const g=A0(l,n.options.font);if(m?(a.width=this.maxWidth,a.height=Ba(h)+g):(a.height=this.maxHeight,a.width=Ba(h)+g),c.display&&this.ticks.length){const{first:w,last:b,widest:S,highest:O}=this._getLabelSizes(),I=2*c.padding,V=Qe(this.labelRotation),X=Math.cos(V),K=Math.sin(V);m?a.height=Math.min(this.maxHeight,a.height+(c.mirror?0:K*S.width+X*O.height)+I):a.width=Math.min(this.maxWidth,a.width+(c.mirror?0:X*S.width+K*O.height)+I),this._calculatePadding(w,b,K,X)}}this._handleMargins(),m?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=a.height):(this.width=a.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(a,n,c,l){const{ticks:{align:h,padding:d},position:m}=this.options,g=0!==this.labelRotation,w="top"!==m&&"x"===this.axis;if(this.isHorizontal()){const b=this.getPixelForTick(0)-this.left,S=this.right-this.getPixelForTick(this.ticks.length-1);let O=0,I=0;g?w?(O=l*a.width,I=c*n.height):(O=c*a.height,I=l*n.width):"start"===h?I=n.width:"end"===h?O=a.width:"inner"!==h&&(O=a.width/2,I=n.width/2),this.paddingLeft=Math.max((O-b+d)*this.width/(this.width-b),0),this.paddingRight=Math.max((I-S+d)*this.width/(this.width-S),0)}else{let b=n.height/2,S=a.height/2;"start"===h?(b=0,S=a.height):"end"===h&&(b=n.height,S=0),this.paddingTop=b+d,this.paddingBottom=S+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){$t(this.options.afterFit,[this])}isHorizontal(){const{axis:a,position:n}=this.options;return"top"===n||"bottom"===n||"x"===a}isFullSize(){return this.options.fullSize}_convertTicksToLabels(a){let n,c;for(this.beforeTickToLabelConversion(),this.generateTickLabels(a),n=0,c=a.length;n<c;n++)Ut(a[n].label)&&(a.splice(n,1),c--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let a=this._labelSizes;if(!a){const n=this.options.ticks.sampleSize;let c=this.ticks;n<c.length&&(c=C0(c,n)),this._labelSizes=a=this._computeLabelSizes(c,c.length,this.options.ticks.maxTicksLimit)}return a}_computeLabelSizes(a,n,c){const{ctx:l,_longestTextCache:h}=this,d=[],m=[],g=Math.floor(n/E0(n,c));let S,O,I,V,X,K,_e,ge,Oe,Pe,Ee,w=0,b=0;for(S=0;S<n;S+=g){if(V=a[S].label,X=this._resolveTickFontOptions(S),l.font=K=X.string,_e=h[K]=h[K]||{data:{},gc:[]},ge=X.lineHeight,Oe=Pe=0,Ut(V)||tr(V)){if(tr(V))for(O=0,I=V.length;O<I;++O)Ee=V[O],!Ut(Ee)&&!tr(Ee)&&(Oe=Mr(l,_e.data,_e.gc,Oe,Ee),Pe+=ge)}else Oe=Mr(l,_e.data,_e.gc,Oe,V),Pe=ge;d.push(Oe),m.push(Pe),w=Math.max(Oe,w),b=Math.max(Pe,b)}!function S0(i,a){Gt(i,n=>{const c=n.gc,l=c.length/2;let h;if(l>a){for(h=0;h<l;++h)delete n.data[c[h]];c.splice(0,l)}})}(h,n);const Ie=d.indexOf(w),st=m.indexOf(b),Ue=ut=>({width:d[ut]||0,height:m[ut]||0});return{first:Ue(0),last:Ue(n-1),widest:Ue(Ie),highest:Ue(st),widths:d,heights:m}}getLabelForValue(a){return a}getPixelForValue(a,n){return NaN}getValueForPixel(a){}getPixelForTick(a){const n=this.ticks;return a<0||a>n.length-1?null:this.getPixelForValue(n[a].value)}getPixelForDecimal(a){this._reversePixels&&(a=1-a);const n=this._startPixel+a*this._length;return function ka(i){return nr(i,-32768,32767)}(this._alignToPixels?Ji(this.chart,n,0):n)}getDecimalForPixel(a){const n=(a-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:a,max:n}=this;return a<0&&n<0?n:a>0&&n>0?a:0}getContext(a){const n=this.ticks||[];if(a>=0&&a<n.length){const c=n[a];return c.$context||(c.$context=function F0(i,a,n){return Oi(i,{tick:n,index:a,type:"tick"})}(this.getContext(),a,c))}return this.$context||(this.$context=function To(i,a){return Oi(i,{scale:a,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const a=this.options.ticks,n=Qe(this.labelRotation),c=Math.abs(Math.cos(n)),l=Math.abs(Math.sin(n)),h=this._getLabelSizes(),d=a.autoSkipPadding||0,m=h?h.widest.width+d:0,g=h?h.highest.height+d:0;return this.isHorizontal()?g*c>m*l?m/c:g/l:g*l<m*c?g/c:m/l}_isVisible(){const a=this.options.display;return"auto"!==a?!!a:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(a){const n=this.axis,c=this.chart,l=this.options,{grid:h,position:d,border:m}=l,g=h.offset,w=this.isHorizontal(),S=this.ticks.length+(g?1:0),O=Ba(h),I=[],V=m.setContext(this.getContext()),X=V.display?V.width:0,K=X/2,_e=function(ur){return Ji(c,ur,X)};let ge,Oe,Pe,Ee,Ie,st,Ue,ut,It,Ft,Nt,qr;if("top"===d)ge=_e(this.bottom),st=this.bottom-O,ut=ge-K,Ft=_e(a.top)+K,qr=a.bottom;else if("bottom"===d)ge=_e(this.top),Ft=a.top,qr=_e(a.bottom)-K,st=ge+K,ut=this.top+O;else if("left"===d)ge=_e(this.right),Ie=this.right-O,Ue=ge-K,It=_e(a.left)+K,Nt=a.right;else if("right"===d)ge=_e(this.left),It=a.left,Nt=_e(a.right)-K,Ie=ge+K,Ue=this.left+O;else if("x"===n){if("center"===d)ge=_e((a.top+a.bottom)/2+.5);else if(Mt(d)){const ur=Object.keys(d)[0];ge=_e(this.chart.scales[ur].getPixelForValue(d[ur]))}Ft=a.top,qr=a.bottom,st=ge+K,ut=st+O}else if("y"===n){if("center"===d)ge=_e((a.left+a.right)/2);else if(Mt(d)){const ur=Object.keys(d)[0];ge=_e(this.chart.scales[ur].getPixelForValue(d[ur]))}Ie=ge-K,Ue=Ie-O,It=a.left,Nt=a.right}const gn=Tt(l.ticks.maxTicksLimit,S),qt=Math.max(1,Math.ceil(S/gn));for(Oe=0;Oe<S;Oe+=qt){const ur=this.getContext(Oe),Er=h.setContext(ur),Wn=m.setContext(ur),en=Er.lineWidth,Ka=Er.color,Zo=Wn.dash||[],Ja=Wn.dashOffset,Us=Er.tickWidth,Hs=Er.tickColor,Ws=Er.tickBorderDash||[],Vs=Er.tickBorderDashOffset;Pe=Au(this,Oe,g),void 0!==Pe&&(Ee=Ji(c,Pe,en),w?Ie=Ue=It=Nt=Ee:st=ut=Ft=qr=Ee,I.push({tx1:Ie,ty1:st,tx2:Ue,ty2:ut,x1:It,y1:Ft,x2:Nt,y2:qr,width:en,color:Ka,borderDash:Zo,borderDashOffset:Ja,tickWidth:Us,tickColor:Hs,tickBorderDash:Ws,tickBorderDashOffset:Vs}))}return this._ticksLength=S,this._borderValue=ge,I}_computeLabelItems(a){const n=this.axis,c=this.options,{position:l,ticks:h}=c,d=this.isHorizontal(),m=this.ticks,{align:g,crossAlign:w,padding:b,mirror:S}=h,O=Ba(c.grid),I=O+b,V=S?-b:I,X=-Qe(this.labelRotation),K=[];let _e,ge,Oe,Pe,Ee,Ie,st,Ue,ut,It,Ft,Nt,qr="middle";if("top"===l)Ie=this.bottom-V,st=this._getXAxisLabelAlignment();else if("bottom"===l)Ie=this.top+V,st=this._getXAxisLabelAlignment();else if("left"===l){const qt=this._getYAxisLabelAlignment(O);st=qt.textAlign,Ee=qt.x}else if("right"===l){const qt=this._getYAxisLabelAlignment(O);st=qt.textAlign,Ee=qt.x}else if("x"===n){if("center"===l)Ie=(a.top+a.bottom)/2+I;else if(Mt(l)){const qt=Object.keys(l)[0];Ie=this.chart.scales[qt].getPixelForValue(l[qt])+I}st=this._getXAxisLabelAlignment()}else if("y"===n){if("center"===l)Ee=(a.left+a.right)/2-I;else if(Mt(l)){const qt=Object.keys(l)[0];Ee=this.chart.scales[qt].getPixelForValue(l[qt])}st=this._getYAxisLabelAlignment(O).textAlign}"y"===n&&("start"===g?qr="top":"end"===g&&(qr="bottom"));const gn=this._getLabelSizes();for(_e=0,ge=m.length;_e<ge;++_e){Oe=m[_e],Pe=Oe.label;const qt=h.setContext(this.getContext(_e));Ue=this.getPixelForTick(_e)+h.labelOffset,ut=this._resolveTickFontOptions(_e),It=ut.lineHeight,Ft=tr(Pe)?Pe.length:1;const ur=Ft/2,Er=qt.color,Wn=qt.textStrokeColor,en=qt.textStrokeWidth;let Zo,Ka=st;if(d?(Ee=Ue,"inner"===st&&(Ka=_e===ge-1?this.options.reverse?"left":"right":0===_e?this.options.reverse?"right":"left":"center"),Nt="top"===l?"near"===w||0!==X?-Ft*It+It/2:"center"===w?-gn.highest.height/2-ur*It+It:It/2-gn.highest.height:"near"===w||0!==X?It/2:"center"===w?gn.highest.height/2-ur*It:gn.highest.height-Ft*It,S&&(Nt*=-1),0!==X&&!qt.showLabelBackdrop&&(Ee+=It/2*Math.sin(X))):(Ie=Ue,Nt=(1-Ft)*It/2),qt.showLabelBackdrop){const Ja=fr(qt.backdropPadding),Us=gn.heights[_e],Hs=gn.widths[_e];let Ws=Nt-Ja.top,Vs=0-Ja.left;switch(qr){case"middle":Ws-=Us/2;break;case"bottom":Ws-=Us}switch(st){case"center":Vs-=Hs/2;break;case"right":Vs-=Hs}Zo={left:Vs,top:Ws,width:Hs+Ja.width,height:Us+Ja.height,color:qt.backdropColor}}K.push({label:Pe,font:ut,textOffset:Nt,options:{rotation:X,color:Er,strokeColor:Wn,strokeWidth:en,textAlign:Ka,textBaseline:qr,translation:[Ee,Ie],backdrop:Zo}})}return K}_getXAxisLabelAlignment(){const{position:a,ticks:n}=this.options;if(-Qe(this.labelRotation))return"top"===a?"left":"right";let l="center";return"start"===n.align?l="left":"end"===n.align?l="right":"inner"===n.align&&(l="inner"),l}_getYAxisLabelAlignment(a){const{position:n,ticks:{crossAlign:c,mirror:l,padding:h}}=this.options,m=a+h,g=this._getLabelSizes().widest.width;let w,b;return"left"===n?l?(b=this.right+h,"near"===c?w="left":"center"===c?(w="center",b+=g/2):(w="right",b+=g)):(b=this.right-m,"near"===c?w="right":"center"===c?(w="center",b-=g/2):(w="left",b=this.left)):"right"===n?l?(b=this.left+h,"near"===c?w="right":"center"===c?(w="center",b-=g/2):(w="left",b-=g)):(b=this.left+m,"near"===c?w="left":"center"===c?(w="center",b+=g/2):(w="right",b=this.right)):w="right",{textAlign:w,x:b}}_computeLabelArea(){if(this.options.ticks.mirror)return;const a=this.chart,n=this.options.position;return"left"===n||"right"===n?{top:0,left:this.left,bottom:a.height,right:this.right}:"top"===n||"bottom"===n?{top:this.top,left:0,bottom:this.bottom,right:a.width}:void 0}drawBackground(){const{ctx:a,options:{backgroundColor:n},left:c,top:l,width:h,height:d}=this;n&&(a.save(),a.fillStyle=n,a.fillRect(c,l,h,d),a.restore())}getLineWidthForValue(a){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const l=this.ticks.findIndex(h=>h.value===a);return l>=0?n.setContext(this.getContext(l)).lineWidth:0}drawGrid(a){const n=this.options.grid,c=this.ctx,l=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(a));let h,d;const m=(g,w,b)=>{!b.width||!b.color||(c.save(),c.lineWidth=b.width,c.strokeStyle=b.color,c.setLineDash(b.borderDash||[]),c.lineDashOffset=b.borderDashOffset,c.beginPath(),c.moveTo(g.x,g.y),c.lineTo(w.x,w.y),c.stroke(),c.restore())};if(n.display)for(h=0,d=l.length;h<d;++h){const g=l[h];n.drawOnChartArea&&m({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),n.drawTicks&&m({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const{chart:a,ctx:n,options:{border:c,grid:l}}=this,h=c.setContext(this.getContext()),d=c.display?h.width:0;if(!d)return;const m=l.setContext(this.getContext(0)).lineWidth,g=this._borderValue;let w,b,S,O;this.isHorizontal()?(w=Ji(a,this.left,d)-d/2,b=Ji(a,this.right,m)+m/2,S=O=g):(S=Ji(a,this.top,d)-d/2,O=Ji(a,this.bottom,m)+m/2,w=b=g),n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.beginPath(),n.moveTo(w,S),n.lineTo(b,O),n.stroke(),n.restore()}drawLabels(a){if(!this.options.ticks.display)return;const c=this.ctx,l=this._computeLabelArea();l&&jt(c,l);const h=this.getLabelItems(a);for(const d of h)Qi(c,d.label,0,d.textOffset,d.font,d.options);l&&Ta(c)}drawTitle(){const{ctx:a,options:{position:n,title:c,reverse:l}}=this;if(!c.display)return;const h=Rr(c.font),d=fr(c.padding),m=c.align;let g=h.lineHeight/2;"bottom"===n||"center"===n||Mt(n)?(g+=d.bottom,tr(c.text)&&(g+=h.lineHeight*(c.text.length-1))):g+=d.top;const{titleX:w,titleY:b,maxWidth:S,rotation:O}=function O0(i,a,n,c){const{top:l,left:h,bottom:d,right:m,chart:g}=i,{chartArea:w,scales:b}=g;let O,I,V,S=0;const X=d-l,K=m-h;if(i.isHorizontal()){if(I=rn(c,h,m),Mt(n)){const _e=Object.keys(n)[0];V=b[_e].getPixelForValue(n[_e])+X-a}else V="center"===n?(w.bottom+w.top)/2+X-a:T0(i,n,a);O=m-h}else{if(Mt(n)){const _e=Object.keys(n)[0];I=b[_e].getPixelForValue(n[_e])-K+a}else I="center"===n?(w.left+w.right)/2-K+a:T0(i,n,a);V=rn(c,d,l),S="left"===n?-Xt:Xt}return{titleX:I,titleY:V,maxWidth:O,rotation:S}}(this,g,n,m);Qi(a,c.text,0,0,h,{color:c.color,maxWidth:S,rotation:O,textAlign:D0(m,n,l),textBaseline:"middle",translation:[w,b]})}draw(a){this._isVisible()&&(this.drawBackground(),this.drawGrid(a),this.drawBorder(),this.drawTitle(),this.drawLabels(a))}_layers(){const a=this.options,n=a.ticks&&a.ticks.z||0,c=Tt(a.grid&&a.grid.z,-1),l=Tt(a.border&&a.border.z,0);return this._isVisible()&&this.draw===ha.prototype.draw?[{z:c,draw:h=>{this.drawBackground(),this.drawGrid(h),this.drawTitle()}},{z:l,draw:()=>{this.drawBorder()}},{z:n,draw:h=>{this.drawLabels(h)}}]:[{z:n,draw:h=>{this.draw(h)}}]}getMatchingVisibleMetas(a){const n=this.chart.getSortedVisibleDatasetMetas(),c=this.axis+"AxisID",l=[];let h,d;for(h=0,d=n.length;h<d;++h){const m=n[h];m[c]===this.id&&(!a||m.type===a)&&l.push(m)}return l}_resolveTickFontOptions(a){return Rr(this.options.ticks.setContext(this.getContext(a)).font)}_maxDigits(){const a=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/a}}class ms{constructor(a,n,c){this.type=a,this.scope=n,this.override=c,this.items=Object.create(null)}isForType(a){return Object.prototype.isPrototypeOf.call(this.type.prototype,a.prototype)}register(a){const n=Object.getPrototypeOf(a);let c;(function Ni(i){return"id"in i&&"defaults"in i})(n)&&(c=this.register(n));const l=this.items,h=a.id,d=this.scope+"."+h;if(!h)throw new Error("class does not have id: "+a);return h in l||(l[h]=a,function I0(i,a,n){const c=Zi(Object.create(null),[n?mr.get(n):{},mr.get(a),i.defaults]);mr.set(a,c),i.defaultRoutes&&function P0(i,a){Object.keys(a).forEach(n=>{const c=n.split("."),l=c.pop(),h=[i].concat(c).join("."),d=a[n].split("."),m=d.pop(),g=d.join(".");mr.route(h,l,g,m)})}(a,i.defaultRoutes),i.descriptors&&mr.describe(a,i.descriptors)}(a,d,c),this.override&&mr.override(a.id,a.overrides)),d}get(a){return this.items[a]}unregister(a){const n=this.items,c=a.id,l=this.scope;c in n&&delete n[c],l&&c in mr[l]&&(delete mr[l][c],this.override&&delete li[c])}}class Fu{constructor(){this.controllers=new ms(pi,"datasets",!0),this.elements=new ms(Hn,"elements"),this.plugins=new ms(Object,"plugins"),this.scales=new ms(ha,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...a){this._each("register",a)}remove(...a){this._each("unregister",a)}addControllers(...a){this._each("register",a,this.controllers)}addElements(...a){this._each("register",a,this.elements)}addPlugins(...a){this._each("register",a,this.plugins)}addScales(...a){this._each("register",a,this.scales)}getController(a){return this._get(a,this.controllers,"controller")}getElement(a){return this._get(a,this.elements,"element")}getPlugin(a){return this._get(a,this.plugins,"plugin")}getScale(a){return this._get(a,this.scales,"scale")}removeControllers(...a){this._each("unregister",a,this.controllers)}removeElements(...a){this._each("unregister",a,this.elements)}removePlugins(...a){this._each("unregister",a,this.plugins)}removeScales(...a){this._each("unregister",a,this.scales)}_each(a,n,c){[...n].forEach(l=>{const h=c||this._getRegistryForType(l);c||h.isForType(l)||h===this.plugins&&l.id?this._exec(a,h,l):Gt(l,d=>{const m=c||this._getRegistryForType(d);this._exec(a,m,d)})})}_exec(a,n,c){const l=Ir(a);$t(c["before"+l],[],c),n[a](c),$t(c["after"+l],[],c)}_getRegistryForType(a){for(let n=0;n<this._typedRegistries.length;n++){const c=this._typedRegistries[n];if(c.isForType(a))return c}return this.plugins}_get(a,n,c){const l=n.get(a);if(void 0===l)throw new Error('"'+a+'" is not a registered '+c+".");return l}}var Qn=new Fu;class Tr{constructor(){this._init=[]}notify(a,n,c,l){"beforeInit"===n&&(this._init=this._createDescriptors(a,!0),this._notify(this._init,a,"install"));const h=l?this._descriptors(a).filter(l):this._descriptors(a),d=this._notify(h,a,n,c);return"afterDestroy"===n&&(this._notify(h,a,"stop"),this._notify(this._init,a,"uninstall")),d}_notify(a,n,c,l){l=l||{};for(const h of a){const d=h.plugin;if(!1===$t(d[c],[n,l,h.options],d)&&l.cancelable)return!1}return!0}invalidate(){Ut(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(a){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(a);return this._notifyStateChanges(a),n}_createDescriptors(a,n){const c=a&&a.config,l=Tt(c.options&&c.options.plugins,{}),h=function dn(i){const a={},n=[],c=Object.keys(Qn.plugins.items);for(let h=0;h<c.length;h++)n.push(Qn.getPlugin(c[h]));const l=i.plugins||[];for(let h=0;h<l.length;h++){const d=l[h];-1===n.indexOf(d)&&(n.push(d),a[d.id]=!0)}return{plugins:n,localIds:a}}(c);return!1!==l||n?function Fn(i,{plugins:a,localIds:n},c,l){const h=[],d=i.getContext();for(const m of a){const g=m.id,w=Fr(c[g],l);null!==w&&h.push({plugin:m,options:M0(i.config,{plugin:m,local:n[g]},w,d)})}return h}(a,h,l,n):[]}_notifyStateChanges(a){const n=this._oldCache||[],c=this._cache,l=(h,d)=>h.filter(m=>!d.some(g=>m.plugin.id===g.plugin.id));this._notify(l(n,c),a,"stop"),this._notify(l(c,n),a,"start")}}function Fr(i,a){return a||!1!==i?!0===i?{}:i:null}function M0(i,{plugin:a,local:n},c,l){const h=i.pluginScopeKeys(a),d=i.getOptionScopes(c,h);return n&&a.defaults&&d.push(a.defaults),i.createResolver(d,l,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Uc(i,a){return((a.datasets||{})[i]||{}).indexAxis||a.indexAxis||(mr.datasets[i]||{}).indexAxis||"x"}function L0(i){if("x"===i||"y"===i||"r"===i)return i}function Du(i){return"top"===i||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0}function _i(i,...a){if(L0(i))return i;for(const n of a){const c=n.axis||Du(n.position)||i.length>1&&L0(i[0].toLowerCase());if(c)return c}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function Ua(i,a,n){if(n[a+"AxisID"]===i)return{axis:a}}function B0(i){const a=i.options||(i.options={});a.plugins=Tt(a.plugins,{}),a.scales=function N0(i,a){const n=li[i.type]||{scales:{}},c=a.scales||{},l=Uc(i.type,a),h=Object.create(null);return Object.keys(c).forEach(d=>{const m=c[d];if(!Mt(m))return console.error(`Invalid scale configuration for scale: ${d}`);if(m._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const g=_i(d,m,function ua(i,a){if(a.data&&a.data.datasets){const n=a.data.datasets.filter(c=>c.xAxisID===i||c.yAxisID===i);if(n.length)return Ua(i,"x",n[0])||Ua(i,"y",n[0])}return{}}(d,i),mr.scales[m.type]),w=function gs(i,a){return i===a?"_index_":"_value_"}(g,l),b=n.scales||{};h[d]=Si(Object.create(null),[{axis:g},m,b[g],b[w]])}),i.data.datasets.forEach(d=>{const m=d.type||i.type,g=d.indexAxis||Uc(m,a),b=(li[m]||{}).scales||{};Object.keys(b).forEach(S=>{const O=function R0(i,a){let n=i;return"_index_"===i?n=a:"_value_"===i&&(n="x"===a?"y":"x"),n}(S,g),I=d[O+"AxisID"]||O;h[I]=h[I]||Object.create(null),Si(h[I],[{axis:O},c[I],b[S]])})}),Object.keys(h).forEach(d=>{const m=h[d];Si(m,[mr.scales[m.type],mr.scale])}),h}(i,a)}function U0(i){return(i=i||{}).datasets=i.datasets||[],i.labels=i.labels||[],i}const H0=new Map,xs=new Set;function _s(i,a){let n=H0.get(i);return n||(n=a(),H0.set(i,n),xs.add(n)),n}const vs=(i,a,n)=>{const c=Pn(a,n);void 0!==c&&i.add(c)};class Iu{constructor(a){this._config=function Ou(i){return(i=i||{}).data=U0(i.data),B0(i),i}(a),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(a){this._config.type=a}get data(){return this._config.data}set data(a){this._config.data=U0(a)}get options(){return this._config.options}set options(a){this._config.options=a}get plugins(){return this._config.plugins}update(){const a=this._config;this.clearCache(),B0(a)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(a){return _s(a,()=>[[`datasets.${a}`,""]])}datasetAnimationScopeKeys(a,n){return _s(`${a}.transition.${n}`,()=>[[`datasets.${a}.transitions.${n}`,`transitions.${n}`],[`datasets.${a}`,""]])}datasetElementScopeKeys(a,n){return _s(`${a}-${n}`,()=>[[`datasets.${a}.elements.${n}`,`datasets.${a}`,`elements.${n}`,""]])}pluginScopeKeys(a){const n=a.id;return _s(`${this.type}-plugin-${n}`,()=>[[`plugins.${n}`,...a.additionalOptionScopes||[]]])}_cachedScopes(a,n){const c=this._scopeCache;let l=c.get(a);return(!l||n)&&(l=new Map,c.set(a,l)),l}getOptionScopes(a,n,c){const{options:l,type:h}=this,d=this._cachedScopes(a,c),m=d.get(n);if(m)return m;const g=new Set;n.forEach(b=>{a&&(g.add(a),b.forEach(S=>vs(g,a,S))),b.forEach(S=>vs(g,l,S)),b.forEach(S=>vs(g,li[h]||{},S)),b.forEach(S=>vs(g,mr,S)),b.forEach(S=>vs(g,io,S))});const w=Array.from(g);return 0===w.length&&w.push(Object.create(null)),xs.has(n)&&d.set(n,w),w}chartOptionScopes(){const{options:a,type:n}=this;return[a,li[n]||{},mr.datasets[n]||{},{type:n},mr,io]}resolveNamedOptions(a,n,c,l=[""]){const h={$shared:!0},{resolver:d,subPrefixes:m}=Hc(this._resolverCache,a,l);let g=d;(function qn(i,a){const{isScriptable:n,isIndexable:c}=lc(i);for(const l of a){const h=n(l),d=c(l),m=(d||h)&&i[l];if(h&&(Mn(m)||W0(m))||d&&tr(m))return!0}return!1})(d,n)&&(h.$shared=!1,g=qi(d,c=Mn(c)?c():c,this.createResolver(a,c,m)));for(const w of n)h[w]=g[w];return h}createResolver(a,n,c=[""],l){const{resolver:h}=Hc(this._resolverCache,a,c);return Mt(n)?qi(h,n,void 0,l):h}}function Hc(i,a,n){let c=i.get(a);c||(c=new Map,i.set(a,c));const l=n.join();let h=c.get(l);return h||(h={resolver:cc(a,n),subPrefixes:n.filter(m=>!m.toLowerCase().includes("hover"))},c.set(l,h)),h}const W0=i=>Mt(i)&&Object.getOwnPropertyNames(i).reduce((a,n)=>a||Mn(i[n]),!1),Pu=["top","bottom","left","right","chartArea"];function V0(i,a){return"top"===i||"bottom"===i||-1===Pu.indexOf(i)&&"x"===a}function z0(i,a){return function(n,c){return n[i]===c[i]?n[a]-c[a]:n[i]-c[i]}}function Wc(i){const a=i.chart,n=a.options.animation;a.notifyPlugins("afterRender"),$t(n&&n.onComplete,[i],a)}function Mu(i){const a=i.chart,n=a.options.animation;$t(n&&n.onProgress,[i],a)}function ws(i){return oo()&&"string"==typeof i?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const ys={},Vc=i=>{const a=ws(i);return Object.values(ys).filter(n=>n.canvas===a).pop()};function Ru(i,a,n){const c=Object.keys(i);for(const l of c){const h=+l;if(h>=a){const d=i[l];delete i[l],(n>0||h>a)&&(i[h+n]=d)}}}function Eo(i,a,n){return i.options.clip?i[n]:a[n]}let Lr=(()=>{class i{static register(...n){Qn.add(...n),j0()}static unregister(...n){Qn.remove(...n),j0()}constructor(n,c){const l=this.config=new Iu(c),h=ws(n),d=Vc(h);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const m=l.createResolver(l.chartOptionScopes(),this.getContext());this.platform=new(l.platform||function Tu(i){return!oo()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?vu:Lc}(h)),this.platform.updateConfig(l);const g=this.platform.acquireContext(h,m.aspectRatio),w=g&&g.canvas,b=w&&w.height,S=w&&w.width;this.id=Js(),this.ctx=g,this.canvas=w,this.width=S,this.height=b,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Tr,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function Bl(i,a){let n;return function(...c){return a?(clearTimeout(n),n=setTimeout(i,a,c)):i.apply(this,c),a}}(O=>this.update(O),m.resizeDelay||0),this._dataChanges=[],ys[this.id]=this,g&&w?(ui.listen(this,"complete",Wc),ui.listen(this,"progress",Mu),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:n,maintainAspectRatio:c},width:l,height:h,_aspectRatio:d}=this;return Ut(n)?c&&d?d:h?l/h:null:n}get data(){return this.config.data}set data(n){this.config.data=n}get options(){return this._options}set options(n){this.config.options=n}get registry(){return Qn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Da(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Et(this.canvas,this.ctx),this}stop(){return ui.stop(this),this}resize(n,c){ui.running(this)?this._resizeBeforeDraw={width:n,height:c}:this._resize(n,c)}_resize(n,c){const l=this.options,m=this.platform.getMaximumSize(this.canvas,n,c,l.maintainAspectRatio&&this.aspectRatio),g=l.devicePixelRatio||this.platform.getDevicePixelRatio(),w=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,Da(this,g,!0)&&(this.notifyPlugins("resize",{size:m}),$t(l.onResize,[this,m],this),this.attached&&this._doResize(w)&&this.render())}ensureScalesHaveIDs(){Gt(this.options.scales||{},(l,h)=>{l.id=h})}buildOrUpdateScales(){const n=this.options,c=n.scales,l=this.scales,h=Object.keys(l).reduce((m,g)=>(m[g]=!1,m),{});let d=[];c&&(d=d.concat(Object.keys(c).map(m=>{const g=c[m],w=_i(m,g),b="r"===w,S="x"===w;return{options:g,dposition:b?"chartArea":S?"bottom":"left",dtype:b?"radialLinear":S?"category":"linear"}}))),Gt(d,m=>{const g=m.options,w=g.id,b=_i(w,g),S=Tt(g.type,m.dtype);(void 0===g.position||V0(g.position,b)!==V0(m.dposition))&&(g.position=m.dposition),h[w]=!0;let O=null;w in l&&l[w].type===S?O=l[w]:(O=new(Qn.getScale(S))({id:w,type:S,ctx:this.ctx,chart:this}),l[O.id]=O),O.init(g,n)}),Gt(h,(m,g)=>{m||delete l[g]}),Gt(l,m=>{kt.configure(this,m,m.options),kt.addBox(this,m)})}_updateMetasets(){const n=this._metasets,c=this.data.datasets.length,l=n.length;if(n.sort((h,d)=>h.index-d.index),l>c){for(let h=c;h<l;++h)this._destroyDatasetMeta(h);n.splice(c,l-c)}this._sortedMetasets=n.slice(0).sort(z0("order","index"))}_removeUnreferencedMetasets(){const{_metasets:n,data:{datasets:c}}=this;n.length>c.length&&delete this._stacks,n.forEach((l,h)=>{0===c.filter(d=>d===l._dataset).length&&this._destroyDatasetMeta(h)})}buildOrUpdateControllers(){const n=[],c=this.data.datasets;let l,h;for(this._removeUnreferencedMetasets(),l=0,h=c.length;l<h;l++){const d=c[l];let m=this.getDatasetMeta(l);const g=d.type||this.config.type;if(m.type&&m.type!==g&&(this._destroyDatasetMeta(l),m=this.getDatasetMeta(l)),m.type=g,m.indexAxis=d.indexAxis||Uc(g,this.options),m.order=d.order||0,m.index=l,m.label=""+d.label,m.visible=this.isDatasetVisible(l),m.controller)m.controller.updateIndex(l),m.controller.linkScales();else{const w=Qn.getController(g),{datasetElementType:b,dataElementType:S}=mr.datasets[g];Object.assign(w,{dataElementType:Qn.getElement(S),datasetElementType:b&&Qn.getElement(b)}),m.controller=new w(this,l),n.push(m.controller)}}return this._updateMetasets(),n}_resetElements(){Gt(this.data.datasets,(n,c)=>{this.getDatasetMeta(c).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(n){const c=this.config;c.update();const l=this._options=c.createResolver(c.chartOptionScopes(),this.getContext()),h=this._animationsDisabled=!l.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:n,cancelable:!0}))return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let b=0,S=this.data.datasets.length;b<S;b++){const{controller:O}=this.getDatasetMeta(b),I=!h&&-1===d.indexOf(O);O.buildOrUpdateElements(I),m=Math.max(+O.getMaxOverflow(),m)}m=this._minPadding=l.layout.autoPadding?m:0,this._updateLayout(m),h||Gt(d,b=>{b.reset()}),this._updateDatasets(n),this.notifyPlugins("afterUpdate",{mode:n}),this._layers.sort(z0("z","_idx"));const{_active:g,_lastEvent:w}=this;w?this._eventHandler(w,!0):g.length&&this._updateHoverStyles(g,g,!0),this.render()}_updateScales(){Gt(this.scales,n=>{kt.removeBox(this,n)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const n=this.options,c=new Set(Object.keys(this._listeners)),l=new Set(n.events);(!ro(c,l)||!!this._responsiveListeners!==n.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,c=this._getUniformDataChanges()||[];for(const{method:l,start:h,count:d}of c)Ru(n,h,"_removeElements"===l?-d:d)}_getUniformDataChanges(){const n=this._dataChanges;if(!n||!n.length)return;this._dataChanges=[];const c=this.data.datasets.length,l=d=>new Set(n.filter(m=>m[0]===d).map((m,g)=>g+","+m.splice(1).join(","))),h=l(0);for(let d=1;d<c;d++)if(!ro(h,l(d)))return;return Array.from(h).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(n){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;kt.update(this,this.width,this.height,n);const c=this.chartArea,l=c.width<=0||c.height<=0;this._layers=[],Gt(this.boxes,h=>{l&&"chartArea"===h.position||(h.configure&&h.configure(),this._layers.push(...h._layers()))},this),this._layers.forEach((h,d)=>{h._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(n){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:n,cancelable:!0})){for(let c=0,l=this.data.datasets.length;c<l;++c)this.getDatasetMeta(c).controller.configure();for(let c=0,l=this.data.datasets.length;c<l;++c)this._updateDataset(c,Mn(n)?n({datasetIndex:c}):n);this.notifyPlugins("afterDatasetsUpdate",{mode:n})}}_updateDataset(n,c){const l=this.getDatasetMeta(n),h={meta:l,index:n,mode:c,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",h)&&(l.controller._update(c),h.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",h))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(ui.has(this)?this.attached&&!ui.running(this)&&ui.start(this):(this.draw(),Wc({chart:this})))}draw(){let n;if(this._resizeBeforeDraw){const{width:l,height:h}=this._resizeBeforeDraw;this._resize(l,h),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const c=this._layers;for(n=0;n<c.length&&c[n].z<=0;++n)c[n].draw(this.chartArea);for(this._drawDatasets();n<c.length;++n)c[n].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(n){const c=this._sortedMetasets,l=[];let h,d;for(h=0,d=c.length;h<d;++h){const m=c[h];(!n||m.visible)&&l.push(m)}return l}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const n=this.getSortedVisibleDatasetMetas();for(let c=n.length-1;c>=0;--c)this._drawDataset(n[c]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(n){const c=this.ctx,l=n._clip,h=!l.disabled,d=function Lu(i,a){const{xScale:n,yScale:c}=i;return n&&c?{left:Eo(n,a,"left"),right:Eo(n,a,"right"),top:Eo(c,a,"top"),bottom:Eo(c,a,"bottom")}:a}(n,this.chartArea),m={meta:n,index:n.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",m)&&(h&&jt(c,{left:!1===l.left?0:d.left-l.left,right:!1===l.right?this.width:d.right+l.right,top:!1===l.top?0:d.top-l.top,bottom:!1===l.bottom?this.height:d.bottom+l.bottom}),n.controller.draw(),h&&Ta(c),m.cancelable=!1,this.notifyPlugins("afterDatasetDraw",m))}isPointInArea(n){return Ln(n,this.chartArea,this._minPadding)}getElementsAtEventForMode(n,c,l,h){const d=Dc.modes[c];return"function"==typeof d?d(this,n,l,h):[]}getDatasetMeta(n){const c=this.data.datasets[n],l=this._metasets;let h=l.filter(d=>d&&d._dataset===c).pop();return h||(h={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:c&&c.order||0,index:n,_dataset:c,_parsed:[],_sorted:!1},l.push(h)),h}getContext(){return this.$context||(this.$context=Oi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(n){const c=this.data.datasets[n];if(!c)return!1;const l=this.getDatasetMeta(n);return"boolean"==typeof l.hidden?!l.hidden:!c.hidden}setDatasetVisibility(n,c){this.getDatasetMeta(n).hidden=!c}toggleDataVisibility(n){this._hiddenIndices[n]=!this._hiddenIndices[n]}getDataVisibility(n){return!this._hiddenIndices[n]}_updateVisibility(n,c,l){const h=l?"show":"hide",d=this.getDatasetMeta(n),m=d.controller._resolveAnimations(void 0,h);Ai(c)?(d.data[c].hidden=!l,this.update()):(this.setDatasetVisibility(n,l),m.update(d,{visible:l}),this.update(g=>g.datasetIndex===n?h:void 0))}hide(n,c){this._updateVisibility(n,c,!1)}show(n,c){this._updateVisibility(n,c,!0)}_destroyDatasetMeta(n){const c=this._metasets[n];c&&c.controller&&c.controller._destroy(),delete this._metasets[n]}_stop(){let n,c;for(this.stop(),ui.remove(this),n=0,c=this.data.datasets.length;n<c;++n)this._destroyDatasetMeta(n)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:n,ctx:c}=this;this._stop(),this.config.clearCache(),n&&(this.unbindEvents(),Et(n,c),this.platform.releaseContext(c),this.canvas=null,this.ctx=null),delete ys[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...n){return this.canvas.toDataURL(...n)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const n=this._listeners,c=this.platform,l=(d,m)=>{c.addEventListener(this,d,m),n[d]=m},h=(d,m,g)=>{d.offsetX=m,d.offsetY=g,this._eventHandler(d)};Gt(this.options.events,d=>l(d,h))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const n=this._responsiveListeners,c=this.platform,l=(w,b)=>{c.addEventListener(this,w,b),n[w]=b},h=(w,b)=>{n[w]&&(c.removeEventListener(this,w,b),delete n[w])},d=(w,b)=>{this.canvas&&this.resize(w,b)};let m;const g=()=>{h("attach",g),this.attached=!0,this.resize(),l("resize",d),l("detach",m)};m=()=>{this.attached=!1,h("resize",d),this._stop(),this._resize(0,0),l("attach",g)},c.isAttached(this.canvas)?g():m()}unbindEvents(){Gt(this._listeners,(n,c)=>{this.platform.removeEventListener(this,c,n)}),this._listeners={},Gt(this._responsiveListeners,(n,c)=>{this.platform.removeEventListener(this,c,n)}),this._responsiveListeners=void 0}updateHoverStyle(n,c,l){const h=l?"set":"remove";let d,m,g,w;for("dataset"===c&&(d=this.getDatasetMeta(n[0].datasetIndex),d.controller["_"+h+"DatasetHoverStyle"]()),g=0,w=n.length;g<w;++g){m=n[g];const b=m&&this.getDatasetMeta(m.datasetIndex).controller;b&&b[h+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(n){const c=this._active||[],l=n.map(({datasetIndex:d,index:m})=>{const g=this.getDatasetMeta(d);if(!g)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:g.data[m],index:m}});!ba(l,c)&&(this._active=l,this._lastEvent=null,this._updateHoverStyles(l,c))}notifyPlugins(n,c,l){return this._plugins.notify(this,n,c,l)}isPluginEnabled(n){return 1===this._plugins._cache.filter(c=>c.plugin.id===n).length}_updateHoverStyles(n,c,l){const h=this.options.hover,d=(w,b)=>w.filter(S=>!b.some(O=>S.datasetIndex===O.datasetIndex&&S.index===O.index)),m=d(c,n),g=l?n:d(n,c);m.length&&this.updateHoverStyle(m,h.mode,!1),g.length&&h.mode&&this.updateHoverStyle(g,h.mode,!0)}_eventHandler(n,c){const l={event:n,replay:c,cancelable:!0,inChartArea:this.isPointInArea(n)},h=m=>(m.options.events||this.options.events).includes(n.native.type);if(!1===this.notifyPlugins("beforeEvent",l,h))return;const d=this._handleEvent(n,c,l.inChartArea);return l.cancelable=!1,this.notifyPlugins("afterEvent",l,h),(d||l.changed)&&this.render(),this}_handleEvent(n,c,l){const{_active:h=[],options:d}=this,g=this._getActiveElements(n,h,l,c),w=function rc(i){return"mouseup"===i.type||"click"===i.type||"contextmenu"===i.type}(n),b=function $0(i,a,n,c){return n&&"mouseout"!==i.type?c?a:i:null}(n,this._lastEvent,l,w);l&&(this._lastEvent=null,$t(d.onHover,[n,g,this],this),w&&$t(d.onClick,[n,g,this],this));const S=!ba(g,h);return(S||c)&&(this._active=g,this._updateHoverStyles(g,h,c)),this._lastEvent=b,S}_getActiveElements(n,c,l,h){if("mouseout"===n.type)return[];if(!l)return c;const d=this.options.hover;return this.getElementsAtEventForMode(n,d.mode,d,h)}}return oe(i,"defaults",mr),oe(i,"instances",ys),oe(i,"overrides",li),oe(i,"registry",Qn),oe(i,"version","4.4.0"),oe(i,"getChart",Vc),i})();function j0(){return Gt(Lr.instances,i=>i._plugins.invalidate())}function Ha(i,a,n,c){return{x:n+i*Math.cos(a),y:c+i*Math.sin(a)}}function So(i,a,n,c,l,h){const{x:d,y:m,startAngle:g,pixelMargin:w,innerRadius:b}=a,S=Math.max(a.outerRadius+c+n-w,0),O=b>0?b+c+n+w:0;let I=0;const V=l-g;if(c){const Er=((b>0?b-c:0)+(S>0?S-c:0))/2;I=(V-(0!==Er?V*Er/(Er+c):V))/2}const K=(V-Math.max(.001,V*S-n/Rt)/S)/2,_e=g+K+I,ge=l-K-I,{outerStart:Oe,outerEnd:Pe,innerStart:Ee,innerEnd:Ie}=function zc(i,a,n,c){const l=function Co(i){return ao(i,["outerStart","outerEnd","innerStart","innerEnd"])}(i.options.borderRadius),h=(n-a)/2,d=Math.min(h,c*a/2),m=g=>{const w=(n-Math.min(h,g))*c/2;return nr(g,0,Math.min(h,w))};return{outerStart:m(l.outerStart),outerEnd:m(l.outerEnd),innerStart:nr(l.innerStart,0,d),innerEnd:nr(l.innerEnd,0,d)}}(a,O,S,ge-_e),st=S-Oe,Ue=S-Pe,ut=_e+Oe/st,It=ge-Pe/Ue,Ft=O+Ee,Nt=O+Ie,qr=_e+Ee/Ft,gn=ge-Ie/Nt;if(i.beginPath(),h){const qt=(ut+It)/2;if(i.arc(d,m,S,ut,qt),i.arc(d,m,S,qt,It),Pe>0){const en=Ha(Ue,It,d,m);i.arc(en.x,en.y,Pe,It,ge+Xt)}const ur=Ha(Nt,ge,d,m);if(i.lineTo(ur.x,ur.y),Ie>0){const en=Ha(Nt,gn,d,m);i.arc(en.x,en.y,Ie,ge+Xt,gn+Math.PI)}const Er=(ge-Ie/O+(_e+Ee/O))/2;if(i.arc(d,m,O,ge-Ie/O,Er,!0),i.arc(d,m,O,Er,_e+Ee/O,!0),Ee>0){const en=Ha(Ft,qr,d,m);i.arc(en.x,en.y,Ee,qr+Math.PI,_e-Xt)}const Wn=Ha(st,_e,d,m);if(i.lineTo(Wn.x,Wn.y),Oe>0){const en=Ha(st,ut,d,m);i.arc(en.x,en.y,Oe,_e-Xt,ut)}}else{i.moveTo(d,m);const qt=Math.cos(ut)*S+d,ur=Math.sin(ut)*S+m;i.lineTo(qt,ur);const Er=Math.cos(It)*S+d,Wn=Math.sin(It)*S+m;i.lineTo(Er,Wn)}i.closePath()}class bs extends Hn{constructor(a){super(),oe(this,"circumference",void 0),oe(this,"endAngle",void 0),oe(this,"fullCircles",void 0),oe(this,"innerRadius",void 0),oe(this,"outerRadius",void 0),oe(this,"pixelMargin",void 0),oe(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,a&&Object.assign(this,a)}inRange(a,n,c){const l=this.getProps(["x","y"],c),{angle:h,distance:d}=kr(l,{x:a,y:n}),{startAngle:m,endAngle:g,innerRadius:w,outerRadius:b,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],c),O=(this.options.spacing+this.options.borderWidth)/2,V=Tt(S,g-m)>=rr||lt(h,m,g),X=Rn(d,w+O,b+O);return V&&X}getCenterPoint(a){const{x:n,y:c,startAngle:l,endAngle:h,innerRadius:d,outerRadius:m}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],a),{offset:g,spacing:w}=this.options,b=(l+h)/2,S=(d+m+w+g)/2;return{x:n+Math.cos(b)*S,y:c+Math.sin(b)*S}}tooltipPosition(a){return this.getCenterPoint(a)}draw(a){const{options:n,circumference:c}=this,l=(n.offset||0)/4,h=(n.spacing||0)/2,d=n.circular;if(this.pixelMargin="inner"===n.borderAlign?.33:0,this.fullCircles=c>rr?Math.floor(c/rr):0,0===c||this.innerRadius<0||this.outerRadius<0)return;a.save();const m=(this.startAngle+this.endAngle)/2;a.translate(Math.cos(m)*l,Math.sin(m)*l);const w=l*(1-Math.sin(Math.min(Rt,c||0)));a.fillStyle=n.backgroundColor,a.strokeStyle=n.borderColor,function Bu(i,a,n,c,l){const{fullCircles:h,startAngle:d,circumference:m}=a;let g=a.endAngle;if(h){So(i,a,n,c,g,l);for(let w=0;w<h;++w)i.fill();isNaN(m)||(g=d+(m%rr||rr))}So(i,a,n,c,g,l),i.fill()}(a,this,w,h,d),function Uu(i,a,n,c,l){const{fullCircles:h,startAngle:d,circumference:m,options:g}=a,{borderWidth:w,borderJoinStyle:b,borderDash:S,borderDashOffset:O}=g,I="inner"===g.borderAlign;if(!w)return;i.setLineDash(S||[]),i.lineDashOffset=O,I?(i.lineWidth=2*w,i.lineJoin=b||"round"):(i.lineWidth=w,i.lineJoin=b||"bevel");let V=a.endAngle;if(h){So(i,a,n,c,V,l);for(let X=0;X<h;++X)i.stroke();isNaN(m)||(V=d+(m%rr||rr))}I&&function Nu(i,a,n){const{startAngle:c,pixelMargin:l,x:h,y:d,outerRadius:m,innerRadius:g}=a;let w=l/m;i.beginPath(),i.arc(h,d,m,c-w,n+w),g>l?(w=l/g,i.arc(h,d,g,n+w,c-w,!0)):i.arc(h,d,l,n+Xt,c-Xt),i.closePath(),i.clip()}(i,a,V),h||(So(i,a,n,c,V,l),i.stroke())}(a,this,w,h,d),a.restore()}}function G0(i,a,n=a){i.lineCap=Tt(n.borderCapStyle,a.borderCapStyle),i.setLineDash(Tt(n.borderDash,a.borderDash)),i.lineDashOffset=Tt(n.borderDashOffset,a.borderDashOffset),i.lineJoin=Tt(n.borderJoinStyle,a.borderJoinStyle),i.lineWidth=Tt(n.borderWidth,a.borderWidth),i.strokeStyle=Tt(n.borderColor,a.borderColor)}function Hu(i,a,n){i.lineTo(n.x,n.y)}function X0(i,a,n={}){const c=i.length,{start:l=0,end:h=c-1}=n,{start:d,end:m}=a,g=Math.max(l,d),w=Math.min(h,m);return{count:c,start:g,loop:a.loop,ilen:w<g&&!(l<d&&h<d||l>m&&h>m)?c+w-g:w-g}}function Vu(i,a,n,c){const{points:l,options:h}=a,{count:d,start:m,loop:g,ilen:w}=X0(l,n,c),b=function Wu(i){return i.stepped?Xh:i.tension||"monotone"===i.cubicInterpolationMode?Jt:Hu}(h);let I,V,X,{move:S=!0,reverse:O}=c||{};for(I=0;I<=w;++I)V=l[(m+(O?w-I:I))%d],!V.skip&&(S?(i.moveTo(V.x,V.y),S=!1):b(i,X,V,O,h.stepped),X=V);return g&&(V=l[(m+(O?w:0))%d],b(i,X,V,O,h.stepped)),!!g}function zu(i,a,n,c){const l=a.points,{count:h,start:d,ilen:m}=X0(l,n,c),{move:g=!0,reverse:w}=c||{};let O,I,V,X,K,_e,b=0,S=0;const ge=Pe=>(d+(w?m-Pe:Pe))%h,Oe=()=>{X!==K&&(i.lineTo(b,K),i.lineTo(b,X),i.lineTo(b,_e))};for(g&&(I=l[ge(0)],i.moveTo(I.x,I.y)),O=0;O<=m;++O){if(I=l[ge(O)],I.skip)continue;const Pe=I.x,Ee=I.y,Ie=0|Pe;Ie===V?(Ee<X?X=Ee:Ee>K&&(K=Ee),b=(S*b+Pe)/++S):(Oe(),i.lineTo(Pe,Ee),V=Ie,S=0,X=K=Ee),_e=Ee}Oe()}function $c(i){const a=i.options;return i._decimated||i._loop||a.tension||"monotone"===a.cubicInterpolationMode||a.stepped||a.borderDash&&a.borderDash.length?Vu:zu}oe(bs,"id","arc"),oe(bs,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),oe(bs,"defaultRoutes",{backgroundColor:"backgroundColor"}),oe(bs,"descriptors",{_scriptable:!0,_indexable:i=>"borderDash"!==i});const Gu="function"==typeof Path2D;let Ao=(()=>{class i extends Hn{constructor(n){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,n&&Object.assign(this,n)}updateControlPoints(n,c){const l=this.options;!l.tension&&"monotone"!==l.cubicInterpolationMode||l.stepped||this._pointsUpdated||(t0(this._points,l,n,l.spanGaps?this._loop:this._fullLoop,c),this._pointsUpdated=!0)}set points(n){this._points=n,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function tu(i,a){const n=i.points,c=i.options.spanGaps,l=n.length;if(!l)return[];const h=!!i._loop,{start:d,end:m}=function vc(i,a,n,c){let l=0,h=a-1;if(n&&!c)for(;l<a&&!i[l].skip;)l++;for(;l<a&&i[l].skip;)l++;for(l%=a,n&&(h+=l);h>l&&i[h%a].skip;)h--;return h%=a,{start:l,end:h}}(n,l,h,c);return function a0(i,a,n,c){return c&&c.setContext&&n?function wc(i,a,n,c){const l=i._chart.getContext(),h=lr(i.options),{_datasetIndex:d,options:{spanGaps:m}}=i,g=n.length,w=[];let b=h,S=a[0].start,O=S;function I(V,X,K,_e){const ge=m?-1:1;if(V!==X){for(V+=g;n[V%g].skip;)V-=ge;for(;n[X%g].skip;)X+=ge;V%g!=X%g&&(w.push({start:V%g,end:X%g,loop:K,style:_e}),b=_e,S=X%g)}}for(const V of a){S=m?S:V.start;let K,X=n[S%g];for(O=S+1;O<=V.end;O++){const _e=n[O%g];K=lr(c.setContext(Oi(l,{type:"segment",p0:X,p1:_e,p0DataIndex:(O-1)%g,p1DataIndex:O%g,datasetIndex:d}))),ru(K,b)&&I(S,O-1,V.loop,b),X=_e,b=K}S<O-1&&I(S,O-1,V.loop,b)}return w}(i,a,n,c):a}(i,!0===c?[{start:d,end:m,loop:h}]:function wr(i,a,n,c){const l=i.length,h=[];let g,d=a,m=i[a];for(g=a+1;g<=n;++g){const w=i[g%l];w.skip||w.stop?m.skip||(h.push({start:a%l,end:(g-1)%l,loop:c=!1}),a=d=w.stop?g:null):(d=g,m.skip&&(a=g)),m=w}return null!==d&&h.push({start:a%l,end:d%l,loop:c}),h}(n,d,m<d?m+l:m,!!i._fullLoop&&0===d&&m===l-1),n,a)}(this,this.options.segment))}first(){const n=this.segments;return n.length&&this.points[n[0].start]}last(){const n=this.segments,l=n.length;return l&&this.points[n[l-1].end]}interpolate(n,c){const l=this.options,h=n[c],d=this.points,m=fo(this,{property:c,start:h,end:h});if(!m.length)return;const g=[],w=function Y0(i){return i.stepped?eu:i.tension||"monotone"===i.cubicInterpolationMode?n0:ia}(l);let b,S;for(b=0,S=m.length;b<S;++b){const{start:O,end:I}=m[b],V=d[O],X=d[I];if(V===X){g.push(V);continue}const _e=w(V,X,Math.abs((h-V[c])/(X[c]-V[c])),l.stepped);_e[c]=n[c],g.push(_e)}return 1===g.length?g[0]:g}pathSegment(n,c,l){return $c(this)(n,this,c,l)}path(n,c,l){const h=this.segments,d=$c(this);let m=this._loop;c=c||0,l=l||this.points.length-c;for(const g of h)m&=d(n,this,g,{start:c,end:c+l-1});return!!m}draw(n,c,l,h){(this.points||[]).length&&(this.options||{}).borderWidth&&(n.save(),function Xu(i,a,n,c){Gu&&!a.options.segment?function $u(i,a,n,c){let l=a._path;l||(l=a._path=new Path2D,a.path(l,n,c)&&l.closePath()),G0(i,a.options),i.stroke(l)}(i,a,n,c):function ju(i,a,n,c){const{segments:l,options:h}=a,d=$c(a);for(const m of l)G0(i,h,m.style),i.beginPath(),d(i,a,m,{start:n,end:n+c-1})&&i.closePath(),i.stroke()}(i,a,n,c)}(n,this,l,h),n.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return oe(i,"id","line"),oe(i,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),oe(i,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),oe(i,"descriptors",{_scriptable:!0,_indexable:a=>"borderDash"!==a&&"fill"!==a}),i})();function Z0(i,a,n,c){const l=i.options,{[n]:h}=i.getProps([n],c);return Math.abs(a-h)<l.radius+l.hitRadius}let Yu=(()=>{class i extends Hn{constructor(n){super(),oe(this,"parsed",void 0),oe(this,"skip",void 0),oe(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,c,l){const h=this.options,{x:d,y:m}=this.getProps(["x","y"],l);return Math.pow(n-d,2)+Math.pow(c-m,2)<Math.pow(h.hitRadius+h.radius,2)}inXRange(n,c){return Z0(this,n,"x",c)}inYRange(n,c){return Z0(this,n,"y",c)}getCenterPoint(n){const{x:c,y:l}=this.getProps(["x","y"],n);return{x:c,y:l}}size(n){let c=(n=n||this.options||{}).radius||0;return c=Math.max(c,c&&n.hoverRadius||0),2*(c+(c&&n.borderWidth||0))}draw(n,c){const l=this.options;this.skip||l.radius<.1||!Ln(this,c,this.size(l)/2)||(n.strokeStyle=l.borderColor,n.lineWidth=l.borderWidth,n.fillStyle=l.backgroundColor,Sn(n,l,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}return oe(i,"id","point"),oe(i,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),oe(i,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),i})();function K0(i,a){const{x:n,y:c,base:l,width:h,height:d}=i.getProps(["x","y","base","width","height"],a);let m,g,w,b,S;return i.horizontal?(S=d/2,m=Math.min(n,l),g=Math.max(n,l),w=c-S,b=c+S):(S=h/2,m=n-S,g=n+S,w=Math.min(c,l),b=Math.max(c,l)),{left:m,top:w,right:g,bottom:b}}function Bi(i,a,n,c){return i?0:nr(a,n,c)}function jc(i,a,n,c){const l=null===a,h=null===n,m=i&&!(l&&h)&&K0(i,c);return m&&(l||Rn(a,m.left,m.right))&&(h||Rn(n,m.top,m.bottom))}function J0(i,a){i.rect(a.x,a.y,a.w,a.h)}function Gc(i,a,n={}){const c=i.x!==n.x?-a:0,l=i.y!==n.y?-a:0;return{x:i.x+c,y:i.y+l,w:i.w+((i.x+i.w!==n.x+n.w?a:0)-c),h:i.h+((i.y+i.h!==n.y+n.h?a:0)-l),radius:i.radius}}class Fo extends Hn{constructor(a){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,a&&Object.assign(this,a)}draw(a){const{inflateAmount:n,options:{borderColor:c,backgroundColor:l}}=this,{inner:h,outer:d}=function Ju(i){const a=K0(i),n=a.right-a.left,c=a.bottom-a.top,l=function Zu(i,a,n){const l=i.borderSkipped,h=cs(i.options.borderWidth);return{t:Bi(l.top,h.top,0,n),r:Bi(l.right,h.right,0,a),b:Bi(l.bottom,h.bottom,0,n),l:Bi(l.left,h.left,0,a)}}(i,n/2,c/2),h=function Ku(i,a,n){const{enableBorderRadius:c}=i.getProps(["enableBorderRadius"]),l=i.options.borderRadius,h=Yt(l),d=Math.min(a,n),m=i.borderSkipped,g=c||Mt(l);return{topLeft:Bi(!g||m.top||m.left,h.topLeft,0,d),topRight:Bi(!g||m.top||m.right,h.topRight,0,d),bottomLeft:Bi(!g||m.bottom||m.left,h.bottomLeft,0,d),bottomRight:Bi(!g||m.bottom||m.right,h.bottomRight,0,d)}}(i,n/2,c/2);return{outer:{x:a.left,y:a.top,w:n,h:c,radius:h},inner:{x:a.left+l.l,y:a.top+l.t,w:n-l.l-l.r,h:c-l.t-l.b,radius:{topLeft:Math.max(0,h.topLeft-Math.max(l.t,l.l)),topRight:Math.max(0,h.topRight-Math.max(l.t,l.r)),bottomLeft:Math.max(0,h.bottomLeft-Math.max(l.b,l.l)),bottomRight:Math.max(0,h.bottomRight-Math.max(l.b,l.r))}}}}(this),m=function Qu(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}(d.radius)?Ea:J0;a.save(),(d.w!==h.w||d.h!==h.h)&&(a.beginPath(),m(a,Gc(d,n,h)),a.clip(),m(a,Gc(h,-n,d)),a.fillStyle=c,a.fill("evenodd")),a.beginPath(),m(a,Gc(h,n)),a.fillStyle=l,a.fill(),a.restore()}inRange(a,n,c){return jc(this,a,n,c)}inXRange(a,n){return jc(this,a,null,n)}inYRange(a,n){return jc(this,null,a,n)}getCenterPoint(a){const{x:n,y:c,base:l,horizontal:h}=this.getProps(["x","y","base","horizontal"],a);return{x:h?(n+l)/2:n,y:h?c:(c+l)/2}}getRange(a){return"x"===a?this.width/2:this.height/2}}oe(Fo,"id","bar"),oe(Fo,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),oe(Fo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var qu=Object.freeze({__proto__:null,ArcElement:bs,BarElement:Fo,LineElement:Ao,PointElement:Yu});const Xc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Q0=Xc.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function q0(i){return Xc[i%Xc.length]}function Yc(i){return Q0[i%Q0.length]}function tf(i){let a;for(a in i)if(i[a].borderColor||i[a].backgroundColor)return!0;return!1}var rf={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,a,n){if(!n.enabled)return;const{data:{datasets:c},options:l}=i.config,{elements:h}=l;if(!n.forceOverride&&(tf(c)||function nd(i){return i&&(i.borderColor||i.backgroundColor)}(l)||h&&tf(h)))return;const d=function rd(i){let a=0;return(n,c)=>{const l=i.getDatasetMeta(c).controller;l instanceof Cc?a=function td(i,a){return i.backgroundColor=i.data.map(()=>q0(a++)),a}(n,a):l instanceof xo?a=function ef(i,a){return i.backgroundColor=i.data.map(()=>Yc(a++)),a}(n,a):l&&(a=function ed(i,a){return i.borderColor=q0(a),i.backgroundColor=Yc(a),++a}(n,a))}}(i);c.forEach(d)}};function af(i){if(i._decimated){const a=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,writable:!0,value:a})}}function Zc(i){i.data.datasets.forEach(a=>{af(a)})}var ad={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,a,n)=>{if(!n.enabled)return void Zc(i);const c=i.width;i.data.datasets.forEach((l,h)=>{const{_data:d,indexAxis:m}=l,g=i.getDatasetMeta(h),w=d||l.data;if("y"===Ca([m,i.options.indexAxis])||!g.controller.supportsDecimation)return;const b=i.scales[g.xAxisID];if("linear"!==b.type&&"time"!==b.type||i.options.parsing)return;let V,{start:S,count:O}=function sf(i,a){const n=a.length;let l,c=0;const{iScale:h}=i,{min:d,max:m,minDefined:g,maxDefined:w}=h.getUserBounds();return g&&(c=nr(ci(a,h.axis,d).lo,0,n-1)),l=w?nr(ci(a,h.axis,m).hi+1,c,n)-c:n-c,{start:c,count:l}}(g,w);if(O<=(n.threshold||4*c))af(l);else{switch(Ut(d)&&(l._data=w,delete l.data,Object.defineProperty(l,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(X){this._data=X}})),n.algorithm){case"lttb":V=function id(i,a,n,c,l){const h=l.samples||c;if(h>=n)return i.slice(a,a+n);const d=[],m=(n-2)/(h-2);let g=0;const w=a+n-1;let S,O,I,V,X,b=a;for(d[g++]=i[b],S=0;S<h-2;S++){let ge,K=0,_e=0;const Oe=Math.floor((S+1)*m)+1+a,Pe=Math.min(Math.floor((S+2)*m)+1,n)+a,Ee=Pe-Oe;for(ge=Oe;ge<Pe;ge++)K+=i[ge].x,_e+=i[ge].y;K/=Ee,_e/=Ee;const Ie=Math.floor(S*m)+1+a,st=Math.min(Math.floor((S+1)*m)+1,n)+a,{x:Ue,y:ut}=i[b];for(I=V=-1,ge=Ie;ge<st;ge++)V=.5*Math.abs((Ue-K)*(i[ge].y-ut)-(Ue-i[ge].x)*(_e-ut)),V>I&&(I=V,O=i[ge],X=ge);d[g++]=O,b=X}return d[g++]=i[w],d}(w,S,O,c,n);break;case"min-max":V=function nf(i,a,n,c){let d,m,g,w,b,S,O,I,V,X,l=0,h=0;const K=[],ge=i[a].x,Pe=i[a+n-1].x-ge;for(d=a;d<a+n;++d){m=i[d],g=(m.x-ge)/Pe*c,w=m.y;const Ee=0|g;if(Ee===b)w<V?(V=w,S=d):w>X&&(X=w,O=d),l=(h*l+m.x)/++h;else{const Ie=d-1;if(!Ut(S)&&!Ut(O)){const st=Math.min(S,O),Ue=Math.max(S,O);st!==I&&st!==Ie&&K.push({...i[st],x:l}),Ue!==I&&Ue!==Ie&&K.push({...i[Ue],x:l})}d>0&&Ie!==I&&K.push(i[Ie]),K.push(m),b=Ee,h=0,V=X=w,S=O=I=d}}return K}(w,S,O,c);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}l._decimated=V}})},destroy(i){Zc(i)}};function Kc(i,a,n,c){if(c)return;let l=a[i],h=n[i];return"angle"===i&&(l=Pr(l),h=Pr(h)),{property:i,start:l,end:h}}function Jc(i,a,n){for(;a>i;a--){const c=n[a];if(!isNaN(c.x)&&!isNaN(c.y))break}return a}function cf(i,a,n,c){return i&&a?c(i[n],a[n]):i?i[n]:a?a[n]:0}function lf(i,a){let n=[],c=!1;return tr(i)?(c=!0,n=i):n=function of(i,a){const{x:n=null,y:c=null}=i||{},l=a.points,h=[];return a.segments.forEach(({start:d,end:m})=>{m=Jc(d,m,l);const g=l[d],w=l[m];null!==c?(h.push({x:g.x,y:c}),h.push({x:w.x,y:c})):null!==n&&(h.push({x:n,y:g.y}),h.push({x:n,y:w.y}))}),h}(i,a),n.length?new Ao({points:n,options:{tension:0},_loop:c,_fullLoop:c}):null}function ff(i){return i&&!1!==i.fill}function od(i,a,n){let l=i[a].fill;const h=[a];let d;if(!n)return l;for(;!1!==l&&-1===h.indexOf(l);){if(!sr(l))return l;if(d=i[l],!d)return!1;if(d.visible)return l;h.push(l),l=d.fill}return!1}function cd(i,a,n){const c=function ud(i){const a=i.options,n=a.fill;let c=Tt(n&&n.target,n);return void 0===c&&(c=!!a.backgroundColor),!1!==c&&null!==c&&(!0===c?"origin":c)}(i);if(Mt(c))return!isNaN(c.value)&&c;let l=parseFloat(c);return sr(l)&&Math.floor(l)===l?function ld(i,a,n,c){return("-"===i||"+"===i)&&(n=a+n),!(n===a||n<0||n>=c)&&n}(c[0],a,l,n):["origin","start","end","stack","shape"].indexOf(c)>=0&&c}function md(i,a,n){const c=[];for(let l=0;l<n.length;l++){const h=n[l],{first:d,last:m,point:g}=gd(h,a,"x");if(!(!g||d&&m))if(d)c.unshift(g);else if(i.push(g),!m)break}i.push(...c)}function gd(i,a,n){const c=i.interpolate(a,n);if(!c)return{};const l=c[n],h=i.segments,d=i.points;let m=!1,g=!1;for(let w=0;w<h.length;w++){const b=h[w],S=d[b.start][n],O=d[b.end][n];if(Rn(l,S,O)){m=l===S,g=l===O;break}}return{first:m,last:g,point:c}}class hf{constructor(a){this.x=a.x,this.y=a.y,this.radius=a.radius}pathSegment(a,n,c){const{x:l,y:h,radius:d}=this;return a.arc(l,h,d,(n=n||{start:0,end:rr}).end,n.start,!0),!c.bounds}interpolate(a){const{x:n,y:c,radius:l}=this,h=a.angle;return{x:n+Math.cos(h)*l,y:c+Math.sin(h)*l,angle:h}}}function Qc(i,a,n){const c=function xd(i){const{chart:a,fill:n,line:c}=i;if(sr(n))return function _d(i,a){const n=i.getDatasetMeta(a);return n&&i.isDatasetVisible(a)?n.dataset:null}(a,n);if("stack"===n)return function dd(i){const{scale:a,index:n,line:c}=i,l=[],h=c.segments,d=c.points,m=function pd(i,a){const n=[],c=i.getMatchingVisibleMetas("line");for(let l=0;l<c.length;l++){const h=c[l];if(h.index===a)break;h.hidden||n.unshift(h.dataset)}return n}(a,n);m.push(lf({x:null,y:a.bottom},c));for(let g=0;g<h.length;g++){const w=h[g];for(let b=w.start;b<=w.end;b++)md(l,d[b],m)}return new Ao({points:l,options:{}})}(i);if("shape"===n)return!0;const l=function vd(i){return(i.scale||{}).getPointPositionForValue?function wd(i){const{scale:a,fill:n}=i,c=a.options,l=a.getLabels().length,h=c.reverse?a.max:a.min,d=function hd(i,a,n){let c;return c="start"===i?n:"end"===i?a.options.reverse?a.min:a.max:Mt(i)?i.value:a.getBaseValue(),c}(n,a,h),m=[];if(c.grid.circular){const g=a.getPointPositionForValue(0,h);return new hf({x:g.x,y:g.y,radius:a.getDistanceFromCenterForValue(d)})}for(let g=0;g<l;++g)m.push(a.getPointPositionForValue(g,d));return m}(i):function uf(i){const{scale:a={},fill:n}=i,c=function fd(i,a){let n=null;return"start"===i?n=a.bottom:"end"===i?n=a.top:Mt(i)?n=a.getPixelForValue(i.value):a.getBasePixel&&(n=a.getBasePixel()),n}(n,a);if(sr(c)){const l=a.isHorizontal();return{x:l?c:null,y:l?null:c}}return null}(i)}(i);return l instanceof hf?l:lf(l,c)}(a),{line:l,scale:h,axis:d}=a,m=l.options,g=m.fill,w=m.backgroundColor,{above:b=w,below:S=w}=g||{};c&&l.points.length&&(jt(i,n),function yd(i,a){const{line:n,target:c,above:l,below:h,area:d,scale:m}=a,g=n._loop?"angle":a.axis;i.save(),"x"===g&&h!==l&&(df(i,c,d.top),pf(i,{line:n,target:c,color:l,scale:m,property:g}),i.restore(),i.save(),df(i,c,d.bottom)),pf(i,{line:n,target:c,color:h,scale:m,property:g}),i.restore()}(i,{line:l,target:c,above:b,below:S,area:n,scale:h,axis:d}),Ta(i))}function df(i,a,n){const{segments:c,points:l}=a;let h=!0,d=!1;i.beginPath();for(const m of c){const{start:g,end:w}=m,b=l[g],S=l[Jc(g,w,l)];h?(i.moveTo(b.x,b.y),h=!1):(i.lineTo(b.x,n),i.lineTo(b.x,b.y)),d=!!a.pathSegment(i,m,{move:d}),d?i.closePath():i.lineTo(S.x,n)}i.lineTo(a.first().x,n),i.closePath(),i.clip()}function pf(i,a){const{line:n,target:c,property:l,color:h,scale:d}=a,m=function sd(i,a,n){const c=i.segments,l=i.points,h=a.points,d=[];for(const m of c){let{start:g,end:w}=m;w=Jc(g,w,l);const b=Kc(n,l[g],l[w],m.loop);if(!a.segments){d.push({source:m,target:b,start:l[g],end:l[w]});continue}const S=fo(a,b);for(const O of S){const I=Kc(n,h[O.start],h[O.end],O.loop),V=Ia(m,l,I);for(const X of V)d.push({source:X,target:O,start:{[n]:cf(b,I,"start",Math.max)},end:{[n]:cf(b,I,"end",Math.min)}})}}return d}(n,c,l);for(const{source:g,target:w,start:b,end:S}of m){const{style:{backgroundColor:O=h}={}}=g,I=!0!==c;i.save(),i.fillStyle=O,bd(i,d,I&&Kc(l,b,S)),i.beginPath();const V=!!n.pathSegment(i,g);let X;if(I){V?i.closePath():mf(i,c,S,l);const K=!!c.pathSegment(i,w,{move:V,reverse:!0});X=V&&K,X||mf(i,c,b,l)}i.closePath(),i.fill(X?"evenodd":"nonzero"),i.restore()}}function bd(i,a,n){const{top:c,bottom:l}=a.chart.chartArea,{property:h,start:d,end:m}=n||{};"x"===h&&(i.beginPath(),i.rect(d,c,m-d,l-c),i.clip())}function mf(i,a,n,c){const l=a.interpolate(n,c);l&&i.lineTo(l.x,l.y)}var kd={id:"filler",afterDatasetsUpdate(i,a,n){const c=(i.data.datasets||[]).length,l=[];let h,d,m,g;for(d=0;d<c;++d)h=i.getDatasetMeta(d),m=h.dataset,g=null,m&&m.options&&m instanceof Ao&&(g={visible:i.isDatasetVisible(d),index:d,fill:cd(m,d,c),chart:i,axis:h.controller.options.indexAxis,scale:h.vScale,line:m}),h.$filler=g,l.push(g);for(d=0;d<c;++d)g=l[d],g&&!1!==g.fill&&(g.fill=od(l,d,n.propagate))},beforeDraw(i,a,n){const c="beforeDraw"===n.drawTime,l=i.getSortedVisibleDatasetMetas(),h=i.chartArea;for(let d=l.length-1;d>=0;--d){const m=l[d].$filler;m&&(m.line.updateControlPoints(h,m.axis),c&&m.fill&&Qc(i.ctx,m,h))}},beforeDatasetsDraw(i,a,n){if("beforeDatasetsDraw"!==n.drawTime)return;const c=i.getSortedVisibleDatasetMetas();for(let l=c.length-1;l>=0;--l){const h=c[l].$filler;ff(h)&&Qc(i.ctx,h,i.chartArea)}},beforeDatasetDraw(i,a,n){const c=a.meta.$filler;!ff(c)||"beforeDatasetDraw"!==n.drawTime||Qc(i.ctx,c,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const gf=(i,a)=>{let{boxHeight:n=a,boxWidth:c=a}=i;return i.usePointStyle&&(n=Math.min(n,a),c=i.pointStyleWidth||Math.min(c,a)),{boxWidth:c,boxHeight:n,itemHeight:Math.max(a,n)}};class xf extends Hn{constructor(a){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=a.chart,this.options=a.options,this.ctx=a.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(a,n,c){this.maxWidth=a,this.maxHeight=n,this._margins=c,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const a=this.options.labels||{};let n=$t(a.generateLabels,[this.chart],this)||[];a.filter&&(n=n.filter(c=>a.filter(c,this.chart.data))),a.sort&&(n=n.sort((c,l)=>a.sort(c,l,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:a,ctx:n}=this;if(!a.display)return void(this.width=this.height=0);const c=a.labels,l=Rr(c.font),h=l.size,d=this._computeTitleHeight(),{boxWidth:m,itemHeight:g}=gf(c,h);let w,b;n.font=l.string,this.isHorizontal()?(w=this.maxWidth,b=this._fitRows(d,h,m,g)+10):(b=this.maxHeight,w=this._fitCols(d,l,m,g)+10),this.width=Math.min(w,a.maxWidth||this.maxWidth),this.height=Math.min(b,a.maxHeight||this.maxHeight)}_fitRows(a,n,c,l){const{ctx:h,maxWidth:d,options:{labels:{padding:m}}}=this,g=this.legendHitBoxes=[],w=this.lineWidths=[0],b=l+m;let S=a;h.textAlign="left",h.textBaseline="middle";let O=-1,I=-b;return this.legendItems.forEach((V,X)=>{const K=c+n/2+h.measureText(V.text).width;(0===X||w[w.length-1]+K+2*m>d)&&(S+=b,w[w.length-(X>0?0:1)]=0,I+=b,O++),g[X]={left:0,top:I,row:O,width:K,height:l},w[w.length-1]+=K+m}),S}_fitCols(a,n,c,l){const{ctx:h,maxHeight:d,options:{labels:{padding:m}}}=this,g=this.legendHitBoxes=[],w=this.columnSizes=[],b=d-a;let S=m,O=0,I=0,V=0,X=0;return this.legendItems.forEach((K,_e)=>{const{itemWidth:ge,itemHeight:Oe}=function Ed(i,a,n,c,l){const h=function Cd(i,a,n,c){let l=i.text;return l&&"string"!=typeof l&&(l=l.reduce((h,d)=>h.length>d.length?h:d)),a+n.size/2+c.measureText(l).width}(c,i,a,n),d=function Sd(i,a,n){let c=i;return"string"!=typeof a.text&&(c=_f(a,n)),c}(l,c,a.lineHeight);return{itemWidth:h,itemHeight:d}}(c,n,h,K,l);_e>0&&I+Oe+2*m>b&&(S+=O+m,w.push({width:O,height:I}),V+=O+m,X++,O=I=0),g[_e]={left:V,top:I,col:X,width:ge,height:Oe},O=Math.max(O,ge),I+=Oe+m}),S+=O,w.push({width:O,height:I}),S}adjustHitBoxes(){if(!this.options.display)return;const a=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:c,labels:{padding:l},rtl:h}}=this,d=xe(h,this.left,this.width);if(this.isHorizontal()){let m=0,g=rn(c,this.left+l,this.right-this.lineWidths[m]);for(const w of n)m!==w.row&&(m=w.row,g=rn(c,this.left+l,this.right-this.lineWidths[m])),w.top+=this.top+a+l,w.left=d.leftForLtr(d.x(g),w.width),g+=w.width+l}else{let m=0,g=rn(c,this.top+a+l,this.bottom-this.columnSizes[m].height);for(const w of n)w.col!==m&&(m=w.col,g=rn(c,this.top+a+l,this.bottom-this.columnSizes[m].height)),w.top=g,w.left+=this.left+l,w.left=d.leftForLtr(d.x(w.left),w.width),g+=w.height+l}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const a=this.ctx;jt(a,this),this._draw(),Ta(a)}}_draw(){const{options:a,columnSizes:n,lineWidths:c,ctx:l}=this,{align:h,labels:d}=a,m=mr.color,g=xe(a.rtl,this.left,this.width),w=Rr(d.font),{padding:b}=d,S=w.size,O=S/2;let I;this.drawTitle(),l.textAlign=g.textAlign("left"),l.textBaseline="middle",l.lineWidth=.5,l.font=w.string;const{boxWidth:V,boxHeight:X,itemHeight:K}=gf(d,S),Oe=this.isHorizontal(),Pe=this._computeTitleHeight();I=Oe?{x:rn(h,this.left+b,this.right-c[0]),y:this.top+b+Pe,line:0}:{x:this.left+b,y:rn(h,this.top+Pe+b,this.bottom-n[0].height),line:0},Jn(this.ctx,a.textDirection);const Ee=K+b;this.legendItems.forEach((Ie,st)=>{l.strokeStyle=Ie.fontColor,l.fillStyle=Ie.fontColor;const Ue=l.measureText(Ie.text).width,ut=g.textAlign(Ie.textAlign||(Ie.textAlign=d.textAlign)),It=V+O+Ue;let Ft=I.x,Nt=I.y;g.setWidth(this.width),Oe?st>0&&Ft+It+b>this.right&&(Nt=I.y+=Ee,I.line++,Ft=I.x=rn(h,this.left+b,this.right-c[I.line])):st>0&&Nt+Ee>this.bottom&&(Ft=I.x=Ft+n[I.line].width+b,I.line++,Nt=I.y=rn(h,this.top+Pe+b,this.bottom-n[I.line].height)),function(Ie,st,Ue){if(isNaN(V)||V<=0||isNaN(X)||X<0)return;l.save();const ut=Tt(Ue.lineWidth,1);if(l.fillStyle=Tt(Ue.fillStyle,m),l.lineCap=Tt(Ue.lineCap,"butt"),l.lineDashOffset=Tt(Ue.lineDashOffset,0),l.lineJoin=Tt(Ue.lineJoin,"miter"),l.lineWidth=ut,l.strokeStyle=Tt(Ue.strokeStyle,m),l.setLineDash(Tt(Ue.lineDash,[])),d.usePointStyle){const It={radius:X*Math.SQRT2/2,pointStyle:Ue.pointStyle,rotation:Ue.rotation,borderWidth:ut},Ft=g.xPlus(Ie,V/2);jl(l,It,Ft,st+O,d.pointStyleWidth&&V)}else{const It=st+Math.max((S-X)/2,0),Ft=g.leftForLtr(Ie,V),Nt=Yt(Ue.borderRadius);l.beginPath(),Object.values(Nt).some(qr=>0!==qr)?Ea(l,{x:Ft,y:It,w:V,h:X,radius:Nt}):l.rect(Ft,It,V,X),l.fill(),0!==ut&&l.stroke()}l.restore()}(g.x(Ft),Nt,Ie),Ft=((i,a,n,c)=>i===(c?"left":"right")?n:"center"===i?(a+n)/2:a)(ut,Ft+V+O,Oe?Ft+It:this.right,a.rtl),function(Ie,st,Ue){Qi(l,Ue.text,Ie,st+K/2,w,{strikethrough:Ue.hidden,textAlign:g.textAlign(Ue.textAlign)})}(g.x(Ft),Nt,Ie),Oe?I.x+=It+b:I.y+="string"!=typeof Ie.text?_f(Ie,w.lineHeight)+b:Ee}),an(this.ctx,a.textDirection)}drawTitle(){const a=this.options,n=a.title,c=Rr(n.font),l=fr(n.padding);if(!n.display)return;const h=xe(a.rtl,this.left,this.width),d=this.ctx,m=n.position,w=l.top+c.size/2;let b,S=this.left,O=this.width;if(this.isHorizontal())O=Math.max(...this.lineWidths),b=this.top+w,S=rn(a.align,S,this.right-O);else{const V=this.columnSizes.reduce((X,K)=>Math.max(X,K.height),0);b=w+rn(a.align,this.top,this.bottom-V-a.labels.padding-this._computeTitleHeight())}const I=rn(m,S,S+O);d.textAlign=h.textAlign(ss(m)),d.textBaseline="middle",d.strokeStyle=n.color,d.fillStyle=n.color,d.font=c.string,Qi(d,n.text,I,b,c)}_computeTitleHeight(){const a=this.options.title,n=Rr(a.font),c=fr(a.padding);return a.display?n.lineHeight+c.height:0}_getLegendItemAt(a,n){let c,l,h;if(Rn(a,this.left,this.right)&&Rn(n,this.top,this.bottom))for(h=this.legendHitBoxes,c=0;c<h.length;++c)if(l=h[c],Rn(a,l.left,l.left+l.width)&&Rn(n,l.top,l.top+l.height))return this.legendItems[c];return null}handleEvent(a){const n=this.options;if(!function Ad(i,a){return!(("mousemove"!==i&&"mouseout"!==i||!a.onHover&&!a.onLeave)&&(!a.onClick||"click"!==i&&"mouseup"!==i))}(a.type,n))return;const c=this._getLegendItemAt(a.x,a.y);if("mousemove"===a.type||"mouseout"===a.type){const l=this._hoveredItem,h=((i,a)=>null!==i&&null!==a&&i.datasetIndex===a.datasetIndex&&i.index===a.index)(l,c);l&&!h&&$t(n.onLeave,[a,l,this],this),this._hoveredItem=c,c&&!h&&$t(n.onHover,[a,c,this],this)}else c&&$t(n.onClick,[a,c,this],this)}}function _f(i,a){return a*(i.text?i.text.length:0)}var Fd={id:"legend",_element:xf,start(i,a,n){const c=i.legend=new xf({ctx:i.ctx,options:n,chart:i});kt.configure(i,c,n),kt.addBox(i,c)},stop(i){kt.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,a,n){const c=i.legend;kt.configure(i,c,n),c.options=n},afterUpdate(i){const a=i.legend;a.buildLabels(),a.adjustHitBoxes()},afterEvent(i,a){a.replay||i.legend.handleEvent(a.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,a,n){const c=a.datasetIndex,l=n.chart;l.isDatasetVisible(c)?(l.hide(c),a.hidden=!0):(l.show(c),a.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const a=i.data.datasets,{labels:{usePointStyle:n,pointStyle:c,textAlign:l,color:h,useBorderRadius:d,borderRadius:m}}=i.legend.options;return i._getSortedDatasetMetas().map(g=>{const w=g.controller.getStyle(n?0:void 0),b=fr(w.borderWidth);return{text:a[g.index].label,fillStyle:w.backgroundColor,fontColor:h,hidden:!g.visible,lineCap:w.borderCapStyle,lineDash:w.borderDash,lineDashOffset:w.borderDashOffset,lineJoin:w.borderJoinStyle,lineWidth:(b.width+b.height)/4,strokeStyle:w.borderColor,pointStyle:c||w.pointStyle,rotation:w.rotation,textAlign:l||w.textAlign,borderRadius:d&&(m||w.borderRadius),datasetIndex:g.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class ks extends Hn{constructor(a){super(),this.chart=a.chart,this.options=a.options,this.ctx=a.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(a,n){const c=this.options;if(this.left=0,this.top=0,!c.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=a,this.height=this.bottom=n;const l=tr(c.text)?c.text.length:1;this._padding=fr(c.padding);const h=l*Rr(c.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=h:this.width=h}isHorizontal(){const a=this.options.position;return"top"===a||"bottom"===a}_drawArgs(a){const{top:n,left:c,bottom:l,right:h,options:d}=this,m=d.align;let w,b,S,g=0;return this.isHorizontal()?(b=rn(m,c,h),S=n+a,w=h-c):("left"===d.position?(b=c+a,S=rn(m,l,n),g=-.5*Rt):(b=h-a,S=rn(m,n,l),g=.5*Rt),w=l-n),{titleX:b,titleY:S,maxWidth:w,rotation:g}}draw(){const a=this.ctx,n=this.options;if(!n.display)return;const c=Rr(n.font),h=c.lineHeight/2+this._padding.top,{titleX:d,titleY:m,maxWidth:g,rotation:w}=this._drawArgs(h);Qi(a,n.text,0,0,c,{color:n.color,maxWidth:g,rotation:w,textAlign:ss(n.align),textBaseline:"middle",translation:[d,m]})}}var wf={id:"title",_element:ks,start(i,a,n){!function vf(i,a){const n=new ks({ctx:i.ctx,options:a,chart:i});kt.configure(i,n,a),kt.addBox(i,n),i.titleBlock=n}(i,n)},stop(i){kt.removeBox(i,i.titleBlock),delete i.titleBlock},beforeUpdate(i,a,n){const c=i.titleBlock;kt.configure(i,c,n),c.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ts=new WeakMap;var Wa={id:"subtitle",start(i,a,n){const c=new ks({ctx:i.ctx,options:n,chart:i});kt.configure(i,c,n),kt.addBox(i,c),Ts.set(i,c)},stop(i){kt.removeBox(i,Ts.get(i)),Ts.delete(i)},beforeUpdate(i,a,n){const c=Ts.get(i);kt.configure(i,c,n),c.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Es={average(i){if(!i.length)return!1;let a,n,c=0,l=0,h=0;for(a=0,n=i.length;a<n;++a){const d=i[a].element;if(d&&d.hasValue()){const m=d.tooltipPosition();c+=m.x,l+=m.y,++h}}return{x:c/h,y:l/h}},nearest(i,a){if(!i.length)return!1;let h,d,m,n=a.x,c=a.y,l=Number.POSITIVE_INFINITY;for(h=0,d=i.length;h<d;++h){const g=i[h].element;if(g&&g.hasValue()){const b=fn(a,g.getCenterPoint());b<l&&(l=b,m=g)}}if(m){const g=m.tooltipPosition();n=g.x,c=g.y}return{x:n,y:c}}};function sn(i,a){return a&&(tr(a)?Array.prototype.push.apply(i,a):i.push(a)),i}function Ui(i){return("string"==typeof i||i instanceof String)&&i.indexOf("\n")>-1?i.split("\n"):i}function Dd(i,a){const{element:n,datasetIndex:c,index:l}=a,h=i.getDatasetMeta(c).controller,{label:d,value:m}=h.getLabelAndValue(l);return{chart:i,label:d,parsed:h.getParsed(l),raw:i.data.datasets[c].data[l],formattedValue:m,dataset:h.getDataset(),dataIndex:l,datasetIndex:c,element:n}}function yf(i,a){const n=i.chart.ctx,{body:c,footer:l,title:h}=i,{boxWidth:d,boxHeight:m}=a,g=Rr(a.bodyFont),w=Rr(a.titleFont),b=Rr(a.footerFont),S=h.length,O=l.length,I=c.length,V=fr(a.padding);let X=V.height,K=0,_e=c.reduce((Pe,Ee)=>Pe+Ee.before.length+Ee.lines.length+Ee.after.length,0);_e+=i.beforeBody.length+i.afterBody.length,S&&(X+=S*w.lineHeight+(S-1)*a.titleSpacing+a.titleMarginBottom),_e&&(X+=I*(a.displayColors?Math.max(m,g.lineHeight):g.lineHeight)+(_e-I)*g.lineHeight+(_e-1)*a.bodySpacing),O&&(X+=a.footerMarginTop+O*b.lineHeight+(O-1)*a.footerSpacing);let ge=0;const Oe=function(Pe){K=Math.max(K,n.measureText(Pe).width+ge)};return n.save(),n.font=w.string,Gt(i.title,Oe),n.font=g.string,Gt(i.beforeBody.concat(i.afterBody),Oe),ge=a.displayColors?d+2+a.boxPadding:0,Gt(c,Pe=>{Gt(Pe.before,Oe),Gt(Pe.lines,Oe),Gt(Pe.after,Oe)}),ge=0,n.font=b.string,Gt(i.footer,Oe),n.restore(),K+=V.width,{width:K,height:X}}function Pd(i,a,n,c){const{x:l,width:h}=n,{width:d,chartArea:{left:m,right:g}}=i;let w="center";return"center"===c?w=l<=(m+g)/2?"left":"right":l<=h/2?w="left":l>=d-h/2&&(w="right"),function Id(i,a,n,c){const{x:l,width:h}=c,d=n.caretSize+n.caretPadding;if("left"===i&&l+h+d>a.width||"right"===i&&l-h-d<0)return!0}(w,i,a,n)&&(w="center"),w}function qc(i,a,n){const c=n.yAlign||a.yAlign||function Od(i,a){const{y:n,height:c}=a;return n<c/2?"top":n>i.height-c/2?"bottom":"center"}(i,n);return{xAlign:n.xAlign||a.xAlign||Pd(i,a,n,c),yAlign:c}}function bf(i,a,n,c){const{caretSize:l,caretPadding:h,cornerRadius:d}=i,{xAlign:m,yAlign:g}=n,w=l+h,{topLeft:b,topRight:S,bottomLeft:O,bottomRight:I}=Yt(d);let V=function Md(i,a){let{x:n,width:c}=i;return"right"===a?n-=c:"center"===a&&(n-=c/2),n}(a,m);const X=function Rd(i,a,n){let{y:c,height:l}=i;return"top"===a?c+=n:c-="bottom"===a?l+n:l/2,c}(a,g,w);return"center"===g?"left"===m?V+=w:"right"===m&&(V-=w):"left"===m?V-=Math.max(b,O)+l:"right"===m&&(V+=Math.max(S,I)+l),{x:nr(V,0,c.width-a.width),y:nr(X,0,c.height-a.height)}}function Do(i,a,n){const c=fr(n.padding);return"center"===a?i.x+i.width/2:"right"===a?i.x+i.width-c.right:i.x+c.left}function kf(i){return sn([],Ui(i))}function Ef(i,a){const n=a&&a.dataset&&a.dataset.tooltip&&a.dataset.tooltip.callbacks;return n?i.override(n):i}const Cf={beforeTitle:Wr,title(i){if(i.length>0){const a=i[0],n=a.chart.data.labels,c=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return a.dataset.label||"";if(a.label)return a.label;if(c>0&&a.dataIndex<c)return n[a.dataIndex]}return""},afterTitle:Wr,beforeBody:Wr,beforeLabel:Wr,label(i){if(this&&this.options&&"dataset"===this.options.mode)return i.label+": "+i.formattedValue||i.formattedValue;let a=i.dataset.label||"";a&&(a+=": ");const n=i.formattedValue;return Ut(n)||(a+=n),a},labelColor(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const n=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Wr,afterBody:Wr,beforeFooter:Wr,footer:Wr,afterFooter:Wr};function mn(i,a,n,c){const l=i[a].call(n,c);return typeof l>"u"?Cf[a].call(n,c):l}let Sf=(()=>{class i extends Hn{constructor(n){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=n.chart,this.options=n.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(n){this.options=n,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const n=this._cachedAnimations;if(n)return n;const c=this.chart,l=this.options.setContext(this.getContext()),h=l.enabled&&c.options.animation&&l.animations,d=new St(this.chart,h);return h._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=function Tf(i,a,n){return Oi(i,{tooltip:a,tooltipItems:n,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(n,c){const{callbacks:l}=c,h=mn(l,"beforeTitle",this,n),d=mn(l,"title",this,n),m=mn(l,"afterTitle",this,n);let g=[];return g=sn(g,Ui(h)),g=sn(g,Ui(d)),g=sn(g,Ui(m)),g}getBeforeBody(n,c){return kf(mn(c.callbacks,"beforeBody",this,n))}getBody(n,c){const{callbacks:l}=c,h=[];return Gt(n,d=>{const m={before:[],lines:[],after:[]},g=Ef(l,d);sn(m.before,Ui(mn(g,"beforeLabel",this,d))),sn(m.lines,mn(g,"label",this,d)),sn(m.after,Ui(mn(g,"afterLabel",this,d))),h.push(m)}),h}getAfterBody(n,c){return kf(mn(c.callbacks,"afterBody",this,n))}getFooter(n,c){const{callbacks:l}=c,h=mn(l,"beforeFooter",this,n),d=mn(l,"footer",this,n),m=mn(l,"afterFooter",this,n);let g=[];return g=sn(g,Ui(h)),g=sn(g,Ui(d)),g=sn(g,Ui(m)),g}_createItems(n){const c=this._active,l=this.chart.data,h=[],d=[],m=[];let w,b,g=[];for(w=0,b=c.length;w<b;++w)g.push(Dd(this.chart,c[w]));return n.filter&&(g=g.filter((S,O,I)=>n.filter(S,O,I,l))),n.itemSort&&(g=g.sort((S,O)=>n.itemSort(S,O,l))),Gt(g,S=>{const O=Ef(n.callbacks,S);h.push(mn(O,"labelColor",this,S)),d.push(mn(O,"labelPointStyle",this,S)),m.push(mn(O,"labelTextColor",this,S))}),this.labelColors=h,this.labelPointStyles=d,this.labelTextColors=m,this.dataPoints=g,g}update(n,c){const l=this.options.setContext(this.getContext()),h=this._active;let d,m=[];if(h.length){const g=Es[l.position].call(this,h,this._eventPosition);m=this._createItems(l),this.title=this.getTitle(m,l),this.beforeBody=this.getBeforeBody(m,l),this.body=this.getBody(m,l),this.afterBody=this.getAfterBody(m,l),this.footer=this.getFooter(m,l);const w=this._size=yf(this,l),b=Object.assign({},g,w),S=qc(this.chart,l,b),O=bf(l,b,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,d={opacity:1,x:O.x,y:O.y,width:w.width,height:w.height,caretX:g.x,caretY:g.y}}else 0!==this.opacity&&(d={opacity:0});this._tooltipItems=m,this.$context=void 0,d&&this._resolveAnimations().update(this,d),n&&l.external&&l.external.call(this,{chart:this.chart,tooltip:this,replay:c})}drawCaret(n,c,l,h){const d=this.getCaretPosition(n,l,h);c.lineTo(d.x1,d.y1),c.lineTo(d.x2,d.y2),c.lineTo(d.x3,d.y3)}getCaretPosition(n,c,l){const{xAlign:h,yAlign:d}=this,{caretSize:m,cornerRadius:g}=l,{topLeft:w,topRight:b,bottomLeft:S,bottomRight:O}=Yt(g),{x:I,y:V}=n,{width:X,height:K}=c;let _e,ge,Oe,Pe,Ee,Ie;return"center"===d?(Ee=V+K/2,"left"===h?(_e=I,ge=_e-m,Pe=Ee+m,Ie=Ee-m):(_e=I+X,ge=_e+m,Pe=Ee-m,Ie=Ee+m),Oe=_e):(ge="left"===h?I+Math.max(w,S)+m:"right"===h?I+X-Math.max(b,O)-m:this.caretX,"top"===d?(Pe=V,Ee=Pe-m,_e=ge-m,Oe=ge+m):(Pe=V+K,Ee=Pe+m,_e=ge+m,Oe=ge-m),Ie=Pe),{x1:_e,x2:ge,x3:Oe,y1:Pe,y2:Ee,y3:Ie}}drawTitle(n,c,l){const h=this.title,d=h.length;let m,g,w;if(d){const b=xe(l.rtl,this.x,this.width);for(n.x=Do(this,l.titleAlign,l),c.textAlign=b.textAlign(l.titleAlign),c.textBaseline="middle",m=Rr(l.titleFont),g=l.titleSpacing,c.fillStyle=l.titleColor,c.font=m.string,w=0;w<d;++w)c.fillText(h[w],b.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+g,w+1===d&&(n.y+=l.titleMarginBottom-g)}}_drawColorBox(n,c,l,h,d){const m=this.labelColors[l],g=this.labelPointStyles[l],{boxHeight:w,boxWidth:b}=d,S=Rr(d.bodyFont),O=Do(this,"left",d),I=h.x(O),X=c.y+(w<S.lineHeight?(S.lineHeight-w)/2:0);if(d.usePointStyle){const K={radius:Math.min(b,w)/2,pointStyle:g.pointStyle,rotation:g.rotation,borderWidth:1},_e=h.leftForLtr(I,b)+b/2,ge=X+w/2;n.strokeStyle=d.multiKeyBackground,n.fillStyle=d.multiKeyBackground,Sn(n,K,_e,ge),n.strokeStyle=m.borderColor,n.fillStyle=m.backgroundColor,Sn(n,K,_e,ge)}else{n.lineWidth=Mt(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,n.strokeStyle=m.borderColor,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset||0;const K=h.leftForLtr(I,b),_e=h.leftForLtr(h.xPlus(I,1),b-2),ge=Yt(m.borderRadius);Object.values(ge).some(Oe=>0!==Oe)?(n.beginPath(),n.fillStyle=d.multiKeyBackground,Ea(n,{x:K,y:X,w:b,h:w,radius:ge}),n.fill(),n.stroke(),n.fillStyle=m.backgroundColor,n.beginPath(),Ea(n,{x:_e,y:X+1,w:b-2,h:w-2,radius:ge}),n.fill()):(n.fillStyle=d.multiKeyBackground,n.fillRect(K,X,b,w),n.strokeRect(K,X,b,w),n.fillStyle=m.backgroundColor,n.fillRect(_e,X+1,b-2,w-2))}n.fillStyle=this.labelTextColors[l]}drawBody(n,c,l){const{body:h}=this,{bodySpacing:d,bodyAlign:m,displayColors:g,boxHeight:w,boxWidth:b,boxPadding:S}=l,O=Rr(l.bodyFont);let I=O.lineHeight,V=0;const X=xe(l.rtl,this.x,this.width),K=function(ut){c.fillText(ut,X.x(n.x+V),n.y+I/2),n.y+=I+d},_e=X.textAlign(m);let ge,Oe,Pe,Ee,Ie,st,Ue;for(c.textAlign=m,c.textBaseline="middle",c.font=O.string,n.x=Do(this,_e,l),c.fillStyle=l.bodyColor,Gt(this.beforeBody,K),V=g&&"right"!==_e?"center"===m?b/2+S:b+2+S:0,Ee=0,st=h.length;Ee<st;++Ee){for(ge=h[Ee],Oe=this.labelTextColors[Ee],c.fillStyle=Oe,Gt(ge.before,K),Pe=ge.lines,g&&Pe.length&&(this._drawColorBox(c,n,Ee,X,l),I=Math.max(O.lineHeight,w)),Ie=0,Ue=Pe.length;Ie<Ue;++Ie)K(Pe[Ie]),I=O.lineHeight;Gt(ge.after,K)}V=0,I=O.lineHeight,Gt(this.afterBody,K),n.y-=d}drawFooter(n,c,l){const h=this.footer,d=h.length;let m,g;if(d){const w=xe(l.rtl,this.x,this.width);for(n.x=Do(this,l.footerAlign,l),n.y+=l.footerMarginTop,c.textAlign=w.textAlign(l.footerAlign),c.textBaseline="middle",m=Rr(l.footerFont),c.fillStyle=l.footerColor,c.font=m.string,g=0;g<d;++g)c.fillText(h[g],w.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+l.footerSpacing}}drawBackground(n,c,l,h){const{xAlign:d,yAlign:m}=this,{x:g,y:w}=n,{width:b,height:S}=l,{topLeft:O,topRight:I,bottomLeft:V,bottomRight:X}=Yt(h.cornerRadius);c.fillStyle=h.backgroundColor,c.strokeStyle=h.borderColor,c.lineWidth=h.borderWidth,c.beginPath(),c.moveTo(g+O,w),"top"===m&&this.drawCaret(n,c,l,h),c.lineTo(g+b-I,w),c.quadraticCurveTo(g+b,w,g+b,w+I),"center"===m&&"right"===d&&this.drawCaret(n,c,l,h),c.lineTo(g+b,w+S-X),c.quadraticCurveTo(g+b,w+S,g+b-X,w+S),"bottom"===m&&this.drawCaret(n,c,l,h),c.lineTo(g+V,w+S),c.quadraticCurveTo(g,w+S,g,w+S-V),"center"===m&&"left"===d&&this.drawCaret(n,c,l,h),c.lineTo(g,w+O),c.quadraticCurveTo(g,w,g+O,w),c.closePath(),c.fill(),h.borderWidth>0&&c.stroke()}_updateAnimationTarget(n){const c=this.chart,l=this.$animations,h=l&&l.x,d=l&&l.y;if(h||d){const m=Es[n.position].call(this,this._active,this._eventPosition);if(!m)return;const g=this._size=yf(this,n),w=Object.assign({},m,this._size),b=qc(c,n,w),S=bf(n,w,b,c);(h._to!==S.x||d._to!==S.y)&&(this.xAlign=b.xAlign,this.yAlign=b.yAlign,this.width=g.width,this.height=g.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(n){const c=this.options.setContext(this.getContext());let l=this.opacity;if(!l)return;this._updateAnimationTarget(c);const h={width:this.width,height:this.height},d={x:this.x,y:this.y};l=Math.abs(l)<.001?0:l;const m=fr(c.padding);c.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(n.save(),n.globalAlpha=l,this.drawBackground(d,n,h,c),Jn(n,c.textDirection),d.y+=m.top,this.drawTitle(d,n,c),this.drawBody(d,n,c),this.drawFooter(d,n,c),an(n,c.textDirection),n.restore())}getActiveElements(){return this._active||[]}setActiveElements(n,c){const l=this._active,h=n.map(({datasetIndex:g,index:w})=>{const b=this.chart.getDatasetMeta(g);if(!b)throw new Error("Cannot find a dataset at index "+g);return{datasetIndex:g,element:b.data[w],index:w}}),d=!ba(l,h),m=this._positionChanged(h,c);(d||m)&&(this._active=h,this._eventPosition=c,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(n,c,l=!0){if(c&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const h=this.options,d=this._active||[],m=this._getActiveElements(n,d,c,l),g=this._positionChanged(m,n),w=c||!ba(m,d)||g;return w&&(this._active=m,(h.enabled||h.external)&&(this._eventPosition={x:n.x,y:n.y},this.update(!0,c))),w}_getActiveElements(n,c,l,h){const d=this.options;if("mouseout"===n.type)return[];if(!h)return c;const m=this.chart.getElementsAtEventForMode(n,d.mode,d,l);return d.reverse&&m.reverse(),m}_positionChanged(n,c){const{caretX:l,caretY:h,options:d}=this,m=Es[d.position].call(this,n,c);return!1!==m&&(l!==m.x||h!==m.y)}}return oe(i,"positioners",Es),i})();var Ld={id:"tooltip",_element:Sf,positioners:Es,afterInit(i,a,n){n&&(i.tooltip=new Sf({chart:i,options:n}))},beforeUpdate(i,a,n){i.tooltip&&i.tooltip.initialize(n)},reset(i,a,n){i.tooltip&&i.tooltip.initialize(n)},afterDraw(i){const a=i.tooltip;if(a&&a._willRender()){const n={tooltip:a};if(!1===i.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;a.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",n)}},afterEvent(i,a){i.tooltip&&i.tooltip.handleEvent(a.event,a.replay,a.inChartArea)&&(a.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,a)=>a.bodyFont.size,boxWidth:(i,a)=>a.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Cf},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>"filter"!==i&&"itemSort"!==i&&"external"!==i,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Af=Object.freeze({__proto__:null,Colors:rf,Decimation:ad,Filler:kd,Legend:Fd,SubTitle:Wa,Title:wf,Tooltip:Ld});function Ff(i){const a=this.getLabels();return i>=0&&i<a.length?a[i]:i}let Ud=(()=>{class i extends ha{constructor(n){super(n),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(n){const c=this._addedLabels;if(c.length){const l=this.getLabels();for(const{index:h,label:d}of c)l[h]===d&&l.splice(h,1);this._addedLabels=[]}super.init(n)}parse(n,c){if(Ut(n))return null;const l=this.getLabels();return((i,a)=>null===i?null:nr(Math.round(i),0,a))(c=isFinite(c)&&l[c]===n?c:function Nd(i,a,n,c){const l=i.indexOf(a);return-1===l?((i,a,n,c)=>("string"==typeof a?(n=i.push(a)-1,c.unshift({index:n,label:a})):isNaN(a)&&(n=null),n))(i,a,n,c):l!==i.lastIndexOf(a)?n:l}(l,n,Tt(c,n),this._addedLabels),l.length-1)}determineDataLimits(){const{minDefined:n,maxDefined:c}=this.getUserBounds();let{min:l,max:h}=this.getMinMax(!0);"ticks"===this.options.bounds&&(n||(l=0),c||(h=this.getLabels().length-1)),this.min=l,this.max=h}buildTicks(){const n=this.min,c=this.max,l=this.options.offset,h=[];let d=this.getLabels();d=0===n&&c===d.length-1?d:d.slice(n,c+1),this._valueRange=Math.max(d.length-(l?0:1),1),this._startValue=this.min-(l?.5:0);for(let m=n;m<=c;m++)h.push({value:m});return h}getLabelForValue(n){return Ff.call(this,n)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(n){return"number"!=typeof n&&(n=this.parse(n)),null===n?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getPixelForTick(n){const c=this.ticks;return n<0||n>c.length-1?null:this.getPixelForValue(c[n].value)}getValueForPixel(n){return Math.round(this._startValue+this.getDecimalForPixel(n)*this._valueRange)}getBasePixel(){return this.bottom}}return oe(i,"id","category"),oe(i,"defaults",{ticks:{callback:Ff}}),i})();function Df(i,a,{horizontal:n,minRotation:c}){const l=Qe(c),h=(n?Math.sin(l):Math.cos(l))||.001;return Math.min(a/h,.75*a*(""+i).length)}class Cs extends ha{constructor(a){super(a),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(a,n){return Ut(a)||("number"==typeof a||a instanceof Number)&&!isFinite(+a)?null:+a}handleTickRangeOptions(){const{beginAtZero:a}=this.options,{minDefined:n,maxDefined:c}=this.getUserBounds();let{min:l,max:h}=this;const d=g=>l=n?l:g,m=g=>h=c?h:g;if(a){const g=Ye(l),w=Ye(h);g<0&&w<0?m(0):g>0&&w>0&&d(0)}if(l===h){let g=0===h?1:Math.abs(.05*h);m(h+g),a||d(l-g)}this.min=l,this.max=h}getTickLimit(){const a=this.options.ticks;let l,{maxTicksLimit:n,stepSize:c}=a;return c?(l=Math.ceil(this.max/c)-Math.floor(this.min/c)+1,l>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${c} would result generating up to ${l} ticks. Limiting to 1000.`),l=1e3)):(l=this.computeTickLimit(),n=n||11),n&&(l=Math.min(n,l)),l}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const a=this.options,n=a.ticks;let c=this.getTickLimit();c=Math.max(2,c);const d=function Hd(i,a){const n=[],{bounds:l,step:h,min:d,max:m,precision:g,count:w,maxTicks:b,maxDigits:S,includeBounds:O}=i,I=h||1,V=b-1,{min:X,max:K}=a,_e=!Ut(d),ge=!Ut(m),Oe=!Ut(w),Pe=(K-X)/(S+1);let Ie,st,Ue,ut,Ee=Y((K-X)/V/I)*I;if(Ee<1e-14&&!_e&&!ge)return[{value:X},{value:K}];ut=Math.ceil(K/Ee)-Math.floor(X/Ee),ut>V&&(Ee=Y(ut*Ee/V/I)*I),Ut(g)||(Ie=Math.pow(10,g),Ee=Math.ceil(Ee*Ie)/Ie),"ticks"===l?(st=Math.floor(X/Ee)*Ee,Ue=Math.ceil(K/Ee)*Ee):(st=X,Ue=K),_e&&ge&&h&&function Fe(i,a){const n=Math.round(i);return n-a<=i&&n+a>=i}((m-d)/h,Ee/1e3)?(ut=Math.round(Math.min((m-d)/Ee,b)),Ee=(m-d)/ut,st=d,Ue=m):Oe?(st=_e?d:st,Ue=ge?m:Ue,ut=w-1,Ee=(Ue-st)/ut):(ut=(Ue-st)/Ee,ut=le(ut,Math.round(ut),Ee/1e3)?Math.round(ut):Math.ceil(ut));const It=Math.max(xr(Ee),xr(st));Ie=Math.pow(10,Ut(g)?It:g),st=Math.round(st*Ie)/Ie,Ue=Math.round(Ue*Ie)/Ie;let Ft=0;for(_e&&(O&&st!==d?(n.push({value:d}),st<d&&Ft++,le(Math.round((st+Ft*Ee)*Ie)/Ie,d,Df(d,Pe,i))&&Ft++):st<d&&Ft++);Ft<ut;++Ft){const Nt=Math.round((st+Ft*Ee)*Ie)/Ie;if(ge&&Nt>m)break;n.push({value:Nt})}return ge&&O&&Ue!==m?n.length&&le(n[n.length-1].value,m,Df(m,Pe,i))?n[n.length-1].value=m:n.push({value:m}):(!ge||Ue===m)&&n.push({value:Ue}),n}({maxTicks:c,bounds:a.bounds,min:a.min,max:a.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:!1!==n.includeBounds},this._range||this);return"ticks"===a.bounds&&Be(d,this,"value"),a.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const a=this.ticks;let n=this.min,c=this.max;if(super.configure(),this.options.offset&&a.length){const l=(c-n)/Math.max(a.length-1,1)/2;n-=l,c+=l}this._startValue=n,this._endValue=c,this._valueRange=c-n}getLabelForValue(a){return dr(a,this.chart.options.locale,this.options.ticks.format)}}class Oo extends Cs{determineDataLimits(){const{min:a,max:n}=this.getMinMax(!0);this.min=sr(a)?a:0,this.max=sr(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const a=this.isHorizontal(),n=a?this.width:this.height,c=Qe(this.options.ticks.minRotation),l=(a?Math.sin(c):Math.cos(c))||.001,h=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,h.lineHeight/l))}getPixelForValue(a){return null===a?NaN:this.getPixelForDecimal((a-this._startValue)/this._valueRange)}getValueForPixel(a){return this._startValue+this.getDecimalForPixel(a)*this._valueRange}}oe(Oo,"id","linear"),oe(Oo,"defaults",{ticks:{callback:os.formatters.numeric}});const Ss=i=>Math.floor(ce(i)),pa=(i,a)=>Math.pow(10,Ss(i)+a);function Of(i){return i/Math.pow(10,Ss(i))==1}function If(i,a,n){const c=Math.pow(10,n),l=Math.floor(i/c);return Math.ceil(a/c)-l}class As extends ha{constructor(a){super(a),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(a,n){const c=Cs.prototype.parse.apply(this,[a,n]);if(0!==c)return sr(c)&&c>0?c:null;this._zero=!0}determineDataLimits(){const{min:a,max:n}=this.getMinMax(!0);this.min=sr(a)?Math.max(0,a):null,this.max=sr(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!sr(this._userMin)&&(this.min=a===pa(this.min,0)?pa(this.min,-1):pa(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:a,maxDefined:n}=this.getUserBounds();let c=this.min,l=this.max;const h=m=>c=a?c:m,d=m=>l=n?l:m;c===l&&(c<=0?(h(1),d(10)):(h(pa(c,-1)),d(pa(l,1)))),c<=0&&h(pa(l,-1)),l<=0&&d(pa(c,1)),this.min=c,this.max=l}buildTicks(){const a=this.options,c=function Vd(i,{min:a,max:n}){a=ln(i.min,a);const c=[],l=Ss(a);let h=function Wd(i,a){let c=Ss(a-i);for(;If(i,a,c)>10;)c++;for(;If(i,a,c)<10;)c--;return Math.min(c,Ss(i))}(a,n),d=h<0?Math.pow(10,Math.abs(h)):1;const m=Math.pow(10,h),g=l>h?Math.pow(10,l):0,w=Math.round((a-g)*d)/d,b=Math.floor((a-g)/m/10)*m*10;let S=Math.floor((w-b)/Math.pow(10,h)),O=ln(i.min,Math.round((g+b+S*Math.pow(10,h))*d)/d);for(;O<n;)c.push({value:O,major:Of(O),significand:S}),S>=10?S=S<15?15:20:S++,S>=20&&(h++,S=2,d=h>=0?1:d),O=Math.round((g+b+S*Math.pow(10,h))*d)/d;const I=ln(i.max,O);return c.push({value:I,major:Of(I),significand:S}),c}({min:this._userMin,max:this._userMax},this);return"ticks"===a.bounds&&Be(c,this,"value"),a.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}getLabelForValue(a){return void 0===a?"0":dr(a,this.chart.options.locale,this.options.ticks.format)}configure(){const a=this.min;super.configure(),this._startValue=ce(a),this._valueRange=ce(this.max)-ce(a)}getPixelForValue(a){return(void 0===a||0===a)&&(a=this.min),null===a||isNaN(a)?NaN:this.getPixelForDecimal(a===this.min?0:(ce(a)-this._startValue)/this._valueRange)}getValueForPixel(a){const n=this.getDecimalForPixel(a);return Math.pow(10,this._startValue+n*this._valueRange)}}function Io(i){const a=i.ticks;if(a.display&&i.display){const n=fr(a.backdropPadding);return Tt(a.font&&a.font.size,mr.font.size)+n.height}return 0}function zd(i,a,n){return n=tr(n)?n:[n],{w:Gh(i,a.string,n),h:n.length*a.lineHeight}}function Pf(i,a,n,c,l){return i===c||i===l?{start:a-n/2,end:a+n/2}:i<c||i>l?{start:a-n,end:a}:{start:a,end:a+n}}function jd(i,a,n,c,l){const h=Math.abs(Math.sin(n)),d=Math.abs(Math.cos(n));let m=0,g=0;c.start<a.l?(m=(a.l-c.start)/h,i.l=Math.min(i.l,a.l-m)):c.end>a.r&&(m=(c.end-a.r)/h,i.r=Math.max(i.r,a.r+m)),l.start<a.t?(g=(a.t-l.start)/d,i.t=Math.min(i.t,a.t-g)):l.end>a.b&&(g=(l.end-a.b)/d,i.b=Math.max(i.b,a.b+g))}function Gd(i,a,n){const c=i.drawingArea,{extra:l,additionalAngle:h,padding:d,size:m}=n,g=i.getPointPosition(a,c+l+d,h),w=Math.round(yt(Pr(g.angle+Xt))),b=function Zd(i,a,n){return 90===n||270===n?i-=a/2:(n>270||n<90)&&(i-=a),i}(g.y,m.h,w),S=function Fs(i){return 0===i||180===i?"center":i<180?"left":"right"}(w),O=function Yd(i,a,n){return"right"===n?i-=a:"center"===n&&(i-=a/2),i}(g.x,m.w,S);return{visible:!0,x:g.x,y:b,textAlign:S,left:O,top:b,right:O+m.w,bottom:b+m.h}}function Mf(i,a){if(!a)return!0;const{left:n,top:c,right:l,bottom:h}=i;return!(Ln({x:n,y:c},a)||Ln({x:n,y:h},a)||Ln({x:l,y:c},a)||Ln({x:l,y:h},a))}function Po(i,a,n){const{left:c,top:l,right:h,bottom:d}=n,{backdropColor:m}=a;if(!Ut(m)){const g=Yt(a.borderRadius),w=fr(a.backdropPadding);i.fillStyle=m;const b=c-w.left,S=l-w.top,O=h-c+w.width,I=d-l+w.height;Object.values(g).some(V=>0!==V)?(i.beginPath(),Ea(i,{x:b,y:S,w:O,h:I,radius:g}),i.fill()):i.fillRect(b,S,O,I)}}function Lf(i,a,n,c){const{ctx:l}=i;if(n)l.arc(i.xCenter,i.yCenter,a,0,rr);else{let h=i.getPointPosition(0,a);l.moveTo(h.x,h.y);for(let d=1;d<c;d++)h=i.getPointPosition(d,a),l.lineTo(h.x,h.y)}}oe(As,"id","logarithmic"),oe(As,"defaults",{ticks:{callback:os.formatters.logarithmic,major:{enabled:!0}}});class wi extends Cs{constructor(a){super(a),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const a=this._padding=fr(Io(this.options)/2),n=this.width=this.maxWidth-a.width,c=this.height=this.maxHeight-a.height;this.xCenter=Math.floor(this.left+n/2+a.left),this.yCenter=Math.floor(this.top+c/2+a.top),this.drawingArea=Math.floor(Math.min(n,c)/2)}determineDataLimits(){const{min:a,max:n}=this.getMinMax(!1);this.min=sr(a)&&!isNaN(a)?a:0,this.max=sr(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Io(this.options))}generateTickLabels(a){Cs.prototype.generateTickLabels.call(this,a),this._pointLabels=this.getLabels().map((n,c)=>{const l=$t(this.options.pointLabels.callback,[n,c],this);return l||0===l?l:""}).filter((n,c)=>this.chart.getDataVisibility(c))}fit(){const a=this.options;a.display&&a.pointLabels.display?function $d(i){const a={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},n=Object.assign({},a),c=[],l=[],h=i._pointLabels.length,d=i.options.pointLabels,m=d.centerPointLabels?Rt/h:0;for(let g=0;g<h;g++){const w=d.setContext(i.getPointLabelContext(g));l[g]=w.padding;const b=i.getPointPosition(g,i.drawingArea+l[g],m),S=Rr(w.font),O=zd(i.ctx,S,i._pointLabels[g]);c[g]=O;const I=Pr(i.getIndexAngle(g)+m),V=Math.round(yt(I));jd(n,a,I,Pf(V,b.x,O.w,0,180),Pf(V,b.y,O.h,90,270))}i.setCenterPoint(a.l-n.l,n.r-a.r,a.t-n.t,n.b-a.b),i._pointLabelItems=function Xd(i,a,n){const c=[],l=i._pointLabels.length,h=i.options,{centerPointLabels:d,display:m}=h.pointLabels,g={extra:Io(h)/2,additionalAngle:d?Rt/l:0};let w;for(let b=0;b<l;b++){g.padding=n[b],g.size=a[b];const S=Gd(i,b,g);c.push(S),"auto"===m&&(S.visible=Mf(S,w),S.visible&&(w=S))}return c}(i,c,l)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(a,n,c,l){this.xCenter+=Math.floor((a-n)/2),this.yCenter+=Math.floor((c-l)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(a,n,c,l))}getIndexAngle(a){return Pr(a*(rr/(this._pointLabels.length||1))+Qe(this.options.startAngle||0))}getDistanceFromCenterForValue(a){if(Ut(a))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-a)*n:(a-this.min)*n}getValueForDistanceFromCenter(a){if(Ut(a))return NaN;const n=a/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(a){const n=this._pointLabels||[];if(a>=0&&a<n.length){const c=n[a];return function on(i,a,n){return Oi(i,{label:n,index:a,type:"pointLabel"})}(this.getContext(),a,c)}}getPointPosition(a,n,c=0){const l=this.getIndexAngle(a)-Xt+c;return{x:Math.cos(l)*n+this.xCenter,y:Math.sin(l)*n+this.yCenter,angle:l}}getPointPositionForValue(a,n){return this.getPointPosition(a,this.getDistanceFromCenterForValue(n))}getBasePosition(a){return this.getPointPositionForValue(a||0,this.getBaseValue())}getPointLabelPosition(a){const{left:n,top:c,right:l,bottom:h}=this._pointLabelItems[a];return{left:n,top:c,right:l,bottom:h}}drawBackground(){const{backgroundColor:a,grid:{circular:n}}=this.options;if(a){const c=this.ctx;c.save(),c.beginPath(),Lf(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),c.closePath(),c.fillStyle=a,c.fill(),c.restore()}}drawGrid(){const a=this.ctx,n=this.options,{angleLines:c,grid:l,border:h}=n,d=this._pointLabels.length;let m,g,w;if(n.pointLabels.display&&function Rf(i,a){const{ctx:n,options:{pointLabels:c}}=i;for(let l=a-1;l>=0;l--){const h=i._pointLabelItems[l];if(!h.visible)continue;const d=c.setContext(i.getPointLabelContext(l));Po(n,d,h);const m=Rr(d.font),{x:g,y:w,textAlign:b}=h;Qi(n,i._pointLabels[l],g,w+m.lineHeight/2,m,{color:d.color,textAlign:b,textBaseline:"middle"})}}(this,d),l.display&&this.ticks.forEach((b,S)=>{if(0!==S){g=this.getDistanceFromCenterForValue(b.value);const O=this.getContext(S),I=l.setContext(O),V=h.setContext(O);!function Kd(i,a,n,c,l){const h=i.ctx,d=a.circular,{color:m,lineWidth:g}=a;!d&&!c||!m||!g||n<0||(h.save(),h.strokeStyle=m,h.lineWidth=g,h.setLineDash(l.dash),h.lineDashOffset=l.dashOffset,h.beginPath(),Lf(i,n,d,c),h.closePath(),h.stroke(),h.restore())}(this,I,g,d,V)}}),c.display){for(a.save(),m=d-1;m>=0;m--){const b=c.setContext(this.getPointLabelContext(m)),{color:S,lineWidth:O}=b;!O||!S||(a.lineWidth=O,a.strokeStyle=S,a.setLineDash(b.borderDash),a.lineDashOffset=b.borderDashOffset,g=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),w=this.getPointPosition(m,g),a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(w.x,w.y),a.stroke())}a.restore()}}drawBorder(){}drawLabels(){const a=this.ctx,n=this.options,c=n.ticks;if(!c.display)return;const l=this.getIndexAngle(0);let h,d;a.save(),a.translate(this.xCenter,this.yCenter),a.rotate(l),a.textAlign="center",a.textBaseline="middle",this.ticks.forEach((m,g)=>{if(0===g&&!n.reverse)return;const w=c.setContext(this.getContext(g)),b=Rr(w.font);if(h=this.getDistanceFromCenterForValue(this.ticks[g].value),w.showLabelBackdrop){a.font=b.string,d=a.measureText(m.label).width,a.fillStyle=w.backdropColor;const S=fr(w.backdropPadding);a.fillRect(-d/2-S.left,-h-b.size/2-S.top,d+S.width,b.size+S.height)}Qi(a,m.label,0,-h,b,{color:w.color,strokeColor:w.textStrokeColor,strokeWidth:w.textStrokeWidth})}),a.restore()}drawTitle(){}}oe(wi,"id","radialLinear"),oe(wi,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:os.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:i=>i,padding:5,centerPointLabels:!1}}),oe(wi,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),oe(wi,"descriptors",{angleLines:{_fallback:"grid"}});const Hi={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Jr=Object.keys(Hi);function Mo(i,a){return i-a}function Ro(i,a){if(Ut(a))return null;const n=i._adapter,{parser:c,round:l,isoWeekday:h}=i._parseOpts;let d=a;return"function"==typeof c&&(d=c(d)),sr(d)||(d="string"==typeof c?n.parse(d,c):n.parse(d)),null===d?null:(l&&(d="week"!==l||!ne(h)&&!0!==h?n.startOf(d,l):n.startOf(d,"isoWeek",h)),+d)}function yi(i,a,n,c){const l=Jr.length;for(let h=Jr.indexOf(i);h<l-1;++h){const d=Hi[Jr[h]];if(d.common&&Math.ceil((n-a)/((d.steps?d.steps:Number.MAX_SAFE_INTEGER)*d.size))<=c)return Jr[h]}return Jr[l-1]}function Va(i,a,n){if(n){if(n.length){const{lo:c,hi:l}=Zn(n,a);i[n[c]>=a?n[c]:n[l]]=!0}}else i[a]=!0}function Bf(i,a,n){const c=[],l={},h=a.length;let d,m;for(d=0;d<h;++d)m=a[d],l[m]=d,c.push({value:m,major:!1});return 0!==h&&n?function Lo(i,a,n,c){const l=i._adapter,h=+l.startOf(a[0].value,c),d=a[a.length-1].value;let m,g;for(m=h;m<=d;m=+l.add(m,1,c))g=n[m],g>=0&&(a[g].major=!0);return a}(i,c,l,n):c}let Uf=(()=>{class i extends ha{constructor(n){super(n),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(n,c={}){const l=n.time||(n.time={}),h=this._adapter=new pu__date(n.adapters.date);h.init(c),Si(l.displayFormats,h.formats()),this._parseOpts={parser:l.parser,round:l.round,isoWeekday:l.isoWeekday},super.init(n),this._normalized=c.normalized}parse(n,c){return void 0===n?null:Ro(this,n)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const n=this.options,c=this._adapter,l=n.time.unit||"day";let{min:h,max:d,minDefined:m,maxDefined:g}=this.getUserBounds();function w(b){!m&&!isNaN(b.min)&&(h=Math.min(h,b.min)),!g&&!isNaN(b.max)&&(d=Math.max(d,b.max))}(!m||!g)&&(w(this._getLabelBounds()),("ticks"!==n.bounds||"labels"!==n.ticks.source)&&w(this.getMinMax(!1))),h=sr(h)&&!isNaN(h)?h:+c.startOf(Date.now(),l),d=sr(d)&&!isNaN(d)?d:+c.endOf(Date.now(),l)+1,this.min=Math.min(h,d-1),this.max=Math.max(h+1,d)}_getLabelBounds(){const n=this.getLabelTimestamps();let c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return n.length&&(c=n[0],l=n[n.length-1]),{min:c,max:l}}buildTicks(){const n=this.options,c=n.time,l=n.ticks,h="labels"===l.source?this.getLabelTimestamps():this._generate();"ticks"===n.bounds&&h.length&&(this.min=this._userMin||h[0],this.max=this._userMax||h[h.length-1]);const d=this.min,g=function Rl(i,a,n){let c=0,l=i.length;for(;c<l&&i[c]<a;)c++;for(;l>c&&i[l-1]>n;)l--;return c>0||l<i.length?i.slice(c,l):i}(h,d,this.max);return this._unit=c.unit||(l.autoSkip?yi(c.minUnit,this.min,this.max,this._getLabelCapacity(d)):function Jd(i,a,n,c,l){for(let h=Jr.length-1;h>=Jr.indexOf(n);h--){const d=Jr[h];if(Hi[d].common&&i._adapter.diff(l,c,d)>=a-1)return d}return Jr[n?Jr.indexOf(n):0]}(this,g.length,c.minUnit,this.min,this.max)),this._majorUnit=l.major.enabled&&"year"!==this._unit?function Nf(i){for(let a=Jr.indexOf(i)+1,n=Jr.length;a<n;++a)if(Hi[Jr[a]].common)return Jr[a]}(this._unit):void 0,this.initOffsets(h),n.reverse&&g.reverse(),Bf(this,g,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(n=>+n.value))}initOffsets(n=[]){let h,d,c=0,l=0;this.options.offset&&n.length&&(h=this.getDecimalForValue(n[0]),c=1===n.length?1-h:(this.getDecimalForValue(n[1])-h)/2,d=this.getDecimalForValue(n[n.length-1]),l=1===n.length?d:(d-this.getDecimalForValue(n[n.length-2]))/2);const m=n.length<3?.5:.25;c=nr(c,0,m),l=nr(l,0,m),this._offsets={start:c,end:l,factor:1/(c+1+l)}}_generate(){const n=this._adapter,c=this.min,l=this.max,h=this.options,d=h.time,m=d.unit||yi(d.minUnit,c,l,this._getLabelCapacity(c)),g=Tt(h.ticks.stepSize,1),w="week"===m&&d.isoWeekday,b=ne(w)||!0===w,S={};let I,V,O=c;if(b&&(O=+n.startOf(O,"isoWeek",w)),O=+n.startOf(O,b?"day":m),n.diff(l,c,m)>1e5*g)throw new Error(c+" and "+l+" are too far apart with stepSize of "+g+" "+m);const X="data"===h.ticks.source&&this.getDataTimestamps();for(I=O,V=0;I<l;I=+n.add(I,g,m),V++)Va(S,I,X);return(I===l||"ticks"===h.bounds||1===V)&&Va(S,I,X),Object.keys(S).sort(Mo).map(K=>+K)}getLabelForValue(n){const l=this.options.time;return this._adapter.format(n,l.tooltipFormat?l.tooltipFormat:l.displayFormats.datetime)}format(n,c){return this._adapter.format(n,c||this.options.time.displayFormats[this._unit])}_tickFormatFunction(n,c,l,h){const d=this.options,m=d.ticks.callback;if(m)return $t(m,[n,c,l],this);const g=d.time.displayFormats,w=this._unit,b=this._majorUnit,O=b&&g[b],I=l[c];return this._adapter.format(n,h||(b&&O&&I&&I.major?O:w&&g[w]))}generateTickLabels(n){let c,l,h;for(c=0,l=n.length;c<l;++c)h=n[c],h.label=this._tickFormatFunction(h.value,c,n)}getDecimalForValue(n){return null===n?NaN:(n-this.min)/(this.max-this.min)}getPixelForValue(n){const c=this._offsets,l=this.getDecimalForValue(n);return this.getPixelForDecimal((c.start+l)*c.factor)}getValueForPixel(n){const c=this._offsets,l=this.getDecimalForPixel(n)/c.factor-c.end;return this.min+l*(this.max-this.min)}_getLabelSize(n){const c=this.options.ticks,l=this.ctx.measureText(n).width,h=Qe(this.isHorizontal()?c.maxRotation:c.minRotation),d=Math.cos(h),m=Math.sin(h),g=this._resolveTickFontOptions(0).size;return{w:l*d+g*m,h:l*m+g*d}}_getLabelCapacity(n){const c=this.options.time,l=c.displayFormats,h=l[c.unit]||l.millisecond,d=this._tickFormatFunction(n,0,Bf(this,[n],this._majorUnit),h),m=this._getLabelSize(d),g=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return g>0?g:1}getDataTimestamps(){let c,l,n=this._cache.data||[];if(n.length)return n;const h=this.getMatchingVisibleMetas();if(this._normalized&&h.length)return this._cache.data=h[0].controller.getAllParsedValues(this);for(c=0,l=h.length;c<l;++c)n=n.concat(h[c].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const n=this._cache.labels||[];let c,l;if(n.length)return n;const h=this.getLabels();for(c=0,l=h.length;c<l;++c)n.push(Ro(this,h[c]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(n){return as(n.sort(Mo))}}return oe(i,"id","time"),oe(i,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}}),i})();function el(i,a,n){let h,d,m,g,c=0,l=i.length-1;n?(a>=i[c].pos&&a<=i[l].pos&&({lo:c,hi:l}=ci(i,"pos",a)),({pos:h,time:m}=i[c]),({pos:d,time:g}=i[l])):(a>=i[c].time&&a<=i[l].time&&({lo:c,hi:l}=ci(i,"time",a)),({time:h,pos:m}=i[c]),({time:d,pos:g}=i[l]));const w=d-h;return w?m+(g-m)*(a-h)/w:m}class Hf extends Uf{constructor(a){super(a),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const a=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(a);this._minPos=el(n,this.min),this._tableRange=el(n,this.max)-this._minPos,super.initOffsets(a)}buildLookupTable(a){const{min:n,max:c}=this,l=[],h=[];let d,m,g,w,b;for(d=0,m=a.length;d<m;++d)w=a[d],w>=n&&w<=c&&l.push(w);if(l.length<2)return[{time:n,pos:0},{time:c,pos:1}];for(d=0,m=l.length;d<m;++d)b=l[d+1],g=l[d-1],w=l[d],Math.round((b+g)/2)!==w&&h.push({time:w,pos:d/(m-1)});return h}_generate(){const a=this.min,n=this.max;let c=super.getDataTimestamps();return(!c.includes(a)||!c.length)&&c.splice(0,0,a),(!c.includes(n)||1===c.length)&&c.push(n),c.sort((l,h)=>l-h)}_getTimestampsForTable(){let a=this._cache.all||[];if(a.length)return a;const n=this.getDataTimestamps(),c=this.getLabelTimestamps();return a=n.length&&c.length?this.normalize(n.concat(c)):n.length?n:c,a=this._cache.all=a,a}getDecimalForValue(a){return(el(this._table,a)-this._minPos)/this._tableRange}getValueForPixel(a){const n=this._offsets,c=this.getDecimalForPixel(a)/n.factor-n.end;return el(this._table,c*this._tableRange+this._minPos,!0)}}oe(Hf,"id","timeseries"),oe(Hf,"defaults",Uf.defaults);const Qd=[_o,qu,Af,Object.freeze({__proto__:null,CategoryScale:Ud,LinearScale:Oo,LogarithmicScale:As,RadialLinearScale:wi,TimeScale:Uf,TimeSeriesScale:Hf})];var No=te(5619),Bo=te(3997);const Ds=function ep(i,a){return i===a||i!=i&&a!=a},Uo=function tp(i,a){for(var n=i.length;n--;)if(Ds(i[n][0],a))return n;return-1};var np=Array.prototype.splice;function za(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}za.prototype.clear=function V1(){this.__data__=[],this.size=0},za.prototype.delete=function ip(i){var a=this.__data__,n=Uo(a,i);return!(n<0||(n==a.length-1?a.pop():np.call(a,n,1),--this.size,0))},za.prototype.get=function ap(i){var a=this.__data__,n=Uo(a,i);return n<0?void 0:a[n][1]},za.prototype.has=function sp(i){return Uo(this.__data__,i)>-1},za.prototype.set=function Os(i,a){var n=this.__data__,c=Uo(n,i);return c<0?(++this.size,n.push([i,a])):n[c][1]=a,this};const Ho=za,zf="object"==typeof global&&global&&global.Object===Object&&global;var xp="object"==typeof self&&self&&self.Object===Object&&self;const $a=zf||xp||Function("return this")();var _p=$a.Symbol,$f=Object.prototype,vp=$f.hasOwnProperty,wp=$f.toString,Is=_p?_p.toStringTag:void 0;var jf=Object.prototype.toString;var Gf=_p?_p.toStringTag:void 0;const Vo=function Sp(i){return null==i?void 0===i?"[object Undefined]":"[object Null]":Gf&&Gf in Object(i)?function yp(i){var a=vp.call(i,Is),n=i[Is];try{i[Is]=void 0;var c=!0}catch{}var l=wp.call(i);return c&&(a?i[Is]=n:delete i[Is]),l}(i):function rl(i){return jf.call(i)}(i)},ma=function Ap(i){var a=typeof i;return null!=i&&("object"==a||"function"==a)},nl=function Pp(i){if(!ma(i))return!1;var a=Vo(i);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a};var i,Mp=$a["__core-js_shared__"],Xf=(i=/[^.]+$/.exec(Mp&&Mp.keys&&Mp.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";var Np=Function.prototype.toString;var Hp=/^\[object .+?Constructor\]$/,Jf=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const zp=function Vp(i){return!(!ma(i)||function Rp(i){return!!Xf&&Xf in i}(i))&&(nl(i)?Jf:Hp).test(function Bp(i){if(null!=i){try{return Np.call(i)}catch{}try{return i+""}catch{}}return""}(i))},al=function Gp(i,a){var n=function $p(i,a){return i?.[a]}(i,a);return zp(n)?n:void 0},Qf=al($a,"Map"),Ps=al(Object,"create");var em=Object.prototype.hasOwnProperty;var ol=Object.prototype.hasOwnProperty;function Tn(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}Tn.prototype.clear=function Zp(){this.__data__=Ps?Ps(null):{},this.size=0},Tn.prototype.delete=function Jp(i){var a=this.has(i)&&delete this.__data__[i];return this.size-=a?1:0,a},Tn.prototype.get=function tm(i){var a=this.__data__;if(Ps){var n=a[i];return"__lodash_hash_undefined__"===n?void 0:n}return em.call(a,i)?a[i]:void 0},Tn.prototype.has=function eh(i){var a=this.__data__;return Ps?void 0!==a[i]:ol.call(a,i)},Tn.prototype.set=function G1(i,a){var n=this.__data__;return this.size+=this.has(i)?0:1,n[i]=Ps&&void 0===a?"__lodash_hash_undefined__":a,this};const cl=Tn,zo=function am(i,a){var n=i.__data__;return function rh(i){var a=typeof i;return"string"==a||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==i:null===i}(a)?n["string"==typeof a?"string":"hash"]:n.map};function Xa(i){var a=-1,n=null==i?0:i.length;for(this.clear();++a<n;){var c=i[a];this.set(c[0],c[1])}}Xa.prototype.clear=function th(){this.size=0,this.__data__={hash:new cl,map:new(Qf||Ho),string:new cl}},Xa.prototype.delete=function sm(i){var a=zo(this,i).delete(i);return this.size-=a?1:0,a},Xa.prototype.get=function cm(i){return zo(this,i).get(i)},Xa.prototype.has=function fm(i){return zo(this,i).has(i)},Xa.prototype.set=function um(i,a){var n=zo(this,i),c=n.size;return n.set(i,a),this.size+=n.size==c?0:1,this};const dm=Xa;function ga(i){var a=this.__data__=new Ho(i);this.size=a.size}ga.prototype.clear=function cp(){this.__data__=new Ho,this.size=0},ga.prototype.delete=function fp(i){var a=this.__data__,n=a.delete(i);return this.size=a.size,n},ga.prototype.get=function up(i){return this.__data__.get(i)},ga.prototype.has=function pp(i){return this.__data__.has(i)},ga.prototype.set=function mm(i,a){var n=this.__data__;if(n instanceof Ho){var c=n.__data__;if(!Qf||c.length<199)return c.push([i,a]),this.size=++n.size,this;n=this.__data__=new dm(c)}return n.set(i,a),this.size=n.size,this};const xm=ga;var _m=function(){try{var i=al(Object,"defineProperty");return i({},"",{}),i}catch{}}();const $o=_m,ll=function vm(i,a,n){"__proto__"==a&&$o?$o(i,a,{configurable:!0,enumerable:!0,value:n,writable:!0}):i[a]=n},fl=function wm(i,a,n){(void 0!==n&&!Ds(i[a],n)||void 0===n&&!(a in i))&&ll(i,a,n)};var bm=function ym(i){return function(a,n,c){for(var l=-1,h=Object(a),d=c(a),m=d.length;m--;){var g=d[i?m:++l];if(!1===n(h[g],g,h))break}return a}}();const km=bm;var ih="object"==typeof exports&&exports&&!exports.nodeType&&exports,ah=ih&&"object"==typeof module&&module&&!module.nodeType&&module,sh=ah&&ah.exports===ih?$a.Buffer:void 0,oh=sh?sh.allocUnsafe:void 0;const ch=$a.Uint8Array,Om=function Dm(i,a){var n=a?function Am(i){var a=new i.constructor(i.byteLength);return new ch(a).set(new ch(i)),a}(i.buffer):i.buffer;return new i.constructor(n,i.byteOffset,i.length)};var lh=Object.create,Mm=function(){function i(){}return function(a){if(!ma(a))return{};if(lh)return lh(a);i.prototype=a;var n=new i;return i.prototype=void 0,n}}();const Ms=Mm;var Rm=function hl(i,a){return function(n){return i(a(n))}}(Object.getPrototypeOf,Object);const fh=Rm;var Lm=Object.prototype;const uh=function hh(i){var a=i&&i.constructor;return i===("function"==typeof a&&a.prototype||Lm)},Rs=function Um(i){return null!=i&&"object"==typeof i},dh=function Wm(i){return Rs(i)&&"[object Arguments]"==Vo(i)};var ph=Object.prototype,Vm=ph.hasOwnProperty,zm=ph.propertyIsEnumerable,$m=dh(function(){return arguments}())?dh:function(i){return Rs(i)&&Vm.call(i,"callee")&&!zm.call(i,"callee")};const ul=$m,dl=Array.isArray,Ya=function Gm(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=9007199254740991},pl=function Ls(i){return null!=i&&Ya(i.length)&&!nl(i)};var Qr="object"==typeof exports&&exports&&!exports.nodeType&&exports,_h=Qr&&"object"==typeof module&&module&&!module.nodeType&&module,vh=_h&&_h.exports===Qr?$a.Buffer:void 0;const wh=(vh?vh.isBuffer:void 0)||function gh(){return!1};var yh=Function.prototype.toString,Go=Object.prototype.hasOwnProperty,qm=yh.call(Object);var hr={};hr["[object Float32Array]"]=hr["[object Float64Array]"]=hr["[object Int8Array]"]=hr["[object Int16Array]"]=hr["[object Int32Array]"]=hr["[object Uint8Array]"]=hr["[object Uint8ClampedArray]"]=hr["[object Uint16Array]"]=hr["[object Uint32Array]"]=!0,hr["[object Arguments]"]=hr["[object Array]"]=hr["[object ArrayBuffer]"]=hr["[object Boolean]"]=hr["[object DataView]"]=hr["[object Date]"]=hr["[object Error]"]=hr["[object Function]"]=hr["[object Map]"]=hr["[object Number]"]=hr["[object Object]"]=hr["[object RegExp]"]=hr["[object Set]"]=hr["[object String]"]=hr["[object WeakMap]"]=!1;var Eh="object"==typeof exports&&exports&&!exports.nodeType&&exports,Bs=Eh&&"object"==typeof module&&module&&!module.nodeType&&module,vl=Bs&&Bs.exports===Eh&&zf.process,vg=function(){try{return Bs&&Bs.require&&Bs.require("util").types||vl&&vl.binding&&vl.binding("util")}catch{}}(),Sh=vg&&vg.isTypedArray;const Ah=Sh?function xg(i){return function(a){return i(a)}}(Sh):function mg(i){return Rs(i)&&Ya(i.length)&&!!hr[Vo(i)]},wl=function yg(i,a){if(("constructor"!==a||"function"!=typeof i[a])&&"__proto__"!=a)return i[a]};var kg=Object.prototype.hasOwnProperty;const Eg=function Tg(i,a,n){var c=i[a];(!kg.call(i,a)||!Ds(c,n)||void 0===n&&!(a in i))&&ll(i,a,n)};var Dg=/^(?:0|[1-9]\d*)$/;const Dh=function Og(i,a){var n=typeof i;return!!(a=a??9007199254740991)&&("number"==n||"symbol"!=n&&Dg.test(i))&&i>-1&&i%1==0&&i<a};var Pg=Object.prototype.hasOwnProperty;const Rg=function Mg(i,a){var n=dl(i),c=!n&&ul(i),l=!n&&!c&&wh(i),h=!n&&!c&&!l&&Ah(i),d=n||c||l||h,m=d?function Ag(i,a){for(var n=-1,c=Array(i);++n<i;)c[n]=a(n);return c}(i.length,String):[],g=m.length;for(var w in i)(a||Pg.call(i,w))&&(!d||!("length"==w||l&&("offset"==w||"parent"==w)||h&&("buffer"==w||"byteLength"==w||"byteOffset"==w)||Dh(w,g)))&&m.push(w);return m};var Ug=Object.prototype.hasOwnProperty;const Wg=function Hg(i){if(!ma(i))return function Lg(i){var a=[];if(null!=i)for(var n in Object(i))a.push(n);return a}(i);var a=uh(i),n=[];for(var c in i)"constructor"==c&&(a||!Ug.call(i,c))||n.push(c);return n},Oh=function Vg(i){return pl(i)?Rg(i,!0):Wg(i)},$g=function zg(i){return function Cg(i,a,n,c){var l=!n;n||(n={});for(var h=-1,d=a.length;++h<d;){var m=a[h],g=c?c(n[m],i[m],m,n,i):void 0;void 0===g&&(g=i[m]),l?ll(n,m,g):Eg(n,m,g)}return n}(i,Oh(i))},Gg=function jg(i,a,n,c,l,h,d){var m=wl(i,n),g=wl(a,n),w=d.get(g);if(w)fl(i,n,w);else{var b=h?h(m,g,n+"",i,a,d):void 0,S=void 0===b;if(S){var O=dl(g),I=!O&&wh(g),V=!O&&!I&&Ah(g);b=g,O||I||V?dl(m)?b=m:function Xm(i){return Rs(i)&&pl(i)}(m)?b=function Im(i,a){var n=-1,c=i.length;for(a||(a=Array(c));++n<c;)a[n]=i[n];return a}(m):I?(S=!1,b=function Em(i,a){if(a)return i.slice();var n=i.length,c=oh?oh(n):new i.constructor(n);return i.copy(c),c}(g,!0)):V?(S=!1,b=Om(g,!0)):b=[]:function eg(i){if(!Rs(i)||"[object Object]"!=Vo(i))return!1;var a=fh(i);if(null===a)return!0;var n=Go.call(a,"constructor")&&a.constructor;return"function"==typeof n&&n instanceof n&&yh.call(n)==qm}(g)||ul(g)?(b=m,ul(m)?b=$g(m):(!ma(m)||nl(m))&&(b=function Nm(i){return"function"!=typeof i.constructor||uh(i)?{}:Ms(fh(i))}(g))):S=!1}S&&(d.set(g,b),l(b,g,c,h,d),d.delete(g)),fl(i,n,b)}},Xg=function Ih(i,a,n,c,l){i!==a&&km(a,function(h,d){if(l||(l=new xm),ma(h))Gg(i,a,d,n,Ih,c,l);else{var m=c?c(wl(i,d),h,d+"",i,a,l):void 0;void 0===m&&(m=h),fl(i,d,m)}},Oh)},Ph=function Yg(i){return i};var yl=Math.max;const e1=function qg(i){return function(){return i}};var t1=$o?function(i,a){return $o(i,"toString",{configurable:!0,enumerable:!1,value:e1(a),writable:!0})}:Ph,a1=Date.now,o1=function s1(i){var a=0,n=0;return function(){var c=a1(),l=16-(c-n);if(n=c,l>0){if(++a>=800)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}(t1);const c1=o1,f1=function l1(i,a){return c1(function Jg(i,a,n){return a=yl(void 0===a?i.length-1:a,0),function(){for(var c=arguments,l=-1,h=yl(c.length-a,0),d=Array(h);++l<h;)d[l]=c[a+l];l=-1;for(var m=Array(a+1);++l<a;)m[l]=c[l];return m[a]=n(d),function Zg(i,a,n){switch(n.length){case 0:return i.call(a);case 1:return i.call(a,n[0]);case 2:return i.call(a,n[0],n[1]);case 3:return i.call(a,n[0],n[1],n[2])}return i.apply(a,n)}(i,this,m)}}(i,a,Ph),i+"")};var p1=function d1(i){return f1(function(a,n){var c=-1,l=n.length,h=l>1?n[l-1]:void 0,d=l>2?n[2]:void 0;for(h=i.length>3&&"function"==typeof h?(l--,h):void 0,d&&function h1(i,a,n){if(!ma(n))return!1;var c=typeof a;return!!("number"==c?pl(n)&&Dh(a,n.length):"string"==c&&a in n)&&Ds(n[a],i)}(n[0],n[1],d)&&(h=l<3?void 0:h,l=1),a=Object(a);++c<l;){var m=n[c];m&&i(a,m,c,h)}return a})}(function(i,a,n){Xg(i,a,n)});const Mh=p1;let m1=(()=>{var i;class a{constructor(){this.colorschemesOptions=new No.X(void 0)}setColorschemesOptions(c){this.pColorschemesOptions=c,this.colorschemesOptions.next(c)}getColorschemesOptions(){return this.pColorschemesOptions}}return(i=a).\u0275fac=function(c){return new(c||i)},i.\u0275prov=v.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),a})(),g1=(()=>{var i;class a{constructor(c,l,h){this.zone=l,this.themeService=h,this.type="bar",this.plugins=[],this.chartClick=new v.vpe,this.chartHover=new v.vpe,this.subs=[],this.themeOverrides={},this.ctx=c.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe((0,Bo.x)()).subscribe(d=>this.themeChanged(d)))}ngOnChanges(c){const l=["type"],h=Object.getOwnPropertyNames(c);if(h.some(d=>l.includes(d))||h.every(d=>c[d].isFirstChange()))this.render();else{const d=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,d.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,d.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,d.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(c=>c.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new Lr(this.ctx,this.getChartConfiguration()))}update(c){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(c))}hideDataset(c,l){this.chart&&(this.chart.getDatasetMeta(c).hidden=l,this.update())}isDatasetHidden(c){return this.chart?.getDatasetMeta(c)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(c){this.themeOverrides=c,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return Mh({onHover:(c,l)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:c,active:l}))},onClick:(c,l)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:c,active:l}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}}return(i=a).\u0275fac=function(c){return new(c||i)(v.Y36(v.SBq),v.Y36(v.R0b),v.Y36(m1))},i.\u0275dir=v.lG2({type:i,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],features:[v.TTD]}),a})();const Rh=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]],x1={plugins:{colors:{enabled:!1}},datasets:{line:{backgroundColor:i=>Vi(zi(i.datasetIndex),.4),borderColor:i=>Vi(zi(i.datasetIndex),1),pointBackgroundColor:i=>Vi(zi(i.datasetIndex),1),pointBorderColor:"#fff"},bar:{backgroundColor:i=>Vi(zi(i.datasetIndex),.6),borderColor:i=>Vi(zi(i.datasetIndex),1)},get radar(){return this.line},doughnut:{backgroundColor:i=>Vi(zi(i.dataIndex),.6),borderColor:"#fff"},get pie(){return this.doughnut},polarArea:{backgroundColor:i=>Vi(zi(i.dataIndex),.6),borderColor:i=>Vi(zi(i.dataIndex),1)},get bubble(){return this.doughnut},get scatter(){return this.doughnut},get area(){return this.polarArea}}};function Vi(i,a){return"rgba("+i.concat(a).join(",")+")"}function bl(i,a){return Math.floor(Math.random()*(a-i+1))+i}function zi(i=0){return Rh[i]||function _1(){return[bl(0,255),bl(0,255),bl(0,255)]}()}let Lh=(()=>{var i;class a{constructor(){this.generateColors=!0}}return(i=a).\u0275fac=function(c){return new(c||i)},i.\u0275prov=v.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),a})();Lr.register(...Qd);let v1=(()=>{var i;class a{constructor(c){c?.plugins&&Lr.register(...c.plugins);const l=Mh(c?.generateColors?x1:{},c?.defaults||{});mr.set(l)}static forRoot(c){return{ngModule:a,providers:[{provide:Lh,useValue:c}]}}}return(i=a).\u0275fac=function(c){return new(c||i)(v.LFG(Lh,8))},i.\u0275mod=v.oAB({type:i}),i.\u0275inj=v.cJS({}),a})()}}]);