import{c as T,n as E,r as B}from"./chunk-TX7XZQ5T.js";import{b as N}from"./chunk-3YF3KXXN.js";import{a as D}from"./chunk-R7EXO3PO.js";import"./chunk-7T3FGSDY.js";import{b as A}from"./chunk-URQ7JVRI.js";import{$,F as S,Qa as I,Sa as w,U as n,V as c,X as m,Y as b,Ya as M,Za as x,aa as h,bc as F,cb as H,dc as R,ec as V,fa as C,fb as O,ga as g,k as P,oc as k,s as p,sc as v,ya as j,za as l}from"./chunk-BOCJVWYR.js";var u=(()=>{let e=class e extends A{constructor(t){super(t,"shared")}getComplect(t){let r=new R().set("id",t);return this.http.get(`${this.rootUrl}getComplect`,{params:r})}};e.\u0275fac=function(r){return new(r||e)(m(V))},e.\u0275prov=n({token:e,factory:e.\u0275fac});let i=e;return i})();var f=(()=>{let e=class e{constructor(t){this.sharedHttpService=t,this.complectSource=new P(null),this.complect$=this.complectSource.asObservable()}loadComplect(t){return this.sharedHttpService.getComplect(t).pipe(p(r=>(this.complectSource.next(r),r)))}clearComplect(){this.complectSource.next(null)}updatePropertyParam(t){this.resetPropertyParams([t])}updatePropertyParams(t){this.resetPropertyParams(t)}resetPropertyParams(t){this.complect$.pipe(S(1)).subscribe(r=>{t.forEach(s=>{let o=r?.properties.find(a=>a.id===s.propertyId);o&&(o.params=s)}),this.complectSource.next(r)})}};e.\u0275fac=function(r){return new(r||e)(m(u))},e.\u0275prov=n({token:e,factory:e.\u0275fac});let i=e;return i})();var U=(()=>{let e=class e{constructor(t,r,s){this.activatedRoute=t,this.toastr=r,this.sharedService=s,this.screenStateStore=b(N),this.subscriptions=[],this.complect$=this.sharedService.complect$.pipe(p(o=>o?.complect??null)),this.properties$=this.sharedService.complect$.pipe(p(o=>o?.properties??null)),this.items$=this.sharedService.complect$.pipe(p(o=>o?.items&&o.properties?o.items.map(a=>T.getItem(a,o.properties)):null))}ngOnInit(){let t=this.activatedRoute.paramMap.subscribe(r=>{let s=r.get("id");s?this.subscriptions.push(this.sharedService.loadComplect(s).subscribe(o=>{})):(this.toastr.error("Id is undefined"),this.sharedService.clearComplect())});this.subscriptions.push(t)}ngOnDestroy(){this.subscriptions.forEach(t=>{t&&t.unsubscribe()})}onCurrentCategoryChange(t){}onPropertyParamChange(t){this.sharedService.updatePropertyParam(t)}onPropertyParamsChange(t){this.sharedService.updatePropertyParams(t)}};e.\u0275fac=function(r){return new(r||e)(l(k),l(D),l(f))},e.\u0275cmp=$({type:e,selectors:[["app-shared"]],decls:3,vars:7,consts:[["shared",""],[1,"shared"],[1,"block","complect-items","active",3,"propertyParamsChange","propertyParamChange","isActive","complect$","items$","properties$","isReadonly"]],template:function(r,s){if(r&1){let o=H();M(0,"section",1,0)(2,"app-complect-items",2),O("propertyParamsChange",function(y){return C(o),g(s.onPropertyParamsChange(y))})("propertyParamChange",function(y){return C(o),g(s.onPropertyParamChange(y))}),x()()}r&2&&(w("mobile",s.screenStateStore.isMobilePortrait()),j(2),I("isActive",!0)("complect$",s.complect$)("items$",s.items$)("properties$",s.properties$)("isReadonly",!0))},dependencies:[E],styles:[".shared[_ngcontent-%COMP%]{display:flex;justify-content:stretch;align-items:stretch;width:100%;height:100%;gap:5px;padding:5px}.shared[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1 0 auto;height:100%;width:100%}"]});let i=e;return i})();var G=[{path:":id",component:U}],_=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=h({type:e}),e.\u0275inj=c({imports:[v.forChild(G),v]});let i=e;return i})();var fe=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=h({type:e}),e.\u0275inj=c({providers:[u,f],imports:[F,_,B]});let i=e;return i})();export{fe as SharedModule};
