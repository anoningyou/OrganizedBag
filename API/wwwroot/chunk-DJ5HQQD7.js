import{b as ke}from"./chunk-VKUBE5QY.js";import{a as ht,b as Y,d as X,e as U,f as gt,g as ft,h as ye,i as Me,j as Ht,k as jt,l as Nt,m as Oe,n as Ft,o as Ut,p as Wt,q as Bt,r as Qt}from"./chunk-TX7XZQ5T.js";import{b as se}from"./chunk-3YF3KXXN.js";import{a as ve}from"./chunk-R7EXO3PO.js";import"./chunk-7T3FGSDY.js";import{Aa as Yt,Ba as Xt,D as St,Ga as T,H as Mt,M as W,N as B,Q as xe,ba as Se,ca as It,da as Dt,ea as Pt,f as Fe,fa as Et,g as Ge,ga as Ot,ha as kt,i as k,ia as Tt,j as Ye,ja as Rt,k as Ct,ka as $t,l as Xe,la as zt,ma as Ie,na as De,oa as Pe,ra as Ee,s as ae,t as ce,ta as Vt,u as le,ua as Lt,v as bt,va as At,w as wt,x as vt,y as xt,z as yt,za as Gt}from"./chunk-URQ7JVRI.js";import{$ as te,$a as G,$b as we,A as Q,Ab as lt,B as J,Bb as H,Cb as j,Ea as He,F,Fa as je,J as Je,K as de,Oa as w,P as K,Pa as it,Qa as p,R as Ke,Sa as ie,Tb as oe,U as et,Ub as be,V as I,Vb as re,Wb as mt,X as fe,Xb as pt,Y as ee,Ya as c,Yb as dt,Za as g,Zb as _t,_a as $,a as Ve,aa as D,ab as A,ba as Le,bc as O,cb as M,cc as ut,fa as u,fb as v,ga as h,h as ge,hb as m,j as Z,k as Qe,kb as ne,mb as _e,nb as ue,oa as Ae,ob as he,p as E,pa as L,pb as nt,qb as b,rb as z,s as P,sa as tt,sb as ot,sc as Ne,t as pe,tb as rt,u as qe,ub as st,vb as at,y as Ze,ya as d,yb as Ce,za as y,zb as ct}from"./chunk-BOCJVWYR.js";var Te=function(i){return i.Items="items",i.ComplectItems="complectItems",i.Complects="complects",i}(Te||{});var Re=(()=>{let o=class o{constructor(n,e,t){this.itemsService=n,this.complectsService=e,this.toastr=t}importComplect(n){switch(n.type){case"application/json":this.loadJson(n);break;case"text/csv":this.loadCsv(n);break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":this.loadExcel(n);break;default:this.toastr.error(`Unknown file type ${n.type}`);break}}loadCsv(n){let e=new FileReader;e.onload=t=>{let s=t.target?.result;if(s&&typeof s=="string"){let a=s.split(`
`);if(!a||!a.length)return;let _=a[0].split(","),l=[];for(let C=1;C<a.length-1;C++){let x=a[C].split(",");x.length&&l.push(x)}this.addComplectFromArray(_,l,n.name.replace(/\.[^\.]+$/,""))}},e.readAsText(n,"UTF-8")}loadExcel(n){let e=new FileReader;e.onload=t=>{let s=t.target?.result;if(s){let a=gt(s),_=a.Sheets[a.SheetNames[0]],l=ft.sheet_to_json(_,{header:1});l&&l.length&&this.addComplectFromArray(l[0],l.slice(1),a.SheetNames[0])}},e.readAsArrayBuffer(n)}addComplectFromArray(n,e,t){if(!n||!n.length){this.toastr.error("Heders are empty");return}if(!e||!e.length){this.toastr.error("Data is empty");return}let s=n.findIndex(_=>_.toLowerCase()==="group"),a=n.findIndex(_=>_.toLowerCase()==="count");this.itemsService.properties$.pipe(F(1)).subscribe(_=>{let l=_.map(f=>({property:f,index:n.findIndex(S=>S.toLowerCase()===f.name.toLowerCase())})),C=e.reduce((f,S)=>{let R=S.filter((ze,me)=>me!==s&&me!==a).join("|");return(f[R]=f[R]||[]).push(S),f},{}),x=[];Object.keys(C).forEach(f=>{let S=Y();C[f].forEach(R=>{R.push(S)}),x.push({id:S,values:l.map(R=>({propertyId:R.property.id,value:R.index!==-1?C[f][0][R.index]:null}))})});let N=this.getNewComplectFromArray(e,s,a,t);this.itemsService.addItems(x,f=>{this.complectsService.addComplect(N)})})}loadJson(n){let e=new FileReader;e.onload=t=>{let s=t.target?.result;if(s&&typeof s=="string"){let a=JSON.parse(s);this.addComplect(a)}},e.readAsText(n,"UTF-8")}addComplect(n){this.itemsService.properties$.pipe(F(1)).subscribe(e=>{let t=n.groups.flatMap(_=>_.items).reduce((_,l)=>{let C=l.id?l.id:Y();return(_[C]=_[C]||[]).push(l),_},{}),s=[];Object.keys(t).forEach(_=>{let l=Y();t[_].forEach(x=>{x.id=l});let C={id:t[_][0].id,values:t[_][0].values.map(x=>({propertyId:e.find(N=>N.name===x.name)?.id,value:x.value})).filter(x=>!!x.propertyId)};s.push(C)});let a=this.getNewComplect(n);this.itemsService.addItems(s,_=>{this.complectsService.addComplect(a)})})}getNewComplect(n){return{id:Y(),name:n.name,description:n.description,groups:n.groups.map(e=>({id:Y(),name:e.name,items:e.items.map(t=>({count:t.count,itemId:t.id}))}))}}getNewComplectFromArray(n,e,t,s){let a={};e!==-1?a=n.reduce((l,C)=>((l[C[e]]=l[C[e]]||[]).push(C),l),{}):a["Default group"]=n;let _={id:Y(),name:s,groups:[]};return Object.keys(a).forEach(l=>{let C=Y();_.groups.push({id:C,complectId:_.id,name:l,items:a[l].map(x=>({groupId:C,itemId:x[x.length-1],count:t!==-1?+x[t]:1}))})}),_}};o.\u0275fac=function(e){return new(e||o)(fe(X),fe(U),fe(ve))},o.\u0275prov=et({token:o,factory:o.\u0275fac});let i=o;return i})();var q=typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;function xi(i){let o=i.cloneNode(!0),r=o.querySelectorAll("[id]"),n=i.nodeName.toLowerCase();return o.removeAttribute("id"),r.forEach(e=>{e.removeAttribute("id")}),n==="canvas"?Kt(i,o):(n==="input"||n==="select"||n==="textarea")&&Jt(i,o),Zt("canvas",i,o,Kt),Zt("input, textarea, select",i,o,Jt),o}function Zt(i,o,r,n){let e=o.querySelectorAll(i);if(e.length){let t=r.querySelectorAll(i);for(let s=0;s<e.length;s++)n(e[s],t[s])}}var yi=0;function Jt(i,o){o.type!=="file"&&(o.value=i.value),o.type==="radio"&&o.name&&(o.name=`mat-clone-${o.name}-${yi++}`)}function Kt(i,o){let r=o.getContext("2d");if(r)try{r.drawImage(i,0,0)}catch{}}function ei(i,o,r,n){let e={top:i.top,bottom:i.bottom,left:i.left,right:i.right};return o.top&&(e.top+=n),o.bottom&&(e.bottom+=n),o.left&&(e.left+=r),o.right&&(e.right+=r),e.height=e.bottom-e.top,e.width=e.right-e.left,e}function Si(i,o){let r=0,n=0,e=i.nativeElement.style,s=["transform","-ms-transform","-moz-transform","-o-transform"].map(a=>e[a]).find(a=>!!a);if(s&&s.includes("translate")&&(r=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),n=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),o==="absolute")return{height:i.nativeElement.offsetHeight,width:i.nativeElement.offsetWidth,top:i.nativeElement.offsetTop-n,bottom:i.nativeElement.offsetHeight+i.nativeElement.offsetTop-n,left:i.nativeElement.offsetLeft-r,right:i.nativeElement.offsetWidth+i.nativeElement.offsetLeft-r};{let a=i.nativeElement.getBoundingClientRect();return{height:a.height,width:a.width,top:a.top-n,bottom:a.bottom-n,left:a.left-r,right:a.right-r,scrollTop:i.nativeElement.scrollTop,scrollLeft:i.nativeElement.scrollLeft}}}var ti=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function ii(i,o){return i.left&&i.top?o.topLeft:i.right&&i.top?o.topRight:i.left&&i.bottom?o.bottomLeft:i.right&&i.bottom?o.bottomRight:i.left||i.right?o.leftOrRight:i.top||i.bottom?o.topOrBottom:""}function $e({edges:i,initialRectangle:o,newRectangle:r}){let n={};return Object.keys(i).forEach(e=>{n[e]=(r[e]||0)-(o[e]||0)}),n}var ni="resize-active",Mi="resize-ghost-element",Ii=50,Be=(()=>{class i{constructor(r,n,e,t){this.platformId=r,this.renderer=n,this.elm=e,this.zone=t,this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=ti,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=Ii,this.resizeStart=new L,this.resizing=new L,this.resizeEnd=new L,this.mouseup=new Z,this.mousedown=new Z,this.mousemove=new Z,this.destroy$=new Z,this.pointerEventListeners=We.getInstance(n,t)}ngOnInit(){let r=Q(this.pointerEventListeners.pointerDown,this.mousedown),n=Q(this.pointerEventListeners.pointerMove,this.mousemove).pipe(Ke(({event:l})=>{t&&l.cancelable&&l.preventDefault()}),de()),e=Q(this.pointerEventListeners.pointerUp,this.mouseup),t,s=()=>{t&&t.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(t.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},a=()=>Ve(Ve({},ti),this.resizeCursors);r.pipe(qe(l=>{function C(f){return{clientX:f.clientX-l.clientX,clientY:f.clientY-l.clientY}}let x=()=>{let f={x:1,y:1};return t&&(this.resizeSnapGrid.left&&t.edges.left?f.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&t.edges.right&&(f.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&t.edges.top?f.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&t.edges.bottom&&(f.y=+this.resizeSnapGrid.bottom)),f};function N(f,S){return{x:Math.ceil(f.clientX/S.x),y:Math.ceil(f.clientY/S.y)}}return Q(n.pipe(F(1)).pipe(P(f=>[,f])),n.pipe(Je())).pipe(P(([f,S])=>[f&&C(f),C(S)])).pipe(J(([f,S])=>{if(!f)return!0;let R=x(),ze=N(f,R),me=N(S,R);return ze.x!==me.x||ze.y!==me.y})).pipe(P(([,f])=>{let S=x();return{clientX:Math.round(f.clientX/S.x)*S.x,clientY:Math.round(f.clientY/S.y)*S.y}})).pipe(K(Q(e,r)))})).pipe(J(()=>!!t)).pipe(P(({clientX:l,clientY:C})=>ei(t.startingRect,t.edges,l,C))).pipe(J(l=>this.allowNegativeResizes||!!(l.height&&l.width&&l.height>0&&l.width>0))).pipe(J(l=>this.validateResize?this.validateResize({rectangle:l,edges:$e({edges:t.edges,initialRectangle:t.startingRect,newRectangle:l})}):!0),K(this.destroy$)).subscribe(l=>{t&&t.clonedNode&&(this.renderer.setStyle(t.clonedNode,"height",`${l.height}px`),this.renderer.setStyle(t.clonedNode,"width",`${l.width}px`),this.renderer.setStyle(t.clonedNode,"top",`${l.top}px`),this.renderer.setStyle(t.clonedNode,"left",`${l.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:$e({edges:t.edges,initialRectangle:t.startingRect,newRectangle:l}),rectangle:l})}),t.currentRect=l}),r.pipe(P(({edges:l})=>l||{}),J(l=>Object.keys(l).length>0),K(this.destroy$)).subscribe(l=>{t&&s();let C=Si(this.elm,this.ghostElementPositioning);t={edges:l,startingRect:C,currentRect:C};let x=a(),N=ii(t.edges,x);this.renderer.setStyle(document.body,"cursor",N),this.setElementClass(this.elm,ni,!0),this.enableGhostResize&&(t.clonedNode=xi(this.elm.nativeElement),this.elm.nativeElement.parentElement.appendChild(t.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(t.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(t.clonedNode,"left",`${t.startingRect.left}px`),this.renderer.setStyle(t.clonedNode,"top",`${t.startingRect.top}px`),this.renderer.setStyle(t.clonedNode,"height",`${t.startingRect.height}px`),this.renderer.setStyle(t.clonedNode,"width",`${t.startingRect.width}px`),this.renderer.setStyle(t.clonedNode,"cursor",ii(t.edges,x)),this.renderer.addClass(t.clonedNode,Mi),t.clonedNode.scrollTop=t.startingRect.scrollTop,t.clonedNode.scrollLeft=t.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:$e({edges:l,initialRectangle:C,newRectangle:C}),rectangle:ei(C,{},0,0)})})}),e.pipe(K(this.destroy$)).subscribe(()=>{t&&(this.renderer.removeClass(this.elm.nativeElement,ni),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:$e({edges:t.edges,initialRectangle:t.startingRect,newRectangle:t.currentRect}),rectangle:t.currentRect})}),s(),t=null)})}ngOnDestroy(){ut(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.destroy$.next()}setElementClass(r,n,e){e?this.renderer.addClass(r.nativeElement,n):this.renderer.removeClass(r.nativeElement,n)}}return i.\u0275fac=function(r){return new(r||i)(y(tt),y(He),y(Ae),y(je))},i.\u0275dir=Le({type:i,selectors:[["","mwlResizable",""]],inputs:{validateResize:"validateResize",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},exportAs:["mwlResizable"]}),i})(),We=class i{constructor(o,r){this.pointerDown=new ge(n=>{let e,t;return r.runOutsideAngular(()=>{e=o.listen("document","mousedown",s=>{n.next({clientX:s.clientX,clientY:s.clientY,event:s})}),q&&(t=o.listen("document","touchstart",s=>{n.next({clientX:s.touches[0].clientX,clientY:s.touches[0].clientY,event:s})}))}),()=>{e(),q&&t()}}).pipe(de()),this.pointerMove=new ge(n=>{let e,t;return r.runOutsideAngular(()=>{e=o.listen("document","mousemove",s=>{n.next({clientX:s.clientX,clientY:s.clientY,event:s})}),q&&(t=o.listen("document","touchmove",s=>{n.next({clientX:s.targetTouches[0].clientX,clientY:s.targetTouches[0].clientY,event:s})}))}),()=>{e(),q&&t()}}).pipe(de()),this.pointerUp=new ge(n=>{let e,t,s;return r.runOutsideAngular(()=>{e=o.listen("document","mouseup",a=>{n.next({clientX:a.clientX,clientY:a.clientY,event:a})}),q&&(t=o.listen("document","touchend",a=>{n.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}),s=o.listen("document","touchcancel",a=>{n.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}))}),()=>{e(),q&&(t(),s())}}).pipe(de())}static getInstance(o,r){return i.instance||(i.instance=new i(o,r)),i.instance}},oi=(()=>{class i{constructor(r,n,e,t){this.renderer=r,this.element=n,this.zone=e,this.resizableDirective=t,this.resizeEdges={},this.eventListeners={},this.destroy$=new Z}ngOnInit(){this.zone.runOutsideAngular(()=>{this.listenOnTheHost("mousedown").subscribe(r=>{this.onMousedown(r,r.clientX,r.clientY)}),this.listenOnTheHost("mouseup").subscribe(r=>{this.onMouseup(r.clientX,r.clientY)}),q&&(this.listenOnTheHost("touchstart").subscribe(r=>{this.onMousedown(r,r.touches[0].clientX,r.touches[0].clientY)}),Q(this.listenOnTheHost("touchend"),this.listenOnTheHost("touchcancel")).subscribe(r=>{this.onMouseup(r.changedTouches[0].clientX,r.changedTouches[0].clientY)}))})}ngOnDestroy(){this.destroy$.next(),this.unsubscribeEventListeners()}onMousedown(r,n,e){r.cancelable&&r.preventDefault(),this.eventListeners.touchmove||(this.eventListeners.touchmove=this.renderer.listen(this.element.nativeElement,"touchmove",t=>{this.onMousemove(t,t.targetTouches[0].clientX,t.targetTouches[0].clientY)})),this.eventListeners.mousemove||(this.eventListeners.mousemove=this.renderer.listen(this.element.nativeElement,"mousemove",t=>{this.onMousemove(t,t.clientX,t.clientY)})),this.resizable.mousedown.next({clientX:n,clientY:e,edges:this.resizeEdges})}onMouseup(r,n){this.unsubscribeEventListeners(),this.resizable.mouseup.next({clientX:r,clientY:n,edges:this.resizeEdges})}get resizable(){return this.resizableDirective||this.resizableContainer}onMousemove(r,n,e){this.resizable.mousemove.next({clientX:n,clientY:e,edges:this.resizeEdges,event:r})}unsubscribeEventListeners(){Object.keys(this.eventListeners).forEach(r=>{this.eventListeners[r](),delete this.eventListeners[r]})}listenOnTheHost(r){return Ze(this.element.nativeElement,r).pipe(K(this.destroy$))}}return i.\u0275fac=function(r){return new(r||i)(y(He),y(Ae),y(je),y(Be,8))},i.\u0275dir=Le({type:i,selectors:[["","mwlResizeHandle",""]],inputs:{resizeEdges:"resizeEdges",resizableContainer:"resizableContainer"}}),i})(),ri=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=D({type:i}),i.\u0275inj=I({}),i})();var zn=[k({transform:"rotate3d(0, 0, 1, 15deg)",offset:.2}),k({transform:"rotate3d(0, 0, 1, -10deg)",offset:.4}),k({transform:"rotate3d(0, 0, 1, 5deg)",offset:.6}),k({transform:"rotate3d(0, 0, 1, -5deg)",offset:.8}),k({transform:"none",offset:1})],Vn=[k({opacity:1}),k({transform:"translate3d(1, 0, 0)",opacity:0})],si=[k({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})];var ki=(i,o)=>({mobile:i,inactive:o}),Ti=()=>["expandedDetail"];function Ri(i,o){if(i&1){let r=M();c(0,"mat-card-header",6)(1,"button",7),v("click",function(){u(r);let e=m();return h(e.onActiveClick())}),c(2,"mat-icon"),b(3,"list"),g()()()}}function $i(i,o){i&1&&$(0,"div",19)}function zi(i,o){if(i&1){let r=M();c(0,"li",15),w(1,$i,1,0,"div",16),c(2,"mat-checkbox",17),at("ngModelChange",function(e){let t=u(r).$implicit;return st(t.params.listDisplay,e)||(t.params.listDisplay=e),h(e)}),v("click",function(e){return u(r),h(e.stopPropagation())})("change",function(){let e=u(r).$implicit,t=m(3);return h(t.onItemHeaderSelected(e.params))}),b(3),g(),c(4,"mat-icon",18),b(5," swap_vert "),g()()}if(i&2){let r=o.$implicit;d(2),rt("ngModel",r.params.listDisplay),p("disableRipple",!0),d(),ot(" ",r.name," ")}}function Vi(i,o){if(i&1){let r=M();c(0,"ul",13),v("cdkDropListDropped",function(e){u(r);let t=m(2);return h(t.onDropHeader(e))}),w(1,zi,6,3,"li",14),g()}if(i&2){let r=o.ngIf;p("cdkDropListData",r),d(),p("ngForOf",r)}}function Li(i,o){if(i&1){let r=M();c(0,"mat-card-header",8)(1,"mat-card-title")(2,"button",9)(3,"mat-icon"),b(4,"settings"),g()(),c(5,"mat-menu",10,0),v("click",function(e){return u(r),h(e.stopPropagation())}),w(7,Vi,2,2,"ul",11),H(8,"async"),g(),c(9,"span",12),b(10,"My stuff"),g()()()}if(i&2){let r=nt(6),n=m();d(2),p("matMenuTriggerFor",r),d(5),p("ngIf",j(8,2,n.propertiesSorted$))}}function Ai(i,o){if(i&1&&(c(0,"mat-header-cell",37)(1,"span"),b(2),g()()),i&2){let r=m(2).$implicit;p("ngClass",r.class),d(2),z(r.header)}}function Hi(i,o){i&1&&w(0,Ai,3,2,"mat-header-cell",36)}function ji(i,o){if(i&1&&(c(0,"mat-header-cell",39)(1,"span"),b(2),g()()),i&2){let r=m(2).$implicit;p("ngClass",r.class),d(2),z(r.header)}}function Ni(i,o){i&1&&w(0,ji,3,2,"mat-header-cell",38)}function Fi(i,o){if(i&1){let r=M();c(0,"mat-icon",44),v("mousedown",function(){u(r);let e=m(6);return h(e.dragDisabled=!1)})("mouseUp",function(){u(r);let e=m(6);return h(e.dragDisabled=!0)})("touchstart",function(){u(r);let e=m(6);return h(e.dragDisabled=!1)})("touchend",function(){u(r);let e=m(6);return h(e.dragDisabled=!0)}),b(1," more_vert "),g()}}function Gi(i,o){if(i&1&&(G(0),w(1,Fi,2,0,"mat-icon",43),A()),i&2){let r=m().$implicit;d(),p("ngIf",!r.isSummary)}}function Yi(i,o){if(i&1&&(G(0),c(1,"span",45),b(2),g(),A()),i&2){let r=m().$implicit;d(2),z(r.count)}}function Xi(i,o){if(i&1){let r=M();G(0),c(1,"div",46)(2,"button",47),v("click",function(e){u(r);let t=m().$implicit,s=m(4);return h(s.openEditItemDialog(t,e))}),c(3,"mat-icon"),b(4,"edit"),g()(),c(5,"button",48),v("click",function(e){u(r);let t=m().$implicit,s=m(4);return h(s.openCloneItemDialog(t,e))}),c(6,"mat-icon"),b(7,"control_point_duplicate"),g()(),c(8,"button",49),v("click",function(e){u(r);let t=m().$implicit,s=m(4);return h(s.openDeleteItemDialog(t,e))}),c(9,"mat-icon"),b(10,"delete"),g()()(),A()}}function Ui(i,o){if(i&1&&(G(0),c(1,"span",50),b(2),g(),A()),i&2){let r=m().$implicit,n=m().$implicit;d(2),z(n.cell(r))}}function Wi(i,o){if(i&1&&(G(0),$(1,"app-item-value",51),A()),i&2){let r=m().$implicit,n=m().$implicit;d(),p("property",n.property)("value",n.cell(r))}}function Bi(i,o){if(i&1&&(c(0,"mat-cell",40),w(1,Gi,2,1,"ng-container",41)(2,Yi,3,1,"ng-container",41)(3,Xi,11,0,"ng-container",41)(4,Ui,3,1,"ng-container",41)(5,Wi,2,2,"ng-container",42),g()),i&2){let r=m().$implicit;p("ngClass",r.class)("ngSwitch",r.columnDef),d(),p("ngSwitchCase","move-item"),d(),p("ngSwitchCase","count"),d(),p("ngSwitchCase","actions"),d(),p("ngSwitchCase","category")}}function Qi(i,o){if(i&1&&(G(0,31)(1,32),w(2,Hi,1,0,"ng-template",33)(3,Ni,1,0,"ng-template",34),A(),w(4,Bi,6,6,"mat-cell",35),A()),i&2){let r=o.$implicit;p("matColumnDef",r.columnDef),d(),p("ngSwitch",r.columnDef),d(),ne("ngSwitchCase",r.columnDef==="count"||r.columnDef==="actions"||r.columnDef==="move-item")}}function qi(i,o){if(i&1&&$(0,"app-item-view",55),i&2){let r=m().$implicit;p("item",r)}}function Zi(i,o){if(i&1&&(c(0,"mat-cell",52)(1,"div",53),w(2,qi,1,1,"app-item-view",54),g()()),i&2){let r=o.$implicit,n=m().ngIf,e=m(2);ie("hidden",r!==e.expandedElement),it("colspan",n.length),d(),p("@detailExpand",r===e.expandedElement?"expanded":"collapsed"),d(),p("ngIf",r===e.expandedElement)}}function Ji(i,o){i&1&&$(0,"mat-header-row",56)}function Ki(i,o){i&1&&$(0,"div",19)}function en(i,o){if(i&1){let r=M();c(0,"mat-row",57),v("cdkDragStarted",function(e){u(r);let t=m(3);return h(t.onDragStarted(e))})("cdkDragEnded",function(){u(r);let e=m(3);return h(e.onDragEnded())})("click",function(e){let t=u(r).$implicit,s=m(3);return h(s.onItemClick(t,e))})("onLongPress",function(e){let t=u(r).$implicit,s=m(3);return h(s.onItemLongPress(t,e))})("@cardAnimator.done",function(){let e=u(r).$implicit,t=m(3);return h(t.onItemSwipeRightEnd(e))})("swiperight",function(){let e=u(r).$implicit,t=m(3);return h(t.onItemSwipeRight(e))}),w(1,Ki,1,0,"div",16),g()}if(i&2){let r=o.$implicit,n=m(3);ie("expanded-row",n.expandedElement===r),p("cdkDragData",r)("longPress",!0)("@cardAnimator",r===n.slidingElement?"slideOutRight":"")}}function tn(i,o){i&1&&$(0,"mat-row",58)}function nn(i,o){if(i&1&&(c(0,"mat-table",24,1),w(2,Qi,5,3,"ng-container",25),H(3,"async"),G(4,26),w(5,Zi,3,5,"mat-cell",27),A(),w(6,Ji,1,0,"mat-header-row",28),H(7,"async"),w(8,en,2,5,"mat-row",29),H(9,"async"),w(10,tn,1,0,"mat-row",30),g()),i&2){let r=m(2);p("dataSource",r.dataSource)("cdkDropListDisabled",r.dragDisabled)("cdkDropListData",r.dataSource),d(2),p("ngForOf",j(3,8,r.columnViews$)),d(4),p("matHeaderRowDef",j(7,10,r.displayedColumns$))("matHeaderRowDefSticky",!0),d(2),p("matRowDefColumns",j(9,12,r.displayedColumns$)),d(2),p("matRowDefColumns",Ce(14,Ti))}}function on(i,o){if(i&1){let r=M();c(0,"mat-card-content",20),w(1,nn,11,15,"mat-table",21),H(2,"async"),c(3,"div",22)(4,"button",23),v("click",function(){u(r);let e=m();return h(e.openAddItemDialog())}),c(5,"mat-icon"),b(6,"add"),g()()()()}if(i&2){let r=m();d(),p("ngIf",j(2,1,r.displayedColumns$))}}var pi=(()=>{let o=class o{constructor(n,e,t){this.itemsService=n,this.complectsService=e,this.dialog=t,this.isActive=!1,this.isActiveChange=new L,this.properties$=E([]),this.items$=E([]),this.tempIndexSource=new Qe(null),this.tempIndex$=this.tempIndexSource.asObservable(),this.subsctiptions=[],this.propertiesSorted$=E([]),this.propertiesFiltered$=E([]),this.itemList$=E([]),this.columnViews$=E([]),this.displayedColumns$=E([]),this.expandedElement=null,this.slidingElement=null,this.dataSource=new zt,this.dragDisabled=!0,this.screenStateStore=ee(se)}ngOnInit(){this.propertiesSorted$=this.properties$.pipe(P(e=>[...e?.sort((t,s)=>t.params.listOrder>s.params.listOrder?1:-1)??[]])),this.propertiesFiltered$=this.propertiesSorted$.pipe(P(e=>e.filter(t=>t.params.listDisplay))),this.columnViews$=this.propertiesFiltered$.pipe(P(e=>this.getColumns(e))),this.displayedColumns$=this.columnViews$.pipe(P(e=>e.map(t=>t.columnDef)??[])),this.itemList$=pe({items:this.items$,tempIndex:this.tempIndex$}).pipe(P(e=>{if(e.tempIndex===null||!e.items)return e.items??[];{let t=[...e.items];return t.splice(e.tempIndex+1,0,e.items[e.tempIndex]),t}}));let n=pe([this.itemList$,this.propertiesFiltered$]).subscribe(e=>{this.dataSource.data=e[0]?e[0]:[],this.table?.renderRows()});this.subsctiptions.push(n)}ngOnDestroy(){this.subsctiptions.forEach(n=>{n.unsubscribe()})}getColumns(n){let e=n.map(t=>({columnDef:t.id??"",header:t.name,property:t,cell:s=>`${s.values.find(a=>a.id===t.id)?.value}`,width:`${t.params.complectWidth??50} px`,class:"item__value"}))??[];return this.screenStateStore.isMobilePortrait()||e.unshift({columnDef:"move-item",header:"",property:null,cell:()=>"",width:"30px",class:"move"}),e.push({columnDef:"actions",header:"",property:null,cell:t=>"",width:"30px",class:"actions"}),e}onItemHeaderSelected(n){this.itemsService.updatePropertyParam(n)}onDropHeader(n){let e=n.container.data?.map(t=>t.params)??[];bt(e,n.previousIndex,n.currentIndex),e.forEach((t,s)=>{t.listOrder=s}),this.itemsService.updatePropertyParams(e)}onActiveClick(){this.isActiveChange.emit()}onItemClick(n,e){this.screenStateStore.isMobile()||(this.expandedElement=this.expandedElement===n?null:n,e.stopPropagation())}onItemLongPress(n,e){this.screenStateStore.isMobile()&&(this.dragDisabled?this.expandedElement=this.expandedElement===n?null:n:this.expandedElement=null,e.stopPropagation())}onDragEnded(){this.tempIndexSource.next(null),this.dragDisabled=!0}onDragStarted(n){n.source.data?.id&&this.tempIndexSource.next(this.dataSource.data.findIndex(e=>e.id===n.source.data.id))}onItemSwipeRight(n){if(!this.screenStateStore.isMobilePortrait()){this.slidingElement=null;return}this.slidingElement||(this.slidingElement=n,this.complectsService.addItemToCurrentGroup(n).subscribe(e=>{}))}onItemSwipeRightEnd(n){this.slidingElement=null}openAddItemDialog(){this.dialog.open(ye,{data:null}).afterClosed().subscribe(e=>{})}openEditItemDialog(n,e){e.stopPropagation(),this.dialog.open(ye,{data:n}).afterClosed().subscribe(s=>{})}openCloneItemDialog(n,e){e.stopPropagation();let t=Object.assign(new ht,n);t.id="",this.dialog.open(ye,{data:t}).afterClosed().subscribe(a=>{})}openDeleteItemDialog(n,e){e.stopPropagation(),this.dialog.open(Me,{data:"Delete item?"}).afterClosed().subscribe(s=>{s&&this.itemsService.deleteItem(n.id)})}};o.\u0275fac=function(e){return new(e||o)(y(X),y(U),y(xe))},o.\u0275cmp=te({type:o,selectors:[["app-items"]],viewQuery:function(e,t){if(e&1&&_e(Se,5),e&2){let s;ue(s=he())&&(t.table=s.first)}},inputs:{isActive:"isActive",properties$:"properties$",items$:"items$"},outputs:{isActiveChange:"isActiveChange"},decls:4,vars:7,consts:[["itemsListHeadersMenu","matMenu"],["itemsList","cdkDropList"],[1,"card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],["class","header",4,"ngIf"],["class","content",4,"ngIf"],[1,"mobile-preview"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[1,"header"],["mat-icon-button","","color","primary","aria-label","Show headers","matTooltip","Show headers",3,"matMenuTriggerFor"],[1,"table-headers-menu",3,"click"],["class","table-headers-menu-list","cdkDropList","",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],[1,"header-name"],["cdkDropList","",1,"table-headers-menu-list",3,"cdkDropListDropped","cdkDropListData"],["class","item","cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y","cdkDragBoundary",".table-headers-menu-list",1,"item"],["class","drag-placeholder",4,"cdkDragPlaceholder"],[1,"ckeckbox",3,"ngModelChange","click","change","ngModel","disableRipple"],["cdkDragHandle","",1,"drag-handle"],[1,"drag-placeholder"],[1,"content"],["class","items","multiTemplateDataRows","","id","itemsList","cdkDropList","","cdkDropListConnectedTo","complectItemsList","cdkDropListSortingDisabled","",3,"dataSource","cdkDropListDisabled","cdkDropListData",4,"ngIf"],[1,"end-row"],["mat-icon-button","","color","primary","aria-label","Add item","matTooltip","Add",1,"add-btn",3,"click"],["multiTemplateDataRows","","id","itemsList","cdkDropList","","cdkDropListConnectedTo","complectItemsList","cdkDropListSortingDisabled","",1,"items",3,"dataSource","cdkDropListDisabled","cdkDropListData"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["class","detail-cell",3,"hidden",4,"matCellDef"],["class","row table-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","row item","cdkDrag","",3,"expanded-row","cdkDragData","longPress","cdkDragStarted","cdkDragEnded","click","onLongPress","swiperight",4,"matRowDef","matRowDefColumns"],["class","row detail-row",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],[3,"ngSwitch"],[3,"ngSwitchCase"],["ngSwitchDefault",""],[3,"ngClass","ngSwitch",4,"matCellDef"],["sticky","",3,"ngClass",4,"matHeaderCellDef"],["sticky","",3,"ngClass"],[3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass"],[3,"ngClass","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","reorder",3,"mousedown","mouseUp","touchstart","touchend",4,"ngIf"],[1,"reorder",3,"mousedown","mouseUp","touchstart","touchend"],[1,"count-value"],[1,"buttons-container"],["mat-icon-button","","color","primary","aria-label","Edit count",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit item",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete from complect",1,"small-button",3,"click"],[1,"category"],[1,"value",3,"property","value"],[1,"detail-cell"],[1,"detail"],[3,"item",4,"ngIf"],[3,"item"],[1,"row","table-header"],["cdkDrag","",1,"row","item",3,"cdkDragStarted","cdkDragEnded","click","onLongPress","swiperight","cdkDragData","longPress"],[1,"row","detail-row"]],template:function(e,t){e&1&&(c(0,"mat-card",2),w(1,Ri,4,0,"mat-card-header",3)(2,Li,11,4,"mat-card-header",4)(3,on,7,3,"mat-card-content",5),g()),e&2&&(p("ngClass",ct(4,ki,t.screenStateStore.isMobilePortrait(),t.screenStateStore.isMobilePortrait()&&!t.isActive)),d(),p("ngIf",t.screenStateStore.isMobilePortrait()&&!t.isActive),d(),p("ngIf",!t.screenStateStore.isMobilePortrait()||t.isActive),d(),p("ngIf",!t.screenStateStore.isMobilePortrait()||t.isActive))},dependencies:[oe,be,re,mt,pt,dt,ae,Ie,Pe,Ee,De,Vt,Lt,Se,Dt,kt,Pt,It,Tt,Et,Ot,Rt,$t,ce,xt,vt,wt,yt,le,At,St,Mt,Ht,jt,Nt,we],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;background:#f5f5f5;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.card[_ngcontent-%COMP%]{height:100%}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex:0 0 auto;display:flex;justify-content:space-between}.card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{display:flex;align-items:center}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:calc(100% - 60px);display:flex;flex-direction:column;align-items:stretch;width:100%;max-width:100%;overflow-y:auto;overflow-x:hidden}.card[_ngcontent-%COMP%]   .mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 5px;display:flex;justify-content:center;align-items:center}.table-headers-menu-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;min-width:190px}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;padding-right:10px;justify-content:space-between;align-items:center;transition:box-shadow .2s cubic-bezier(0,0,.2,1)}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active{background:#f5f5f5}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:move}.table-headers-menu-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:40px;transition:transform .25s cubic-bezier(0,0,.2,1)}.row[_ngcontent-%COMP%]{min-height:30px;overflow-wrap:break-word;position:relative}.row[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{display:flex}.row[_ngcontent-%COMP%]   .drag-placeholder[_ngcontent-%COMP%]{background:#fff;border:3px dotted rgba(0,0,0,.14);min-height:35px}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{max-width:0;min-width:0;padding-left:0;padding-right:0;position:relative;overflow:visible}.row[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:none;position:absolute;top:0;right:0;z-index:100;background-color:#fdfdfd;border-radius:10px}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{position:relative;width:0;max-width:0;min-width:0;padding-left:0;padding-right:0;overflow:visible}.row[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]   .reorder[_ngcontent-%COMP%]{position:absolute;left:-5px;top:0;z-index:100;cursor:move;display:block;color:#0003}.row[_ngcontent-%COMP%]   .expand[_ngcontent-%COMP%]{max-width:0;width:0;padding:0}.row.expanded-row[_ngcontent-%COMP%], .row.detail-row[_ngcontent-%COMP%]{background-color:#00000008}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom-width:0!important}.row.expanded-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:none}.detail-row[_ngcontent-%COMP%]{min-height:0}.detail-row[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{overflow:hidden;width:100%;padding-bottom:5px}.end-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;position:sticky;bottom:0;width:100%;height:30px}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:relative}.end-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.card.mobile[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{min-height:60px}"],data:{animation:[Fe("detailExpand",[Ye("collapsed",k({height:"0px",minHeight:"0"})),Ye("expanded",k({height:"*"})),Xe("expanded <=> collapsed",Ge("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))]),Fe("cardAnimator",[Xe("* => slideOutRight",Ge(300,Ct(si)))])]},changeDetection:0});let i=o;return i})();var sn=(i,o,r)=>({mobile:i,inactive:o,hidden:r});function an(i,o){if(i&1){let r=M();c(0,"div",5)(1,"button",6),v("click",function(){u(r);let e=m();return h(e.onToggleCard())}),c(2,"mat-icon"),b(3),g()()()}if(i&2){let r=m();p("ngClass",r.isCardHidden?"card-hidden":""),d(),ne("matTooltip",r.isCardHidden?"Show packs":"Hide packs"),d(2),z(r.isCardHidden?"arrow_back_ios":"arrow_forward_ios")}}function cn(i,o){if(i&1){let r=M();c(0,"mat-card-header",7)(1,"button",8),v("click",function(){u(r);let e=m();return h(e.onActiveClick())}),c(2,"mat-icon"),b(3,"view_quilt"),g()()()}}function ln(i,o){i&1&&(c(0,"mat-card-header")(1,"mat-card-title"),b(2,"My packs"),g()())}function mn(i,o){if(i&1){let r=M();c(0,"li",13),H(1,"async"),v("click",function(){let e=u(r).$implicit,t=m(2);return h(t.onComplectClick(e))}),$(2,"mat-divider"),c(3,"div",14)(4,"h4",15),b(5),g(),c(6,"div",16)(7,"div",17)(8,"button",18),v("click",function(){let e=u(r).$implicit,t=m(2);return h(t.openEditComplectDialog(e))}),c(9,"mat-icon"),b(10,"edit"),g()(),c(11,"button",19),v("click",function(){let e=u(r).$implicit,t=m(2);return h(t.openCloneComplectDialog(e))}),c(12,"mat-icon"),b(13,"control_point_duplicate"),g()(),c(14,"button",20),v("click",function(){let e=u(r).$implicit,t=m(2);return h(t.openDeleteComplectDialog(e))}),c(15,"mat-icon"),b(16,"delete"),g()()()()(),c(17,"div",21)(18,"p",22),b(19),g()()()}if(i&2){let r,n=o.$implicit,e=m(2);p("ngClass",n.id===((r=j(1,3,e.currentComplect$))==null?null:r.id)?"complect-list__item_selected":""),d(5),z(n.name),d(14),z(n.description)}}function pn(i,o){if(i&1){let r=M();c(0,"mat-card-content")(1,"ul",9),w(2,mn,20,5,"li",10),H(3,"async"),c(4,"li",11)(5,"button",12),v("click",function(){u(r);let e=m();return h(e.openAddComplectDialog())}),c(6,"mat-icon"),b(7,"add"),g()()()()()}if(i&2){let r=m();d(2),p("ngForOf",j(3,1,r.orderedComplects$))}}var di=(()=>{let o=class o{constructor(n,e,t){this.complectsService=n,this.dialog=e,this.toastr=t,this.isActive=!1,this.isActiveChange=new L,this.complects$=E(null),this.currentComplect$=E(null),this.currentComplectChange=new L,this.orderedComplects$=E([]),this.isCardHidden=!1,this.screenStateStore=ee(se)}ngOnInit(){this.orderedComplects$=this.complects$.pipe(P(n=>n?.sort((e,t)=>e.name.localeCompare(t.name))??[]))}openAddComplectDialog(){this.dialog.open(Oe,{data:null}).afterClosed().subscribe(e=>{e&&this.currentComplectChange.emit(e)})}openEditComplectDialog(n){this.dialog.open(Oe,{data:n}).afterClosed().subscribe(t=>{})}openCloneComplectDialog(n){let e=Object.assign({},n);e.id="",e.groups=n.groups.map(s=>{let a=Object.assign({},s);return a.id=void 0,a.complectId="",a.items=s.items.map(_=>Object.assign({},_)),a}),this.dialog.open(Oe,{data:e}).afterClosed().pipe(F(1)).subscribe(s=>{s&&this.currentComplectChange.emit(s)})}openDeleteComplectDialog(n){this.dialog.open(Me,{data:"Delete complect?"}).afterClosed().subscribe(t=>{t&&n.id&&this.complectsService.deleteComplect(n.id)&&pe({currentComplect:this.currentComplect$,complects:this.complects$}).pipe(F(1)).subscribe({next:s=>{this.toastr.success("Done!"),n.id===s.currentComplect?.id&&this.currentComplectChange.emit(s.complects?.length?s.complects[0]:null)},error:s=>this.toastr.error(s.error)})})}onComplectClick(n){this.currentComplectChange.emit(n)}onToggleCard(){this.isCardHidden=!this.isCardHidden}onActiveClick(){this.isActiveChange.emit()}};o.\u0275fac=function(e){return new(e||o)(y(U),y(xe),y(ve))},o.\u0275cmp=te({type:o,selectors:[["app-complects"]],inputs:{isActive:"isActive",complects$:"complects$",currentComplect$:"currentComplect$"},outputs:{isActiveChange:"isActiveChange",currentComplectChange:"currentComplectChange"},decls:6,vars:9,consts:[[1,"container"],["class","toggle-button",3,"ngClass",4,"ngIf"],[1,"card",3,"ngClass"],["class","mobile-preview",4,"ngIf"],[4,"ngIf"],[1,"toggle-button",3,"ngClass"],["mat-icon-button","","color","primary",3,"click","matTooltip"],[1,"mobile-preview"],["mat-icon-button","","color","primary","aria-label","Show items","matTooltip","Show items",3,"click"],[1,"complect-list"],["class","complect-list__item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"complect-list_item","complect-list_item-end"],["mat-icon-button","","color","primary","aria-label","Add complect","matTooltip","Add",1,"complect-list__add-btn",3,"click"],[1,"complect-list__item",3,"click","ngClass"],[1,"complect-list__item-header"],["matListItemTitle","",1,"complect-list__item-header-text"],[1,"complect-list__buttons"],[1,"complect-list__buttons-container"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Edit",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Edit item","matTooltip","Clone",1,"small-button",3,"click"],["mat-icon-button","","color","primary","aria-label","Delete item","matTooltip","Delete",1,"small-button",3,"click"],[1,"complect-list__item-data"],["matListItemLine",""]],template:function(e,t){e&1&&(c(0,"div",0),w(1,an,4,3,"div",1),c(2,"mat-card",2),w(3,cn,4,0,"mat-card-header",3)(4,ln,3,0,"mat-card-header",4)(5,pn,8,3,"mat-card-content",4),g()()),e&2&&(d(),p("ngIf",!t.screenStateStore.isMobilePortrait()),d(),p("ngClass",lt(5,sn,t.screenStateStore.isMobilePortrait(),!t.isActive,!t.screenStateStore.isMobilePortrait()&&t.isCardHidden)),d(),p("ngIf",t.screenStateStore.isMobilePortrait()&&!t.isActive),d(),p("ngIf",!t.screenStateStore.isMobilePortrait()||t.isActive),d(),p("ngIf",!t.screenStateStore.isMobilePortrait()||t.isActive))},dependencies:[oe,be,re,ae,Ie,Pe,Ee,De,ce,Gt,Xt,Yt,le,we],styles:[".container[_ngcontent-%COMP%]{height:100%;position:relative}.mat-mdc-card[_ngcontent-%COMP%]{height:100%}.mat-mdc-card-header[_ngcontent-%COMP%]{justify-content:space-between;margin-left:30px}.mat-mdc-card-content[_ngcontent-%COMP%]{min-width:250px;height:calc(100% - 50px);overflow:auto}.complect-list__item[_ngcontent-%COMP%]{padding-right:3px}.complect-list__item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__item-header-text[_ngcontent-%COMP%]{margin-bottom:3px}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]{width:0;position:relative}.complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]   .complect-list__buttons-container[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;display:none}.complect-list__item[_ngcontent-%COMP%]:hover{cursor:pointer}.complect-list__item[_ngcontent-%COMP%]:hover   .complect-list__item-header[_ngcontent-%COMP%]   .complect-list__buttons[_ngcontent-%COMP%]   .complect-list__buttons-container[_ngcontent-%COMP%]{display:flex}.complect-list__item_selected[_ngcontent-%COMP%]{background-color:#0000000a}.complect-list_item-end[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;left:0;bottom:0;display:flex;justify-content:flex-end}.toggle-button[_ngcontent-%COMP%]{position:absolute;top:0;z-index:100}.toggle-button.card-visible[_ngcontent-%COMP%]{left:0}.toggle-button.card-hidden[_ngcontent-%COMP%]{right:0}.hidden[_ngcontent-%COMP%]{display:none}.mobile-preview[_ngcontent-%COMP%]{height:100%;padding:0 5px;margin:0;display:flex;justify-content:center;align-items:center}"],changeDetection:0});let i=o;return i})();var _n=["home"],un=["items"],hn=()=>({right:!0});function gn(i,o){if(i&1){let r=M();c(0,"div",9)(1,"button",10),v("click",function(){u(r);let e=m();return h(e.onToggleItems())}),c(2,"mat-icon"),b(3),g()()()}if(i&2){let r=m();p("ngClass",r.isItemsHidden?"card-hidden":"card-visible"),d(),ne("matTooltip",r.isItemsHidden?"Show packs":"Hide packs"),d(2),z(r.isItemsHidden?"arrow_forward_ios":"arrow_back_ios")}}function fn(i,o){i&1&&$(0,"div",11),i&2&&p("resizeEdges",Ce(1,hn))}var _i=(()=>{let o=class o{constructor(n,e,t){this.itemsService=n,this.complectsService=e,this.importService=t,this.mobileWidth=992,this.itemsWidth=300,this.isItemsHidden=!1,this.tabsEnum=Te,this.activeTab=Te.ComplectItems,this.subsctiptions=[],this.screenStateStore=ee(se)}ngOnInit(){}ngOnDestroy(){this.subsctiptions.forEach(n=>{n.unsubscribe()})}onItemsResizeEnd(n){this.itemsWidth=n.rectangle.width??50}onCurrentComplectChange(n){this.complectsService.setCurrentComplect(n)}onCurrentCategoryChange(n){this.complectsService.setCurrentGroup(n)}onPropertyParamChange(n){this.itemsService.updatePropertyParam(n)}onPropertyParamsChange(n){this.itemsService.updatePropertyParams(n)}onToggleItems(){this.isItemsHidden=!this.isItemsHidden}onActiveTabChange(n){this.activeTab=n}importComplect(n){this.importService.importComplect(n)}getItemsWidth(){return this.screenStateStore.isMobilePortrait()?"100%":this.isItemsHidden?"0":`${this.itemsWidth}px`}getItemsMinWidth(){return this.screenStateStore.isMobilePortrait()?"100%":this.isItemsHidden?"0":"200px"}getItemsStyle(){return this.screenStateStore.isMobilePortrait()?{}:{width:this.isItemsHidden?"0":`${this.itemsWidth}px`,"min-width":this.isItemsHidden?"0":"200px"}}};o.\u0275fac=function(e){return new(e||o)(y(X),y(U),y(Re))},o.\u0275cmp=te({type:o,selectors:[["app-home"]],viewQuery:function(e,t){if(e&1&&(_e(_n,7),_e(un,7)),e&2){let s;ue(s=he())&&(t.homeElement=s.first),ue(s=he())&&(t.itemsElement=s.first)}},decls:9,vars:21,consts:[["home",""],["items",""],[1,"home"],["mwlResizable","",1,"block","items",3,"resizeEnd","ngClass","ngStyle","enableGhostResize"],["class","toggle-button",3,"ngClass",4,"ngIf"],[3,"isActiveChange","isActive","properties$","items$"],["class","resize-handle-right","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],[1,"block","complect-items",3,"isActiveChange","complectChange","currentCategoryChange","propertyParamsChange","propertyParamChange","onImportComplect","ngClass","isActive","complect$","items$","properties$"],[1,"block","complects",3,"isActiveChange","currentComplectChange","ngClass","isActive","complects$","currentComplect$"],[1,"toggle-button",3,"ngClass"],["mat-icon-button","","color","primary",3,"click","matTooltip"],["mwlResizeHandle","",1,"resize-handle-right",3,"resizeEdges"]],template:function(e,t){if(e&1){let s=M();c(0,"section",2,0)(2,"div",3,1),v("resizeEnd",function(_){return u(s),h(t.onItemsResizeEnd(_))}),w(4,gn,4,3,"div",4),c(5,"app-items",5),v("isActiveChange",function(){return u(s),h(t.onActiveTabChange(t.tabsEnum.Items))}),g(),w(6,fn,1,2,"div",6),g(),c(7,"app-complect-items",7),v("isActiveChange",function(){return u(s),h(t.onActiveTabChange(t.tabsEnum.ComplectItems))})("complectChange",function(_){return u(s),h(t.onCurrentComplectChange(_))})("currentCategoryChange",function(_){return u(s),h(t.onCurrentCategoryChange(_))})("propertyParamsChange",function(_){return u(s),h(t.onPropertyParamsChange(_))})("propertyParamChange",function(_){return u(s),h(t.onPropertyParamChange(_))})("onImportComplect",function(_){return u(s),h(t.importComplect(_))}),g(),c(8,"app-complects",8),v("isActiveChange",function(){return u(s),h(t.onActiveTabChange(t.tabsEnum.Complects))})("currentComplectChange",function(_){return u(s),h(t.onCurrentComplectChange(_))}),g()()}e&2&&(ie("mobile",t.screenStateStore.isMobilePortrait()),d(2),ie("resizable",!t.screenStateStore.isMobilePortrait()),p("ngClass",t.activeTab===t.tabsEnum.Items?"active":"inactive")("ngStyle",t.getItemsStyle())("enableGhostResize",!1),d(2),p("ngIf",!t.screenStateStore.isMobilePortrait()),d(),p("isActive",t.activeTab===t.tabsEnum.Items)("properties$",t.itemsService.properties$)("items$",t.itemsService.itemObjects$),d(),p("ngIf",!t.screenStateStore.isMobilePortrait()),d(),p("ngClass",t.activeTab===t.tabsEnum.ComplectItems?"active":"inactive")("isActive",t.activeTab===t.tabsEnum.ComplectItems)("complect$",t.complectsService.currentComplect$)("items$",t.itemsService.itemObjects$)("properties$",t.itemsService.properties$),d(),p("ngClass",t.activeTab===t.tabsEnum.Complects?"active":"inactive")("isActive",t.activeTab===t.tabsEnum.Complects)("complects$",t.complectsService.complects$)("currentComplect$",t.complectsService.currentComplect$))},dependencies:[oe,re,_t,Be,oi,ae,ce,le,pi,Ft,di],styles:[".home[_ngcontent-%COMP%]{display:flex;justify-content:stretch;align-items:stretch;height:100%;gap:5px;padding:5px}.home[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;height:100%}.home[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{position:relative}.home[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]   app-items[_ngcontent-%COMP%]{flex-grow:1;width:100%}.home[_ngcontent-%COMP%]   .complect-items[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;min-width:280px}.home[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{position:absolute;top:0;z-index:100}.home[_ngcontent-%COMP%]   .toggle-button.card-visible[_ngcontent-%COMP%]{right:0}.home[_ngcontent-%COMP%]   .toggle-button.card-hidden[_ngcontent-%COMP%]{left:0}.home.mobile[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:space-between}.home.mobile[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-grow:1;width:auto;min-width:auto}.home.mobile[_ngcontent-%COMP%] > .active[_ngcontent-%COMP%]{order:-1;flex:1 0 100%;height:calc(100% - 70px);width:100%}.home.mobile[_ngcontent-%COMP%] > .inactive[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;height:60px;max-width:50%}.home.mobile[_ngcontent-%COMP%] > .inactive.complect-items[_ngcontent-%COMP%]{order:3;flex-grow:1;flex-shrink:0;max-width:calc(100% - 65px);width:calc(100% - 65px)}.home.mobile[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{display:none}"]});let i=o;return i})();var ui=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[O,ke,W,B,T]});let i=o;return i})();var hi=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[O,W,B,T,ke]});let i=o;return i})();var gi=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[O,ui,T,W,B,Ut,Wt,hi,Bt]});let i=o;return i})();var fi=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[O,W,B,T]});let i=o;return i})();var Ci=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[O,T,fi]});let i=o;return i})();var Cn=[{path:"",component:_i}],bi=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({imports:[Ne.forChild(Cn),Ne]});let i=o;return i})();var yr=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=I({providers:[X,Re],imports:[O,ri,T,gi,Qt,Ci,bi]});let i=o;return i})();export{yr as HomeModule};
